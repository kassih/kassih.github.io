<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>Hugo Site Deployment With Github Actions | Ef's log</title><meta name=keywords content="Hugo,GitHub Actions"><meta name=description content="Applying a small part of Continuous Deployment to your Hugo site"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/blog/hugo-deployment-with-github-actions/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="Hugo Site Deployment With Github Actions"><meta property="og:description" content="Applying a small part of Continuous Deployment to your Hugo site"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/blog/hugo-deployment-with-github-actions/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-11-01T14:51:02+07:00"><meta property="article:modified_time" content="2021-11-01T14:51:02+07:00"><meta property="og:see_also" content="https://fahmifj.github.io/blog/hugo-setup-and-deployment/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hugo Site Deployment With Github Actions"><meta name=twitter:description content="Applying a small part of Continuous Deployment to your Hugo site"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://fahmifj.github.io/blog/"},{"@type":"ListItem","position":2,"name":"Hugo Site Deployment With Github Actions","item":"https://fahmifj.github.io/blog/hugo-deployment-with-github-actions/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hugo Site Deployment With Github Actions","name":"Hugo Site Deployment With Github Actions","description":"Applying a small part of Continuous Deployment to your Hugo site","keywords":["Hugo","GitHub Actions"],"articleBody":"This post is a continuation from my previous post about Hugo Setup and Deployment. In this post, weâ€™ll look into GitHub Actions.\nFirst thing first, letâ€™s sum up what we did previously:\nWe created a site and generated its HTML files (under /public folder) using Hugo. We hosted these HTML files in a GitHub repository (by enabling the GitHub Pages feature). And then we wrote a deployment script written in bash, which is used to automatically generate and push the HTML files to the GitHub repository in order update the contents of our site. Actually, the deployment script we wrote is not the effective way to deploy our site if you care about network bandwidth and storage. This is because there will be a bunch of new HTML files generated on our machine and weâ€™re going to upload all of them to the Internet each time we wish to update the site. Luckily, we can tackle this with GitHub Actions\nGitHub Actions basically does the same thing as we did, but, instead of using our own machine to generate and push the html files, weâ€™ll let GitHub VM/Docker instances do it for us.\nI know that there are a lot of similar tutorials out there, but let me finish what Iâ€™ve started!\nGoals The only goal of this post is:\nAutomate Site Deployment using GitHub Actions (Iâ€™ll try my best to explain about it!) Prerequisites Prerequisites are still the same, they are:\nA GitHub account Familiarity with CLI Familiarity with Git. A Little Clean Up Letâ€™s start by reviewing the previous site structure, hereâ€™s where we (I) left it:\n$ tree -a -L 2 -I \"\\.git\" . â”œâ”€â”€ .gitmodules â”œâ”€â”€ archetypes â”‚Â â””â”€â”€ default.md â”œâ”€â”€ config.yml â”œâ”€â”€ content â”‚Â â””â”€â”€ post â”œâ”€â”€ data â”œâ”€â”€ deploy.sh â”œâ”€â”€ layouts â”œâ”€â”€ public # \u003c-- All files under this folder are hosted using GitHub Pages, â”‚Â â”œâ”€â”€ 404.html â”‚Â â”œâ”€â”€ assets â”‚Â â”œâ”€â”€ categories â”‚Â â”œâ”€â”€ en â”‚Â â”œâ”€â”€ fa â”‚Â â”œâ”€â”€ fr â”‚Â â”œâ”€â”€ index.html â”‚Â â”œâ”€â”€ index.json â”‚Â â”œâ”€â”€ index.xml â”‚Â â”œâ”€â”€ page â”‚Â â”œâ”€â”€ post â”‚Â â”œâ”€â”€ robots.txt â”‚Â â”œâ”€â”€ series â”‚Â â”œâ”€â”€ sitemap.xml â”‚Â â””â”€â”€ tags â”œâ”€â”€ resources â”‚Â â””â”€â”€ _gen â”œâ”€â”€ static â””â”€â”€ themes â””â”€â”€ PaperMod 20 directories, 10 files Weâ€™ll now ignore the public folder and remove all of its content including the git repository inside it because this will be handled by GitHub Actions later.\n$ rm ./public/* -r f $ rm ./public/.git -rf If you happen to use the public folder as a submodule, remove the following lines from .git/config and .gitmodules\n[submodule \"public\"] url = https://github.com/your-username/my-blog.git active = true Clean any cached content from the public folder.\n$ git rm --cached ./public -f Then letâ€™s create another GitHub repository with the format your-username.github.io, because weâ€™re going to use this repo as the remote repository of our site.\n$ git remote add origin https://github.com/your-username/your-username.github.io.git For the config.yaml, change the baseURL value with:\nbaseURL: \"https://your-username.github.io/\" Add the Theme as Submodule If you happen to not using theme as submodule previously, this time we will.\nRun the following command to add the PaperMod theme we cloned previously as a submodule of our site.\n$ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod If you donâ€™t use the same theme, simply replace the url and directory parts to match yours.\nAdd GitHub Actions On the previous post, we automated several things: site build, commit, and push our site to GitHub using a bash script. We can call the execution of this script as a workflow that runs a single job, it is to deploy our site. Each command executed within the deployment script (build, commit, push) can be referred as a step.\nGitHub Actions are basically the advanced version of the deployment script we created. Itâ€™s event-driven, which means we can set a specific event to trigger the workflow. In this case, weâ€™ll create an event that will trigger the site deployment each time we push a new commit to the main branch.\nA workflow file for GitHub Actions must be written in YAML syntax, and itâ€™s placed under a special directory called .github/workflows/[here].yml, so letâ€™s create the folder first inside our site repository.\n$ mkdir -p ./.github/workflows Weâ€™ll save the following code under the workflow directory with a name gh-pages.yml (./.github/workflows/gh-pages.yml).\nname: github pages on: push: branches: - main # Set a branch to deploy jobs: deploy: runs-on: ubuntu-18.04 steps: - uses: actions/checkout@v2 with: submodules: true # Fetch Hugo themes (true OR recursive) fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: 'latest' extended: true - name: Build run: hugo --minify --cleanDestinationDir - name: Deploy uses: peaceiris/actions-gh-pages@v3 with: github_token: ${{ secrets.GITHUB_TOKEN }} publish_dir: ./public You can study the code yourself, because Iâ€™m not the one who created it ðŸ˜…. But, to make sure that the public folder always get cleaned first before build, I added --cleanDestinationDir option.\nLetâ€™s commit this workflow and push it to GitHub.\n$ git add ./.github/workflows/gh-pages.yml $ git commit -m \"Add gh-pages.yml\" $ git push -u origin main Trigger the Workflow! We can create a new post, then add some text to it.\n$ hugo new post/test-gh-actions.md $ echo 'Test GH Action' \u003e\u003e content/post/test-gh-actions.md Finally, commit the change and push it to your repository to trigger the workflow\n$ git commit -m \"Trigger build\" $ git push -u origin main To observe the deployment process/workflow, just navigate to your site repository and click on the action menu (https://github.com/your-username/your-username.github.io/actions).\nThatâ€™s it!\nMy Current Deployment A bit off topic, but Iâ€™ll show you my current deployment process.\nMy deployment process a little bit different, because Iâ€™ve separated my blog into two: blog-core and the full static HTML site (itâ€™s this site). The blog-core is a private repo whereas the full static HTML is a public repository. The blog-core repo contains my draft, notes, and other (a lot of them), which is only available for me locally because of .gitignore.\nWhen a new commit is pushed on the blog-core, GitHub Actions will be triggered to generate the static HTML files. The newly generated HTML files are then pushed to the public repo. I had to include my secret token in the blog-core so that GitHub Actions could use the token to authenticate itself to do some modification on public repo.\nNote: these are not the actual commands.\nIâ€™ll separate this section in a dedicated post later! nevermind lol\nWell, itâ€™s not in detail, but it should give you an idea of how it works. See you in another post.\nI found the blog post that explains about this: Deploy a Public Github Pages site from a Private Hugo Repository. And hereâ€™s the Github Actions that I use Hugo Remote.\n","wordCount":"1118","inLanguage":"en","datePublished":"2021-11-01T14:51:02+07:00","dateModified":"2021-11-01T14:51:02+07:00","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/blog/hugo-deployment-with-github-actions/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://fahmifj.github.io/blog/>Blog</a></div><h1 class=post-title>Hugo Site Deployment With Github Actions</h1><p class=post-description>Applying a small part of Continuous Deployment to your Hugo site</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>November 01, 2021
</span>&nbsp;&#183;&nbsp;<span class=meta-read>6 min read</span></div><hr><div class=series-info>Series:&nbsp;<a href=https://fahmifj.github.io/series/hugo/>Hugo</a></div></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#a-little-clean-up aria-label="A Little Clean Up">A Little Clean Up</a></li><li><a href=#add-the-theme-as-submodule aria-label="Add the Theme as Submodule">Add the Theme as Submodule</a></li><li><a href=#add-github-actions aria-label="Add GitHub Actions">Add GitHub Actions</a></li><li><a href=#trigger-the-workflow aria-label="Trigger the Workflow!">Trigger the Workflow!</a></li><li><a href=#my-current-deployment aria-label="My Current Deployment">My Current Deployment</a></li></ul></div></aside><div class=post-content><p>This post is a continuation from my previous post about <a href=https://fahmifj.github.io/blog/hugo-setup-and-deployment/>Hugo Setup and Deployment</a>. In this post, we&rsquo;ll look into GitHub Actions.</p><p>First thing first, let&rsquo;s sum up what we did previously:</p><ul><li>We created a site and generated its HTML files (under <code>/public</code> folder) using Hugo.</li><li>We hosted these HTML files in a GitHub repository (by enabling the GitHub Pages feature).</li><li>And then we wrote a deployment script written in bash, which is used to automatically generate and push the HTML files to the GitHub repository in order update the contents of our site.</li></ul><p>Actually, the deployment script we wrote is not the effective way to deploy our site if you care about network bandwidth and storage. This is because there will be a bunch of new HTML files generated on our machine and we&rsquo;re going to upload all of them to the Internet each time we wish to update the site. Luckily, we can tackle this with GitHub Actions</p><p>GitHub Actions basically does the same thing as we did, but, instead of using our own machine to generate and push the html files, we&rsquo;ll let GitHub VM/Docker instances do it for us.</p><p>I know that there are a lot of similar tutorials out there, but let me finish what I&rsquo;ve started!</p><h4 id=goals>Goals<a class=anchor aria-hidden=true href=#goals>#</a></h4><p>The only goal of this post is:</p><ul><li>Automate Site Deployment using GitHub Actions (I&rsquo;ll try my best to explain about it!)</li></ul><h4 id=prerequisites>Prerequisites<a class=anchor aria-hidden=true href=#prerequisites>#</a></h4><p>Prerequisites are still the same, they are:</p><ul><li>A GitHub account</li><li>Familiarity with CLI</li><li>Familiarity with Git.</li></ul><h2 id=a-little-clean-up>A Little Clean Up<a class=anchor aria-hidden=true href=#a-little-clean-up>#</a></h2><p>Let&rsquo;s start by reviewing the previous site structure, here&rsquo;s where we (I) left it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ tree -a -L <span class=m>2</span> -I <span class=s2>&#34;\.git&#34;</span>
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ .gitmodules
</span></span><span class=line><span class=cl>â”œâ”€â”€ archetypes
</span></span><span class=line><span class=cl>â”‚Â Â  â””â”€â”€ default.md
</span></span><span class=line><span class=cl>â”œâ”€â”€ config.yml
</span></span><span class=line><span class=cl>â”œâ”€â”€ content
</span></span><span class=line><span class=cl>â”‚Â Â  â””â”€â”€ post
</span></span><span class=line><span class=cl>â”œâ”€â”€ data
</span></span><span class=line><span class=cl>â”œâ”€â”€ deploy.sh
</span></span><span class=line><span class=cl>â”œâ”€â”€ layouts
</span></span><span class=line><span class=cl>â”œâ”€â”€ public <span class=c1># &lt;-- All files under this folder are hosted using GitHub Pages,</span>
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ 404.html
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ assets
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ categories
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ en
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ fa
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ fr
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ index.html
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ index.json
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ index.xml
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ page
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ post
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ robots.txt
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ series
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ sitemap.xml
</span></span><span class=line><span class=cl>â”‚Â Â  â””â”€â”€ tags
</span></span><span class=line><span class=cl>â”œâ”€â”€ resources
</span></span><span class=line><span class=cl>â”‚Â Â  â””â”€â”€ _gen
</span></span><span class=line><span class=cl>â”œâ”€â”€ static
</span></span><span class=line><span class=cl>â””â”€â”€ themes
</span></span><span class=line><span class=cl>    â””â”€â”€ PaperMod
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>20</span> directories, <span class=m>10</span> files
</span></span></code></pre></div><p>We&rsquo;ll now ignore the public folder and remove all of its content including the git repository inside it because this will be handled by GitHub Actions later.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ rm ./public/* -r f
</span></span><span class=line><span class=cl>$ rm ./public/.git -rf
</span></span></code></pre></div><p>If you happen to use the <code>public</code> folder as a submodule, remove the following lines from <code>.git/config</code> and <code>.gitmodules</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[submodule &#34;public&#34;]
</span></span><span class=line><span class=cl>        url = https://github.com/your-username/my-blog.git
</span></span><span class=line><span class=cl>        active = true
</span></span></code></pre></div><p>Clean any cached content from the <code>public</code> folder.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ git rm --cached ./public -f
</span></span></code></pre></div><p>Then let&rsquo;s create another GitHub repository with the format <code>your-username.github.io</code>, because we&rsquo;re going to use this repo as the remote repository of our site.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ git remote add origin https://github.com/your-username/your-username.github.io.git
</span></span></code></pre></div><p>For the <code>config.yaml</code>, change the baseURL value with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>baseURL</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://your-username.github.io/&#34;</span><span class=w>
</span></span></span></code></pre></div><h2 id=add-the-theme-as-submodule>Add the Theme as Submodule<a class=anchor aria-hidden=true href=#add-the-theme-as-submodule>#</a></h2><p>If you happen to not using theme as submodule previously, this time we will.</p><p>Run the following command to add the PaperMod theme we cloned previously as a submodule of our site.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod
</span></span></code></pre></div><p>If you don&rsquo;t use the same theme, simply replace the url and directory parts to match yours.</p><h2 id=add-github-actions>Add GitHub Actions<a class=anchor aria-hidden=true href=#add-github-actions>#</a></h2><p>On the previous post, we automated several things: site build, commit, and push our site to GitHub using a bash script. We can call the execution of this script as a <strong>workflow</strong> that runs a single <strong>job</strong>, it is to deploy our site. Each command executed within the deployment script (build, commit, push) can be referred as a <strong>step</strong>.</p><p>GitHub Actions are basically the advanced version of the deployment script we created. It&rsquo;s event-driven, which means we can set a specific event to trigger the workflow. In this case, we&rsquo;ll create an event that will trigger the site deployment each time we push a new commit to the main branch.</p><p>A workflow file for GitHub Actions must be written in YAML syntax, and it&rsquo;s placed under a special directory called <code>.github/workflows/[here].yml</code>, so let&rsquo;s create the folder first inside our site repository.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ mkdir -p ./.github/workflows
</span></span></code></pre></div><p>We&rsquo;ll save the following code under the workflow directory with a name <code>gh-pages.yml</code> (<code>./.github/workflows/gh-pages.yml</code>).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>github pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>main </span><span class=w> </span><span class=c># Set a branch to deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-18.04</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>submodules</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>  </span><span class=c># Fetch Hugo themes (true OR recursive)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>fetch-depth</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>    </span><span class=c># Fetch all history for .GitInfo and .Lastmod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup Hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-hugo@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>hugo-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;latest&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>extended</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>hugo --minify --cleanDestinationDir</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>peaceiris/actions-gh-pages@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>github_token</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.GITHUB_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>publish_dir</span><span class=p>:</span><span class=w> </span><span class=l>./public</span><span class=w>
</span></span></span></code></pre></div><p>You can study the code yourself, because I&rsquo;m not the one who created it ðŸ˜…. But, to make sure that the public folder always get cleaned first before build, I added <code>--cleanDestinationDir</code> option.</p><p>Let&rsquo;s commit this workflow and push it to GitHub.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ git add ./.github/workflows/gh-pages.yml
</span></span><span class=line><span class=cl>$ git commit -m <span class=s2>&#34;Add gh-pages.yml&#34;</span>
</span></span><span class=line><span class=cl>$ git push -u origin main
</span></span></code></pre></div><h2 id=trigger-the-workflow>Trigger the Workflow!<a class=anchor aria-hidden=true href=#trigger-the-workflow>#</a></h2><p>We can create a new post, then add some text to it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ hugo new post/test-gh-actions.md
</span></span><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;Test GH Action&#39;</span> &gt;&gt; content/post/test-gh-actions.md
</span></span></code></pre></div><p>Finally, commit the change and push it to your repository to trigger the workflow</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ git commit -m <span class=s2>&#34;Trigger build&#34;</span>
</span></span><span class=line><span class=cl>$ git push -u origin main
</span></span></code></pre></div><p>To observe the deployment process/workflow, just navigate to your site repository and click on the action menu (<code>https://github.com/your-username/your-username.github.io/actions</code>).</p><p>That&rsquo;s it!</p><h2 id=my-current-deployment>My Current Deployment<a class=anchor aria-hidden=true href=#my-current-deployment>#</a></h2><p>A bit off topic, but I&rsquo;ll show you my current deployment process.</p><p>My deployment process a little bit different, because I&rsquo;ve separated my blog into two: blog-core and the full static HTML site (it&rsquo;s this site). The blog-core is a private repo whereas the full static HTML is a public repository. The blog-core repo contains my draft, notes, and other (a lot of them), which is only available for me locally because of <code>.gitignore</code>.</p><p>When a new commit is pushed on the blog-core, GitHub Actions will be triggered to generate the static HTML files. The newly generated HTML files are then pushed to the public repo. I had to include my secret token in the blog-core so that GitHub Actions could use the token to authenticate itself to do some modification on public repo.</p><p><div class=img-container><img src=imgs/image-20211102111943965.png alt=image-20211102111943965></div></p><p>Note: these are not the actual commands.</p><p><del>I&rsquo;ll separate this section in a dedicated post later! nevermind lol</del></p><p>Well, it&rsquo;s not in detail, but it should give you an idea of how it works. See you in another post.</p><blockquote><p>I found the blog post that explains about this: <a href=https://victoria.dev/blog/two-ways-to-deploy-a-public-github-pages-site-from-a-private-hugo-repository/>Deploy a Public Github Pages site from a Private Hugo Repository</a>. And here&rsquo;s the Github Actions that I use <a href=https://github.com/victoriadrake/hugo-remote>Hugo Remote</a>.</p></blockquote><div class=post-references><h2>References</h2><ul><li><a href=https://github.com/peaceiris/actions-hugo target=_blank rel="noopener noreferrer">https://github.com/peaceiris/actions-hugo</a></li><li><a href=https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions target=_blank rel="noopener noreferrer">https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/tutorial/>Tutorial</a></li><li><a href=https://fahmifj.github.io/tags/hugo/>Hugo</a></li><li><a href=https://fahmifj.github.io/tags/ci/cd/>CI/CD</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Hugo Site Deployment With Github Actions on twitter" href="https://twitter.com/intent/tweet/?text=Hugo%20Site%20Deployment%20With%20Github%20Actions&url=https%3a%2f%2ffahmifj.github.io%2fblog%2fhugo-deployment-with-github-actions%2f&hashtags=Tutorial%2cHugo%2cCI%2fCD"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hugo Site Deployment With Github Actions on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fblog%2fhugo-deployment-with-github-actions%2f&title=Hugo%20Site%20Deployment%20With%20Github%20Actions&summary=Hugo%20Site%20Deployment%20With%20Github%20Actions&source=https%3a%2f%2ffahmifj.github.io%2fblog%2fhugo-deployment-with-github-actions%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hugo Site Deployment With Github Actions on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fblog%2fhugo-deployment-with-github-actions%2f&title=Hugo%20Site%20Deployment%20With%20Github%20Actions"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hugo Site Deployment With Github Actions on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fblog%2fhugo-deployment-with-github-actions%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hugo Site Deployment With Github Actions on whatsapp" href="https://api.whatsapp.com/send?text=Hugo%20Site%20Deployment%20With%20Github%20Actions%20-%20https%3a%2f%2ffahmifj.github.io%2fblog%2fhugo-deployment-with-github-actions%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hugo Site Deployment With Github Actions on telegram" href="https://telegram.me/share/url?text=Hugo%20Site%20Deployment%20With%20Github%20Actions&url=https%3a%2f%2ffahmifj.github.io%2fblog%2fhugo-deployment-with-github-actions%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;Â·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>